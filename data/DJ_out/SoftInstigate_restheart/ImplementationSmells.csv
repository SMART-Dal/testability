Project Name,Package Name,Type Name,Method Name,Implementation Smell,Cause of the Smell,Method start line no
SoftInstigate_restheart,org.restheart.polyglot,JSInterceptorFactory,create,Complex Method,Cyclomatic complexity of the method is 32,69
SoftInstigate_restheart,org.restheart.polyglot,JSInterceptorFactory,create,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@49e9faa8,69
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,JavaScriptService,Complex Method,Cyclomatic complexity of the method is 10,73
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,JavaScriptService,Long Statement,The length of the statement "var optionsSource=Source.newBuilder(language`optionsScript`"optionsScript").mimeType("application/javascript+module").build();" is 126.,73
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,JavaScriptService,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + ": "+ t.getMessage()+ "` "+ packageHint);" is 128.,73
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,JavaScriptService,Long Statement,The length of the statement "options.getMember("modulesReplacements").getMemberKeys().stream().forEach(k -> sb.append(k).append(":").append(options.getMember("modulesReplacements").getMember(k)).append("`"));" is 179.,73
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,JavaScriptService,Long Statement,The length of the statement "this.handleSource=Source.newBuilder(language`handleScript`"handleScript").mimeType("application/javascript+module").build();" is 124.,73
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Complex Method,Cyclomatic complexity of the method is 13,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` missing member 'options.name'` "+ packageHint);" is 137.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.name'` "+ packageHint);" is 135.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` missing member 'options.description'` "+ packageHint);" is 144.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.description'` "+ packageHint);" is 142.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` missing member 'options.uri'` "+ packageHint);" is 136.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.uri'` "+ packageHint);" is 134.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.uri'` "+ packageHint);" is 134.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.secured'` "+ packageHint);" is 138.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.matchPolicy'` "+ packageHint);" is 142.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.matchPolicy'` "+ packageHint);" is 142.,213
SoftInstigate_restheart,org.restheart.polyglot,JavaScriptService,checkOptions,Long Statement,The length of the statement "throw new IllegalArgumentException("wrong js service " + pluginPath.toAbsolutePath() + "` wrong member 'options.modulesReplacements'` "+ packageHint);" is 150.,213
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,watch,Long Statement,The length of the statement "pluginsDirectory.register(watchService`StandardWatchEventKinds.ENTRY_CREATE`StandardWatchEventKinds.ENTRY_MODIFY`StandardWatchEventKinds.ENTRY_DELETE);" is 151.,156
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,findJsPluginDirectories,Complex Conditional,The conditional expression !services.isEmpty() || !nodeServices.isEmpty() || !interceptors.isEmpty() is complex.,246
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,findDeclaredPlugins,Complex Conditional,The conditional expression p.isJsonObject() && p.getAsJsonObject().has(prop) && p.getAsJsonObject().get(prop).isJsonArray()&& p.getAsJsonObject().getAsJsonArray(prop).size() > 0 is complex.,308
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,findDeclaredPlugins,Complex Method,Cyclomatic complexity of the method is 8,308
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,findDeclaredPlugins,Long Statement,The length of the statement "if (p.isJsonObject() && p.getAsJsonObject().has(prop) && p.getAsJsonObject().get(prop).isJsonArray()&& p.getAsJsonObject().getAsJsonArray(prop).size() > 0) {" is 157.,308
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,deployService,Long Statement,The length of the statement "var record=new PluginRecord<Service>(srv.getName()`srv.getDescription()`srv.isSecured()`true`srv.getClass().getName()`srv`new HashMap<>());" is 139.,377
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,deployService,Long Statement,The length of the statement "LOGGER.info(ansi().fg(GREEN).a("URI {} bound to service {}` description: {}` secured: {}` uri match {}").reset().toString()`srv.getUri()`srv.getName()`srv.getDescription()`srv.isSecured()`srv.getMatchPolicy());" is 210.,377
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,deployNodeService,Long Statement,The length of the statement "var record=new PluginRecord<Service>(srv.getName()`"description"`srv.isSecured()`true`srv.getClass().getName()`srv`new HashMap<>());" is 132.,405
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,deployNodeService,Long Statement,The length of the statement "LOGGER.info(ansi().fg(GREEN).a("URI {} bound to service {}` description: {}` secured: {}` uri match {}").reset().toString()`srv.getUri()`srv.getName()`srv.getDescription()`srv.isSecured()`srv.getMatchPolicy());" is 210.,405
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,deployNodeService,Magic Number,The method contains a magic number: 300,405
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,deployInterceptor,Long Statement,The length of the statement "LOGGER.info(ansi().fg(GREEN).a("Added interceptor {}` description: {}").reset().toString()`interceptorRecord.getName()`interceptorRecord.getDescription());" is 155.,440
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,undeployServices,Long Statement,The length of the statement "var pathsToUndeploy=DEPLOYEES.keySet().stream().filter(path -> DEPLOYEES.get(path).isService).filter(path -> path.startsWith(pluginPath)).collect(Collectors.toList());" is 167.,461
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,undeployServices,Long Statement,The length of the statement "LOGGER.info(ansi().fg(GREEN).a("removed service {} bound to URI {}").reset().toString()`toUndeploy.getName()`toUndeploy.getUri());" is 130.,461
SoftInstigate_restheart,org.restheart.polyglot,PolyglotDeployer,undeployInterceptors,Long Statement,The length of the statement "var pathsToUndeploy=DEPLOYEES.keySet().stream().filter(path -> DEPLOYEES.get(path).isInterceptor).filter(path -> path.startsWith(pluginPath)).collect(Collectors.toList());" is 171.,479
SoftInstigate_restheart,org.restheart.polyglot,AbstractJSPlugin,AbstractJSPlugin,Long Parameter List,The method has 10 parameters. ,76
SoftInstigate_restheart,org.restheart.polyglot,AbstractJSPlugin,context,Long Statement,The length of the statement "return Context.newBuilder().engine(engine).allowAllAccess(true).allowHostAccess(HostAccess.ALL).allowHostClassLookup(className -> true).allowIO(true).allowExperimentalOptions(true).options(OPTS).build();" is 203.,98
SoftInstigate_restheart,org.restheart.polyglot,AbstractJSPlugin,addBindings,Long Parameter List,The method has 5 parameters. ,137
SoftInstigate_restheart,org.restheart.polyglot,AbstractJSPlugin,addBindings,Long Statement,The length of the statement "@SuppressWarnings("unchecked") var args=pluginsArgs != null ? (Map<String`Object>)pluginsArgs.getOrDefault(pluginName`new HashMap<String`Object>()) : new HashMap<String`Object>();" is 179.,137
SoftInstigate_restheart,org.restheart.polyglot,AbstractJSPlugin,finalize,Empty catch clause,The method has an empty catch block.,195
SoftInstigate_restheart,org.restheart.polyglot,NodeService,NodeService,Complex Conditional,The conditional expression !parsedObj.get("handle").isJsonPrimitive() || !parsedObj.get("handle").getAsJsonPrimitive().isString() || !"function".equals(parsedObj.get("handle").getAsString()) is complex.,82
SoftInstigate_restheart,org.restheart.polyglot,NodeService,NodeService,Complex Method,Cyclomatic complexity of the method is 17,82
SoftInstigate_restheart,org.restheart.polyglot,NodeService,NodeService,Long Statement,The length of the statement "if (!optionsObj.get("description").isJsonPrimitive() || !optionsObj.get("description").getAsJsonPrimitive().isString()) {" is 121.,82
SoftInstigate_restheart,org.restheart.polyglot,NodeService,NodeService,Long Statement,The length of the statement "if (!optionsObj.get("matchPolicy").isJsonPrimitive() || !optionsObj.get("matchPolicy").getAsJsonPrimitive().isString()) {" is 121.,82
SoftInstigate_restheart,org.restheart.polyglot,NodeService,NodeService,Long Statement,The length of the statement "if (!parsedObj.get("handle").isJsonPrimitive() || !parsedObj.get("handle").getAsJsonPrimitive().isString() || !"function".equals(parsedObj.get("handle").getAsString())) {" is 170.,82
SoftInstigate_restheart,org.restheart.polyglot,NodeService,NodeService,Magic Number,The method contains a magic number: 300,82
SoftInstigate_restheart,org.restheart.polyglot,NodeService,handle,Long Statement,The length of the statement "Object[] message={"handle"`this.codeHash`this.source`request`response`out`LOGGER`this.mclient`this.pluginArgs == null ? Maps.newHashMap() : this.pluginArgs.get(this.name)};" is 172.,197
SoftInstigate_restheart,org.restheart.polyglot.interceptors,JsonProxyJSInterceptor,JsonProxyJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.polyglot.interceptors,StringJSInterceptor,StringJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.polyglot.interceptors,CsvJSInterceptor,CsvJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.polyglot.interceptors,BsonJSInterceptor,BsonJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.polyglot.interceptors,AbstractJSInterceptor,AbstractJSInterceptor,Long Parameter List,The method has 9 parameters. ,43
SoftInstigate_restheart,org.restheart.polyglot.interceptors,ByteArrayJSInterceptor,ByteArrayJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.polyglot.interceptors,JsonJSInterceptor,JsonJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.polyglot.interceptors,ByteArrayProxyJSInterceptor,ByteArrayProxyJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.polyglot.interceptors,MongoJSInterceptor,MongoJSInterceptor,Long Parameter List,The method has 9 parameters. ,33
SoftInstigate_restheart,org.restheart.handlers,TracingInstrumentationHandler,handleRequest,Long Statement,The length of the statement "Optional.ofNullable(exchange.getRequestHeaders().get(traceIdHeader)).flatMap(x -> Optional.ofNullable(x.peekFirst())).ifPresent(value -> {" is 138.,43
SoftInstigate_restheart,org.restheart.handlers,ErrorHandler,handleRequest,Long Statement,The length of the statement "Response.of(exchange).setInError(HttpStatus.SC_INTERNAL_SERVER_ERROR`"Error handling the request` see logs for more information");" is 130.,53
SoftInstigate_restheart,org.restheart.handlers,ErrorHandler,handleRequest,Long Statement,The length of the statement "var errMsg="Error handling the request. " + "An external dependency could be missing for " + pi.getType().name().toLowerCase() + " "+ pi.getName()+ ". Copy the missing dependency jar to the plugins directory "+ "to add it to the classpath";" is 240.,53
SoftInstigate_restheart,org.restheart.handlers,ErrorHandler,handleRequest,Long Statement,The length of the statement "String version=Version.getInstance().getVersion() == null ? "of correct version" : "v" + Version.getInstance().getVersion();" is 124.,53
SoftInstigate_restheart,org.restheart.handlers,ErrorHandler,handleRequest,Long Statement,The length of the statement "var errMsg="Linkage error handling the request. " + "Check that " + pi.getType().name().toLowerCase() + " "+ pi.getName()+ " was compiled against restheart-commons "+ version;" is 175.,53
SoftInstigate_restheart,org.restheart.handlers,ErrorHandler,handleRequest,Long Statement,The length of the statement "Response.of(exchange).setInError(HttpStatus.SC_INTERNAL_SERVER_ERROR`"Error handling the request` see logs for more information"`le);" is 133.,53
SoftInstigate_restheart,org.restheart.handlers,ErrorHandler,handleRequest,Long Statement,The length of the statement "Response.of(exchange).setInError(HttpStatus.SC_INTERNAL_SERVER_ERROR`"Error handling the request` see logs for more information"`t);" is 132.,53
SoftInstigate_restheart,org.restheart.handlers,ConfigurableEncodingHandler,ConfigurableEncodingHandler,Long Statement,The length of the statement "super(next`new ContentEncodingRepository().addEncodingHandler("gzip"`new GzipEncodingProvider()`60).addEncodingHandler("deflate"`new DeflateEncodingProvider()`50));" is 164.,47
SoftInstigate_restheart,org.restheart.handlers,ConfigurableEncodingHandler,ConfigurableEncodingHandler,Magic Number,The method contains a magic number: 60,47
SoftInstigate_restheart,org.restheart.handlers,ConfigurableEncodingHandler,ConfigurableEncodingHandler,Magic Number,The method contains a magic number: 50,47
SoftInstigate_restheart,org.restheart.handlers,ConfigurableEncodingHandler,handleRequest,Long Statement,The length of the statement "if (Arrays.stream(values.split("`")).anyMatch((v) -> Headers.GZIP.toString().equals(v) || Headers.DEFLATE.toString().equals(v))) {" is 130.,64
SoftInstigate_restheart,org.restheart.handlers,ConfigurableEncodingHandler,handleRequest,Long Statement,The length of the statement "ByteArrayProxyResponse.of(exchange).setInError(HttpStatus.SC_BAD_REQUEST`"Accept-Encoding header must include gzip or deflate");" is 128.,64
SoftInstigate_restheart,org.restheart.handlers,ResponseInterceptorsExecutor,executeResponseInterceptor,Long Statement,The length of the statement "LOGGER.warn("Error resolving interceptor {} for {} on intercept point {}"`ri.getClass().getSimpleName()`exchange.getRequestPath()`InterceptPoint.RESPONSE`e);" is 157.,101
SoftInstigate_restheart,org.restheart.handlers,ResponseInterceptorsExecutor,executeResponseInterceptor,Long Statement,The length of the statement "LOGGER.debug("Executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`InterceptPoint.RESPONSE);" is 141.,101
SoftInstigate_restheart,org.restheart.handlers,ResponseInterceptorsExecutor,executeResponseInterceptor,Long Statement,The length of the statement "LOGGER.error("Error executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`InterceptPoint.RESPONSE`ex);" is 150.,101
SoftInstigate_restheart,org.restheart.handlers,ResponseInterceptorsExecutor,executeAsyncResponseInterceptor,Long Statement,The length of the statement "LOGGER.warn("Error resolving interceptor {} for {} on intercept point {}"`ri.getClass().getSimpleName()`exchange.getRequestPath()`InterceptPoint.RESPONSE_ASYNC);" is 161.,136
SoftInstigate_restheart,org.restheart.handlers,ResponseInterceptorsExecutor,executeAsyncResponseInterceptor,Long Statement,The length of the statement "LOGGER.debug("Executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`InterceptPoint.RESPONSE_ASYNC);" is 147.,136
SoftInstigate_restheart,org.restheart.handlers,ResponseInterceptorsExecutor,executeAsyncResponseInterceptor,Long Statement,The length of the statement "LOGGER.error("Error executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`InterceptPoint.RESPONSE_ASYNC`ex);" is 156.,136
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,dumpExchange,Complex Method,Cyclomatic complexity of the method is 12,89
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,dumpExchange,Long Statement,The length of the statement "final long start=request != null && request.getStartTime() != null ? request.getStartTime() : System.currentTimeMillis();" is 121.,89
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,dumpExchange,Long Statement,The length of the statement "sb.append(" locale=").append(LocaleUtils.getLocalesFromHeader(exchange.getRequestHeaders().get(Headers.ACCEPT_LANGUAGE))).append("\n");" is 135.,89
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,dumpExchange,Magic Number,The method contains a magic number: 2,89
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Complex Method,Cyclomatic complexity of the method is 13,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Long Statement,The length of the statement "exchange.addExchangeCompleteListener(( final HttpServerExchange exchange1` final ExchangeCompletionListener.NextListener nextListener) -> {" is 139.,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Long Statement,The length of the statement "sb.append(" elapsed=").append(System.currentTimeMillis() - start).append("ms").append(" contentLength=").append(exchange1.getResponseContentLength());" is 150.,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Long Statement,The length of the statement "sb.append(" cookie=").append(cookie.getName()).append("=").append(cookie.getValue()).append("; domain=").append(cookie.getDomain()).append("; path=").append(cookie.getPath()).append("\n");" is 188.,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Long Statement,The length of the statement "if (header.getHeaderName() != null && AUTH_TOKEN_HEADER.toString().equalsIgnoreCase(header.getHeaderName().toString())) {" is 121.,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Magic Number,The method contains a magic number: 300,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Magic Number,The method contains a magic number: 304,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Magic Number,The method contains a magic number: 2,209
SoftInstigate_restheart,org.restheart.handlers,RequestLogger,addExchangeCompleteListener,Magic Number,The method contains a magic number: 300,209
SoftInstigate_restheart,org.restheart.handlers,BeforeExchangeInitInterceptorsExecutor,BeforeExchangeInitInterceptorsExecutor,Long Statement,The length of the statement "this.wildCardInterceptors=pluginsRegistry.getInterceptors().stream().filter(pr -> pr.isEnabled()).map(pr -> pr.getInstance()).filter(i -> PluginUtils.interceptPoint(i) == REQUEST_BEFORE_EXCHANGE_INIT).filter(i -> i instanceof WildcardInterceptor).map(i -> (WildcardInterceptor)i).collect(Collectors.toCollection(ArrayList::new));" is 329.,52
SoftInstigate_restheart,org.restheart.handlers,BeforeExchangeInitInterceptorsExecutor,handleRequest,Long Statement,The length of the statement "LOGGER.warn("Error resolving interceptor {} for {} on intercept point {}"`ri.getClass().getSimpleName()`exchange.getRequestPath()`REQUEST_BEFORE_EXCHANGE_INIT`e);" is 162.,75
SoftInstigate_restheart,org.restheart.handlers,BeforeExchangeInitInterceptorsExecutor,handleRequest,Long Statement,The length of the statement "LOGGER.debug("Executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`REQUEST_BEFORE_EXCHANGE_INIT);" is 146.,75
SoftInstigate_restheart,org.restheart.handlers,BeforeExchangeInitInterceptorsExecutor,handleRequest,Long Statement,The length of the statement "LOGGER.error("Error executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`REQUEST_BEFORE_EXCHANGE_INIT`ex);" is 155.,75
SoftInstigate_restheart,org.restheart.handlers,CORSHandler,injectAccessControlAllowHeaders,Long Identifier,The length of the field ACCESS_CONTROL_ALLOW_CREDENTIAL is 31.,49
SoftInstigate_restheart,org.restheart.handlers,CORSHandler,injectAccessControlAllowHeaders,Long Statement,The length of the statement "responseHeaders.add(ACCESS_CONTROL_EXPOSE_HEADERS`LOCATION_STRING + "` " + Headers.ETAG+ "` "+ AUTH_TOKEN_HEADER.toString()+ "` "+ AUTH_TOKEN_VALID_HEADER.toString()+ "` "+ AUTH_TOKEN_LOCATION_HEADER.toString()+ "` "+ HttpHeaders.X_POWERED_BY);" is 244.,49
SoftInstigate_restheart,org.restheart.handlers,RequestInterceptorsExecutor,handleRequest,Long Statement,The length of the statement "LOGGER.warn("Error resolving interceptor {} for {} on intercept point {}"`ri.getClass().getSimpleName()`exchange.getRequestPath()`interceptPoint`e);" is 148.,76
SoftInstigate_restheart,org.restheart.handlers,RequestInterceptorsExecutor,handleRequest,Long Statement,The length of the statement "LOGGER.debug("Executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`interceptPoint);" is 132.,76
SoftInstigate_restheart,org.restheart.handlers,RequestInterceptorsExecutor,handleRequest,Long Statement,The length of the statement "LOGGER.error("Error executing interceptor {} for {} on intercept point {}"`PluginUtils.name(ri)`exchange.getRequestPath()`interceptPoint`ex);" is 141.,76
SoftInstigate_restheart,org.restheart.handlers,ResponseSender,handleRequest,Complex Method,Cyclomatic complexity of the method is 9,54
SoftInstigate_restheart,org.restheart.utils,JsonUnflattener,unflatten,Complex Method,Cyclomatic complexity of the method is 10,84
SoftInstigate_restheart,org.restheart.utils,JsonUnflattener,unflatten,Long Statement,The length of the statement "flattened.keySet().stream().filter(key -> keyPartPattern.matcher(key).matches()).forEach((key) -> unflattened.asDocument().put(key`flattened.get(key)));" is 152.,84
SoftInstigate_restheart,org.restheart.utils,JsonUnflattener,setUnflattenedValue,Long Parameter List,The method has 5 parameters. ,241
SoftInstigate_restheart,org.restheart.utils,JsonUnflattener,hashCode,Magic Number,The method contains a magic number: 27,269
SoftInstigate_restheart,org.restheart.utils,JsonUnflattener,hashCode,Magic Number,The method contains a magic number: 31,269
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getPaginationLinks,Complex Method,Cyclomatic complexity of the method is 12,58
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getPaginationLinks,Long Statement,The length of the statement "String queryStringNoPagingProps=URLUtils.decodeQueryString(URLUtils.getQueryStringRemovingParams(exchange`"page"`"pagesize"));" is 126.,58
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getPaginationLinks,Long Statement,The length of the statement "links.put("last"`requestPath + (totalPages != 1 ? "?page=" + totalPages : "") + (totalPages == 1 ? "?pagesize=" : "&pagesize=")+ pagesize+ "&"+ queryStringNoPagingProps);" is 170.,58
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getPaginationLinks,Long Statement,The length of the statement "links.put("last"`requestPath + (totalPages != 1 ? "?page=" + totalPages : "") + (totalPages == 1 ? "?pagesize=" : "&pagesize=")+ pagesize+ "&"+ queryStringNoPagingProps);" is 170.,58
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Complex Method,Cyclomatic complexity of the method is 14,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "LOGGER.error("error creating URI` null arguments: " + "response = {}` parentUrl = {}` docId = {}"`response`parentUrl`docId);" is 124.,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat(docId.asString().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.STRING.name());" is 183.,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + docId.asInt32().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 187.,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + docId.asInt64().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 187.,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + docId.asDouble().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 188.,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + docId.asDateTime().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.DATE.name());" is 188.,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "response.addWarning("resource with _id: " + _id + " does not have an URI "+ "since the _id is of type "+ docId.getClass().getSimpleName());" is 139.,150
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Complex Method,Cyclomatic complexity of the method is 23,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat(docId.toString()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.STRING.name());" is 172.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + ((BsonNumber)docId).asInt32().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 201.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + ((BsonNumber)docId).asInt64().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 201.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + ((BsonDouble)docId).asDouble().getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 202.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat("" + ((BsonDateTime)docId).getValue()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.DATE.name());" is 191.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat(docId.toString()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 172.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat(docId.toString()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 172.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat(docId.toString()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 172.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat(docId.toString()).concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.NUMBER.name());" is 172.,256
SoftInstigate_restheart,org.restheart.utils,RepresentationUtils,getReferenceLink,Long Statement,The length of the statement "uri=URLUtils.removeTrailingSlashes(parentUrl).concat("/").concat(((Date)docId).getTime() + "").concat("?").concat(DOC_ID_TYPE_QPARAM_KEY).concat("=").concat(DOC_ID_TYPE.DATE.name());" is 182.,256
SoftInstigate_restheart,org.restheart.utils,HttpStatus,getStatusText,Complex Conditional,The conditional expression classIndex < 1 || classIndex > (REASON_PHRASES.length - 1) || codeIndex < 0 || codeIndex > (REASON_PHRASES[classIndex].length - 1) is complex.,339
SoftInstigate_restheart,org.restheart.utils,HttpStatus,getStatusText,Long Statement,The length of the statement "if (classIndex < 1 || classIndex > (REASON_PHRASES.length - 1) || codeIndex < 0 || codeIndex > (REASON_PHRASES[classIndex].length - 1)) {" is 137.,339
SoftInstigate_restheart,org.restheart.utils,HttpStatus,getStatusText,Magic Number,The method contains a magic number: 100,339
SoftInstigate_restheart,org.restheart.utils,HttpStatus,getStatusText,Magic Number,The method contains a magic number: 100,339
SoftInstigate_restheart,org.restheart.utils,HttpStatus,addStatusCodeMap,Magic Number,The method contains a magic number: 100,364
SoftInstigate_restheart,org.restheart.utils,HttpStatus,addStatusCodeMap,Magic Number,The method contains a magic number: 100,364
SoftInstigate_restheart,org.restheart.utils,BuffersUtils,dump,Magic Number,The method contains a magic number: 2,135
SoftInstigate_restheart,org.restheart.utils,BuffersUtils,dump,Magic Number,The method contains a magic number: 2,135
SoftInstigate_restheart,org.restheart.utils,Minify,minify,Complex Method,Cyclomatic complexity of the method is 25,115
SoftInstigate_restheart,org.restheart.utils,Minify,minify,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@6fdb24da,115
SoftInstigate_restheart,org.restheart.utils,Minify,minify,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@4564139e,115
SoftInstigate_restheart,org.restheart.utils,Minify,minify,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@2ad54a66,115
SoftInstigate_restheart,org.restheart.utils,Minify,minify,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@4d225c3a,115
SoftInstigate_restheart,org.restheart.utils,Minify,action,Complex Conditional,The conditional expression nextChar == '/' && (currChar == '(' || currChar == '`' || currChar == '=' || currChar == ':') is complex.,226
SoftInstigate_restheart,org.restheart.utils,Minify,action,Complex Method,Cyclomatic complexity of the method is 14,226
SoftInstigate_restheart,org.restheart.utils,Minify,isAlphanum,Long Statement,The length of the statement "return ((c >= 'a' && c <= 'z') || (c >= '0' && c <= '9') || (c >= 'A' && c <= 'Z')|| c == '_' || c == '$' || c == '\\' || c > 126);" is 131.,294
SoftInstigate_restheart,org.restheart.utils,Minify,isAlphanum,Magic Number,The method contains a magic number: 126,294
SoftInstigate_restheart,org.restheart.utils,Minify,get,Complex Conditional,The conditional expression c >= ' ' || c == '\n' || c == EOF is complex.,307
SoftInstigate_restheart,org.restheart.utils,Minify,next,Complex Method,Cyclomatic complexity of the method is 10,351
SoftInstigate_restheart,org.restheart.utils,Minify,next,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@7b695cb0,351
SoftInstigate_restheart,org.restheart.utils,LogUtils,boxedMessage,Long Parameter List,The method has 5 parameters. ,78
SoftInstigate_restheart,org.restheart.utils,LogUtils,boxedMessage,Magic Number,The method contains a magic number: 66,78
SoftInstigate_restheart,org.restheart.utils,LogUtils,header,Long Statement,The length of the statement "return ansi().a("\n").fg(GREEN).a("*-------------------------------------------------------------------*\n" + "| |\n").reset();" is 127.,110
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,getOrDefault,Long Statement,The length of the statement "LOGGER.warn("Parameter \"{}\" not specified in the configuration file` using its default value \"{}\""`key`defaultValue);" is 121.,49
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,getOrDefault,Long Statement,The length of the statement "LOGGER.warn("Wrong configuration parameter \"{}\": \"{}\"` using its default value \"{}\""`key`conf.get(key)`defaultValue);" is 123.,49
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,asListOfMaps,Long Statement,The length of the statement "LOGGER.trace("configuration parameter {} not specified in the configuration file` using its default value {}"`key`defaultValue);" is 128.,81
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,asMapOfMaps,Complex Method,Cyclomatic complexity of the method is 8,120
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,asMapOfMaps,Long Statement,The length of the statement "LOGGER.trace("configuration parameter {} not specified in the configuration file` using its default value {}"`key`defaultValue);" is 128.,120
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,asListOfStrings,Complex Method,Cyclomatic complexity of the method is 9,225
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,_valueFromEnv,Long Statement,The length of the statement "var key=prefix != null ? prefix + "_" + confParameter.toUpperCase().replaceAll("-"`"_") : confParameter.toUpperCase().replaceAll("-"`"_");" is 138.,346
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,__valueFromEnv,Long Statement,The length of the statement "LOGGER.warn(">>> Found environment variable '{}': overriding parameter '{}' with value '{}'"`key`confParameter`envValue);" is 121.,353
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,overrides,Complex Method,Cyclomatic complexity of the method is 9,483
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtils,overrides,Magic Number,The method contains a magic number: 2,483
SoftInstigate_restheart,org.restheart.utils,BsonUtils,unescapeKeys,Complex Method,Cyclomatic complexity of the method is 9,87
SoftInstigate_restheart,org.restheart.utils,BsonUtils,unescapeKeys,Long Statement,The length of the statement "return json.asString().getValue().startsWith(ESCAPED_DOLLAR) ? new BsonString(json.asString().getValue().substring(1)) : json;" is 126.,87
SoftInstigate_restheart,org.restheart.utils,BsonUtils,escapeKeys,Complex Conditional,The conditional expression escapeDots && !(dontEscapeDotsInRootKeys && root[0]) is complex.,167
SoftInstigate_restheart,org.restheart.utils,BsonUtils,escapeKeys,Complex Method,Cyclomatic complexity of the method is 10,167
SoftInstigate_restheart,org.restheart.utils,BsonUtils,getPropsFromPath,Complex Conditional,The conditional expression pathTokens == null || pathTokens.length == 0 || !pathTokens[0].equals(DOLLAR) is complex.,241
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_getPropsFromPath,Complex Method,Cyclomatic complexity of the method is 28,262
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_getPropsFromPath,Magic Number,The method contains a magic number: 2,262
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_getPropsFromPath,Magic Number,The method contains a magic number: 2,262
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_getPropsFromPath,Magic Number,The method contains a magic number: 2,262
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_getPropsFromPath,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@1e7458a0,262
SoftInstigate_restheart,org.restheart.utils,BsonUtils,isAncestorPath,Complex Method,Cyclomatic complexity of the method is 9,392
SoftInstigate_restheart,org.restheart.utils,BsonUtils,isAncestorPath,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@1e72a772,392
SoftInstigate_restheart,org.restheart.utils,BsonUtils,checkType,Complex Conditional,The conditional expression !o.isPresent() && !"null".equals(type) && !"notnull".equals(type) is complex.,500
SoftInstigate_restheart,org.restheart.utils,BsonUtils,toJson,Long Statement,The length of the statement "var settings=mode != null ? JsonWriterSettings.builder().outputMode(mode).indent(false).build() : JsonWriterSettings.builder().indent(false).dateTimeConverter(new Converter<Long>(){" is 181.,605
SoftInstigate_restheart,org.restheart.utils,BsonUtils,containsUpdateOperators,Long Statement,The length of the statement "return json.asArray().stream().filter(el -> el.isDocument()).anyMatch(element -> _containsUpdateOperators(element.asDocument()`ignoreCurrentDate));" is 147.,728
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_containsUpdateOperators,Long Statement,The length of the statement "return json.asDocument().keySet().stream().filter(key -> !ignoreCurrentDate || !key.equals("$currentDate")).anyMatch(key -> isUpdateOperator(key));" is 147.,751
SoftInstigate_restheart,org.restheart.utils,BsonUtils,flatten,Long Statement,The length of the statement "var keys=json.keySet().stream().filter(key -> !ignoreUpdateOperators || !isUpdateOperator(key)).collect(Collectors.toList());" is 125.,771
SoftInstigate_restheart,org.restheart.utils,BsonUtils,containsKeys,Long Statement,The length of the statement "return all ? array.stream().allMatch(doc -> containsKeys(doc`keys`all)) : array.stream().anyMatch(doc -> containsKeys(doc`keys`all));" is 133.,814
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_containsKeys,Long Statement,The length of the statement "return all ? keys.stream().allMatch(key -> _containsKeys(ufdoc`key`all)) : keys.stream().anyMatch(key -> _containsKeys(ufdoc`key`all));" is 135.,844
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_containsKeys,Complex Conditional,The conditional expression first.length() > 0 && doc.containsKey(first) && doc.get(first).isDocument() is complex.,852
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_containsKeys,Complex Conditional,The conditional expression first.length() > 0 && doc.containsKey(first) && doc.get(first).isArray() is complex.,852
SoftInstigate_restheart,org.restheart.utils,BsonUtils,_containsKeys,Long Statement,The length of the statement "var checkInUO=updateOperators.stream().anyMatch(uo -> _containsKeys(BsonUtils.unflatten(doc.get(uo)).asDocument()`key`all));" is 124.,852
SoftInstigate_restheart,org.restheart.utils,NetUtils,getLocalHostLANAddress,Complex Method,Cyclomatic complexity of the method is 8,31
SoftInstigate_restheart,org.restheart.utils,PluginUtils,actualUri,Complex Conditional,The conditional expression conf != null && conf.get("uri") != null && conf.get("uri") instanceof String is complex.,197
SoftInstigate_restheart,org.restheart.utils,URLUtils,removeTrailingSlashes,Magic Number,The method contains a magic number: 2,35
SoftInstigate_restheart,org.restheart.utils,URLUtils,getParentPath,Complex Conditional,The conditional expression path == null || path.isEmpty() || path.equals("/") is complex.,74
SoftInstigate_restheart,org.restheart.utils,URLUtils,getQueryStringRemovingParams,Complex Conditional,The conditional expression ret == null || ret.isEmpty() || paramsToRemove == null is complex.,104
SoftInstigate_restheart,org.restheart.utils,MetricsUtils,failedAuthHistogramName,Long Statement,The length of the statement "return null == null ? MetricRegistry.name(Authenticator.class`"failed-auth-x-forwarded-for"`"not-set") : MetricRegistry.name(Authenticator.class`"failed-auth-x-forwarded-for"`xffValue(xff`xffReverseIndex));" is 206.,44
SoftInstigate_restheart,org.restheart.utils,ResourcesExtractor,delete,Complex Method,Cyclomatic complexity of the method is 8,149
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testObjectAndFieldWithDotNotation,Magic Number,The method contains a magic number: 4,134
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testObjectWithNumericKeyFieldWithDotNotation,Magic Number,The method contains a magic number: 4,156
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testNestedObjectWithDotNotation,Magic Number,The method contains a magic number: 4,178
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArray,Magic Number,The method contains a magic number: 5,204
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArray,Magic Number,The method contains a magic number: 2,204
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArray,Magic Number,The method contains a magic number: 3,204
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArrayDotNotationLeaf,Magic Number,The method contains a magic number: 3,225
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArrayWithDotNotation,Magic Number,The method contains a magic number: 5,249
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArrayWithDotNotation,Magic Number,The method contains a magic number: 2,249
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArrayWithDotNotation,Magic Number,The method contains a magic number: 3,249
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArrayOfDocumentsWithDotNotation,Magic Number,The method contains a magic number: 5,272
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArrayOfDocumentsWithDotNotation,Magic Number,The method contains a magic number: 2,272
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testArrayOfDocumentsWithDotNotation,Magic Number,The method contains a magic number: 3,272
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testNestedObjectAndWithNumericKeyFieldWithDotNotation,Long Statement,The length of the statement "assertTrue("check sub first element has f property is 'b'"`sub.get(0).asDocument().get("f").asString().getValue().equals("b"));" is 127.,295
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testNestedObjectAndWithNumericKeyFieldWithDotNotation,Magic Number,The method contains a magic number: 4,295
SoftInstigate_restheart,org.restheart.utils,JSONUnflattenerTest,testDotNotationInNestedPropery,Long Statement,The length of the statement "assertTrue("check result contains keys as document with field 'ids.code'"`result.asDocument().get("keys").asDocument().containsKey("ids.code"));" is 144.,322
SoftInstigate_restheart,org.restheart.utils,MetricsUtilsTest,testLast,Magic Number,The method contains a magic number: 2,27
SoftInstigate_restheart,org.restheart.utils,MetricsUtilsTest,testLast,Magic Number,The method contains a magic number: 3,27
SoftInstigate_restheart,org.restheart.utils,MetricsUtilsTest,testLast,Magic Number,The method contains a magic number: 2,27
SoftInstigate_restheart,org.restheart.utils,ConfigurationUtilsTest,testSplit,Magic Number,The method contains a magic number: 4,73
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testGetPropFromPath,Long Statement,The length of the statement "Assert.assertTrue(checkGetPropsFromPath(json1`"$.*"`"{b:1` c: {d:{\"$oid\": \"550c6e62c2e62b5640673e93\"}` e:3}}"`"null"));" is 123.,115
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testGetPropFromPath,Long Statement,The length of the statement "Assert.assertTrue(checkGetPropsFromPath(json1`"$.a"`"{b:1` c: {d:{\"$oid\": \"550c6e62c2e62b5640673e93\"}`e:3}}` f: null}"));" is 125.,115
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,checkCountOnComplexJson,Long Statement,The length of the statement "String _json="{\n" + " \"_id\": \"project-processes\"`\n" + " \"descr\": \"Progetto - Processi\"`\n"+ " \"items\": {\n"+ " \"manufactoring\": {\n"+ " \"descr\": \"Lavorazioni e Costruzioni\"`\n"+ " \"items\": {\n"+ " \"strobel\": {\n"+ " \"descr\": \"Strobel\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"double_lasting\": {\n"+ " \"descr\": \"Sacchetto o Double Lasting\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 2\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"mounted\": {\n"+ " \"descr\": \"Montato\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"membrane_on_upper\": {\n"+ " \"descr\": \"Membrana su Tomaia\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"bootie\": {\n"+ " \"descr\": \"Bootie\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"tubolar\": {\n"+ " \"descr\": \"Tubolare\"`\n"+ " \"type\": \"boolean\"`\n"+ " \"svalues\": [\n"+ " 0`\n"+ " 1.5\n"+ " ]\n"+ " }`\n"+ " \"others\": {\n"+ " \"descr\": \"Altro\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"injection\": {\n"+ " \"descr\": \"Iniezione\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"injection_casting\": {\n"+ " \"descr\": \"Iniezione per colata\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"glue\": {\n"+ " \"descr\": \"Incollata\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"blake\": {\n"+ " \"descr\": \"Blake\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"california\": {\n"+ " \"descr\": \"California\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"goodyear\": {\n"+ " \"descr\": \"Goodyear\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"ideal\": {\n"+ " \"descr\": \"Ideal\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"opanks\": {\n"+ " \"descr\": \"Opanks\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"vulcanized\": {\n"+ " \"descr\": \"Vulcanizzata\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"best_process\": {\n"+ " \"descr\": \"Best process\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 3\n"+ " }\n"+ " }\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"treatments\": {\n"+ " \"descr\": \"Trattamenti\"`\n"+ " \"items\": {\n"+ " \"dye\": {\n"+ " \"descr\": \"Tinta in capo/verniciatura\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"stonewash\": {\n"+ " \"descr\": \"Stone Wash\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 1.75\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"colours_faded\": {\n"+ " \"descr\": \"Slavati\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 2.5\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"creams_waxes\": {\n"+ " \"descr\": \"Cere e Creme\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 3.25\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"spray\": {\n"+ " \"descr\": \"Spray\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 3.25\n"+ " }\n"+ " }\n"+ " }`\n"+ " \"none\": {\n"+ " \"descr\": \"Nessun Trattamento\"`\n"+ " \"type\": \"boolean\"`\n"+ " \"values\": {\n"+ " \"no\": {\n"+ " \"descr\": \"Si\"`\n"+ " \"svalue\": 0\n"+ " }`\n"+ " \"yes\": {\n"+ " \"descr\": \"No\"`\n"+ " \"svalue\": 4\n"+ " }\n"+ " }\n"+ " }\n"+ " }\n"+ " }\n"+ " }\n"+ "}";" is 5681.,278
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,checkCountOnComplexJson,Long Statement,The length of the statement "LOG.debug("$.items.*.items.*.values.*.descr" + " -> " + BsonUtils.getPropsFromPath(json`"$.items.*.items.*.values.*.descr"));" is 125.,278
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,checkCountOnComplexJson,Long Statement,The length of the statement "LOG.debug("$.items.*.items.*.values.*.svalue" + " -> " + BsonUtils.getPropsFromPath(json`"$.items.*.items.*.values.*.svalue"));" is 127.,278
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,checkCountOnComplexJson,Magic Number,The method contains a magic number: 4,278
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testParseFloat,Magic Number,The method contains a magic number: 3.1415,666
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,eq,Complex Conditional,The conditional expression lo.isPresent() && ro.isPresent() && !lo.get().equals(ro.get()) is complex.,713
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,eq,Complex Method,Cyclomatic complexity of the method is 12,713
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testJsonUnflatten,Magic Number,The method contains a magic number: 3,826
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testParseLong,Magic Number,The method contains a magic number: 1111111115887391606l,862
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testParseLong2,Magic Number,The method contains a magic number: 4294967296l,890
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testParseLong2,Magic Number,The method contains a magic number: 5999999999l,890
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testParseInt,Magic Number,The method contains a magic number: 10,904
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testParseDouble,Long Statement,The length of the statement "System.out.println(BsonUtils.toJson(BsonUtils.parse("{'n':{'$numberDouble':'11111111158873916063432424232349289023842309842039587209357329578573489573958734985753498573495743957349839'}}")));" is 191.,912
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testDocumentArrayBuilder,Long Statement,The length of the statement "var uriOrNameCondBuilder=array().add(document().put("APP_URI_FIELD"`"appURI")).add(document().put("APP_NAME_FIELD"`"appURI"));" is 126.,920
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testDocumentArrayBuilder,Long Statement,The length of the statement "var conditionsBuilder=array().add(document().put("$or"`uriOrNameCondBuilder)).add(document().put("APP_ENABLED_FIELD"`true));" is 124.,920
SoftInstigate_restheart,org.restheart.utils,BsonUtilsTest,testDocumentArrayBuilder,Long Statement,The length of the statement "Assert.assertTrue("checking array with docs created with builder equal to what created with constructors"`findArgBuilder.get().toJson().equals(findArg.toJson()));" is 162.,920
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithEmptyRegistry,Long Statement,The length of the statement "assertEquals("{\"version\": \"3.0.0\"` \"gauges\": {}` \"counters\": {}` \"histograms\": {}` \"meters\": {}` \"timers\": {}}"`bson.toJson());" is 141.,36
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithOneTimer,Long Statement,The length of the statement "assertEquals("{\"version\": \"3.0.0\"` \"gauges\": {}` \"counters\": {}` \"histograms\": {}` \"meters\": {}` \"timers\": {\"foobar\": {\"count\": 1` \"max\": 5.0` \"mean\": 5.0` \"min\": 5.0` \"p50\": 5.0` \"p75\": 5.0` \"p95\": 5.0` \"p98\": 5.0` \"p99\": 5.0` \"p999\": 5.0` \"stddev\": 0.0` \"m15_rate\": 0.0` \"m1_rate\": 0.0` \"m5_rate\": 0.0` \"mean_rate\": 1` \"duration_units\": \"milliseconds\"` \"rate_units\": \"calls/second\"}}}"`bson.toJson(writerSettings).replaceAll("\"mean_rate\": [0-9.]+"`"\"mean_rate\": 1"));" is 527.,50
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithOneTimer,Magic Number,The method contains a magic number: 5,50
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithGauges,Long Statement,The length of the statement "assertEquals("{\"version\": \"3.0.0\"` \"gauges\": {\"foobar\": {\"value\": 5}}` \"counters\": {}` \"histograms\": {}` \"meters\": {}` \"timers\": {}}"`bson.toJson(writerSettings));" is 181.,65
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithGauges,Magic Number,The method contains a magic number: 5,65
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithHistogram,Long Statement,The length of the statement "assertEquals("{\"version\": \"3.0.0\"` \"gauges\": {}` \"counters\": {}` \"histograms\": {\"foobar\": {\"count\": 1` \"max\": 5.0` \"mean\": 5.0` \"min\": 5.0` \"p50\": 5.0` \"p75\": 5.0` \"p95\": 5.0` \"p98\": 5.0` \"p99\": 5.0` \"p999\": 5.0` \"stddev\": 0.0}}` \"meters\": {}` \"timers\": {}}"`bson.toJson(writerSettings));" is 326.,78
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithHistogram,Magic Number,The method contains a magic number: 5,78
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithCounter,Long Statement,The length of the statement "assertEquals("{\"version\": \"3.0.0\"` \"gauges\": {}` \"counters\": {\"foobar\": {\"count\": 3}}` \"histograms\": {}` \"meters\": {}` \"timers\": {}}"`bson.toJson(writerSettings));" is 181.,91
SoftInstigate_restheart,org.restheart.utils,MetricsJsonGeneratorTest,testGenerationWithMeter,Long Statement,The length of the statement "assertEquals("{\"version\": \"3.0.0\"` \"gauges\": {}` \"counters\": {}` \"histograms\": {}` \"meters\": {\"foobar\": {\"count\": 1` \"m15_rate\": 0.0` \"m1_rate\": 0.0` \"m5_rate\": 0.0` \"mean_rate\": 1` \"units\": \"calls/second\"}}` \"timers\": {}}"`bson.toJson(writerSettings).replaceAll("\"mean_rate\": [0-9.]+"`"\"mean_rate\": 1"));" is 339.,107
SoftInstigate_restheart,org.restheart.utils,URLUtilsTest,testGetUriWithLongDocId,Magic Number,The method contains a magic number: 123,165
SoftInstigate_restheart,org.restheart.utils,URLUtilsTest,testGetUriWithFilterMany,Magic Number,The method contains a magic number: 20.0d,181
SoftInstigate_restheart,org.restheart.utils,URLUtilsTest,testGetUriWithFilterManyString,Magic Number,The method contains a magic number: 20.0d,222
SoftInstigate_restheart,org.restheart.utils,URLUtilsTest,testGetUriWithFilterOneInteger,Magic Number,The method contains a magic number: 123,259
SoftInstigate_restheart,org.restheart.utils,URLUtilsTest,testGetUriWithFilterManyInverseLong,Magic Number,The method contains a magic number: 123,308
SoftInstigate_restheart,org.restheart.utils,URLUtilsTest,testGetUriWithFilterManyInverseObjectId,Long Statement,The length of the statement "String expResult="/dbName/collName?filter={'referenceField':{'$elemMatch':{'$eq':{'$oid':'" + id.getValue().toString() + "'}}}}";" is 129.,324
SoftInstigate_restheart,org.restheart.utils,BootstrapperUtils,getInstanceName,Long Statement,The length of the statement "return configuration == null ? UNDEFINED : configuration.getInstanceName() == null ? UNDEFINED : configuration.getInstanceName();" is 129.,50
SoftInstigate_restheart,org.restheart.utils,BootstrapperUtils,logStartMessages,Long Statement,The length of the statement "LOGGER.info(STARTING + ansi().fg(RED).bold().a(RESTHEART).reset().toString() + INSTANCE+ ansi().fg(RED).bold().a(instanceName).reset().toString());" is 147.,130
SoftInstigate_restheart,org.restheart.utils,FileUtils,getPidFromFile,Magic Number,The method contains a magic number: 2,137
SoftInstigate_restheart,org.restheart.utils,FileUtils,getPidFromFile,Magic Number,The method contains a magic number: 3,137
SoftInstigate_restheart,org.restheart.utils,RESTHeartDaemon,daemonize,Magic Number,The method contains a magic number: 4,51
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testGet,Magic Number,The method contains a magic number: 100,41
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testGet,Magic Number,The method contains a magic number: 10000,41
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,getNonExistent,Magic Number,The method contains a magic number: 100,51
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,getNonExistent,Magic Number,The method contains a magic number: 10000,51
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testPutNull,Magic Number,The method contains a magic number: 100,58
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testPutNull,Magic Number,The method contains a magic number: 10000,58
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testRemoval,Empty catch clause,The method has an empty catch block.,68
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testRemoval,Magic Number,The method contains a magic number: 100,68
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testRemoval,Magic Number,The method contains a magic number: 10000,68
SoftInstigate_restheart,org.restheart.cache.impl,CaffeineCacheTest,testRemoval,Magic Number,The method contains a magic number: 50,68
SoftInstigate_restheart,org.restheart,Version,Version,Long Statement,The length of the statement "this.version=Version.class.getPackage().getImplementationVersion() == null ? null : Version.class.getPackage().getImplementationVersion();" is 138.,51
SoftInstigate_restheart,org.restheart,Version,extractBuildTime,Long Statement,The length of the statement "return MANIFEST_ENTRIES == null ? Instant.now() : MANIFEST_ENTRIES.stream().filter(e -> e.getKey().toString().equals("Build-Time")).map(e -> (String)e.getValue()).filter(d -> d != null).map(d -> {" is 196.,80
SoftInstigate_restheart,org.restheart,Configuration,Configuration,Long Statement,The length of the statement "logFilePath=asString(conf`LOG_FILE_PATH_KEY`URLUtils.removeTrailingSlashes(System.getProperty("java.io.tmpdir")).concat(File.separator + "restheart.log")`silent);" is 162.,123
SoftInstigate_restheart,org.restheart,Configuration,Configuration,Magic Number,The method contains a magic number: 100,123
SoftInstigate_restheart,org.restheart,Configuration,Configuration,Magic Number,The method contains a magic number: 2,123
SoftInstigate_restheart,org.restheart,Configuration,Configuration,Magic Number,The method contains a magic number: 32,123
SoftInstigate_restheart,org.restheart,Configuration,Configuration,Magic Number,The method contains a magic number: 16384,123
SoftInstigate_restheart,org.restheart,ConfigurationTest,testConfigurationTemplate,Long Statement,The length of the statement "assertEquals("mongodb://restheart:R3ste4rt!@mongodb-test/?readPreference=primary&authSource=admin"`conf.getMongoUri().toString());" is 130.,49
SoftInstigate_restheart,org.restheart,Shutdowner,main,Magic Number,The method contains a magic number: 5,38
SoftInstigate_restheart,org.restheart,Shutdowner,shutdown,Long Statement,The length of the statement "LOGGER.info("Shutting down RESTHeart instance run with configuration file {} and property file {}"`FileUtils.getConfigurationFilePath(args)`FileUtils.getPropertiesFilePath(args));" is 179.,57
SoftInstigate_restheart,org.restheart,Shutdowner,shutdown,Long Statement,The length of the statement "Path pidFilePath=FileUtils.getPidFilePath(FileUtils.getFileAbsolutePathHash(FileUtils.getConfigurationFilePath(args)`FileUtils.getPropertiesFilePath(args)));" is 157.,57
SoftInstigate_restheart,org.restheart,Shutdowner,shutdown,Magic Number,The method contains a magic number: 15,57
SoftInstigate_restheart,org.restheart,Shutdowner,printHelp,Long Statement,The length of the statement "LOGGER.info("java -cp restheart.jar org.restheart.Shutdowner \u2192 shutdown RESTHeart instance run without specifying the configuration file.");" is 145.,105
SoftInstigate_restheart,org.restheart,Shutdowner,printHelp,Long Statement,The length of the statement "LOGGER.info(" java -cp restheart.jar org.restheart.Shutdowner restheart.yml -e default.properties \u2192 shutdown RESTHeart instance run with configuration and properties files.");" is 180.,105
SoftInstigate_restheart,org.restheart,Bootstrapper,parseCommandLineParameters,Long Statement,The length of the statement "System.out.println(RESTHEART.concat(" Version ").concat(version).concat(" Build-Time ").concat(DateTimeFormatter.ofPattern("yyyy-MM-dd").withZone(ZoneId.systemDefault()).format(Version.getInstance().getBuildTime())));" is 217.,176
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "var content=new BufferedReader(new InputStreamReader(confFileStream`StandardCharsets.UTF_8)).lines().collect(Collectors.joining("\n"));" is 135.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "logErrorAndExit("Error instantiating plugins: an external dependency is missing. Copy the missing dependency jar to the plugins directory to add it to the classpath"`iae`false`-112);" is 182.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "logErrorAndExit("Error instantiating plugins: an external dependency is missing. Copy the missing dependency jar to the plugins directory to add it to the classpath"`ncdfe`false`-112);" is 184.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "var version=Version.getInstance().getVersion() == null ? "of correct version" : "v" + Version.getInstance().getVersion();" is 121.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "logErrorAndExit("Linkage error instantiating plugins. Check that all plugins were compiled against restheart-commons " + version`le`false`-111);" is 144.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "PluginsRegistryImpl.getInstance().getInitializers().stream().filter(i -> initPoint(i.getInstance()) == BEFORE_STARTUP).forEach(i -> {" is 133.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "LOGGER.error("Error executing initializer {}. An external dependency is missing. Copy the missing dependency jar to the plugins directory to add it to the classpath"`i.getName()`iae);" is 183.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "var version=Version.getInstance().getVersion() == null ? "of correct version" : "v" + Version.getInstance().getVersion();" is 121.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "LOGGER.error("Linkage error executing initializer {}. Check that it was compiled against restheart-commons {}"`i.getName()`version`le);" is 135.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "PluginsRegistryImpl.getInstance().getInitializers().stream().filter(i -> initPoint(i.getInstance()) == AFTER_STARTUP).forEach(i -> {" is 132.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "LOGGER.error("Error executing initializer {}. An external dependency is missing. Copy the missing dependency jar to the plugins directory to add it to the classpath"`i.getName()`iae);" is 183.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "var version=Version.getInstance().getVersion() == null ? "of correct version" : "v" + Version.getInstance().getVersion();" is 121.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Long Statement,The length of the statement "LOGGER.error("Linkage error executing initializer {}. Check that it was compiled against restheart-commons {}"`i.getName()`version`le);" is 135.,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Magic Number,The method contains a magic number: 112,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Magic Number,The method contains a magic number: 110,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Magic Number,The method contains a magic number: 112,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Magic Number,The method contains a magic number: 111,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Magic Number,The method contains a magic number: 110,288
SoftInstigate_restheart,org.restheart,Bootstrapper,startServer,Magic Number,The method contains a magic number: 2,288
SoftInstigate_restheart,org.restheart,Bootstrapper,stopServer,Complex Method,Cyclomatic complexity of the method is 9,434
SoftInstigate_restheart,org.restheart,Bootstrapper,stopServer,Magic Number,The method contains a magic number: 60,434
SoftInstigate_restheart,org.restheart,Bootstrapper,stopServer,Magic Number,The method contains a magic number: 1000,434
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Complex Conditional,The conditional expression !configuration.isHttpsListener() && !configuration.isHttpListener() && !configuration.isAjpListener() is complex.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Complex Method,Cyclomatic complexity of the method is 11,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Long Statement,The length of the statement "final var allowers=authorizers == null ? null : authorizers.stream().filter(a -> a.isEnabled()).filter(a -> a.getInstance() != null).map(a -> a.getInstance()).filter(a -> PluginUtils.authorizerType(a) == TYPE.ALLOWER).collect(Collectors.toList());" is 247.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Long Statement,The length of the statement "LOGGER.warn(ansi().fg(RED).bold().a("No Authorizer of type ALLOWER defined` all requests to secured services will be forbidden; fullAuthorizer can be enabled to allow any request.").reset().toString());" is 202.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Long Statement,The length of the statement "LOGGER.warn("HTTPS listener bound to localhost:{}. Remote systems will be unable to connect to this server."`configuration.getHttpsPort());" is 139.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Long Statement,The length of the statement "LOGGER.warn("HTTP listener bound to localhost:{}. Remote systems will be unable to connect to this server."`configuration.getHttpPort());" is 137.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Long Statement,The length of the statement "LOGGER.warn("AJP listener bound to localhost:{}. Remote systems will be unable to connect to this server."`configuration.getAjpPort());" is 135.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Long Statement,The length of the statement "builder=builder.setIoThreads(configuration.getIoThreads()).setWorkerThreads(configuration.getWorkerThreads()).setDirectBuffers(configuration.isDirectBuffers()).setBufferSize(configuration.getBufferSize()).setHandler(HANDLERS);" is 226.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,startCoreSystem,Long Statement,The length of the statement "builder.setServerOption(UndertowOptions.ALLOW_UNESCAPED_CHARACTERS_IN_URL`configuration.isAllowUnescapedCharactersInUrl());" is 123.,493
SoftInstigate_restheart,org.restheart,Bootstrapper,initSSLContext,Complex Conditional,The conditional expression configuration.getKeystoreFile() != null && configuration.getKeystorePassword() != null && configuration.getCertPassword() != null is complex.,584
SoftInstigate_restheart,org.restheart,Bootstrapper,initSSLContext,Long Statement,The length of the statement "if (configuration.getKeystoreFile() != null && configuration.getKeystorePassword() != null && configuration.getCertPassword() != null) {" is 136.,584
SoftInstigate_restheart,org.restheart,Bootstrapper,initSSLContext,Long Statement,The length of the statement "logErrorAndExit("Cannot enable the HTTPS listener: the keystore is not configured. Generate a keystore and set the configuration options keystore-file` keystore-password and certpassword. More information at https://restheart.org/docs/security/tls/"`null`false`-1);" is 265.,584
SoftInstigate_restheart,org.restheart,Bootstrapper,initSSLContext,Long Statement,The length of the statement "catch ( KeyManagementException|NoSuchAlgorithmException|KeyStoreException|CertificateException|UnrecoverableKeyException ex) {" is 126.,584
SoftInstigate_restheart,org.restheart,Bootstrapper,initSSLContext,Long Statement,The length of the statement "logErrorAndExit("Couldn't start RESTHeart` error with specified keystore. Check the keystore-file` keystore-password and certpassword options. Exiting.."`ex`false`-1);" is 167.,584
SoftInstigate_restheart,org.restheart,Bootstrapper,initSSLContext,Long Statement,The length of the statement "logErrorAndExit("Couldn't start RESTHeart` keystore file not found. Check the keystore-file` keystore-password and certpassword options. Exiting.."`ex`false`-1);" is 161.,584
SoftInstigate_restheart,org.restheart,Bootstrapper,initSSLContext,Long Statement,The length of the statement "logErrorAndExit("Couldn't start RESTHeart` error reading the keystore file. Check the keystore-file` keystore-password and certpassword options. Exiting.."`ex`false`-1);" is 169.,584
SoftInstigate_restheart,org.restheart,Bootstrapper,getBasePipeline,Long Statement,The length of the statement "return new GracefulShutdownHandler(new RequestLimitingHandler(new RequestLimit(configuration.getRequestsLimit())`new AllowedMethodsHandler(new ErrorHandler(new HttpContinueAcceptingHandler(PluginsRegistryImpl.getInstance().getRootPathHandler()))`HttpString.tryFromString(ExchangeKeys.METHOD.GET.name())`HttpString.tryFromString(ExchangeKeys.METHOD.POST.name())`HttpString.tryFromString(ExchangeKeys.METHOD.PUT.name())`HttpString.tryFromString(ExchangeKeys.METHOD.DELETE.name())`HttpString.tryFromString(ExchangeKeys.METHOD.PATCH.name())`HttpString.tryFromString(ExchangeKeys.METHOD.OPTIONS.name()))));" is 601.,655
SoftInstigate_restheart,org.restheart,Bootstrapper,plugServices,Complex Conditional,The conditional expression srvConfArgs == null || !srvConfArgs.containsKey("uri") || srvConfArgs.get("uri") == null is complex.,675
SoftInstigate_restheart,org.restheart,Bootstrapper,plugServices,Long Statement,The length of the statement "PluginsRegistryImpl.getInstance().getServices().stream().filter(srv -> srv.getInstance().getClass().getDeclaredAnnotation(RegisterPlugin.class) != null).forEach(srv -> {" is 169.,675
SoftInstigate_restheart,org.restheart,Bootstrapper,plugServices,Long Statement,The length of the statement "LOGGER.error("Cannot start service {}: the configuration property 'uri' is not defined and the service does not have a default value"`srv.getName());" is 149.,675
SoftInstigate_restheart,org.restheart,Bootstrapper,plugServices,Long Statement,The length of the statement "LOGGER.info(ansi().fg(GREEN).a("URI {} bound to service {}` secured: {}` uri match {}").reset().toString()`uri`srv.getName()`secured`mp);" is 137.,675
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Complex Method,Cyclomatic complexity of the method is 8,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Long Statement,The length of the statement "var proxyClient=new LoadBalancingProxyClient().setConnectionsPerThread(connectionsPerThread).setSoftMaxConnectionsPerThread(softMaxConnectionsPerThread).setMaxQueueSize(maxQueueSize).setProblemServerRetry(problemServerRetry).setTtl(ttl);" is 237.,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Long Statement,The length of the statement "ProxyHandler proxyHandler=ProxyHandler.builder().setRewriteHostHeader(rewriteHostHeader).setProxyClient(proxyClient).build();" is 125.,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Long Statement,The length of the statement "var proxy=pipe(new PipelineInfoInjector()`new TracingInstrumentationHandler()`new RequestLogger()`new ProxyExchangeBuffersCloser()`new XPoweredByInjector()`new RequestContentInjector(ON_REQUIRES_CONTENT_BEFORE_AUTH)`new RequestInterceptorsExecutor(REQUEST_BEFORE_AUTH)`new QueryStringRebuilder()`new SecurityHandler(authMechanisms`authorizers`tokenManager)`new AuthHeadersRemover()`new XForwardedHeadersInjector()`new RequestContentInjector(ON_REQUIRES_CONTENT_AFTER_AUTH)`new RequestInterceptorsExecutor(REQUEST_AFTER_AUTH)`new QueryStringRebuilder()`new ConduitInjector()`PipelinedWrappingHandler.wrap(new ConfigurableEncodingHandler(proxyHandler)));" is 652.,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Magic Number,The method contains a magic number: 10,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Magic Number,The method contains a magic number: 5,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Magic Number,The method contains a magic number: 10,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugProxies,Magic Number,The method contains a magic number: 13,720
SoftInstigate_restheart,org.restheart,Bootstrapper,plugStaticResourcesHandlers,Complex Method,Cyclomatic complexity of the method is 10,832
SoftInstigate_restheart,org.restheart,Bootstrapper,plugStaticResourcesHandlers,Long Statement,The length of the statement "LOGGER.error("Cannot bind embedded static resources to {}. parameter 'where'" + "cannot start with /. the path is relative to the jar root dir" + " or classpath directory"`where);" is 179.,832
SoftInstigate_restheart,org.restheart,Bootstrapper,plugStaticResourcesHandlers,Magic Number,The method contains a magic number: 3,832
SoftInstigate_restheart,org.restheart,Bootstrapper,logErrorAndExit,Long Parameter List,The method has 5 parameters. ,923
SoftInstigate_restheart,org.restheart.security,BaseAccount,toString,Long Statement,The length of the statement "return "username=".concat(principal != null ? principal.getName() : "null").concat(" roles=").concat(roles != null ? roles.toString() : "null");" is 144.,71
SoftInstigate_restheart,org.restheart.security,MongoPermissions,MongoPermissions,Long Parameter List,The method has 8 parameters. ,63
SoftInstigate_restheart,org.restheart.security,MongoPermissions,MongoPermissions,Long Statement,The length of the statement "this.readFilter=readFilter == null ? null : readFilter.isNull() ? null : BsonUtils.escapeKeys(readFilter.asDocument()`true).asDocument();" is 137.,63
SoftInstigate_restheart,org.restheart.security,MongoPermissions,MongoPermissions,Long Statement,The length of the statement "this.writeFilter=writeFilter == null ? null : writeFilter.isNull() ? null : BsonUtils.escapeKeys(writeFilter.asDocument()`true).asDocument();" is 141.,63
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression args == null || args.isEmpty() || !args.containsKey("mongo") || !args.get("mongo").isDocument() is complex.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_readFilter == null || _readFilter.isNull()) && !_readFilter.isDocument() is complex.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_writeFilter == null || _writeFilter.isNull()) && !_writeFilter.isDocument() is complex.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_mergeRequest == null || _mergeRequest.isNull()) && !_mergeRequest.isDocument() is complex.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_projectResponse == null || _projectResponse.isNull()) && !_projectResponse.isDocument() is complex.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Method,Cyclomatic complexity of the method is 13,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "var readFilter=_readFilter == null ? null : _readFilter.isNull() ? null : BsonUtils.escapeKeys(_readFilter.asDocument()`true).asDocument();" is 139.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "var writeFilter=_writeFilter == null ? null : _writeFilter.isNull() ? null : BsonUtils.escapeKeys(_writeFilter.asDocument()`true).asDocument();" is 143.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` cannot have a mix of inclusion and exclusion");" is 156.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` cannot have a mix of inclusion and exclusion");" is 156.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` valid values are 0 and 1");" is 136.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` valid values are 0 and 1");" is 136.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "return new MongoPermissions(readFilter`writeFilter`parseBooleanArg(args`"allowManagementRequests")`parseBooleanArg(args`"allowBulkPatch")`parseBooleanArg(args`"allowBulkDelete")`parseBooleanArg(args`"allowWriteMode")`mergeRequest`projectResponse);" is 247.,102
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression args == null || args.isEmpty() || !args.containsKey("mongo") || !(args.get("mongo") instanceof Map<?`?>) is complex.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_readFilter == null || _readFilter.isNull()) && !_readFilter.isDocument() is complex.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_writeFilter == null || _writeFilter.isNull()) && !_writeFilter.isDocument() is complex.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_mergeRequest == null || _mergeRequest.isNull()) && !_mergeRequest.isDocument() is complex.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Conditional,The conditional expression !(_projectResponse == null || _projectResponse.isNull()) && !_projectResponse.isDocument() is complex.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Complex Method,Cyclomatic complexity of the method is 17,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Method,The method has 104 lines of code.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "readFilter=_readFilter == null ? null : _readFilter.isNull() ? null : BsonUtils.escapeKeys(_readFilter.asDocument()`true).asDocument();" is 135.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "writeFilter=_writeFilter == null ? null : _writeFilter.isNull() ? null : BsonUtils.escapeKeys(_writeFilter.asDocument()`true).asDocument();" is 139.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` cannot have a mix of inclusion and exclusion");" is 156.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` cannot have a mix of inclusion and exclusion");" is 156.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` valid values are 0 and 1");" is 136.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: the projectResponse contains invalid projection options` valid values are 0 and 1");" is 136.,196
SoftInstigate_restheart,org.restheart.security,MongoPermissions,from,Long Statement,The length of the statement "return new MongoPermissions(readFilter`writeFilter`parseBooleanArg(args`"allowManagementRequests")`parseBooleanArg(args`"allowBulkPatch")`parseBooleanArg(args`"allowBulkDelete")`parseBooleanArg(args`"allowWriteMode")`mergeRequest`projectResponse);" is 247.,196
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Complex Method,Cyclomatic complexity of the method is 30,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Long Method,The method has 157 lines of code.,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Long Statement,The length of the statement "if (Objects.nonNull(request.getAuthenticatedAccount()) && Objects.nonNull(request.getAuthenticatedAccount().getRoles())) {" is 122.,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 1000,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 8,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 9,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 17,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 18,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 5,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 6,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 6,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 6,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePropValue,Magic Number,The method contains a magic number: 6,104
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePredicate,Long Statement,The length of the statement "flatten.keySet().stream().filter(key -> flatten.get(key) != null).filter(key -> isJsonPrimitive(flatten.get(key))).forEach(key -> ret[0]=ret[0].replaceAll(prefix.concat(key)`quote(jsonPrimitiveValue(flatten.get(key)))));" is 220.,298
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,interpolatePredicate,Long Statement,The length of the statement "flatten.keySet().stream().filter(key -> flatten.get(key) != null).filter(key -> isJsonArray(flatten.get(key))).forEach(key -> ret[0]=ret[0].replaceAll(prefix.concat(key)`jsonArrayValue(flatten.get(key).asArray())));" is 215.,298
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,isJsonPrimitive,Long Statement,The length of the statement "return value.isNull() || value.isBoolean() || value.isNumber()|| value.isString()|| value.isObjectId()|| value.isTimestamp()|| value.isDateTime();" is 146.,333
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,jsonPrimitiveValue,Complex Method,Cyclomatic complexity of the method is 10,342
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,jsonPrimitiveValue,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@313bff1e,342
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,jsonArrayValue,Long Statement,The length of the statement "sb.append(array.stream().filter(e -> isJsonPrimitive(e)).map(e -> quote(jsonPrimitiveValue(e))).collect(Collectors.joining("`")));" is 130.,367
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,nextToken,Magic Number,The method contains a magic number: 256,384
SoftInstigate_restheart,org.restheart.security,AclVarsInterpolator,getRequestObject,Magic Number,The method contains a magic number: 1000,497
SoftInstigate_restheart,org.restheart.mongodb,ConnectionChecker,replicaSet,Long Statement,The length of the statement "LOGGER.warn("Unable to check if MongoDB is configured as replica set. The MongoDB user cannot execute replSetGetStatus() command. Tip: add to the MongoDB user the built-in role 'clusterMonitor' that provides this action.");" is 223.,57
SoftInstigate_restheart,org.restheart.mongodb,ConnectionChecker,replicaSet,Magic Number,The method contains a magic number: 13,57
SoftInstigate_restheart,org.restheart.mongodb,MongoService,init,Long Statement,The length of the statement "boolean allPathTemplates=MongoServiceConfiguration.get().getMongoMounts().stream().map(m -> (String)m.get(MONGO_MOUNT_WHERE_KEY)).allMatch(url -> isPathTemplate(url));" is 167.,92
SoftInstigate_restheart,org.restheart.mongodb,MongoService,handle,Long Statement,The length of the statement "final var error="Service mongo is not initialized. " + "Make sure that mongoInitializer is enabled " + "and executed successfully";" is 131.,114
SoftInstigate_restheart,org.restheart.mongodb,MongoService,handle,Magic Number,The method contains a magic number: 500,114
SoftInstigate_restheart,org.restheart.mongodb,MongoService,getBasePipeline,Long Statement,The length of the statement "var _pipeline=PipelinedWrappingHandler.wrap(new ErrorHandler(PipelinedHandler.pipe(new CORSHandler()`new OptionsHandler()`ClientSessionInjector.build()`new ETagPolicyInjector()`RequestDispatcherHandler.getInstance())));" is 219.,131
SoftInstigate_restheart,org.restheart.mongodb,MongoService,getBasePipeline,Long Statement,The length of the statement "var allPathTemplates=MongoServiceConfiguration.get().getMongoMounts().stream().map(m -> (String)m.get(MONGO_MOUNT_WHERE_KEY)).allMatch(url -> isPathTemplate(url));" is 163.,131
SoftInstigate_restheart,org.restheart.mongodb,MongoService,getBasePipeline,Long Statement,The length of the statement "var allPaths=MongoServiceConfiguration.get().getMongoMounts().stream().map(m -> (String)m.get(MONGO_MOUNT_WHERE_KEY)).allMatch(url -> !isPathTemplate(url));" is 156.,131
SoftInstigate_restheart,org.restheart.mongodb,MongoService,getBasePipeline,Long Statement,The length of the statement "LOGGER.error("No mongo resource mounted! Check your mongo-mounts." + " where url must be either all absolute paths" + " or all path templates");" is 144.,131
SoftInstigate_restheart,org.restheart.mongodb,MongoService,requestInitializer,Long Statement,The length of the statement "LOGGER.warn("No MongoDb resource bound for {}. " + "Check mongo service configuration: " + "'mongo-mounts' and plugin arg 'uri'"`path);" is 135.,190
SoftInstigate_restheart,org.restheart.mongodb,MongoService,getMongoMounts,Long Statement,The length of the statement "MongoServiceConfiguration.get().getMongoMounts().stream().forEachOrdered(e -> ret.add(new MongoMount((String)e.get(MONGO_MOUNT_WHAT_KEY)`resolveURI((String)e.get(MONGO_MOUNT_WHERE_KEY)))));" is 189.,259
SoftInstigate_restheart,org.restheart.mongodb,MongoService,myURI,Complex Conditional,The conditional expression myconf != null && myconf.containsKey("uri") && !"/".equals(myconf.get("uri")) is complex.,284
SoftInstigate_restheart,org.restheart.mongodb,MongoService,MongoMount,Long Statement,The length of the statement "throw new IllegalArgumentException("'what' must be * (all db resorces) or start with \"/\". (eg. /db/coll) check your 'mongo-mounts'");" is 135.,312
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Long Statement,The length of the statement "LOGGER.warn("wrong value for {}. allowed values are {}; " + "setting it to {}"`REPRESENTATION_FORMAT_KEY`REPRESENTATION_FORMAT.values()`REPRESENTATION_FORMAT.STANDARD);" is 168.,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Long Statement,The length of the statement "LOGGER.error("Wrong parameter {} in the configuration file: {}` using its default value {}"`MONGO_URI_KEY`iae.getMessage()`DEFAULT_MONGO_URI);" is 142.,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Long Statement,The length of the statement "var _collEtagCheckPolicy=asString(etagCheckPolicies`ETAG_CHECK_POLICY_COLL_KEY`DEFAULT_COLL_ETAG_CHECK_POLICY.name()`silent);" is 125.,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Long Statement,The length of the statement "var _docEtagCheckPolicy=asString(etagCheckPolicies`ETAG_CHECK_POLICY_DOC_KEY`DEFAULT_DOC_ETAG_CHECK_POLICY.name()`silent);" is 122.,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Long Statement,The length of the statement "LOGGER.warn("wrong value for parameter {} setting it to default value {}"`ETAG_CHECK_POLICY_DB_KEY`DEFAULT_DB_ETAG_CHECK_POLICY);" is 129.,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Long Statement,The length of the statement "LOGGER.warn("wrong value for parameter {} setting it to default value {}"`ETAG_CHECK_POLICY_COLL_KEY`DEFAULT_COLL_ETAG_CHECK_POLICY);" is 133.,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Long Statement,The length of the statement "LOGGER.warn("wrong value for parameter {} setting it to default value {}"`ETAG_CHECK_POLICY_COLL_KEY`DEFAULT_COLL_ETAG_CHECK_POLICY);" is 133.,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 100,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 1000,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 1000,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 100,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 1000,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 100,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 1000,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,MongoServiceConfiguration,Magic Number,The method contains a magic number: 50,118
SoftInstigate_restheart,org.restheart.mongodb,MongoServiceConfiguration,toString,Long Statement,The length of the statement "return "Configuration{instanceBaseURL=" + instanceBaseURL + "` defaultRepresentationFromat="+ defaultRepresentationFormat+ "` mongoUri="+ mongoUri+ "` mongoMounts="+ mongoMounts+ "` pluginsArgs="+ getPluginsArgs()+ "` localCacheEnabled="+ localCacheEnabled+ "` localCacheTtl="+ localCacheTtl+ "` schemaCacheEnabled="+ schemaCacheEnabled+ "` schemaCacheTtl="+ schemaCacheTtl+ "` requestsLimit="+ requestsLimit+ "` metricsGatheringLevel="+ metricsGatheringLevel+ "` eagerPoolSize="+ eagerPoolSize+ "` eagerLinearSliceWidht="+ eagerLinearSliceWidht+ "` eagerLinearSliceDelta="+ eagerLinearSliceDelta+ "` eagerLinearSliceHeights="+ Arrays.toString(eagerLinearSliceHeights)+ "` eagerRndSliceMinWidht="+ eagerRndSliceMinWidht+ "` eagerRndMaxCursors="+ eagerRndMaxCursors+ "` dbEtagCheckPolicy="+ dbEtagCheckPolicy+ "` collEtagCheckPolicy="+ collEtagCheckPolicy+ "` docEtagCheckPolicy="+ docEtagCheckPolicy+ "` connectionOptions="+ connectionOptions+ "` queryTimeLimit="+ queryTimeLimit+ "` aggregationTimeLimit="+ aggregationTimeLimit+ "` aggregationCheckOperators="+ aggregationCheckOperators+ "` cursorBatchSize="+ cursorBatchSize+ "` defaultPagesize="+ defaultPagesize+ "` maxPagesize="+ maxPagesize+ "` configurationFileMap="+ configurationFileMap+ '}';" is 1251.,253
SoftInstigate_restheart,org.restheart.mongodb.db,OperationResult,OperationResult,Long Parameter List,The method has 5 parameters. ,110
SoftInstigate_restheart,org.restheart.mongodb.db,MongoClientSingleton,setup,Long Statement,The length of the statement "LOGGER.error(ansi().fg(RED).bold().a("Cannot connect to MongoDB. ").reset().toString() + "Check that MongoDB is running and " + "the configuration property 'mongo-uri' "+ "is set properly");" is 190.,106
SoftInstigate_restheart,org.restheart.mongodb.db,MongoClientSingleton,setup,Long Statement,The length of the statement "LOGGER.error(ansi().fg(RED).bold().a("Cannot connect to MongoDB. ").reset().toString() + "Check that MongoDB is running and " + "the configuration property 'mongo-uri' "+ "is set properly");" is 190.,106
SoftInstigate_restheart,org.restheart.mongodb.db,MongoClientSingleton,setup,Magic Number,The method contains a magic number: 128,106
SoftInstigate_restheart,org.restheart.mongodb.db,MongoClientSingleton,apply,Magic Number,The method contains a magic number: 128,116
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,updateFileMetadata,Long Parameter List,The method has 7 parameters. ,132
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,writeDocument,Complex Method,Cyclomatic complexity of the method is 10,162
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,writeDocument,Long Parameter List,The method has 8 parameters. ,162
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,writeDocument,Long Statement,The length of the statement "var newDocument=cs.isPresent() ? coll.findOneAndUpdate(cs.get()`query`getUpdateDocument(data`false)`ops) : coll.findOneAndUpdate(query`getUpdateDocument(data`false)`ops);" is 170.,162
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,writeDocument,Long Statement,The length of the statement "var newDocument=cs.isPresent() ? coll.findOneAndReplace(cs.get()`query`getReplaceDocument(data)`ops) : coll.findOneAndReplace(query`getReplaceDocument(data)`ops);" is 162.,162
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,restoreDocument,Long Parameter List,The method has 7 parameters. ,309
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,restoreDocument,Long Statement,The length of the statement "var result=cs.isPresent() ? coll.replaceOne(cs.get()`query`data`R_NOT_UPSERT_OPS) : coll.replaceOne(query`data`R_NOT_UPSERT_OPS);" is 129.,309
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,bulkWriteDocuments,Long Parameter List,The method has 6 parameters. ,351
SoftInstigate_restheart,org.restheart.mongodb.db,DbUtils,getBulkWriteModel,Long Parameter List,The method has 6 parameters. ,397
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,getCollectionSize,Long Parameter List,The method has 5 parameters. ,102
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,findIterable,Long Parameter List,The method has 6 parameters. ,143
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,findIterable,Long Statement,The length of the statement "return ret.projection(keys).sort(sortBy).batchSize(BATCH_SIZE).hint(hint).maxTime(MongoServiceConfiguration.get().getQueryTimeLimit()`TimeUnit.MILLISECONDS);" is 157.,143
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,getCollectionData,Long Parameter List,The method has 11 parameters. ,174
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,upsertCollection,Complex Method,Cyclomatic complexity of the method is 10,310
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,upsertCollection,Long Parameter List,The method has 9 parameters. ,310
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,upsertCollection,Long Statement,The length of the statement "var oldProperties=cs.isPresent() ? mcoll.find(cs.get()`query).projection(FIELDS_TO_RETURN).first() : mcoll.find(query).projection(FIELDS_TO_RETURN).first();" is 156.,310
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,upsertCollection,Magic Number,The method contains a magic number: 48,310
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,doCollPropsUpdate,Long Parameter List,The method has 7 parameters. ,413
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,doCollPropsUpdate,Long Statement,The length of the statement "var ret=DbUtils.writeDocument(cs`METHOD.PATCH`WRITE_MODE.UPSERT`mcoll`Optional.of(new BsonString("_properties.".concat(collName)))`Optional.empty()`Optional.empty()`dcontent);" is 175.,413
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,doCollPropsUpdate,Long Statement,The length of the statement "var ret=DbUtils.writeDocument(cs`METHOD.PUT`WRITE_MODE.UPSERT`mcoll`Optional.of(new BsonString("_properties.".concat(collName)))`Optional.empty()`Optional.empty()`dcontent);" is 173.,413
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,deleteCollection,Long Parameter List,The method has 6 parameters. ,453
SoftInstigate_restheart,org.restheart.mongodb.db,Collections,deleteCollection,Long Statement,The length of the statement "var properties=cs.isPresent() ? mcoll.find(cs.get()`query).projection(FIELDS_TO_RETURN).first() : mcoll.find(query).projection(FIELDS_TO_RETURN).first();" is 153.,453
SoftInstigate_restheart,org.restheart.mongodb.db,MongoReactiveClientSingleton,setup,Magic Number,The method contains a magic number: 128,95
SoftInstigate_restheart,org.restheart.mongodb.db,MongoReactiveClientSingleton,apply,Magic Number,The method contains a magic number: 128,100
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,CursorPool,Long Statement,The length of the statement "collSizes=CacheFactory.createLocalLoadingCache(100`org.restheart.cache.Cache.EXPIRE_POLICY.AFTER_WRITE`60 * 1000`( CursorPoolEntryKey key) -> collections.getCollectionSize(key.session()`key.collection()`key.filter()));" is 218.,105
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,CursorPool,Magic Number,The method contains a magic number: 100,105
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,CursorPool,Magic Number,The method contains a magic number: 60,105
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,CursorPool,Magic Number,The method contains a magic number: 1000,105
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,get,Long Statement,The length of the statement "LOGGER.trace("{} cursor to reuse found with less skips than SKIP_SLICE_LINEAR_WIDTH {}"`ansi().fg(GREEN).bold().a("no").reset().toString()`SKIP_SLICE_LINEAR_WIDTH);" is 164.,126
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,get,Long Statement,The length of the statement "var _bestKey=cache.asMap().keySet().stream().filter(cursorsPoolFilterGte(key)).sorted(Comparator.comparingInt(CursorPoolEntryKey::skipped).reversed()).findFirst();" is 163.,126
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,get,Long Statement,The length of the statement "LOGGER.debug("{} cursor in pool. id {}` saving {} skips"`ansi().fg(GREEN).bold().a("found").reset().toString()`_bestKey.get().cursorId()`key.skipped()`_bestKey.get().skipped());" is 177.,126
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,populateCacheLinear,Long Statement,The length of the statement "var sliceKey=new CursorPoolEntryKey(key.session()`key.collection()`key.sort()`key.filter()`key.keys()`key.hint()`sliceSkips`-1);" is 128.,176
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,populateCacheLinear,Long Statement,The length of the statement "var newkey=new CursorPoolEntryKey(key.session()`key.collection()`key.sort()`key.filter()`key.hint()`key.keys()`sliceSkips`System.nanoTime());" is 141.,176
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,populateCacheRandom,Long Statement,The length of the statement "var cursor=collections.findIterable(key.session()`key.collection()`key.sort()`key.filter()`key.hint()`key.keys()).skip(sliceSkips);" is 131.,243
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,populateCacheRandom,Long Statement,The length of the statement "var newkey=new CursorPoolEntryKey(key.session()`key.collection()`key.sort()`key.filter()`key.hint()`key.keys()`sliceSkips`System.nanoTime());" is 141.,243
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,cursorsPoolFilterEq,Long Statement,The length of the statement "return poolCursor -> Objects.equals(poolCursor.collection().getNamespace()`requestCursor.collection().getNamespace()) && Objects.equals(poolCursor.filter()`requestCursor.filter()) && Objects.equals(poolCursor.sort()`requestCursor.sort())&& Objects.equals(poolCursor.keys()`requestCursor.keys())&& poolCursor.skipped() == requestCursor.skipped();" is 345.,310
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,cursorsPoolFilterGte,Long Statement,The length of the statement "return poolCursor -> Objects.equals(poolCursor.collection().getNamespace()`requestCursor.collection().getNamespace()) && Objects.equals(poolCursor.filter()`requestCursor.filter()) && Objects.equals(poolCursor.sort()`requestCursor.sort())&& Objects.equals(poolCursor.keys()`requestCursor.keys())&& poolCursor.skipped() <= requestCursor.skipped() && requestCursor.skipped() - poolCursor.skipped() <= MIN_SKIP_DISTANCE_PERCENTAGE * requestCursor.skipped();" is 453.,319
SoftInstigate_restheart,org.restheart.mongodb.db,CursorPool,getCacheSizes,Long Statement,The length of the statement "return new TreeMap<>(cache.asMap().keySet().stream().collect(Collectors.groupingBy(CursorPoolEntryKey::getCacheStatsGroup`Collectors.counting())));" is 147.,330
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,createFile,Long Parameter List,The method has 5 parameters. ,78
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,upsertFile,Long Identifier,The length of the identifier creationOperationWasSuccessful is 30.,126
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,upsertFile,Long Parameter List,The method has 9 parameters. ,126
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,upsertFile,Long Statement,The length of the statement "final boolean deleteOperationWasSuccessful=deletionResult.getHttpCode() == SC_NO_CONTENT || deletionResult.getHttpCode() == SC_OK;" is 130.,126
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,upsertFile,Long Statement,The length of the statement "final boolean creationOperationWasSuccessful=SC_CREATED == creationResult.getHttpCode() || SC_OK == creationResult.getHttpCode();" is 129.,126
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,deleteFile,Long Parameter List,The method has 7 parameters. ,196
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,updateFileMetadata,Long Parameter List,The method has 11 parameters. ,275
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,updateFileMetadata,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@563fe04,275
SoftInstigate_restheart,org.restheart.mongodb.db,GridFs,optimisticCheckEtag,Long Parameter List,The method has 7 parameters. ,378
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,getDocumentEtag,Long Parameter List,The method has 5 parameters. ,68
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,getDocumentEtag,Long Statement,The length of the statement "var documents=cs.isPresent() ? mcoll.find(cs.get()`query).projection(new BsonDocument("_etag"`new BsonInt32(1))) : mcoll.find(query).projection(new BsonDocument("_etag"`new BsonInt32(1)));" is 188.,68
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,writeDocument,Long Parameter List,The method has 12 parameters. ,93
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,writeDocument,Long Statement,The length of the statement "var httpCode=writeResult.getHttpCode() > 0 ? writeResult.getHttpCode() : oldDocument == null ? HttpStatus.SC_CREATED : HttpStatus.SC_OK;" is 136.,93
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,bulkPostDocuments,Long Parameter List,The method has 8 parameters. ,160
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,bulkPostDocuments,Long Statement,The length of the statement "documents.stream().filter(d -> d != null && d.isDocument()).forEachOrdered(document -> document.asDocument().put("_etag"`newEtag));" is 131.,160
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,bulkPatchDocuments,Long Parameter List,The method has 7 parameters. ,199
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,deleteDocument,Long Parameter List,The method has 9 parameters. ,245
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,deleteDocument,Long Statement,The length of the statement "var oldDocument=cs.isPresent() ? mcoll.findOneAndDelete(cs.get()`idFilter(documentId`filter`shardKeys)) : mcoll.findOneAndDelete(idFilter(documentId`filter`shardKeys));" is 168.,245
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,bulkDeleteDocuments,Long Parameter List,The method has 6 parameters. ,317
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,optimisticCheckEtag,Long Parameter List,The method has 8 parameters. ,356
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,optimisticCheckEtag,Long Statement,The length of the statement "DbUtils.writeDocument(cs`METHOD.PUT`WRITE_MODE.UPSERT`coll`Optional.of(oldDocument.get("_id"))`Optional.empty()`shardKeys`oldDocument);" is 135.,356
SoftInstigate_restheart,org.restheart.mongodb.db,Documents,optimisticCheckEtag,Long Statement,The length of the statement "DbUtils.writeDocument(cs`METHOD.PUT`WRITE_MODE.UPSERT`coll`Optional.of(oldDocument.get("_id"))`shardKeys`Optional.empty()`oldDocument);" is 135.,356
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,getCollectionNames,Long Statement,The length of the statement "return _colls.stream().filter(coll -> !MongoRequest.isReservedCollectionName(coll)).sorted().collect(Collectors.toList());" is 122.,125
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,getDatabaseProperties,Long Statement,The length of the statement "var props=cs.isPresent() ? propsColl.find(cs.get()`PROPS_QUERY).limit(1).first() : propsColl.find(PROPS_QUERY).limit(1).first();" is 128.,165
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,getDatabaseData,Long Parameter List,The method has 7 parameters. ,189
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,getDatabaseData,Long Statement,The length of the statement "_colls=_colls.subList((page - 1) * pagesize`(page - 1) * pagesize + pagesize > _colls.size() ? _colls.size() : (page - 1) * pagesize + pagesize);" is 145.,189
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,upsertDB,Long Parameter List,The method has 8 parameters. ,260
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,upsertDB,Long Statement,The length of the statement "var oldProperties=cs.isPresent() ? mcoll.find(cs.get()`eq("_id"`DB_META_DOCID)).projection(FIELDS_TO_RETURN).first() : mcoll.find(eq("_id"`DB_META_DOCID)).projection(FIELDS_TO_RETURN).first();" is 192.,260
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,doDbPropsUpdate,Long Parameter List,The method has 7 parameters. ,347
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,doDbPropsUpdate,Long Statement,The length of the statement "var ret=DbUtils.writeDocument(cs`method`WRITE_MODE.UPSERT`mcoll`Optional.of(new BsonString(DB_META_DOCID))`Optional.empty()`Optional.empty()`dcontent);" is 151.,347
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,doDbPropsUpdate,Long Statement,The length of the statement "return new OperationResult(ret.getHttpCode() > 0 ? ret.getHttpCode() : updating ? HttpStatus.SC_OK : HttpStatus.SC_CREATED`newEtag);" is 132.,347
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,deleteDatabase,Long Parameter List,The method has 5 parameters. ,367
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,deleteDatabase,Long Statement,The length of the statement "var properties=cs.isPresent() ? mcoll.find(cs.get()`query).projection(FIELDS_TO_RETURN).first() : mcoll.find(query).projection(FIELDS_TO_RETURN).first();" is 153.,367
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,getCollectionSize,Long Parameter List,The method has 5 parameters. ,453
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,getCollectionData,Long Parameter List,The method has 11 parameters. ,470
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,deleteCollection,Long Parameter List,The method has 6 parameters. ,501
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,upsertCollection,Long Parameter List,The method has 9 parameters. ,527
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,deleteIndex,Long Parameter List,The method has 5 parameters. ,562
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,findIterable,Long Parameter List,The method has 8 parameters. ,596
SoftInstigate_restheart,org.restheart.mongodb.db,Databases,createIndex,Long Parameter List,The method has 6 parameters. ,626
SoftInstigate_restheart,org.restheart.mongodb.db,Indexes,getCollectionIndexes,Long Statement,The length of the statement "var indexes=cs.isPresent() ? collections.collection(rsOps`dbName`collName).listIndexes(cs.get()) : collections.collection(rsOps`dbName`collName).listIndexes();" is 159.,64
SoftInstigate_restheart,org.restheart.mongodb.db,Indexes,createIndex,Long Parameter List,The method has 6 parameters. ,93
SoftInstigate_restheart,org.restheart.mongodb.db,Indexes,deleteIndex,Long Parameter List,The method has 5 parameters. ,124
SoftInstigate_restheart,org.restheart.mongodb.db,Indexes,getIndexOptions,Complex Method,Cyclomatic complexity of the method is 17,148
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,ClientSessionImpl,notifyMessageSent,Long Identifier,The length of the identifier firstMessageInCurrentTransaction is 32.,94
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,ClientSessionImpl,notifyMessageSent,Long Identifier,The length of the field messageSentInCurrentTransaction is 31.,94
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,ClientSessionImpl,setMessageSentInCurrentTransaction,Long Identifier,The length of the parameter messageSentInCurrentTransaction is 31.,175
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,ClientSessionImpl,setMessageSentInCurrentTransaction,Long Identifier,The length of the field messageSentInCurrentTransaction is 31.,175
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,ClientSessionImpl,isMessageSentInCurrentTransaction,Long Identifier,The length of the field messageSentInCurrentTransaction is 31.,183
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,ClientSessionImpl,getSid,Complex Conditional,The conditional expression cs != null && cs.getServerSession() != null && cs.getServerSession().getIdentifier() != null && cs.getServerSession().getIdentifier().isDocument() && cs.getServerSession().getIdentifier().asDocument().containsKey("id") && cs.getServerSession().getIdentifier().asDocument().get("id").isBinary() is complex.,191
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,ClientSessionImpl,getSid,Long Statement,The length of the statement "if (cs != null && cs.getServerSession() != null && cs.getServerSession().getIdentifier() != null && cs.getServerSession().getIdentifier().isDocument() && cs.getServerSession().getIdentifier().asDocument().containsKey("id") && cs.getServerSession().getIdentifier().asDocument().get("id").isBinary()) {" is 300.,191
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnClientSessionImpl,TxnClientSessionImpl,Long Parameter List,The method has 5 parameters. ,48
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnClientSessionImpl,setMessageSentInCurrentTransaction,Long Identifier,The length of the parameter messageSentInCurrentTransaction is 31.,58
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnClientSessionImpl,hasActiveTransaction,Long Statement,The length of the statement "return transactionState == TransactionStatus.IN || (transactionState == TransactionStatus.COMMITTED && commitInProgress);" is 121.,66
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnClientSessionImpl,notifyMessageSent,Long Identifier,The length of the identifier firstMessageInCurrentTransaction is 32.,75
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnClientSessionImpl,abortTransaction,Empty catch clause,The method has an empty catch block.,156
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Complex Method,Cyclomatic complexity of the method is 8,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Long Identifier,The length of the field TXT_NUM_ERROR_MSG_PREFIX_STARTED is 32.,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Long Identifier,The length of the field TXT_NUM_ERROR_MSG_SUFFIX_STARTED is 32.,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Long Identifier,The length of the field TXT_NUM_ERROR_MSG_PREFIX_ABORTED is 32.,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Long Identifier,The length of the field TXT_NUM_ERROR_MSG_SUFFIX_ABORTED is 32.,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Long Identifier,The length of the field TXT_NUM_ERROR_MSG_PREFIX_COMMITTED is 34.,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Long Identifier,The length of the field TXT_NUM_ERROR_MSG_SUFFIX_COMMITTED is 34.,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Long Statement,The length of the statement "int start=mqe.getErrorMessage().indexOf(TXT_NUM_ERROR_MSG_PREFIX_COMMITTED) + TXT_NUM_ERROR_MSG_PREFIX_COMMITTED.length();" is 122.,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Magic Number,The method contains a magic number: 225,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Magic Number,The method contains a magic number: 251,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnNumFromExc,Magic Number,The method contains a magic number: 256,119
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnStateFromExc,Magic Number,The method contains a magic number: 251,188
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnsUtils,getTxnStateFromExc,Magic Number,The method contains a magic number: 256,188
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,Sid,setCasuallyConsistentFlag,Magic Number,The method contains a magic number: 0xDF,79
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnClientSessionFactory,createClientSession,Long Statement,The length of the statement "var mergedOptions=ClientSessionOptions.builder(options).causallyConsistent(true).defaultTransactionOptions(TransactionOptions.merge(options.getDefaultTransactionOptions()`TransactionOptions.builder().readPreference(rsOps.readPreference() != null ? rsOps.readPreference() : ReadPreference.primary()).readConcern(rsOps.readConcern() != null ? rsOps.readConcern() : ReadConcern.DEFAULT).writeConcern(rsOps.writeConcern() != null ? rsOps.writeConcern() : WriteConcern.MAJORITY).build())).build();" is 492.,178
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,TxnClientSessionFactory,createClientSession,Long Statement,The length of the statement "return new TxnClientSessionImpl(new SimpleServerSessionPool(SessionsUtils.getCluster()`sid)`MongoClientSingleton.getInstance().getClient()`mergedOptions`SessionsUtils.getOperationExecutor()`txnServerStatus);" is 207.,178
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,SidTest,testSessionOptionCase1,Magic Number,The method contains a magic number: 10,38
SoftInstigate_restheart,org.restheart.mongodb.db.sessions,SidTest,testSessionOptionCase2,Magic Number,The method contains a magic number: 10,52
SoftInstigate_restheart,org.restheart.exchange,UninitializedRequest,setCustomRequestInitializer,Long Identifier,The length of the field CUSTOM_REQUEST_INITIALIZER_KEY is 30.,76
SoftInstigate_restheart,org.restheart.exchange,UninitializedRequest,customRequestInitializer,Long Identifier,The length of the field CUSTOM_REQUEST_INITIALIZER_KEY is 30.,86
SoftInstigate_restheart,org.restheart.exchange,JsonProxyResponse,getErrorContent,Long Parameter List,The method has 5 parameters. ,102
SoftInstigate_restheart,org.restheart.exchange,BsonFromCsvRequest,checkContentType,Long Statement,The length of the statement "return contentType != null && contentType.stream().anyMatch(ct -> ct.equals(CVS_CONTENT_TYPE) || ct.startsWith(CVS_CONTENT_TYPE.concat(";")));" is 142.,89
SoftInstigate_restheart,org.restheart.exchange,BsonFromCsvRequest,parseCsv,Complex Method,Cyclomatic complexity of the method is 10,96
SoftInstigate_restheart,org.restheart.exchange,UninitializedResponse,setCustomResponseInitializer,Long Identifier,The length of the field CUSTOM_RESPONSE_INITIALIZER_KEY is 31.,62
SoftInstigate_restheart,org.restheart.exchange,UninitializedResponse,customResponseInitializer,Long Identifier,The length of the field CUSTOM_RESPONSE_INITIALIZER_KEY is 31.,72
SoftInstigate_restheart,org.restheart.exchange,ServiceRequest,ServiceRequest,Long Statement,The length of the statement "throw new IllegalStateException("Error instantiating request object " + getClass().getSimpleName() + "` "+ exchange.getAttachment(REQUEST_KEY).getClass().getSimpleName()+ " already bound to the exchange");" is 205.,44
SoftInstigate_restheart,org.restheart.exchange,ServiceRequest,of,Long Statement,The length of the statement "throw new IllegalStateException("Request bound to exchange is not " + "of the specified type`" + " expected " + type.getSimpleName() + " got "+ ret.getClass().getSimpleName());" is 176.,81
SoftInstigate_restheart,org.restheart.exchange,Request,getQueryParameterOfDefault,Long Statement,The length of the statement "return wrapped.getQueryParameters().containsKey(name) ? wrapped.getQueryParameters().get(name).getFirst() : defaultValue;" is 121.,134
SoftInstigate_restheart,org.restheart.exchange,Request,getAuthenticatedAccount,Long Statement,The length of the statement "return getWrappedExchange().getSecurityContext() != null ? getWrappedExchange().getSecurityContext().getAuthenticatedAccount() : null;" is 134.,278
SoftInstigate_restheart,org.restheart.exchange,Request,isContentTypeFormOrMultipart,Long Statement,The length of the statement "return getContentType(exchange) != null && (getContentType(exchange).startsWith(FORM_URLENCODED) || getContentType(exchange).startsWith(MULTIPART));" is 148.,373
SoftInstigate_restheart,org.restheart.exchange,Request,blockForTooManyRequests,Long Identifier,The length of the field BLOCK_AUTH_FOR_TOO_MANY_REQUESTS is 32.,454
SoftInstigate_restheart,org.restheart.exchange,Request,isBlockForTooManyRequests,Long Identifier,The length of the field BLOCK_AUTH_FOR_TOO_MANY_REQUESTS is 32.,462
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,MongoRequest,Empty catch clause,The method has an empty catch block.,132
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,MongoRequest,Empty catch clause,The method has an empty catch block.,132
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,MongoRequest,Long Statement,The length of the statement "this.whereUri=URLUtils.removeTrailingSlashes(requestUri == null ? null : requestUri.startsWith("/") ? requestUri : "/" + requestUri);" is 133.,132
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,MongoRequest,Long Statement,The length of the statement "this.whatUri=URLUtils.removeTrailingSlashes(resourceUri == null ? null : resourceUri.startsWith("/") || "*".equals(resourceUri) ? resourceUri : "/" + resourceUri);" is 163.,132
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,MongoRequest,Long Statement,The length of the statement "var _jsonMode=exchange.getQueryParameters().containsKey(JSON_MODE_QPARAM_KEY) ? exchange.getQueryParameters().get(JSON_MODE_QPARAM_KEY).getFirst().toUpperCase() : null;" is 168.,132
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,MongoRequest,Long Statement,The length of the statement "var _writeMode=exchange.getQueryParameters().containsKey(WRITE_MODE_QPARAM_KEY) ? exchange.getQueryParameters().get(WRITE_MODE_QPARAM_KEY).getFirst().toUpperCase() : exchange.getQueryParameters().containsKey(WRITE_MODE_SHORT_QPARAM_KEY) ? exchange.getQueryParameters().get(WRITE_MODE_SHORT_QPARAM_KEY).getFirst().toUpperCase() : defaultWriteMode();" is 348.,132
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isReservedDbName,Long Statement,The length of the statement "return dbName == null ? false : "".equals(dbName) || dbName.equalsIgnoreCase(ADMIN) || dbName.equalsIgnoreCase(CONFIG)|| dbName.equalsIgnoreCase(LOCAL)|| dbName.startsWith(SYSTEM);" is 180.,282
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isReservedCollectionName,Long Statement,The length of the statement "return collectionName == null ? false : "".equals(collectionName) || collectionName.startsWith(SYSTEM) || collectionName.endsWith(FS_CHUNKS_SUFFIX)|| collectionName.equals(META_COLLNAME);" is 187.,297
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isReservedDocumentId,Complex Conditional,The conditional expression (type == TYPE.COLLECTION_META && sdi.startsWith(COLL_META_DOCID_PREFIX)) || (type == TYPE.DB_META && sdi.startsWith(DB_META_DOCID)) || (type == TYPE.BULK_DOCUMENTS && RESOURCES_WILDCARD_KEY.equals(sdi))|| (type == TYPE.METRICS && _METRICS.equalsIgnoreCase(sdi))|| (type == TYPE.COLLECTION_SIZE && _SIZE.equalsIgnoreCase(sdi))|| (type == TYPE.INDEX && _INDEXES.equalsIgnoreCase(sdi))|| (type == TYPE.COLLECTION_META && _META.equalsIgnoreCase(sdi))|| (type == TYPE.INVALID && _AGGREGATIONS.equalsIgnoreCase(sdi))|| (type == TYPE.INVALID && _STREAMS.equalsIgnoreCase(sdi)) is complex.,311
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isReservedDocumentId,Long Statement,The length of the statement "if ((type == TYPE.COLLECTION_META && sdi.startsWith(COLL_META_DOCID_PREFIX)) || (type == TYPE.DB_META && sdi.startsWith(DB_META_DOCID)) || (type == TYPE.BULK_DOCUMENTS && RESOURCES_WILDCARD_KEY.equals(sdi))|| (type == TYPE.METRICS && _METRICS.equalsIgnoreCase(sdi))|| (type == TYPE.COLLECTION_SIZE && _SIZE.equalsIgnoreCase(sdi))|| (type == TYPE.INDEX && _INDEXES.equalsIgnoreCase(sdi))|| (type == TYPE.COLLECTION_META && _META.equalsIgnoreCase(sdi))|| (type == TYPE.INVALID && _AGGREGATIONS.equalsIgnoreCase(sdi))|| (type == TYPE.INVALID && _STREAMS.equalsIgnoreCase(sdi))) {" is 576.,311
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Complex Conditional,The conditional expression pathTokens.length == 4 && pathTokens[pathTokens.length - 3].equalsIgnoreCase(_SESSIONS) && pathTokens[pathTokens.length - 1].equalsIgnoreCase(_TRANSACTIONS) is complex.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Complex Conditional,The conditional expression pathTokens.length == 5 && pathTokens[pathTokens.length - 4].equalsIgnoreCase(_SESSIONS) && pathTokens[pathTokens.length - 2].equalsIgnoreCase(_TRANSACTIONS) is complex.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Complex Conditional,The conditional expression pathTokens.length == 4 && !pathTokens[3].equalsIgnoreCase(_INDEXES) && !pathTokens[3].equals(RESOURCES_WILDCARD_KEY) is complex.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Complex Conditional,The conditional expression pathTokens.length > 4 && !pathTokens[3].equalsIgnoreCase(_INDEXES) && !pathTokens[4].equalsIgnoreCase(BINARY_CONTENT) is complex.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Complex Method,Cyclomatic complexity of the method is 39,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Long Method,The method has 129 lines of code.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Long Statement,The length of the statement "else if (pathTokens.length == 4 && pathTokens[pathTokens.length - 3].equalsIgnoreCase(_SESSIONS) && pathTokens[pathTokens.length - 1].equalsIgnoreCase(_TRANSACTIONS)) {" is 168.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Long Statement,The length of the statement "else if (pathTokens.length == 5 && pathTokens[pathTokens.length - 4].equalsIgnoreCase(_SESSIONS) && pathTokens[pathTokens.length - 2].equalsIgnoreCase(_TRANSACTIONS)) {" is 168.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Long Statement,The length of the statement "else if (pathTokens.length == 4 && !pathTokens[3].equalsIgnoreCase(_INDEXES) && !pathTokens[3].equals(RESOURCES_WILDCARD_KEY)) {" is 128.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Long Statement,The length of the statement "else if (pathTokens.length > 4 && !pathTokens[3].equalsIgnoreCase(_INDEXES) && !pathTokens[4].equalsIgnoreCase(BINARY_CONTENT)) {" is 129.,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 5,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 5,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 2,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 4,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,selectRequestType,Magic Number,The method contains a magic number: 3,347
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,replaceParamsWithActualValues,Long Statement,The length of the statement "this.pathTemplateMatch.getParameters().keySet().stream().filter(key -> !key.equals("*")).collect(Collectors.toMap(key -> key`key -> this.pathTemplateMatch.getParameters().get(key)));" is 182.,565
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,replaceParamsWithActualValues,Magic Number,The method contains a magic number: 2,565
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isParentAccessible,Magic Number,The method contains a magic number: 2,586
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getCollectionName,Magic Number,The method contains a magic number: 2,611
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getDocumentIdRaw,Magic Number,The method contains a magic number: 3,619
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getIndexId,Magic Number,The method contains a magic number: 4,627
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getSid,Magic Number,The method contains a magic number: 2,635
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getTxnId,Magic Number,The method contains a magic number: 4,644
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getAggregationOperation,Magic Number,The method contains a magic number: 4,652
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getChangeStreamOperation,Magic Number,The method contains a magic number: 4,660
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isReservedResource,Long Statement,The length of the statement "return isReservedDbName(getDBName()) || isReservedCollectionName(getCollectionName()) || isReservedDocumentId(getType()`getDocumentId());" is 137.,678
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isCount,Long Statement,The length of the statement "return count || getType() == TYPE.ROOT_SIZE || getType() == TYPE.COLLECTION_SIZE || getType() == TYPE.FILES_BUCKET_SIZE || getType() == TYPE.SCHEMA_STORE_SIZE;" is 159.,748
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getHintDocument,Magic Number,The method contains a magic number: 11,855
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,getDocumentId,Magic Number,The method contains a magic number: 2,1039
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isDbNameInvalid,Long Statement,The length of the statement "return (dbName == null || dbName.contains(NUL) || dbName.contains(" ") || dbName.contains("/") || dbName.contains("\\") || dbName.contains(".") || dbName.contains("\"") || dbName.contains("$") || dbName.length() > 64 || dbName.length() == 0);" is 242.,1139
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isDbNameInvalid,Magic Number,The method contains a magic number: 64,1139
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isDbNameInvalidOnWindows,Long Statement,The length of the statement "return (isDbNameInvalid() || dbName.contains("*") || dbName.contains("<")|| dbName.contains(">")|| dbName.contains(":")|| dbName.contains(".")|| dbName.contains("|")|| dbName.contains("?"));" is 190.,1165
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isCollectionNameInvalid,Long Statement,The length of the statement "return (collectionName == null || collectionName.contains(NUL) || collectionName.contains("$") || collectionName.length() == 64);" is 129.,1189
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isCollectionNameInvalid,Magic Number,The method contains a magic number: 64,1189
SoftInstigate_restheart,org.restheart.exchange,MongoRequest,isWriteDocument,Long Statement,The length of the statement "return (((isPut() || isPatch()) && (isFile() || isDocument() || isSchema())) || isPost() && (isCollection() || isFilesBucket() || isSchemaStore()));" is 148.,1473
SoftInstigate_restheart,org.restheart.exchange,ByteArrayProxyResponse,getErrorContent,Long Parameter List,The method has 5 parameters. ,95
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,readContent,Complex Conditional,The conditional expression !request.isGet() && (content == null || content.isDocument()) is complex.,82
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,addWarnings,Complex Conditional,The conditional expression warnings != null && !warnings.isEmpty() && content.isDocument() is complex.,104
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,getErrorContent,Complex Method,Cyclomatic complexity of the method is 8,191
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,getErrorContent,Long Parameter List,The method has 5 parameters. ,191
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,rollback,Complex Conditional,The conditional expression request.isBulkDocuments() || (request.isPost() && request.getContent() != null && request.getContent().isArray()) is complex.,275
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,rollback,Complex Conditional,The conditional expression oldData.get("$set") != null && oldData.get("$set").isDocument() && oldData.get("$set").asDocument().get("_etag") != null is complex.,275
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,rollback,Long Statement,The length of the statement "if (oldData.get("$set") != null && oldData.get("$set").isDocument() && oldData.get("$set").asDocument().get("_etag") != null) {" is 127.,275
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,rollback,Long Statement,The length of the statement "response.getHeaders().put(Headers.ETAG`oldData.get("$set").asDocument().get("_etag").asObjectId().getValue().toString());" is 121.,275
SoftInstigate_restheart,org.restheart.exchange,MongoResponse,restoreDocument,Long Parameter List,The method has 7 parameters. ,343
SoftInstigate_restheart,org.restheart.exchange,PipelineInfo,toString,Long Statement,The length of the statement "return "PipelineInfo(type: " + getType() + "` uri: "+ getUri()+ "` matchPolicy: "+ getUriMatchPolicy()+ "` name: "+ getName()+ ")";" is 131.,65
SoftInstigate_restheart,org.restheart.exchange,Exchange,responseInterceptorsExecuted,Long Statement,The length of the statement "return exchange.getAttachment(RESPONSE_INTERCEPTOR_EXECUTED) != null && exchange.getAttachment(RESPONSE_INTERCEPTOR_EXECUTED);" is 126.,101
SoftInstigate_restheart,org.restheart.exchange,Exchange,isContentTypeJson,Long Statement,The length of the statement "return "application/json".equals(getContentType()) || (getContentType() != null && getContentType().startsWith("application/json;"));" is 133.,116
SoftInstigate_restheart,org.restheart.exchange,Exchange,isInError,Long Statement,The length of the statement "return getWrappedExchange().getAttachment(IN_ERROR_KEY) != null && (boolean)getWrappedExchange().getAttachment(IN_ERROR_KEY);" is 125.,126
SoftInstigate_restheart,org.restheart.exchange,Exchange,isContentTypeXml,Long Statement,The length of the statement "return "text/xml".equals(getContentType()) || (getContentType() != null && getContentType().startsWith("text/xml;")) || "application/xml".equals(getContentType())|| (getContentType() != null && getContentType().startsWith("application/xml;"));" is 243.,142
SoftInstigate_restheart,org.restheart.exchange,Exchange,isAuthenticated,Long Statement,The length of the statement "return getWrappedExchange().getSecurityContext() != null && getWrappedExchange().getSecurityContext().getAuthenticatedAccount() != null;" is 136.,163
SoftInstigate_restheart,org.restheart.exchange,ServiceResponse,ServiceResponse,Long Statement,The length of the statement "throw new IllegalStateException("Error instantiating response object " + getClass().getSimpleName() + "` "+ exchange.getAttachment(RESPONSE_KEY).getClass().getSimpleName()+ " already bound to the exchange");" is 207.,45
SoftInstigate_restheart,org.restheart.exchange,ServiceResponse,of,Long Statement,The length of the statement "throw new IllegalStateException("Response bound to exchange is not " + "of the specified type`" + " expected " + type.getSimpleName() + " got "+ ret.getClass().getSimpleName());" is 177.,82
SoftInstigate_restheart,org.restheart.exchange,ProxyRequest,getBuffer,Long Statement,The length of the statement "throw new IllegalStateException("Request content is not available. " + "Add a Request Inteceptor with " + "@RegisterPlugin(requiresContent = true) to make "+ "the content available.");" is 184.,83
SoftInstigate_restheart,org.restheart.exchange,ProxyResponse,getBuffer,Long Statement,The length of the statement "throw new IllegalStateException("Response content is not available. " + "Add a Response Inteceptor with " + "@RegisterPlugin(requiresContent = true) to make "+ "the content available.");" is 186.,57
SoftInstigate_restheart,org.restheart.exchange,ProxyResponse,getErrorContent,Long Parameter List,The method has 5 parameters. ,111
SoftInstigate_restheart,org.restheart.plugins,Service,handleOptions,Long Statement,The length of the statement "response.getHeaders().put(HttpString.tryFromString("Access-Control-Allow-Methods")`"GET` PUT` POST` PATCH` DELETE` OPTIONS").put(HttpString.tryFromString("Access-Control-Allow-Headers")`"Accept` Accept-Encoding` Authorization` " + "Content-Length` Content-Type` Host` " + "If-Match` Origin` X-Requested-With` "+ "User-Agent` No-Auth-Challenge");" is 345.,94
SoftInstigate_restheart,org.restheart.plugins,ExchangeTypeResolver,requestType,Magic Number,The method contains a magic number: 8363463867743712134L,36
SoftInstigate_restheart,org.restheart.plugins,ExchangeTypeResolver,responseType,Magic Number,The method contains a magic number: 2478049152751095135L,42
SoftInstigate_restheart,org.restheart.plugins,FileConfigurablePlugin,init,Long Statement,The length of the statement "LOGGER.error("*** note that the path must be either absolute or " + "relative to the directory containing the file restheart-security.jar");" is 140.,52
SoftInstigate_restheart,org.restheart.plugins,PluginRecord,PluginRecord,Long Parameter List,The method has 7 parameters. ,45
SoftInstigate_restheart,org.restheart.plugins,PluginRecord,isEnabled,Long Statement,The length of the statement "return confArgs == null ? enabledByDefault : confArgs.containsKey(PLUGIN_ENABLED_KEY) && confArgs.get(PLUGIN_ENABLED_KEY) != null && confArgs.get(PLUGIN_ENABLED_KEY) instanceof Boolean ? (Boolean)confArgs.get(PLUGIN_ENABLED_KEY) : enabledByDefault;" is 248.,96
SoftInstigate_restheart,org.restheart.plugins,PluginRecord,isSecure,Long Statement,The length of the statement "return confArgs == null ? secure : confArgs.containsKey(PLUGIN_SECURE_KEY) && confArgs.get(PLUGIN_SECURE_KEY) != null && confArgs.get(PLUGIN_SECURE_KEY) instanceof Boolean ? (Boolean)confArgs.get(PLUGIN_SECURE_KEY) : secure;" is 224.,111
SoftInstigate_restheart,org.restheart.plugins,PluginsRegistryImpl,__interceptors,Long Statement,The length of the statement "Optional<PluginRecord<Service>> _service=serviceName == null ? Optional.empty() : getServices().stream().filter(pr -> serviceName.equals(pr.getName())).findFirst();" is 164.,275
SoftInstigate_restheart,org.restheart.plugins,PluginsRegistryImpl,__interceptors,Long Statement,The length of the statement "return getInterceptors().stream().filter(ri -> ri.isEnabled()).map(ri -> ri.getInstance()).filter(ri -> (_service.isPresent() && PluginUtils.cachedRequestType(ri).equals(PluginUtils.cachedRequestType(_service.get().getInstance())) && PluginUtils.cachedResponseType(ri).equals(PluginUtils.cachedResponseType(_service.get().getInstance()))) || (_service.isPresent() && ri instanceof WildcardInterceptor) || (_service.isEmpty() && PluginUtils.cachedRequestType(ri).equals(ByteArrayProxyRequest.type()) && PluginUtils.cachedResponseType(ri).equals(ByteArrayProxyResponse.type()))).filter(ri -> interceptPoint == PluginUtils.interceptPoint(ri)).collect(Collectors.toList());" is 669.,275
SoftInstigate_restheart,org.restheart.plugins,PluginsRegistryImpl,getServiceInterceptors,Long Statement,The length of the statement "var _ret=SRV_INTERCEPTORS_CACHE.getLoading(new AbstractMap.SimpleEntry<String`InterceptPoint>(serviceName`interceptPoint));" is 123.,312
SoftInstigate_restheart,org.restheart.plugins,PluginsRegistryImpl,plugService,Long Statement,The length of the statement "var _fauthorizer=new PluginRecord<Authorizer>("fullAuthorizer"`"authorize any operation to any user"`false`true`FullAuthorizer.class.getName()`new FullAuthorizer(false)`null);" is 175.,401
SoftInstigate_restheart,org.restheart.plugins,PluginsRegistryImpl,plugService,Long Statement,The length of the statement "var _srv=pipe(new PipelineInfoInjector()`blockingSrv ? new WorkingThreadsPoolDispatcher() : null`new TracingInstrumentationHandler()`new RequestLogger()`new BeforeExchangeInitInterceptorsExecutor()`new ServiceExchangeInitializer()`new CORSHandler()`new XPoweredByInjector()`new RequestInterceptorsExecutor(REQUEST_BEFORE_AUTH)`new QueryStringRebuilder()`securityHandler`new RequestInterceptorsExecutor(REQUEST_AFTER_AUTH)`new QueryStringRebuilder()`PipelinedWrappingHandler.wrap(new ConfigurableEncodingHandler(PipelinedWrappingHandler.wrap(srv.getInstance())))`new ResponseInterceptorsExecutor()`new ResponseSender());" is 619.,401
SoftInstigate_restheart,org.restheart.plugins,PluginsScanner,removeRefToScanResult,Empty catch clause,The method has an empty catch block.,176
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,authMechanisms,Long Statement,The length of the statement "authMechanismsCache=createPlugins(PluginsScanner.AUTH_MECHANISMS`"Authentication Mechanism"`Bootstrapper.getConfiguration().getAuthMechanisms());" is 145.,89
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,authenticators,Long Statement,The length of the statement "authenticatorsCache=createPlugins(PluginsScanner.AUTHENTICATORS`"Authenticators"`Bootstrapper.getConfiguration().getAuthenticators());" is 134.,103
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,authorizers,Long Statement,The length of the statement "authorizersCache=createPlugins(PluginsScanner.AUTHORIZERS`"Authorizer"`Bootstrapper.getConfiguration().getAuthorizers());" is 121.,117
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,tokenManager,Long Statement,The length of the statement "Set<PluginRecord<TokenManager>> tkms=createPlugins(PluginsScanner.TOKEN_MANAGERS`"Token Manager"`Bootstrapper.getConfiguration().getTokenManagers());" is 149.,131
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,createPlugins,Long Statement,The length of the statement "catch ( ClassNotFoundException|ConfigurationException|InstantiationException|IllegalAccessException|InvocationTargetException e) {" is 130.,194
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,loadPluginClass,Empty catch clause,The method has an empty catch block.,253
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,instantiatePlugin,Long Statement,The length of the statement "throw new ConfigurationException(pluginType + " " + pluginName+ " does not have default constructor "+ pc.getSimpleName()+ "()");" is 129.,273
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,injectCoreDependencies,Long Statement,The length of the statement "var errMsg="Error handling the request. " + "An external dependency is missing for " + ip.type + " "+ ip.name+ ". Copy the missing dependency jar to the plugins directory "+ "to add it to the classpath";" is 203.,284
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,injectMongoDbDependencies,Long Statement,The length of the statement "var errMsg="Error handling the request. " + "An external dependency is missing for " + ip.type + " "+ ip.name+ ". Copy the missing dependency jar to the plugins directory "+ "to add it to the classpath";" is 203.,304
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationMethods,Long Statement,The length of the statement "if (InjectConfiguration.class.equals(injection.clazz) && ip.descriptor.injections.stream().filter(p -> p.methodHash == injection.methodHash).count() == 1) {" is 156.,333
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationMethods,Long Statement,The length of the statement "var allConfScope=injection.params.stream().anyMatch(p -> "scope".equals(p.getKey()) && (ConfigurationScope.class.getName() + "." + ConfigurationScope.ALL.name()).equals(p.getValue().toString()));" is 195.,333
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationMethods,Long Statement,The length of the statement "var scopedConf=(Map)(allConfScope ? Bootstrapper.getConfiguration().toMap() : ip.confs != null ? ip.confs.get(ip.name) : null);" is 127.,333
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationMethods,Long Statement,The length of the statement "LOGGER.warn("{} {} defines method {} with @InjectConfiguration " + "but no configuration found for it"`ip.type`ip.name`injection.method);" is 137.,333
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationMethods,Long Statement,The length of the statement "throw new ConfigurationException(ip.type + " " + ip.name+ " has an invalid method with @InjectConfiguration. "+ "Method signature must be "+ injection.method+ "(Map<String` Object> configuration)");" is 198.,333
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectPluginsRegistryMethods,Long Statement,The length of the statement "if (InjectPluginsRegistry.class.equals(injection.clazz) && ip.descriptor.injections.stream().filter(p -> p.methodHash == injection.methodHash).count() == 1) {" is 158.,367
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectPluginsRegistryMethods,Long Statement,The length of the statement "throw new ConfigurationException(ip.type + " " + ip.name+ " has an invalid method with @InjectPluginsRegistry. "+ "Method signature must be "+ injection.method+ "(PluginsRegistry pluginsRegistry)");" is 198.,367
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "var confMethods=ip.descriptor.injections.stream().filter(p -> InjectConfiguration.class.equals(p.clazz)).collect(Collectors.toList());" is 134.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "var regiMethods=ip.descriptor.injections.stream().filter(p -> InjectPluginsRegistry.class.equals(p.clazz)).collect(Collectors.toList());" is 136.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "var bothMethods=confMethods.stream().filter(c -> regiMethods.stream().anyMatch(r -> r.methodHash == c.methodHash)).collect(Collectors.toList());" is 144.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "var allConfScope=injection.params.stream().anyMatch(p -> "scope".equals(p.getKey()) && (ConfigurationScope.class.getName() + "." + ConfigurationScope.ALL.name()).equals(p.getValue().toString()));" is 195.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "var scopedConf=(Map)(allConfScope ? Bootstrapper.getConfiguration().toMap() : ip.confs != null ? ip.confs.get(ip.name) : null);" is 127.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "LOGGER.warn("{} {} defines method {} with @InjectConfiguration " + "but no configuration found for it"`ip.type`ip.name`injection.method);" is 137.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "ip.clazz.getDeclaredMethod(injection.method`Map.class`PluginsRegistry.class).invoke(ip.instance`scopedConf`pluginsRegistry);" is 124.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectConfigurationAndPluginsRegistryMethods,Long Statement,The length of the statement "throw new ConfigurationException(ip.type + " " + ip.name+ " has an invalid method with @InjectConfiguration"+ " and @InjectPluginsRegistry."+ " Method signature must be "+ injection.method+ "(Map<String` Object> configuration`"+ " PluginsRegistry pluginsRegistry)");" is 266.,392
SoftInstigate_restheart,org.restheart.plugins,PluginsFactory,invokeInjectMongoClientMethods,Long Statement,The length of the statement "throw new ConfigurationException(ip.type + " " + ip.name+ " has an invalid method with @InjectMongoClient. "+ "Method signature must be "+ injection.method+ "(MongoClient mclient)");" is 182.,428
SoftInstigate_restheart,io.undertow.server,HttpServerExchange,addQueryParam,Magic Number,The method contains a magic number: 2,71
SoftInstigate_restheart,io.undertow.server,HttpServerExchange,addQueryParam,Magic Number,The method contains a magic number: 2,72
SoftInstigate_restheart,io.undertow.server,HttpServerExchange,addQueryParam,Magic Number,The method contains a magic number: 2,77
SoftInstigate_restheart,io.undertow.server,HttpServerExchange,addQueryParam,Magic Number,The method contains a magic number: 2,70
SoftInstigate_restheart,org.restheart.security.handlers,SecurityInitialHandler,handleRequest,Long Statement,The length of the statement "exchange.setSecurityContext(this.contextFactory.createSecurityContext(exchange`authenticationMode`null`programaticMechName));" is 125.,71
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticationConstraintHandler,AuthenticationConstraintHandler,Long Statement,The length of the statement "this.allowers=authorizers == null ? Sets.newHashSet() : authorizers.stream().filter(a -> a.isEnabled()).filter(a -> a.getInstance() != null).map(a -> a.getInstance()).filter(a -> PluginUtils.authorizerType(a) == TYPE.ALLOWER).collect(Collectors.toSet());" is 254.,44
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticationConstraintHandler,isAuthenticationRequired,Long Statement,The length of the statement "return this.allowers.isEmpty() ? false : allowers.stream().allMatch(a -> a.isAuthenticationRequired(Request.of(exchange)));" is 123.,62
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticatorMechanismsHandler,AuthenticatorMechanismsHandler,Long Identifier,The length of the field wrappedAuthenticatorMechanisms is 30.,43
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticatorMechanismsHandler,AuthenticatorMechanismsHandler,Long Statement,The length of the statement "this.wrappedAuthenticatorMechanisms=authenticatorMechanisms.stream().map(mechanism -> new AuthenticatorMechanismWrapper(mechanism.getInstance())).collect(Collectors.toCollection(LinkedHashSet::new));" is 199.,43
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticatorMechanismsHandler,AuthenticatorMechanismsHandler,Long Identifier,The length of the field wrappedAuthenticatorMechanisms is 30.,48
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticatorMechanismsHandler,AuthenticatorMechanismsHandler,Long Statement,The length of the statement "this.wrappedAuthenticatorMechanisms=authenticatorMechanisms.stream().map(mechanism -> new AuthenticatorMechanismWrapper(mechanism.getInstance())).collect(Collectors.toCollection(LinkedHashSet::new));" is 199.,48
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticatorMechanismsHandler,handleRequest,Long Identifier,The length of the field wrappedAuthenticatorMechanisms is 30.,53
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticatorMechanismsHandler,handleRequest,Long Statement,The length of the statement "wrappedAuthenticatorMechanisms.stream().forEachOrdered(wrappedMechanism -> amc.addAuthenticationMechanism(wrappedMechanism));" is 125.,53
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticatorMechanismWrapper,authenticate,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@64e0b317,67
SoftInstigate_restheart,org.restheart.security.handlers,SecurityHandler,buildSecurityHandlersChain,Long Statement,The length of the statement "throw new IllegalArgumentException("Error` authorizers cannot " + "be null or empty. " + "Eventually use FullAuthorizer "+ "that gives full access power");" is 155.,66
SoftInstigate_restheart,org.restheart.security.handlers,SecurityHandler,buildSecurityHandlersChain,Long Statement,The length of the statement "return new SecurityInitialHandler(AuthenticationMode.PRO_ACTIVE`new AuthenticatorMechanismsHandler(new AuthenticationConstraintHandler(new AuthenticationCallHandler(new TokenInjector(new AuthorizersHandler(authorizers`next)`tokenManager != null ? tokenManager.getInstance() : null))`authorizers)`mechanisms));" is 309.,66
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticationCallHandler,handleRequest,Complex Conditional,The conditional expression sc.authenticate() && (!sc.isAuthenticationRequired() || sc.isAuthenticated()) is complex.,81
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticationCallHandler,updateFailedAuthMetrics,Long Statement,The length of the statement "_update(AUTH_METRIC_REGISTRY.histogram(failedAuthHistogramName(exchange)`() -> new Histogram(new SlidingTimeWindowArrayReservoir(10`TimeUnit.SECONDS))));" is 153.,123
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticationCallHandler,updateFailedAuthMetrics,Magic Number,The method contains a magic number: 10,123
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticationCallHandler,tryPruneMetrics,Long Statement,The length of the statement "AUTH_METRIC_REGISTRY.removeMatching((name`metric) -> name.startsWith(MetricRegistry.name(Authenticator.class`FAILED_AUTH_METRIC_PREFIX)));" is 138.,149
SoftInstigate_restheart,org.restheart.security.handlers,AuthenticationCallHandler,tryPruneMetrics,Magic Number,The method contains a magic number: 100,149
SoftInstigate_restheart,org.restheart.security.handlers,AuthorizersHandler,isAllowed,Long Statement,The length of the statement "return authorizers.stream().filter(a -> a.isEnabled()).filter(a -> a.getInstance() != null).map(a -> a.getInstance()).filter(a -> PluginUtils.authorizerType(a) == TYPE.ALLOWER).filter(a -> !a.isAuthenticationRequired(request) || request.isAuthenticated()).anyMatch(a -> a.isAllowed(request)) && authorizers.stream().filter(a -> a.isEnabled()).filter(a -> a.getInstance() != null).map(a -> a.getInstance()).filter(a -> !a.isAuthenticationRequired(request) || request.isAuthenticated()).filter(a -> PluginUtils.authorizerType(a) == TYPE.VETOER).allMatch(a -> a.isAllowed(request));" is 579.,75
SoftInstigate_restheart,org.restheart.examples,CsvRepresentationTransformer,handle,Long Statement,The length of the statement "docs.stream().map(BsonValue::asDocument).forEach(fdoc -> sb.append(fdoc.entrySet().stream().map(e -> e.getValue()).map(v -> BsonUtils.toJson(v)).collect(Collectors.joining("`"))).append("\n"));" is 193.,17
SoftInstigate_restheart,org.restheart.examples,CsvRepresentationTransformer,resolve,Long Statement,The length of the statement "return request.isGet() && request.isCollection() && response.getContent() != null && request.getQueryParameterOfDefault("csv"`null) != null;" is 140.,44
SoftInstigate_restheart,org.restheart.examples,CoordsToGeoJson,handle,Long Statement,The length of the statement "docs.stream().map(doc -> doc.asDocument()).filter(doc -> doc.containsKey("lon") && doc.containsKey("lat")).forEachOrdered(doc -> {" is 130.,17
SoftInstigate_restheart,org.restheart.examples,RandomStringService,handle,Magic Number,The method contains a magic number: 10,17
SoftInstigate_restheart,org.restheart.examples,SlackNotifierInterceptor,handle,Long Statement,The length of the statement "final var jsonObject=object().put("text"`":tada: New document\n```" + doc.toJson(JsonWriterSettings.builder().indent(true).build()) + "```").put("channel"`this.channel).get();" is 175.,47
SoftInstigate_restheart,org.restheart.examples,SlackNotifierInterceptor,handle,Long Statement,The length of the statement "var httpClient=HttpClient.newBuilder().version(HttpClient.Version.HTTP_1_1).connectTimeout(Duration.ofSeconds(10)).build();" is 123.,47
SoftInstigate_restheart,org.restheart.examples,SlackNotifierInterceptor,handle,Long Statement,The length of the statement "var httpRequest=HttpRequest.newBuilder().uri(URI.create("https://slack.com/api/chat.postMessage")).header("Authorization"`"Bearer " + this.oauthToken).header("Content-Type"`"application/json; charset=utf-8").POST(BodyPublishers.ofString(json)).build();" is 252.,47
SoftInstigate_restheart,org.restheart.examples,SlackNotifierInterceptor,handle,Long Statement,The length of the statement "LOGGER.info("SlackNotifierInterceptor sent message to Slack channel: {} with status {}"`httpResponse.body()`httpResponse.statusCode());" is 135.,47
SoftInstigate_restheart,org.restheart.examples,SlackNotifierInterceptor,handle,Magic Number,The method contains a magic number: 10,47
SoftInstigate_restheart,org.restheart.examples,SlackNotifierInterceptor,resolve,Long Statement,The length of the statement "return request.isPost() && request.isCollection() && this.collection.equals(request.getCollectionName())&& this.db.equals(request.getDBName())&& response.getDbOperationResult() != null && response.getDbOperationResult().getNewData() != null;" is 241.,80
SoftInstigate_restheart,org.restheart.examples,GreeterService,handle,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@72f61758,13
SoftInstigate_restheart,org.restheart.examples,FormHandler,handle,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@68ff44dc,21
SoftInstigate_restheart,org.restheart.examples,ProtobufToBson,resolve,Long Statement,The length of the statement "return request instanceof UninitializedRequest && request.isPost() && "application/protobuf".equals(request.getContentType())&& "/proto".equals(request.getPath());" is 163.,61
SoftInstigate_restheart,org.restheart.examples,XxxTest,testCodec,Long Statement,The length of the statement "var registry=CodecRegistries.fromRegistries(CodecRegistries.fromProviders(new PBCodecProvider())`MongoClientSettings.getDefaultCodecRegistry());" is 144.,13
SoftInstigate_restheart,org.restheart.examples,CreateContact,main,Magic Number,The method contains a magic number: 3,9
SoftInstigate_restheart,org.restheart.examples,CreateContact,main,Magic Number,The method contains a magic number: 2,9
SoftInstigate_restheart,org.restheart.examples,CreateContact,createContact,Long Statement,The length of the statement "var resp=Unirest.post("http://localhost:8080/proto").header("Content-Type"`"application/protobuf").body(body.toByteArray()).asBinary();" is 135.,20
SoftInstigate_restheart,org.restheart.signup,EmailVerificationSender,resolve,Long Statement,The length of the statement "return response.getDbOperationResult() != null && response.getDbOperationResult().getNewId() != null && response.getDbOperationResult().getNewId().isString() && response.getDbOperationResult().getNewData() != null && response.getDbOperationResult().getNewData().isDocument() && response.getDbOperationResult().getNewData().asDocument().containsKey("code") && response.getDbOperationResult().getNewData().asDocument().get("code").isString();" is 440.,71
SoftInstigate_restheart,org.restheart.signup,UserVerifier,handle,Complex Conditional,The conditional expression !qparams.containsKey("username") || qparams.get("username").isEmpty() || !qparams.containsKey("code")|| qparams.get("code").isEmpty() is complex.,62
SoftInstigate_restheart,org.restheart.signup,UserVerifier,handle,Long Statement,The length of the statement "if (!qparams.containsKey("username") || qparams.get("username").isEmpty() || !qparams.containsKey("code")|| qparams.get("code").isEmpty()) {" is 140.,62
SoftInstigate_restheart,org.restheart.signup,UserVerifier,checkRequest,Long Statement,The length of the statement "return qparams.containsKey("username") && !qparams.get("username").isEmpty() && qparams.containsKey("code")&& !qparams.get("code").isEmpty();" is 141.,100
SoftInstigate_restheart,org.restheart.signup,UserVerifier,verify,Long Statement,The length of the statement "var query=and(eq(propId`new BsonString(username))`eq("code"`new BsonString(code))`eq("roles"`new BsonString("UNVERIFIED")));" is 124.,109
SoftInstigate_restheart,org.restheart.signup,VerificationCodeGenerator,resolve,Long Statement,The length of the statement "return this.mclient != null && request.isWriteDocument() && "users".equalsIgnoreCase(request.getCollectionName()) && request.getContent() != null && request.getContent().isDocument() && (request.getAuthenticatedAccount() == null || request.getAuthenticatedAccount().getRoles().contains("$unauthenticated"));" is 307.,75
SoftInstigate_restheart,org.restheart.signup,VerificationCodeGenerator,userExists,Long Statement,The length of the statement "var existingUser=this.mclient.getDatabase(request.getDBName()).getCollection(request.getCollectionName()`BsonDocument.class).find(eq("_id"`id)).first();" is 152.,84
SoftInstigate_restheart,org.restheart.signup,VerificationCodeGenerator,nextCode,Magic Number,The method contains a magic number: 256,103
SoftInstigate_restheart,org.restheart.graphql.datafetchers,GQLAggregationDataFetcher,get,Long Statement,The length of the statement "res=mongoClient.getDatabase(aggregation.getDb().getValue()).getCollection(aggregation.getCollection().getValue()).withDocumentClass(BsonDocument.class).aggregate(aggregationList).allowDiskUse(aggregation.getAllowDiskUse().getValue()).maxTime(this.aggregationTimeLimit`TimeUnit.MILLISECONDS);" is 291.,46
SoftInstigate_restheart,org.restheart.graphql.datafetchers,GQLQueryDataFetcher,get,Long Statement,The length of the statement "FindIterable<BsonValue> query=mongoClient.getDatabase(queryMapping.getDb()).getCollection(queryMapping.getCollection()`BsonValue.class).find(int_args.containsKey(FIND_FIELD) ? int_args.get(FIND_FIELD).asDocument() : new BsonDocument());" is 236.,43
SoftInstigate_restheart,org.restheart.graphql.cache,AppDefinitionLoader,loadAppDefinition,Long Statement,The length of the statement "var appDefinition=mongoClient.getDatabase(appDB).getCollection(appCollection`BsonDocument.class).find(findArg.get()).first();" is 125.,47
SoftInstigate_restheart,org.restheart.graphql.cache,AppDefinitionLoadingCache,AppDefinitionLoadingCache,Long Statement,The length of the statement "this.appLoadingCache=CacheFactory.createLocalLoadingCache(MAX_CACHE_SIZE`Cache.EXPIRE_POLICY.AFTER_WRITE`ttl`( String key) -> {" is 127.,40
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,initConf,Empty catch clause,The method has an empty catch block.,74
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,handle,Long Identifier,The length of the identifier dispatcherInstrumentationOptions is 32.,107
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,handle,Long Statement,The length of the statement "ExecutionInput.Builder inputBuilder=ExecutionInput.newExecutionInput().query(request.getQuery()).dataLoaderRegistry(dataLoaderRegistry);" is 136.,107
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,handle,Long Statement,The length of the statement "DataLoaderDispatcherInstrumentationOptions dispatcherInstrumentationOptions=DataLoaderDispatcherInstrumentationOptions.newOptions();" is 132.,107
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,handle,Long Statement,The length of the statement "DataLoaderDispatcherInstrumentation dispatcherInstrumentation=new DataLoaderDispatcherInstrumentation(dispatcherInstrumentationOptions);" is 136.,107
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,handle,Magic Number,The method contains a magic number: 400,107
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,requestInitializer,Long Statement,The length of the statement "if (e.getRequestMethod().equalToString(ExchangeKeys.METHOD.POST.name()) || e.getRequestMethod().equalToString(ExchangeKeys.METHOD.OPTIONS.name())) {" is 148.,192
SoftInstigate_restheart,org.restheart.graphql,GraphQLService,requestInitializer,Magic Number,The method contains a magic number: 2,192
SoftInstigate_restheart,org.restheart.graphql,GraphQLAppDeserializer,fromBsonDocument,Long Statement,The length of the statement "throw new GraphQLIllegalAppDefinitionException("'Descriptor' field must be a 'DOCUMENT' but was " + appDef.get("descriptor").getBsonType());" is 140.,36
SoftInstigate_restheart,org.restheart.graphql,GraphQLAppDeserializer,fromBsonDocument,Long Statement,The length of the statement "throw new GraphQLIllegalAppDefinitionException("'Schema' field must be a 'STRING' but was " + appDef.get("descriptor").getBsonType());" is 134.,36
SoftInstigate_restheart,org.restheart.graphql,GraphQLAppDeserializer,fromBsonDocument,Long Statement,The length of the statement "throw new GraphQLIllegalAppDefinitionException("'Mappings' field must be a 'DOCUMENT' but was " + appDef.get("mappings").getBsonType());" is 136.,36
SoftInstigate_restheart,org.restheart.graphql,GraphQLAppDeserializer,getMappings,Complex Method,Cyclomatic complexity of the method is 32,116
SoftInstigate_restheart,org.restheart.graphql,GraphQLAppDeserializer,getMappings,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@2572ee69,116
SoftInstigate_restheart,org.restheart.graphql,GraphQLAppDeserializer,throwIllegalDefinitionException,Long Parameter List,The method has 5 parameters. ,324
SoftInstigate_restheart,org.restheart.graphql,GraphQLAppDeserializer,throwIllegalDefinitionException,Long Statement,The length of the statement "throw new GraphQLIllegalAppDefinitionException("Error with field '" + field + "' of type '"+ type+ "'. The field '"+ arg+ "' must be a '"+ typeExpected+ "' but was '"+ value.getBsonType()+ "'.");" is 195.,324
SoftInstigate_restheart,org.restheart.graphql.scalars.bsonCoercing,GraphQLBsonDecimal128Coercing,parseLiteral,Complex Conditional,The conditional expression input instanceof StringValue || input instanceof IntValue || input instanceof FloatValue is complex.,57
SoftInstigate_restheart,org.restheart.graphql.scalars.bsonCoercing,GraphQLBsonDocumentCoercing,parseObjectField,Complex Method,Cyclomatic complexity of the method is 11,71
SoftInstigate_restheart,org.restheart.graphql.scalars.bsonCoercing,GraphQLBsonDateCoercing,parseValue,Long Statement,The length of the statement "throw new CoercingParseValueException("Expected type 'Long' or 'String' (with a valid OffsetDateTime) but was '" + typeName(input) + "'.");" is 139.,46
SoftInstigate_restheart,org.restheart.graphql.scalars.bsonCoercing,GraphQLBsonRegexCoercing,serialize,Long Statement,The length of the statement "throw new CoercingSerializeException("Expected type 'BsonRegularExpression' but was '" + typeName(dataFetcherResult) + "'.");" is 125.,33
SoftInstigate_restheart,org.restheart.graphql.dataloaders,QueryBatchLoader,load,Long Statement,The length of the statement "BsonDocument findClause=query.asDocument().containsKey("find") ? query.asDocument().getDocument("find") : new BsonDocument();" is 125.,55
SoftInstigate_restheart,org.restheart.graphql.dataloaders,AggregationBatchLoader,load,Long Statement,The length of the statement "List<Facet> listOfFacets=pipelines.stream().map(pipeline -> new Facet(String.valueOf(pipeline.hashCode())`toBson(pipeline))).toList();" is 134.,34
SoftInstigate_restheart,org.restheart.graphql.dataloaders,AggregationBatchLoader,load,Long Statement,The length of the statement "var iterable=mongoClient.getDatabase(this.db).getCollection(this.collection`BsonValue.class).aggregate(List.of(Aggregates.facet(listOfFacets)));" is 144.,34
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionPatchChecker,conf,Empty catch clause,The method has an empty catch block.,62
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionPatchChecker,resolve,Long Statement,The length of the statement "return enabled && this.db.equals(request.getDBName()) && this.coll.equals(request.getCollectionName())&& (request.isBulkDocuments() || (request.isDocument() && request.isPatch() && response.getDbOperationResult() != null && response.getDbOperationResult().getNewData() != null));" is 279.,94
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionPutPostEscaper,conf,Empty catch clause,The method has an empty catch block.,51
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionPutPostEscaper,resolve,Long Statement,The length of the statement "return enabled && this.db.equals(request.getDBName()) && this.coll.equals(request.getCollectionName())&& request.isGet()&& response.getContent() != null;" is 153.,71
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionEscaper,conf,Empty catch clause,The method has an empty catch block.,51
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionEscaper,resolve,Long Statement,The length of the statement "return enabled && this.db.equals(request.getDBName()) && this.coll.equals(request.getCollectionName())&& request.getContent() != null && request.isWriteDocument();" is 163.,71
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionPutPostChecker,conf,Empty catch clause,The method has an empty catch block.,54
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionPutPostChecker,handle,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"wrong GraphQL App definition in document at index positon " + index + ": "+ e.getMessage()`e);" is 141.,69
SoftInstigate_restheart,org.restheart.graphql.interceptors,GraphAppDefinitionPutPostChecker,resolve,Long Statement,The length of the statement "return enabled && this.db.equals(request.getDBName()) && this.coll.equals(request.getCollectionName())&& request.getContent() != null && ((request.isCollection() && request.isPost()) || (request.isDocument() && request.isPut()));" is 229.,97
SoftInstigate_restheart,org.restheart.graphql.models,AggregationMapping,AggregationMapping,Long Parameter List,The method has 6 parameters. ,29
SoftInstigate_restheart,org.restheart.graphql.models,AggregationMapping,getDataFetcher,Long Statement,The length of the statement "return this.dataLoaderSettings.getBatching() ? new GQLBatchAggregationDataFetcher(this) : new GQLAggregationDataFetcher(this);" is 126.,40
SoftInstigate_restheart,org.restheart.graphql.models,AggregationMapping,getDataloader,Long Statement,The length of the statement "return new DataLoader<BsonValue`BsonValue>(new AggregationBatchLoader(this.db.getValue()`this.collection.getValue())`options);" is 126.,47
SoftInstigate_restheart,org.restheart.graphql.models,QueryMapping,QueryMapping,Long Parameter List,The method has 8 parameters. ,46
SoftInstigate_restheart,org.restheart.graphql.models,QueryMapping,getDataloader,Long Statement,The length of the statement "DataLoaderOptions options=new DataLoaderOptions().setCacheKeyFunction(bsonValue -> String.valueOf(bsonValue.hashCode()));" is 121.,68
SoftInstigate_restheart,org.restheart.graphql.models,FieldMapping,searchOperators,Complex Method,Cyclomatic complexity of the method is 11,52
SoftInstigate_restheart,org.restheart.graphql.models,FieldMapping,searchOperators,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@446b99db,52
SoftInstigate_restheart,org.restheart.graphql.exchange,GraphQLRequest,isContentTypeGraphQL,Long Statement,The length of the statement "return GRAPHQL_CONTENT_TYPE.equals(contentType) || (contentType != null && contentType.startsWith(GRAPHQL_CONTENT_TYPE));" is 121.,126
SoftInstigate_restheart,(default package),MavenWrapperDownloader,main,Empty catch clause,The method has an empty catch block.,48
SoftInstigate_restheart,(default package),MavenWrapperDownloader,main,Long Identifier,The length of the identifier mavenWrapperPropertyFileInputStream is 35.,48
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,init,Long Statement,The length of the statement "String[] headers={AUTH_TOKEN_HEADER.toString()`AUTH_TOKEN_VALID_HEADER.toString()`AUTH_TOKEN_LOCATION_HEADER.toString()};" is 121.,69
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,init,Long Statement,The length of the statement "var ti=pluginsRegistry.getInterceptors().stream().filter(i -> "tokenCORSResponseInterceptor".equals(i.getName())).findFirst();" is 126.,69
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,init,Magic Number,The method contains a magic number: 60,69
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,init,Magic Number,The method contains a magic number: 1_000,69
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,cloneWithToken,Long Statement,The length of the statement "ret=new MongoRealmAccount(maccount.getPrincipal().getName()`token`Sets.newTreeSet(maccount.getRoles())`maccount.getAccountDocument());" is 134.,141
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,cloneWithToken,Long Statement,The length of the statement "ret=new FileRealmAccount(faccount.getPrincipal().getName()`token`Sets.newTreeSet(faccount.getRoles())`faccount.getAccountProperties());" is 135.,141
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,injectTokenHeaders,Complex Conditional,The conditional expression request.getAuthenticatedAccount() != null && request.getAuthenticatedAccount().getPrincipal() != null && request.getAuthenticatedAccount().getPrincipal().getName() != null is complex.,182
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,injectTokenHeaders,Long Statement,The length of the statement "if (request.getAuthenticatedAccount() != null && request.getAuthenticatedAccount().getPrincipal() != null && request.getAuthenticatedAccount().getPrincipal().getName() != null) {" is 178.,182
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,injectTokenHeaders,Long Statement,The length of the statement "exchange.getResponseHeaders().add(AUTH_TOKEN_LOCATION_HEADER`URLUtils.removeTrailingSlashes(srvURI).concat("/").concat(cid));" is 125.,182
SoftInstigate_restheart,org.restheart.security.tokens,RndTokenManager,nextToken,Magic Number,The method contains a magic number: 256,199
SoftInstigate_restheart,org.restheart.security.utils,MongoUtils,createCollection,Long Statement,The length of the statement "pc.insertOne(document().put("_id"`new BsonString("_properties.".concat(collName))).put("_etag"`new BsonObjectId()).get());" is 122.,71
SoftInstigate_restheart,org.restheart.security.interceptors,BruteForceAttackGuard,config,Long Statement,The length of the statement "LOGGER.info("Failed auth requests will be counted on X-Forwarded-For header` tracking the {}th value from the last"`xForwardedForValueFromLast);" is 144.,69
SoftInstigate_restheart,org.restheart.security.interceptors,BruteForceAttackGuard,config,Magic Number,The method contains a magic number: 5,69
SoftInstigate_restheart,org.restheart.security.interceptors,BruteForceAttackGuard,logWarning,Long Statement,The length of the statement "LogUtils.boxedWarn(LOGGER`"A brute force attack might be in progress..."`""`"Got too many of failed auth attempts in last 10 seconds from:"`""`"remote ip: " + ExchangeAttributes.remoteIp().readAttribute(exchange)`"X-Forwarded-For header: " + xff`"X-Forwarded-For tracked value: " + xffValue(xff`xForwardedForValueFromLast)`""`"transport protocol: " + ExchangeAttributes.transportProtocol().readAttribute(exchange)`"request method: " + ExchangeAttributes.requestMethod().readAttribute(exchange)`"request url: " + ExchangeAttributes.requestURL().readAttribute(exchange));" is 569.,120
SoftInstigate_restheart,org.restheart.security.interceptors,BruteForceAttackGuard,authHisto,Long Statement,The length of the statement "return AUTH_METRIC_REGISTRY.histogram(failedAuthHistogramName(request.getExchange())`() -> new Histogram(new SlidingTimeWindowArrayReservoir(10`TimeUnit.SECONDS)));" is 164.,136
SoftInstigate_restheart,org.restheart.security.interceptors,BruteForceAttackGuard,authHisto,Magic Number,The method contains a magic number: 10,136
SoftInstigate_restheart,org.restheart.security.services,GetRoleService,handle,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@6650ad9,70
SoftInstigate_restheart,org.restheart.security.services,GetRoleService,checkRequestPath,Long Statement,The length of the statement "return request.getAuthenticatedAccount() != null && request.getAuthenticatedAccount().getPrincipal() != null && request.getAuthenticatedAccount().getPrincipal().getName() != null && request.getAuthenticatedAccount().getRoles() != null && request.getPath().equals(myURI + "/" + request.getAuthenticatedAccount().getPrincipal().getName());" is 337.,107
SoftInstigate_restheart,org.restheart.security.services,RndTokenService,handle,Complex Conditional,The conditional expression request.getPath().startsWith(getUri()) && request.getPath().length() >= (getUri().length() + 2) && Methods.OPTIONS.equals(exchange.getRequestMethod()) is complex.,83
SoftInstigate_restheart,org.restheart.security.services,RndTokenService,handle,Long Statement,The length of the statement "if (request.getPath().startsWith(getUri()) && request.getPath().length() >= (getUri().length() + 2) && Methods.OPTIONS.equals(exchange.getRequestMethod())) {" is 157.,83
SoftInstigate_restheart,org.restheart.security.services,RndTokenService,handle,Long Statement,The length of the statement "response.getHeaders().put(HttpString.tryFromString("Access-Control-Allow-Methods")`"GET` DELETE").put(HttpString.tryFromString("Access-Control-Allow-Headers")`"Accept` Accept-Encoding` Authorization` Content-Length` " + "Content-Type` Host` Origin` X-Requested-With` " + "User-Agent` No-Auth-Challenge");" is 304.,83
SoftInstigate_restheart,org.restheart.security.services,RndTokenService,handle,Long Statement,The length of the statement "if (!((getUri() + "/" + exchange.getSecurityContext().getAuthenticatedAccount().getPrincipal().getName()).equals(exchange.getRequestURI())) && !(ESCAPER.escape(getUri() + "/" + exchange.getSecurityContext().getAuthenticatedAccount().getPrincipal().getName())).equals(exchange.getRequestURI())) {" is 295.,83
SoftInstigate_restheart,org.restheart.security.services,RndTokenService,handle,Long Statement,The length of the statement "BaseAccount account=new BaseAccount(exchange.getSecurityContext().getAuthenticatedAccount().getPrincipal().getName()`null);" is 123.,83
SoftInstigate_restheart,org.restheart.security.services,RndTokenService,handle,Magic Number,The method contains a magic number: 2,83
SoftInstigate_restheart,org.restheart.security.authorizers,FileAclPermission,FileAclPermission,Long Statement,The length of the statement "super(req -> AclVarsInterpolator.interpolatePredicate(req`requestPredicate`FileAclPermission.class.getClassLoader()).resolve(req.getExchange())`roles`priority`raw);" is 164.,48
SoftInstigate_restheart,org.restheart.security.authorizers,FileAclPermission,build,Long Statement,The length of the statement "throw new ConfigurationException("Wrong permission: it specifies both 'role' and 'roles'; it requires just one or the other.");" is 127.,53
SoftInstigate_restheart,org.restheart.security.authorizers,FileAclAuthorizer,isAllowed,Complex Method,Cyclomatic complexity of the method is 8,103
SoftInstigate_restheart,org.restheart.security.authorizers,FileAclAuthorizer,isAllowed,Long Statement,The length of the statement "LOGGER.debug("role {}` permission (roles={}`predicate={})` resolve {} {}"`role`permission.getRoles()`permission.getRequestPredicate()`resolved`marker);" is 151.,103
SoftInstigate_restheart,org.restheart.security.authorizers,FileAclAuthorizer,rolePermissions,Long Statement,The length of the statement "StreamSupport.stream(this.permissions.spliterator()`true).filter(p -> p.getRoles() != null && p.getRoles().contains(role)).sorted(Comparator.comparingInt(FileAclPermission::getPriority)).forEachOrdered(p -> ret.add(p));" is 219.,222
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,initConfiguration,Long Statement,The length of the statement "throw new ConfigurationException("wrong configuration file format. " + "cache-expire-policy valid values are " + Arrays.toString(Cache.EXPIRE_POLICY.values()));" is 160.,91
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,isAllowed,Complex Conditional,The conditional expression this.rootRole != null && exchange.getSecurityContext() != null && exchange.getSecurityContext().getAuthenticatedAccount() != null && exchange.getSecurityContext().getAuthenticatedAccount().getRoles().contains(this.rootRole) is complex.,146
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,isAllowed,Complex Method,Cyclomatic complexity of the method is 8,146
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,isAllowed,Long Statement,The length of the statement "if (this.rootRole != null && exchange.getSecurityContext() != null && exchange.getSecurityContext().getAuthenticatedAccount() != null && exchange.getSecurityContext().getAuthenticatedAccount().getRoles().contains(this.rootRole)) {" is 230.,146
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,isAllowed,Long Statement,The length of the statement "LOGGER.debug("allow request for root user {}"`exchange.getSecurityContext().getAuthenticatedAccount().getPrincipal().getName());" is 128.,146
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,isAllowed,Long Statement,The length of the statement "exchange.putAttachment(MATCHING_ACL_PERMISSION`new MongoAclPermission(new BsonObjectId()`"path-prefix('/')"`roles`Integer.MAX_VALUE`new BsonDocument("mongo"`ALLOW_ALL_MONGO_PERMISSIONS.asBson())));" is 197.,146
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,findRolePermissions,Long Statement,The length of the statement "var permissions=this.mclient.getDatabase(this.aclDb).getCollection(this.aclCollection`BsonDocument.class).find(eq("roles"`role)).projection(PROJECTION).sort(SORT);" is 163.,324
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclAuthorizer,findRolePermissions,Long Statement,The length of the statement "StreamSupport.stream(permissions.spliterator()`true).filter(permissionElem -> permissionElem.isDocument()).map(permissionElem -> permissionElem.asDocument()).filter(permissionDocument -> {" is 188.,324
SoftInstigate_restheart,org.restheart.security.authorizers,OriginVetoer,setConfiguration,Long Statement,The length of the statement "this.whitelist=_whitelist.stream().filter(item -> item != null).map(item -> item.trim()).map(item -> item.toLowerCase()).map(item -> removeTrailingSlashes(item)).map(item -> item.concat("/")).collect(Collectors.toList());" is 221.,51
SoftInstigate_restheart,org.restheart.security.authorizers,OriginVetoer,setConfiguration,Long Statement,The length of the statement "_ingoreList.stream().filter(item -> item != null).map(item -> item.trim()).map(item -> item.toLowerCase()).map(item -> PathTemplate.create(item)).forEach(item -> this.ignoreLists.add(item`true));" is 195.,51
SoftInstigate_restheart,org.restheart.security.authorizers,OriginVetoer,setConfiguration,Long Statement,The length of the statement "LOGGER.info("ignore list defined for originVetoer` requests will be accepted without checking the Origin header for paths in {}"`_ingoreList);" is 142.,51
SoftInstigate_restheart,org.restheart.security.authorizers,OriginVetoer,isAllowed,Long Statement,The length of the statement "var allowed=this.whitelist.stream().anyMatch(wl -> removeTrailingSlashes(origin.toLowerCase()).concat("/").startsWith(wl));" is 123.,85
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclPermission,MongoAclPermission,Long Parameter List,The method has 5 parameters. ,50
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclPermission,MongoAclPermission,Long Statement,The length of the statement "super(req -> AclVarsInterpolator.interpolatePredicate(req`requestPredicate`MongoAclPermission.class.getClassLoader()).resolve(req.getExchange())`roles`priority`raw);" is 165.,50
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclPermission,build,Complex Conditional,The conditional expression _roles == null || !_roles.isArray() || _roles.asArray().isEmpty() is complex.,55
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclPermission,build,Complex Conditional,The conditional expression _priority == null || _priority.isNull() || !_priority.isNumber() is complex.,55
SoftInstigate_restheart,org.restheart.security.authorizers,MongoAclPermission,build,Long Statement,The length of the statement "var roles=StreamSupport.stream(_roles.asArray().spliterator()`true).map(role -> role.asString()).map(role -> role.getValue()).collect(Collectors.toSet());" is 154.,55
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestContainsPredicate,resolve,Long Statement,The length of the statement "LOGGER.warn("bson-request-contains predicate not invoked on BsonRequest but {}` it won't allow the request"`_request == null ? _request : _request.getClass().getSimpleName());" is 175.,57
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestWhitelistPredicate,resolve,Long Statement,The length of the statement "LOGGER.warn("bson-request-whitelist predicate not invoked on BsonRequest but {}` it won't allow the request"`_request == null ? _request : _request.getClass().getSimpleName());" is 176.,55
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestWhitelistPredicate,areAllKeysWhitelisted,Long Statement,The length of the statement "return docArArrayOfDocs.asArray().stream().filter(BsonValue::isDocument).map(BsonValue::asDocument).allMatch(doc -> areAllKeysWhitelisted(whitelist`doc));" is 154.,67
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestWhitelistPredicate,isWhitelisted,Long Statement,The length of the statement "return whitelist.stream().anyMatch(whitelistedKey -> leafKey.equals(whitelistedKey) || leafKey.startsWith(whitelistedKey.concat(".")));" is 135.,90
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestWhitelistPredicate,getLeafsKeys,Long Statement,The length of the statement "d.keySet().stream().filter(BsonUtils::isUpdateOperator).map(uo -> d.get(uo)).filter(doc -> doc.isDocument()).map(doc -> doc.asDocument()).map(doc -> doc.keySet()).forEach(leafsKeys::addAll);" is 190.,95
SoftInstigate_restheart,org.restheart.security.predicates,QParamsContainPredicate,resolve,Long Statement,The length of the statement "return (qparamsInExchange == null && qparams.size() == 0) || (qparamsInExchange != null && this.qparams.stream().allMatch(qparamsInExchange.keySet()::contains));" is 161.,47
SoftInstigate_restheart,org.restheart.security.predicates,QParamsSizePredicate,resolve,Long Statement,The length of the statement "return (qparamsInExchange == null && this.size == 0) || (qparamsInExchange != null && qparamsInExchange.keySet().size() == this.size);" is 134.,41
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestBlacklistPredicate,resolve,Long Statement,The length of the statement "LOGGER.warn("bson-request-blacklist predicate not invoked on BsonRequest but {}` it won't allow the request"`_request == null ? _request : _request.getClass().getSimpleName());" is 176.,56
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestPredicatesTest,testJsonRequestContainsBson,Long Statement,The length of the statement "var predicateFooArrayNotExisting=PredicateParser.parse("bson-request-contains(foo` array` notex)"`MongoUtils.class.getClassLoader());" is 133.,35
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestPredicatesTest,testJsonRequestContainsBson,Long Statement,The length of the statement "var exchange=exchangeWithBsonContent("{ 'foo':{'bar':true}` 'array': [{'a':1`'b':2}`{'b':1}]` '$set': {'p.q.r': true} }");" is 122.,35
SoftInstigate_restheart,org.restheart.security.predicates,BsonRequestPredicatesTest,testJsonRequestBlacklistBson,Long Statement,The length of the statement "var predicateArrayArray2=PredicateParser.parse("bson-request-blacklist(array` array2.foo)"`MongoUtils.class.getClassLoader());" is 126.,85
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,sendChallenge,Long Statement,The length of the statement "if (exchange.getRequestHeaders().contains(SILENT_HEADER_KEY) || exchange.getQueryParameters().containsKey(SILENT_QUERY_PARAM_KEY)) {" is 132.,103
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,DigestAuthMechanism,Long Parameter List,The method has 6 parameters. ,152
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,DigestAuthMechanism,Long Parameter List,The method has 6 parameters. ,159
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,DigestAuthMechanism,Long Parameter List,The method has 7 parameters. ,164
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,DigestAuthMechanism,Long Statement,The length of the statement "this(Collections.singletonList(DigestAlgorithm.MD5)`Collections.singletonList(DigestQop.AUTH)`realmName`domain`new SimpleNonceManager()`mechanismName`identityManager);" is 167.,191
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,handleDigestHeader,Complex Method,Cyclomatic complexity of the method is 19,235
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,validateRequest,Long Statement,The length of the statement "byte[] providedResponse=context.getParsedHeader().get(DigestAuthorizationToken.RESPONSE).getBytes(StandardCharsets.UTF_8);" is 122.,378
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,validateNonceUse,Magic Number,The method contains a magic number: 16,400
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,sendAuthenticationInfoHeader,Long Statement,The length of the statement "sb.append("`").append(Headers.CNONCE.toString()).append("=\"").append(parsedHeader.get(DigestAuthorizationToken.CNONCE)).append("\"");" is 134.,517
SoftInstigate_restheart,org.restheart.security.mechanisms,DigestAuthMechanism,sendAuthenticationInfoHeader,Long Statement,The length of the statement "sb.append("`").append(Headers.NONCE_COUNT.toString()).append("=").append(parsedHeader.get(DigestAuthorizationToken.NONCE_COUNT));" is 129.,517
SoftInstigate_restheart,org.restheart.security.mechanisms,BasicAuthMechanism,sendChallenge,Long Statement,The length of the statement "if (exchange.getRequestHeaders().contains(SILENT_HEADER_KEY) || exchange.getQueryParameters().containsKey(SILENT_QUERY_PARAM_KEY)) {" is 132.,75
SoftInstigate_restheart,org.restheart.security.mechanisms,TokenBasicAuthMechanism,authenticate,Empty catch clause,The method has an empty catch block.,87
SoftInstigate_restheart,org.restheart.security.mechanisms,JwtAuthenticationMechanism,authenticate,Complex Method,Cyclomatic complexity of the method is 10,129
SoftInstigate_restheart,org.restheart.security.mechanisms,JwtAuthenticationMechanism,sendChallenge,Magic Number,The method contains a magic number: 200,209
SoftInstigate_restheart,org.restheart.security.mechanisms,JwtAuthenticationMechanism,getToken,Magic Number,The method contains a magic number: 7,225
SoftInstigate_restheart,org.restheart.security.mechanisms,IdentityAuthMechanism,sendChallenge,Magic Number,The method contains a magic number: 200,68
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdRemover,init,Complex Conditional,The conditional expression usersDb == null || usersCollection == null || propNamePassword == null is complex.,56
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdRemover,init,Long Statement,The length of the statement "LOGGER.error("Wrong configuration of mongoRealmAuthenticator! " + "Password stored in users collection " + "are not filtered out from the response");" is 149.,56
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdRemover,handle,Complex Conditional,The conditional expression content.getAsJsonObject().get("_embedded").isJsonObject() && content.getAsJsonObject().get("_embedded").getAsJsonObject().keySet().contains("rh:doc") && content.getAsJsonObject().get("_embedded").getAsJsonObject().get("rh:doc").isJsonArray() is complex.,89
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdRemover,handle,Long Statement,The length of the statement "else if (content.getAsJsonObject().get("_embedded").isJsonObject() && content.getAsJsonObject().get("_embedded").getAsJsonObject().keySet().contains("rh:doc") && content.getAsJsonObject().get("_embedded").getAsJsonObject().get("rh:doc").isJsonArray()) {" is 253.,89
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdRemover,resolve,Long Statement,The length of the statement "return enabled && request.isGet() && this.usersDb.equalsIgnoreCase(request.getDBName())&& this.usersCollection.equalsIgnoreCase(request.getCollectionName())&& response.getContent() != null;" is 189.,124
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,init,Complex Conditional,The conditional expression usersDb == null || usersCollection == null || propNamePassword == null || minimumPasswordStrength == null is complex.,74
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,init,Long Statement,The length of the statement "LOGGER.error("Wrong configuration of mongoRealmAuthenticator! " + "Password field of users documents " + "is not automatically checked for password strenght: "+ "{usersDb: {}` usersCollection: {}` "+ "propNamePassword: {}` minimumPasswordStrength: {}})"`usersDb`usersCollection`propNamePassword`minimumPasswordStrength);" is 320.,74
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,handle,Complex Conditional,The conditional expression plain != null && plain.isJsonPrimitive() && plain.getAsJsonPrimitive().isString() is complex.,117
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,handle,Complex Conditional,The conditional expression plain != null && plain.isJsonPrimitive() && plain.getAsJsonPrimitive().isString() is complex.,117
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,handle,Complex Method,Cyclomatic complexity of the method is 8,117
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,handle,Long Statement,The length of the statement "StreamSupport.stream(Spliterators.spliteratorUnknownSize(passwords.iterator()`0)`false).takeWhile(p -> !response.isInError()).forEach(plain -> {" is 144.,117
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,reject,Long Statement,The length of the statement "var error=document().put("message"`idx == null ? "Password is too weak" : "Password is too weak in user document at index " + idx).put("http status code"`HttpStatus.SC_NOT_ACCEPTABLE).put("http status description"`HttpStatus.getStatusText(HttpStatus.SC_NOT_ACCEPTABLE));" is 270.,167
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdStrengthEnforcer,resolve,Long Statement,The length of the statement "return enabled && request.isHandledBy("mongo") && request.isWriteDocument()&& request.isContentTypeJson()&& this.usersDb.equalsIgnoreCase(request.getDBName())&& this.usersCollection.equalsIgnoreCase(request.getCollectionName());" is 228.,192
SoftInstigate_restheart,org.restheart.security.authenticators,DenyFilterOnUserPwd,init,Complex Conditional,The conditional expression usersDb == null || usersCollection == null || propNamePassword == null is complex.,57
SoftInstigate_restheart,org.restheart.security.authenticators,DenyFilterOnUserPwd,init,Long Statement,The length of the statement "LOGGER.error("Wrong configuration of mongoRealmAuthenticator! " + "Requests with filters on the password property " + "are not blocked!");" is 138.,57
SoftInstigate_restheart,org.restheart.security.authenticators,DenyFilterOnUserPwd,resolve,Long Statement,The length of the statement "return enabled && request.isGet() && this.usersDb.equalsIgnoreCase(request.getDBName())&& this.usersCollection.equalsIgnoreCase(request.getCollectionName())&& hasFilterOnPassword(request.getFiltersDocument());" is 209.,90
SoftInstigate_restheart,org.restheart.security.authenticators,DenyFilterOnUserPwd,hasFilterOnPassword,Long Statement,The length of the statement "return filters.keySet().contains(propNamePassword) || filters.keySet().stream().filter(key -> filters.get(key).isDocument()).map(key -> filters.get(key).asDocument()).anyMatch(doc -> hasFilterOnPassword(doc));" is 209.,104
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,setConf,Long Identifier,The length of the field enforceMinimumPasswordStrenght is 30.,99
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,setConf,Long Statement,The length of the statement "throw new ConfigurationException("wrong configuration file format. cache-expire-policy valid values are ".concat(Arrays.toString(Cache.EXPIRE_POLICY.values())));" is 161.,99
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,setConf,Long Statement,The length of the statement "throw new ConfigurationException("prop-id must be a root property name not a json path expression. It can use the dot notation.");" is 130.,99
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,setConf,Magic Number,The method contains a magic number: 3,99
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,setMongoClient,Long Statement,The length of the statement "this.USERS_CACHE=CacheFactory.createLocalLoadingCache(this.cacheSize`this.cacheExpirePolicy`this.cacheTTL`key -> findAccount(accountIdTrasformer(key)));" is 152.,147
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,isEnforceMinimumPasswordStrenght,Long Identifier,The length of the field enforceMinimumPasswordStrenght is 30.,243
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,verifyPasswordCredential,Complex Conditional,The conditional expression ref == null || ref.getPrincipal() == null || ref.getPrincipal().getName() == null || ref.getCredentials() == null || ref.getCredentials().getPassword() == null || credential == null || credential.getPassword() == null is complex.,250
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,verifyPasswordCredential,Long Statement,The length of the statement "if (ref == null || ref.getPrincipal() == null || ref.getPrincipal().getName() == null || ref.getCredentials() == null || ref.getCredentials().getPassword() == null || credential == null || credential.getPassword() == null) {" is 224.,250
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,verifyPasswordCredential,Long Statement,The length of the statement "return checkPassword(ref.getPrincipal().getName()`this.bcryptHashedPassword`credential.getPassword()`ref.getCredentials().getPassword());" is 137.,250
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,verifyDigestCredential,Complex Conditional,The conditional expression ref == null || ref.getCredentials() == null || ref.getCredentials().getPassword() == null || ref.getPrincipal() == null || ref.getPrincipal().getName() == null || credential == null is complex.,271
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,verifyDigestCredential,Long Statement,The length of the statement "LOGGER.error("Digest authentication cannot support bcryped stored password` consider using basic authetication over TLS");" is 122.,271
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,verifyDigestCredential,Long Statement,The length of the statement "if (ref == null || ref.getCredentials() == null || ref.getCredentials().getPassword() == null || ref.getPrincipal() == null || ref.getPrincipal().getName() == null || credential == null) {" is 188.,271
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,checkPassword,Complex Conditional,The conditional expression username == null || password == null || expected == null is complex.,319
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,checkPassword,Complex Conditional,The conditional expression _cachedPwd != null && _cachedPwd.isPresent() && _cachedPwd.get().equals(_password) is complex.,319
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,createDefaultAccount,Long Statement,The length of the statement "mclient.getDatabase(this.getUsersDb()).getCollection(this.getUsersCollection()).withDocumentClass(BsonDocument.class).insertOne(this.createUserDocument);" is 153.,467
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,findAccount,Complex Conditional,The conditional expression role != null && role.isJsonPrimitive() && role.getAsJsonPrimitive().isString() is complex.,483
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,findAccount,Long Statement,The length of the statement "var coll=mclient.getDatabase(this.getUsersDb()).getCollection(this.getUsersCollection()).withDocumentClass(BsonDocument.class);" is 127.,483
SoftInstigate_restheart,org.restheart.security.authenticators,MongoRealmAuthenticator,findAccount,Long Statement,The length of the statement "return new MongoRealmAccount(accountId`_password.getAsJsonPrimitive().getAsString().toCharArray()`roles`BsonDocument.parse(account.toString()));" is 144.,483
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdHasher,init,Complex Conditional,The conditional expression usersDb == null || usersCollection == null || propNamePassword == null || complexity == null is complex.,62
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdHasher,init,Long Statement,The length of the statement "LOGGER.error("Wrong configuration of mongoRealmAuthenticator! " + "Password field of users documents " + "is not automatically entcrypted: "+ "{usersDb: {}` usersCollection: {}` "+ "propNamePassword: {}` complexity: {}})"`usersDb`usersCollection`propNamePassword`complexity);" is 275.,62
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdHasher,handle,Complex Conditional,The conditional expression plain != null && plain.isJsonPrimitive() && plain.getAsJsonPrimitive().isString() is complex.,105
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdHasher,handle,Complex Conditional,The conditional expression plain != null && plain.isJsonPrimitive() && plain.getAsJsonPrimitive().isString() is complex.,105
SoftInstigate_restheart,org.restheart.security.authenticators,UserPwdHasher,resolve,Long Statement,The length of the statement "return enabled && request.isHandledBy("mongo") && request.isWriteDocument()&& request.isContentTypeJson()&& this.usersDb.equalsIgnoreCase(request.getDBName())&& this.usersCollection.equalsIgnoreCase(request.getCollectionName());" is 228.,143
SoftInstigate_restheart,org.restheart.mongodb.hal,DBRepresentationFactory,addLinkTemplates,Long Statement,The length of the statement "rep.addLink(new Link("rh:db"`MongoURLUtils.removeTrailingSlashes(MongoURLUtils.getParentPath(requestPath)) + "{dbname}"`true));" is 127.,148
SoftInstigate_restheart,org.restheart.mongodb.hal,DBRepresentationFactory,addLinkTemplates,Long Statement,The length of the statement "rep.addLink(new Link("rh:db"`MongoURLUtils.removeTrailingSlashes(MongoURLUtils.getParentPath(requestPath)) + "/{dbname}"`true));" is 128.,148
SoftInstigate_restheart,org.restheart.mongodb.hal,DBRepresentationFactory,embeddedCollections,Complex Method,Cyclomatic complexity of the method is 8,177
SoftInstigate_restheart,org.restheart.mongodb.hal,Resource,isSHAL,Long Statement,The length of the statement "return request.getRepresentationFormat() == REPRESENTATION_FORMAT.SHAL || request.getRepresentationFormat() == REPRESENTATION_FORMAT.PLAIN_JSON || request.getRepresentationFormat() == REPRESENTATION_FORMAT.PJ;" is 209.,257
SoftInstigate_restheart,org.restheart.mongodb.hal,Resource,isStandardRep,Long Statement,The length of the statement "return request.getRepresentationFormat() == REPRESENTATION_FORMAT.STANDARD || request.getRepresentationFormat() == REPRESENTATION_FORMAT.S;" is 139.,269
SoftInstigate_restheart,org.restheart.mongodb.hal,IndexesRepresentationFactory,getRepresentation,Complex Method,Cyclomatic complexity of the method is 8,49
SoftInstigate_restheart,org.restheart.mongodb.hal,IndexesRepresentationFactory,getRepresentation,Long Statement,The length of the statement "String queryString=exchange.getQueryString() == null || exchange.getQueryString().isEmpty() ? "" : "?" + MongoURLUtils.decodeQueryString(exchange.getQueryString());" is 164.,49
SoftInstigate_restheart,org.restheart.mongodb.hal,IndexesRepresentationFactory,getRepresentation,Long Statement,The length of the statement "long count=embeddedData.stream().filter(props -> props != null).filter(props -> props.isDocument()).map(props -> props.asDocument()).filter((props) -> props.keySet().stream().anyMatch((k) -> k.equals("id") || k.equals("_id"))).count();" is 235.,49
SoftInstigate_restheart,org.restheart.mongodb.hal,IndexesRepresentationFactory,embeddedDocuments,Complex Conditional,The conditional expression _id != null && (_id.isString() || _id.isObjectId()) is complex.,129
SoftInstigate_restheart,org.restheart.mongodb.hal,IndexesRepresentationFactory,embeddedDocuments,Long Statement,The length of the statement "rep.addWarning("index with _id " + _id + (_id == null ? " " : " of type " + _id.getBsonType().name())+ "filtered out. Indexes can only "+ "have ids of type String");" is 165.,129
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,handle,Complex Conditional,The conditional expression request.isGet() || request.isBulkDocuments() || (request.isCollection() && request.isPost() && request.getContent().isArray()) is complex.,53
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,handle,Complex Conditional,The conditional expression Resource.isSHAL(request) && !request.isDocument() && !request.isFile()&& !request.isSchema() is complex.,53
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,handle,Long Statement,The length of the statement "if (request.isGet() || request.isBulkDocuments() || (request.isCollection() && request.isPost() && request.getContent().isArray())) {" is 133.,53
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,resolve,Long Statement,The length of the statement "return !request.isInError() && !request.isDbMeta() && !request.isDbSize()&& !request.isCollectionMeta()&& !request.isCollectionSize()&& !request.isFilesBucketMeta()&& !request.isFilesBucketSize()&& !request.isSchemaStoreMeta()&& !request.isSchemaStoreSize()&& !request.isFileBinary()&& !request.isMetrics()&& request.isHandledBy("mongo")&& request.getRepresentationFormat() != null && (Resource.isSHAL(request) || Resource.isHAL(request));" is 439.,79
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Complex Conditional,The conditional expression request.isGet() && (request.isDocument() || request.isFile() || request.isSchema()) is complex.,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Complex Conditional,The conditional expression request.isBulkDocuments() || (request.isCollection() && request.getContent() != null && request.getContent().isArray() && response.getDbOperationResult() != null && response.getDbOperationResult() instanceof BulkOperationResult) is complex.,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Complex Conditional,The conditional expression request.isGet() && (request.isCollection() || request.isFilesBucket() || request.isSchemaStore()) is complex.,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Complex Method,Cyclomatic complexity of the method is 8,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Long Statement,The length of the statement "return factory.getRepresentation(MongoURLUtils.removeTrailingSlashes(request.getPath())`request.getExchange()`content == null ? null : content.asDocument()).asBsonDocument();" is 174.,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Long Statement,The length of the statement "else if (request.isBulkDocuments() || (request.isCollection() && request.getContent() != null && request.getContent().isArray() && response.getDbOperationResult() != null && response.getDbOperationResult() instanceof BulkOperationResult)) {" is 240.,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Long Statement,The length of the statement "return factory.getRepresentation(request.getExchange()`(BulkOperationResult)response.getDbOperationResult()).asBsonDocument();" is 126.,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,std2HAL,Long Statement,The length of the statement "return factory.getRepresentation(request.getExchange()`content == null ? null : content.asArray()`response.getCount()).asBsonDocument();" is 136.,97
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,hal2SHAL,Long Statement,The length of the statement "content.asDocument().keySet().stream().filter(key -> !"_embedded".equals(key) && !"_links".equals(key)).forEach(key -> ret.append(key`content.asDocument().get(key)));" is 166.,161
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,hal2SHAL,Long Statement,The length of the statement "shal.asDocument().keySet().stream().filter(key -> !"_embedded".equals(key)).forEach(key -> shal.append(key`shal.get(key)));" is 123.,161
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,readHAL2SHAL,Long Statement,The length of the statement "content.asDocument().keySet().stream().filter(key -> !"_embedded".equals(key) && !"_links".equals(key)).forEach(key -> ret.append(key`content.asDocument().get(key)));" is 166.,200
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,writeHAL2SHAL,Complex Conditional,The conditional expression content.asDocument().containsKey("_embedded") && content.asDocument().get("_embedded").isDocument() && content.asDocument().get("_embedded").asDocument().containsKey("rh:result")&& content.asDocument().get("_embedded").asDocument().get("rh:result").isArray() is complex.,236
SoftInstigate_restheart,org.restheart.mongodb.hal,HALRepresentation,writeHAL2SHAL,Long Statement,The length of the statement "if (content.asDocument().containsKey("_embedded") && content.asDocument().get("_embedded").isDocument() && content.asDocument().get("_embedded").asDocument().containsKey("rh:result")&& content.asDocument().get("_embedded").asDocument().get("rh:result").isArray()) {" is 265.,236
SoftInstigate_restheart,org.restheart.mongodb.hal,Link,Link,Complex Conditional,The conditional expression ref == null || href == null || ref.isEmpty() || href.isEmpty() is complex.,34
SoftInstigate_restheart,org.restheart.mongodb.hal,AbstractRepresentationFactory,createRepresentation,Long Statement,The length of the statement "String queryString=exchange.getQueryString() == null || exchange.getQueryString().isEmpty() ? "" : "?" + MongoURLUtils.decodeQueryString(exchange.getQueryString());" is 164.,102
SoftInstigate_restheart,org.restheart.mongodb.hal,RootRepresentationFactory,embeddedDbs,Long Parameter List,The method has 5 parameters. ,122
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addBulkResult,Long Statement,The length of the statement "nrep.addProperty("inserted"`new BsonInt32((wr.getUpserts() != null ? wr.getUpserts().size() : 0) + (wr.getInserts() != null ? wr.getInserts().size() : 0)));" is 156.,86
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addBulkResult,Long Statement,The length of the statement "wr.getUpserts().stream().forEach(update -> nrep.addLink(new Link("rh:newdoc"`RepresentationUtils.getReferenceLink(response`requestPath`update.getId()))`true));" is 159.,86
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addBulkResult,Long Statement,The length of the statement "wr.getInserts().stream().forEach(insert -> nrep.addLink(new Link("rh:newdoc"`RepresentationUtils.getReferenceLink(response`requestPath`insert.getId()))`true));" is 159.,86
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addWriteResult,Long Statement,The length of the statement "nrep.addProperty("inserted"`new BsonInt32((wr.getUpserts() != null ? wr.getUpserts().size() : 0) + (wr.getInserts() != null ? wr.getInserts().size() : 0)));" is 156.,127
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addWriteResult,Long Statement,The length of the statement "wr.getUpserts().stream().forEach(update -> nrep.addLink(new Link("rh:newdoc"`RepresentationUtils.getReferenceLink(requestPath`update.getId()))`true));" is 150.,127
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addWriteResult,Long Statement,The length of the statement "wr.getInserts().stream().forEach(insert -> nrep.addLink(new Link("rh:newdoc"`RepresentationUtils.getReferenceLink(requestPath`insert.getId()))`true));" is 150.,127
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addWriteErrors,Long Statement,The length of the statement "nrep.addProperty("message"`new BsonString(ResponseHelper.getMessageFromErrorCode(error.getCode()) + ": " + error.getMessage()));" is 128.,165
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addWriteErrors,Magic Number,The method contains a magic number: 11000,165
SoftInstigate_restheart,org.restheart.mongodb.hal,BulkResultRepresentationFactory,addWriteErrors,Magic Number,The method contains a magic number: 2,165
SoftInstigate_restheart,org.restheart.mongodb.hal,DocumentRepresentationFactory,addSpecialProperties,Complex Conditional,The conditional expression data.get("_created_on") == null && id != null && id instanceof ObjectId is complex.,50
SoftInstigate_restheart,org.restheart.mongodb.hal,DocumentRepresentationFactory,addSpecialProperties,Long Statement,The length of the statement "rep.addProperty("_lastupdated_on"`new BsonString(Instant.ofEpochSecond(etag.asObjectId().getValue().getTimestamp()).toString()));" is 129.,50
SoftInstigate_restheart,org.restheart.mongodb.hal,DocumentRepresentationFactory,addRelationshipsLinks,Long Statement,The length of the statement "rep.addWarning("collection " + request.getDBName() + "/"+ request.getCollectionName()+ " has invalid relationships definition");" is 128.,83
SoftInstigate_restheart,org.restheart.mongodb.hal,DocumentRepresentationFactory,getRepresentation,Complex Method,Cyclomatic complexity of the method is 8,122
SoftInstigate_restheart,org.restheart.mongodb.hal,DocumentRepresentationFactory,getRepresentation,Long Statement,The length of the statement "var rep=request.isFullHalMode() && data != null ? new Resource(RepresentationUtils.getReferenceLink(response`MongoURLUtils.getParentPath(href)`data.get("_id"))) : new Resource();" is 178.,122
SoftInstigate_restheart,org.restheart.mongodb.hal,DocumentRepresentationFactory,getRepresentation,Long Statement,The length of the statement "boolean isEmbedded=TYPE.COLLECTION.equals(request.getType()) || TYPE.FILES_BUCKET.equals(request.getType()) || TYPE.SCHEMA_STORE.equals(request.getType());" is 155.,122
SoftInstigate_restheart,org.restheart.mongodb.hal,CollectionRepresentationFactory,embeddedDocuments,Complex Method,Cyclomatic complexity of the method is 12,283
SoftInstigate_restheart,org.restheart.mongodb.hal,CollectionRepresentationFactory,embeddedDocuments,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@142e776d,283
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,PutDocumentHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 10,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,PutDocumentHandler,handleRequest,Long Statement,The length of the statement "var result=this.documents.writeDocument(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getMethod()`request.getWriteMode()`Optional.of(request.getDocumentId())`Optional.ofNullable(request.getFiltersDocument())`Optional.ofNullable(request.getShardKey())`content`request.getETag()`request.isETagCheckRequired());" is 382.,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,PutDocumentHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The document's ETag must be provided using the '" + Headers.IF_MATCH + "' header");" is 127.,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,PutDocumentHandler,handleRequest,Magic Number,The method contains a magic number: 11000,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,DeleteDocumentHandler,handleRequest,Long Statement,The length of the statement "var result=documents.deleteDocument(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`Optional.of(request.getDocumentId())`Optional.ofNullable(request.getFiltersDocument())`Optional.ofNullable(request.getShardKey())`request.getETag()`request.isETagCheckRequired());" is 327.,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,DeleteDocumentHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The document's ETag must be provided using the '" + Headers.IF_MATCH + "' header");" is 127.,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,PatchDocumentHandler,handleRequest,Long Statement,The length of the statement "var result=documents.writeDocument(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getMethod()`request.getWriteMode()`Optional.of(request.getDocumentId())`Optional.ofNullable(request.getFiltersDocument())`Optional.ofNullable(request.getShardKey())`content`request.getETag()`request.isETagCheckRequired());" is 377.,52
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,GetDocumentHandler,handleRequest,Complex Conditional,The conditional expression request.isCollectionMeta() || request.isFilesBucketMeta() || request.isSchemaStoreMeta() is complex.,69
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,GetDocumentHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 21,69
SoftInstigate_restheart,org.restheart.mongodb.handlers.document,GetDocumentHandler,handleRequest,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@269dc227,69
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonSchemaTransformer,handleRequest,Long Statement,The length of the statement "content.asArray().stream().filter(doc -> doc.isDocument()).map(doc -> doc.asDocument()).forEachOrdered(doc -> transform(request`doc));" is 134.,62
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonSchemaTransformer,transform,Complex Conditional,The conditional expression request.isGet() && null != document && document.isDocument() is complex.,90
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonSchemaTransformer,transform,Complex Method,Cyclomatic complexity of the method is 13,90
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonSchemaCacheSingleton,JsonSchemaCacheSingleton,Long Statement,The length of the statement "this.schemaCache=CacheFactory.createLocalCache(MAX_CACHE_SIZE`Cache.EXPIRE_POLICY.AFTER_WRITE`MongoServiceConfiguration.get().getSchemaCacheTtl());" is 147.,58
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonSchemaCacheSingleton,JsonSchemaCacheSingleton,Long Statement,The length of the statement "this.rawSchemaCache=CacheFactory.createLocalCache(MAX_CACHE_SIZE`Cache.EXPIRE_POLICY.AFTER_WRITE`MongoServiceConfiguration.get().getSchemaCacheTtl());" is 150.,58
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonMetaSchemaChecker,handleRequest,Magic Number,The method contains a magic number: 2,69
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonMetaSchemaChecker,handleRequest,Magic Number,The method contains a magic number: 2,69
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,JsonMetaSchemaChecker,handleRequest,Magic Number,The method contains a magic number: 2,69
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,SchemaStoreURL,isValid,Magic Number,The method contains a magic number: 4,49
SoftInstigate_restheart,org.restheart.mongodb.handlers.schema,SchemaStoreURL,SchemaStoreURL,Magic Number,The method contains a magic number: 20,85
SoftInstigate_restheart,org.restheart.mongodb.handlers,OptionsHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 23,72
SoftInstigate_restheart,org.restheart.mongodb.handlers,OptionsHandler,handleRequest,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@3e20226e,72
SoftInstigate_restheart,org.restheart.mongodb.handlers,MetaRequestTransformer,handleRequest,Complex Conditional,The conditional expression content != null && content.isDocument() && content.asDocument().containsKey("_id") is complex.,36
SoftInstigate_restheart,org.restheart.mongodb.handlers,ErrorHandler,handleRequest,Complex Conditional,The conditional expression httpCode >= 500 && mce.getMessage() != null && !mce.getMessage().isBlank() is complex.,64
SoftInstigate_restheart,org.restheart.mongodb.handlers,ErrorHandler,handleRequest,Magic Number,The method contains a magic number: 500,64
SoftInstigate_restheart,org.restheart.mongodb.handlers,GzipEncodingHandler,GzipEncodingHandler,Magic Number,The method contains a magic number: 50,42
SoftInstigate_restheart,org.restheart.mongodb.handlers,CORSHandler,injectAccessControlAllowHeaders,Long Identifier,The length of the field ACCESS_CONTROL_ALLOW_CREDENTIAL is 31.,106
SoftInstigate_restheart,org.restheart.mongodb.handlers,CORSHandler,injectAccessControlAllowHeaders,Long Statement,The length of the statement "headers.addResponseHeader(ACCESS_CONTROL_EXPOSE_HEADERS`LOCATION_STRING + "` " + Headers.ETAG+ "` "+ HttpHeaders.X_POWERED_BY);" is 127.,106
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,handleRequest,Long Statement,The length of the statement "MongoResponse.of(exchange).setInError(HttpStatus.SC_METHOD_NOT_ALLOWED`"method " + request.getMethod().name() + " not allowed");" is 128.,108
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,handleRequest,Long Statement,The length of the statement "MongoResponse.of(exchange).setInError(HttpStatus.SC_METHOD_NOT_ALLOWED`"method " + request.getMethod().name() + " not allowed");" is 128.,108
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.ROOT_SIZE`METHOD.GET`PipelinedHandler.pipe(new SizeRequestTransformer(true)`new GetRootHandler()`new SizeRequestTransformer(false)));" is 149.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.DB_SIZE`METHOD.GET`PipelinedHandler.pipe(new SizeRequestTransformer(true)`new GetDBHandler()`new SizeRequestTransformer(false)));" is 145.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.DB_META`METHOD.GET`PipelinedHandler.pipe(new GetDocumentHandler()`new AggregationTransformer(false)`new MetaRequestTransformer()));" is 147.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.COLLECTION`METHOD.GET`PipelinedHandler.pipe(new GetCollectionHandler()`new AggregationTransformer(false)));" is 123.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.COLLECTION_SIZE`METHOD.GET`PipelinedHandler.pipe(new SizeRequestTransformer(true)`new GetCollectionHandler()`new SizeRequestTransformer(false)));" is 161.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.COLLECTION_META`METHOD.GET`PipelinedHandler.pipe(new GetDocumentHandler()`new AggregationTransformer(false)`new MetaRequestTransformer()));" is 155.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.COLLECTION`METHOD.POST`new NormalOrBulkDispatcherHandler(new PostCollectionHandler()`new BulkPostCollectionHandler()));" is 135.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.COLLECTION`METHOD.PUT`PipelinedHandler.pipe(new AggregationTransformer(true)`new PutCollectionHandler()));" is 122.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.COLLECTION`METHOD.PATCH`PipelinedHandler.pipe(new AggregationTransformer(true)`new PatchCollectionHandler()));" is 126.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.FILES_BUCKET_SIZE`METHOD.GET`PipelinedHandler.pipe(new SizeRequestTransformer(true)`new GetCollectionHandler()`new SizeRequestTransformer(false)));" is 163.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.FILES_BUCKET_META`METHOD.GET`PipelinedHandler.pipe(new GetDocumentHandler()`new MetaRequestTransformer()));" is 123.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.SCHEMA_STORE`METHOD.GET`PipelinedHandler.pipe(new GetCollectionHandler()`new JsonSchemaTransformer(false)));" is 124.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.SCHEMA_STORE_SIZE`METHOD.GET`PipelinedHandler.pipe(new SizeRequestTransformer(true)`new GetCollectionHandler()`new SizeRequestTransformer(false)));" is 163.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.SCHEMA_STORE_META`METHOD.GET`PipelinedHandler.pipe(new GetDocumentHandler()`new MetaRequestTransformer()));" is 123.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.SCHEMA_STORE`METHOD.POST`PipelinedHandler.pipe(new JsonMetaSchemaChecker()`new JsonSchemaTransformer(true)`new PostCollectionHandler()));" is 153.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers,RequestDispatcherHandler,defaultInit,Long Statement,The length of the statement "putHandler(TYPE.SCHEMA`METHOD.PUT`PipelinedHandler.pipe(new JsonMetaSchemaChecker()`new JsonSchemaTransformer(true)`new PutDocumentHandler()));" is 143.,175
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,handle,Complex Conditional,The conditional expression (request.isPut() || request.isPatch()) && request.isCollection() is complex.,34
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,handle,Complex Conditional,The conditional expression (oldStreams == null && newStreams != null) || (oldStreams != null && newStreams == null) || (oldStreams != null && newStreams != null && !oldStreams.equals(newStreams)) is complex.,34
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,handle,Long Statement,The length of the statement "var oldStreams=response.getDbOperationResult() != null ? response.getDbOperationResult().getOldData() != null ? response.getDbOperationResult().getOldData().containsKey("streams") ? response.getDbOperationResult().getOldData().get("streams") : null : null : null;" is 263.,34
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,handle,Long Statement,The length of the statement "var newStreams=response.getDbOperationResult() != null ? response.getDbOperationResult().getNewData() != null ? response.getDbOperationResult().getNewData().containsKey("streams") ? response.getDbOperationResult().getNewData().get("streams") : null : null : null;" is 263.,34
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,handle,Long Statement,The length of the statement "if ((oldStreams == null && newStreams != null) || (oldStreams != null && newStreams == null) || (oldStreams != null && newStreams != null && !oldStreams.equals(newStreams))) {" is 175.,34
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,closeAllOnDb,Empty catch clause,The method has an empty catch block.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,closeAllOnCollection,Empty catch clause,The method has an empty catch block.,88
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ObsoleteChangeStreamRemover,resolve,Long Statement,The length of the statement "return (request.isDelete() && request.isCollection()) || (request.isPut() && request.isCollection()) || (request.isPatch() && request.isCollection())|| (request.isDelete() && request.isDb());" is 191.,113
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamsRegistry,getSessionKeysOnOperation,Complex Conditional,The conditional expression db == null || coll == null || operation == null is complex.,88
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamsRegistry,getSessionKeysOnOperation,Long Statement,The length of the statement "keySet().stream().filter(k -> db.equals(get(k).getDb()) && coll.equals(get(k).getCollection()) && operation.equals(get(k).getChangeStreamOperation())).forEach(ret::add);" is 169.,88
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamSubscriber,ChangeStreamSubscriber,Long Parameter List,The method has 5 parameters. ,72
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamSubscriber,onNext,Long Statement,The length of the statement "ChangeStreamWebsocketCallback.NOTIFICATION_PUBLISHER.submit(new ChangeStreamNotification(sessionKey`BsonUtils.toJson(getDocument(notification)`sessionKey.getJsonMode())));" is 171.,87
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamSubscriber,closeAllOnError,Empty catch clause,The method has an empty catch block.,121
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamSubscriber,restartStream,Long Statement,The length of the statement "MongoReactiveClientSingleton.getInstance().getClient().getDatabase(dbName).getCollection(collName).watch(resolvedStages).fullDocument(FullDocument.UPDATE_LOOKUP).subscribe(new ChangeStreamSubscriber(sessionKey`resolvedStages`dbName`collName`true));" is 248.,150
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamSubscriber,getDocument,Complex Method,Cyclomatic complexity of the method is 8,179
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamsActivator,init,Long Statement,The length of the statement "LOGGER.error("Cannot enable Change Streams: MongoDB is a standalone instance and Change Streams require a Replica Set.");" is 121.,47
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamsActivator,enableChangeStreams,Long Statement,The length of the statement "LOGGER.error("Change streams disabled due to error in MongoDB reactive client: {}"`t.getMessage() != null ? t.getMessage() : "not initialized");" is 144.,62
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,GetChangeStreamHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"The stream connection requires WebSocket` " + "no 'Upgrade' or 'Connection' request header found");" is 146.,62
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,GetChangeStreamHandler,handleRequest,Long Statement,The length of the statement "LOGGER.warn("Cannot open stream connection` " + "the request does not specify the required variables " + "in the avars query paramter: {}"`ex.getMessage());" is 156.,62
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,GetChangeStreamHandler,isWebSocketHandshakeRequest,Long Statement,The length of the statement "return chVals != null && uhVals != null && Arrays.stream(chVals.toArray()).anyMatch(val -> val.toLowerCase().contains(CONNECTION_HEADER_VALUE)) && Arrays.stream(uhVals.toArray()).anyMatch(val -> val.toLowerCase().contains(UPGRADE_HEADER_VALUE));" is 245.,123
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,GetChangeStreamHandler,getResolvedStagesAsList,Long Statement,The length of the statement "Optional<ChangeStreamOperation> _query=streams.stream().filter(q -> q.getUri().equals(changesStreamOperation)).findFirst();" is 123.,138
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,GetChangeStreamHandler,startStream,Long Statement,The length of the statement "MongoReactiveClientSingleton.getInstance().getClient().getDatabase(request.getDBName()).getCollection(request.getCollectionName()).watch(resolvedStages).fullDocument(FullDocument.UPDATE_LOOKUP).subscribe(new ChangeStreamSubscriber(streamKey`resolvedStages`request.getDBName()`request.getCollectionName()));" is 306.,162
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamOperation,checkAggregationVariables,Long Statement,The length of the statement "aVars.asArray().getValues().stream().filter(el -> (el.isDocument() || el.isArray())).forEachOrdered(ChangeStreamOperation::checkAggregationVariables);" is 150.,83
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamOperation,ChangeStreamOperation,Long Statement,The length of the statement "throw new InvalidMetadataException("query /" + this.uri + "has invalid '"+ STAGES_ELEMENT_NAME+ "': "+ _stages+ "; must be an array of stage objects");" is 151.,117
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamOperation,ChangeStreamOperation,Long Statement,The length of the statement "throw new InvalidMetadataException("query /" + this.uri + "has invalid '"+ STAGES_ELEMENT_NAME+ "': "+ _stages+ "; must be an array of stage objects");" is 151.,117
SoftInstigate_restheart,org.restheart.mongodb.handlers.changestreams,ChangeStreamOperation,bindAggregationVariables,Complex Method,Cyclomatic complexity of the method is 11,196
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,AggregationPipeline,AggregationPipeline,Long Statement,The length of the statement "throw new InvalidMetadataException("query /" + getUri() + "has invalid '"+ STAGES_ELEMENT_NAME+ "': "+ _stages+ "; must be an array of stage objects");" is 151.,53
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,AggregationPipeline,AggregationPipeline,Long Statement,The length of the statement "throw new InvalidMetadataException("query /" + getUri() + "has invalid '"+ STAGES_ELEMENT_NAME+ "': "+ _stages+ "; must be an array of stage objects");" is 151.,53
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,AggregationPipeline,AggregationPipeline,Long Statement,The length of the statement "throw new InvalidMetadataException("query /" + getUri() + "has invalid '"+ ALLOW_DISK_USER_ELEMENT_NAME+ "': "+ _allowDiskUse+ "; must be boolean");" is 148.,53
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,GetAggregationHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 11,78
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,GetAggregationHandler,handleRequest,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@103dd4b1,78
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,GetAggregationHandler,injectAvars,Long Statement,The length of the statement "avars.put("@mongoPermissions.projectResponse"`mongoPermissions.getProjectResponse() == null ? BsonNull.VALUE : mongoPermissions.getProjectResponse());" is 150.,215
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,GetAggregationHandler,injectAvars,Long Statement,The length of the statement "avars.put("@mongoPermissions.mergeRequest"`mongoPermissions.getMergeRequest() == null ? BsonNull.VALUE : AclVarsInterpolator.interpolateBson(request`mongoPermissions.getMergeRequest()));" is 186.,215
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,GetAggregationHandler,injectAvars,Long Statement,The length of the statement "avars.put("@mongoPermissions.readFilter"`mongoPermissions.getReadFilter() == null ? BsonNull.VALUE : AclVarsInterpolator.interpolateBson(request`mongoPermissions.getReadFilter()));" is 180.,215
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,GetAggregationHandler,injectAvars,Long Statement,The length of the statement "avars.put("@mongoPermissions.writeFilter"`mongoPermissions.getWriteFilter() == null ? BsonNull.VALUE : AclVarsInterpolator.interpolateBson(request`mongoPermissions.getWriteFilter()));" is 183.,215
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,AggregationTransformer,getAggregationMetadata,Long Statement,The length of the statement "List<Optional<BsonValue>> ___aggrs=BsonUtils.getPropsFromPath(contentToTransform`"$." + AbstractAggregationOperation.AGGREGATIONS_ELEMENT_NAME);" is 144.,99
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,AbstractAggregationOperation,checkAggregationVariables,Long Statement,The length of the statement "aVars.asArray().getValues().stream().filter(el -> (el.isDocument() || el.isArray())).forEachOrdered(AbstractAggregationOperation::checkAggregationVariables);" is 157.,112
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,AbstractAggregationOperation,AbstractAggregationOperation,Long Statement,The length of the statement "throw new InvalidMetadataException("query property not have '" + TYPE_ELEMENT_NAME + "' is not a String: "+ _type.toString());" is 126.,145
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,AbstractAggregationOperation,bindAggregationVariables,Complex Method,Cyclomatic complexity of the method is 11,194
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,MapReduce,MapReduce,Long Statement,The length of the statement "throw new InvalidMetadataException("invalid query with uri " + getUri() + "; the "+ MAP_ELEMENT_NAME+ " property is not valid: "+ _map);" is 136.,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,MapReduce,MapReduce,Long Statement,The length of the statement "throw new InvalidMetadataException("invalid query with uri " + getUri() + "; the "+ REDUCE_ELEMENT_NAME+ " property is not valid: "+ _reduce);" is 142.,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.aggregation,MapReduce,MapReduce,Long Statement,The length of the statement "throw new InvalidMetadataException("invalid query with uri " + getUri() + "; the "+ QUERY_ELEMENT_NAME+ " property is not valid: "+ _query);" is 140.,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptor,isFilledAndNotMetrics,Long Statement,The length of the statement "return dbOrCollectionName != null && !dbOrCollectionName.trim().isEmpty() && !dbOrCollectionName.equalsIgnoreCase(_METRICS);" is 124.,46
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptor,addDefaultMetrics,Long Statement,The length of the statement "registry.timer(request.getType().toString() + "." + request.getMethod().toString()).update(duration`TimeUnit.MILLISECONDS);" is 123.,90
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptor,addDefaultMetrics,Long Statement,The length of the statement "registry.timer(request.getType().toString() + "." + request.getMethod().toString()+ "."+ exchange.getStatusCode()).update(duration`TimeUnit.MILLISECONDS);" is 154.,90
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptor,addDefaultMetrics,Long Statement,The length of the statement "registry.timer(request.getType().toString() + "." + request.getMethod().toString()+ "."+ (exchange.getStatusCode() / 100)+ "xx").update(duration`TimeUnit.MILLISECONDS);" is 168.,90
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptor,addDefaultMetrics,Magic Number,The method contains a magic number: 100,90
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,getMetricsRegistry,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@774f5cc4,127
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,handleRequest,Long Identifier,The length of the identifier representationFormatParameters is 30.,147
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,handleRequest,Long Statement,The length of the statement "ResponseType responseType=Optional.ofNullable(ResponseType.forQueryParameter(representationFormatParameters == null ? null : representationFormatParameters.getFirst())).orElseGet(() -> ResponseType.forAcceptHeader(request.getHeader(Headers.ACCEPT.toString())));" is 261.,147
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,handleRequest,Long Statement,The length of the statement "String acceptableTypes=Arrays.stream(ResponseType.values()).map(ResponseType::getContentType).map(x -> "'" + x + "'").collect(Collectors.joining("`"));" is 151.,147
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,generateResponse,Long Identifier,The length of the field DATABASE_AND_COLLECTION_ALL_VALUES_LABEL_VALUE is 46.,234
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,generateResponse,Magic Number,The method contains a magic number: 3,273
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,generateResponse,Magic Number,The method contains a magic number: 2,273
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,isAcceptableFor,Long Statement,The length of the statement "return entry.contentType.equalsIgnoreCase("*/*") || (entry.contentType.equalsIgnoreCase(contentType) && (entry.specialization == null || entry.specialization.equalsIgnoreCase(specialization))) || entry.contentType.equalsIgnoreCase(mediaRange);" is 243.,382
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,forAcceptHeader,Long Statement,The length of the statement "return Arrays.stream(acceptHeader.split("`")).map(String::trim).map(AcceptHeaderEntry::of).filter(Objects::nonNull).sorted(new AcceptHeaderEntryComparator()).flatMap(x -> Arrays.stream(ResponseType.values()).filter(rt -> rt.isAcceptableFor(x))).findFirst().orElse(null);" is 270.,484
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,forQueryParameter,Complex Conditional,The conditional expression REPRESENTATION_FORMAT.S.name().equalsIgnoreCase(rep) || REPRESENTATION_FORMAT.STANDARD.name().equalsIgnoreCase(rep) || REPRESENTATION_FORMAT.HAL.name().equalsIgnoreCase(rep)|| REPRESENTATION_FORMAT.SHAL.name().equalsIgnoreCase(rep)|| REPRESENTATION_FORMAT.PLAIN_JSON.name().equalsIgnoreCase(rep)|| REPRESENTATION_FORMAT.PJ.name().equalsIgnoreCase(rep) is complex.,504
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandler,forQueryParameter,Long Statement,The length of the statement "if (REPRESENTATION_FORMAT.S.name().equalsIgnoreCase(rep) || REPRESENTATION_FORMAT.STANDARD.name().equalsIgnoreCase(rep) || REPRESENTATION_FORMAT.HAL.name().equalsIgnoreCase(rep)|| REPRESENTATION_FORMAT.SHAL.name().equalsIgnoreCase(rep)|| REPRESENTATION_FORMAT.PLAIN_JSON.name().equalsIgnoreCase(rep)|| REPRESENTATION_FORMAT.PJ.name().equalsIgnoreCase(rep)) {" is 358.,504
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsJsonGenerator,generateMetricsBson,Long Statement,The length of the statement "return new BsonDocument().append("version"`new BsonString("3.0.0")).append("gauges"`generator.toBson(registry.getGauges()`generator::generateGauge)).append("counters"`generator.toBson(registry.getCounters()`generator::generateCounter)).append("histograms"`generator.toBson(registry.getHistograms()`generator::generateHistogram)).append("meters"`generator.toBson(registry.getMeters()`generator::generateMeter)).append("timers"`generator.toBson(registry.getTimers()`generator::generateTimer));" is 491.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsJsonGenerator,generateTimer,Long Statement,The length of the statement "document.append("values"`new BsonArray(Arrays.stream(snapshot.getValues()).mapToDouble(x -> x * durationFactor).mapToObj(BsonDouble::new).collect(Collectors.toList())));" is 169.,83
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsJsonGenerator,generateHistogram,Long Statement,The length of the statement "document.append("values"`new BsonArray(Arrays.stream(snapshot.getValues()).mapToObj(BsonInt64::new).collect(Collectors.toList())));" is 131.,134
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,ResponseTypeTest,testIsAcceptableFor,Long Statement,The length of the statement "assertFalse(ResponseType.PROMETHEUS.isAcceptableFor(AcceptHeaderEntry.of("application/json; q=0.9; extraparameter=foobar")));" is 125.,29
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerTest,assertMetricsLevelForRequest,Long Identifier,The length of the parameter expectedLevelForConfigDatabase is 30.,109
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerTest,assertMetricsLevelForRequest,Long Identifier,The length of the parameter expectedLevelForConfigCollection is 32.,109
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerTest,assertMetricsLevelForRequest,Long Parameter List,The method has 5 parameters. ,109
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerTest,createRequest,Magic Number,The method contains a magic number: 200,168
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,setUp,Magic Number,The method contains a magic number: 10,51
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,setUp,Magic Number,The method contains a magic number: 10,51
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,setUp,Magic Number,The method contains a magic number: 5,51
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,setUp,Magic Number,The method contains a magic number: 10,51
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,setUp,Magic Number,The method contains a magic number: 5,51
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,setUp,Magic Number,The method contains a magic number: 2,51
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,testMetricsForRoot,Long Statement,The length of the statement "String expectedMetrics="http_response_timers_count{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 3 $TIMESTAMP$\n" + "http_response_timers_max{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n" + "http_response_timers_mean{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 5.666666666666666 $TIMESTAMP$\n"+ "http_response_timers_min{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 2.0 $TIMESTAMP$\n"+ "http_response_timers_p50{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 5.0 $TIMESTAMP$\n"+ "http_response_timers_p75{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p95{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p98{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p99{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p999{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_stddev{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 3.299831645537221 $TIMESTAMP$\n"+ "http_response_timers_m15_rate{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m1_rate{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m5_rate{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_mean_rate{database=\"_all_\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} $MEAN_RATE$ $TIMESTAMP$\n"+ "\n"+ "http_response_timers_count{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 2 $TIMESTAMP$\n"+ "http_response_timers_max{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_mean{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 7.5 $TIMESTAMP$\n"+ "http_response_timers_min{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 5.0 $TIMESTAMP$\n"+ "http_response_timers_p50{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p75{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p95{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p98{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p99{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p999{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_stddev{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 2.5 $TIMESTAMP$\n"+ "http_response_timers_m15_rate{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m1_rate{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m5_rate{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_mean_rate{database=\"fancy-shop\"`collection=\"_all_\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} $MEAN_RATE$ $TIMESTAMP$\n"+ "\n"+ "http_response_timers_count{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 1 $TIMESTAMP$\n"+ "http_response_timers_max{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_mean{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_min{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p50{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p75{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p95{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p98{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p99{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p999{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_stddev{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m15_rate{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m1_rate{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m5_rate{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_mean_rate{database=\"fancy-shop\"`collection=\"products\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} $MEAN_RATE$ $TIMESTAMP$";" is 6360.,81
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,testMetricsForDatabase,Long Statement,The length of the statement "String expectedMetrics="http_response_timers_count{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 2 $TIMESTAMP$\n" + "http_response_timers_max{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n" + "http_response_timers_mean{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 7.5 $TIMESTAMP$\n"+ "http_response_timers_min{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 5.0 $TIMESTAMP$\n"+ "http_response_timers_p50{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p75{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p95{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p98{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p99{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p999{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_stddev{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 2.5 $TIMESTAMP$\n"+ "http_response_timers_m15_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m1_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m5_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_mean_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} $MEAN_RATE$ $TIMESTAMP$";" is 1456.,138
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,testMetricsForCollection,Long Statement,The length of the statement "String expectedMetrics="http_response_timers_count{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 1 $TIMESTAMP$\n" + "http_response_timers_max{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n" + "http_response_timers_mean{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_min{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p50{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p75{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p95{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p98{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p99{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p999{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_stddev{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m15_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m1_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m5_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_mean_rate{type=\"requests\"`method=\"GET\"`code=\"2xx\"} $MEAN_RATE$ $TIMESTAMP$";" is 1458.,162
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,testDatabaseAndCollectionNamesEscapedCorrectly,Long Statement,The length of the statement "String expectedMetrics="http_response_timers_count{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 1 $TIMESTAMP$\n" + "http_response_timers_max{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n" + "http_response_timers_mean{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_min{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p50{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p75{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p95{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p98{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p99{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_p999{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 10.0 $TIMESTAMP$\n"+ "http_response_timers_stddev{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m15_rate{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m1_rate{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_m5_rate{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} 0.0 $TIMESTAMP$\n"+ "http_response_timers_mean_rate{database=\"my-\\\"project\\\"\"`collection=\"collection containing\\n\\\"data\\\\values\\\"\"`type=\"requests\"`method=\"GET\"`code=\"2xx\"} $MEAN_RATE$ $TIMESTAMP$";" is 2868.,186
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsHandlerResponseTypePrometheusTest,testDatabaseAndCollectionNamesEscapedCorrectly,Magic Number,The method contains a magic number: 10,186
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptorTest,testAddMetrics,Long Statement,The length of the statement "when(config.gatheringAboveOrEqualToLevel(MongoServiceConfiguration.METRICS_GATHERING_LEVEL.COLLECTION)).thenReturn(true);" is 121.,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptorTest,testAddMetrics,Magic Number,The method contains a magic number: 200,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptorTest,testAddMetrics,Magic Number,The method contains a magic number: 3,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptorTest,testAddMetrics,Magic Number,The method contains a magic number: 3,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.metrics,MetricsInstrumentationInterceptorTest,testAddMetrics,Magic Number,The method contains a magic number: 3,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.root,GetRootHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 8,58
SoftInstigate_restheart,org.restheart.mongodb.handlers.root,GetRootHandler,handleRequest,Long Statement,The length of the statement "__dbs=__dbs.subList((request.getPage() - 1) * pagesize`(request.getPage() - 1) * pagesize + pagesize > __dbs.size() ? __dbs.size() : (request.getPage() - 1) * pagesize + pagesize);" is 180.,58
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,PostBucketHandler,handleRequest,Long Statement,The length of the statement "result=gridFs.createFile(request.rsOps()`request.getDBName()`request.getCollectionName()`metadata`request.getFilePath());" is 121.,61
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,PostBucketHandler,handleRequest,Long Statement,The length of the statement "response.getHeaders().add(HttpString.tryFromString("Location")`RepresentationUtils.getReferenceLink(MongoURLUtils.getRemappedRequestURL(exchange)`result.getNewId()));" is 166.,61
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,FileMetadataHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 11,68
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,FileMetadataHandler,handleRequest,Long Statement,The length of the statement "var result=gridFs.updateFileMetadata(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getMethod()`Optional.of(request.getDocumentId())`Optional.ofNullable(request.getFiltersDocument())`Optional.ofNullable(request.getShardKey())`content`request.getETag()`request.isETagCheckRequired());" is 356.,68
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,DeleteFileHandler,handleRequest,Long Statement,The length of the statement "var result=this.gridFs.deleteFile(request.rsOps()`request.getDBName()`request.getCollectionName()`request.getDocumentId()`request.getFiltersDocument()`request.getETag()`request.isETagCheckRequired());" is 200.,57
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,DeleteFileHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The file's ETag must be provided using the '" + Headers.IF_MATCH + "' header");" is 123.,57
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,GetFileBinaryHandler,handleRequest,Long Statement,The length of the statement "var gridFSBucket=GridFSBuckets.create(MongoClientSingleton.getInstance().getClient().getDatabase(request.getDBName())`bucket);" is 126.,80
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,GetFileBinaryHandler,sendBinaryContent,Long Identifier,The length of the field CONTENT_TRANSFER_ENCODING_BINARY is 32.,159
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,GetFileBinaryHandler,sendBinaryContent,Long Parameter List,The method has 5 parameters. ,159
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,PutFileHandler,handleRequest,Long Statement,The length of the statement "result=gridFs.upsertFile(request.rsOps()`request.getDBName()`request.getCollectionName()`metadata`request.getFilePath()`id`request.getFiltersDocument()`request.getETag()`request.isETagCheckRequired());" is 201.,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.files,PutFileHandler,handleRequest,Magic Number,The method contains a magic number: 11000,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.indexes,GetIndexesHandler,handleRequest,Long Statement,The length of the statement "var _indexes=dbs.getCollectionIndexes(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName());" is 151.,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.indexes,PutIndexHandler,handleRequest,Long Statement,The length of the statement "dbs.createIndex(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`keys`Optional.of(ops));" is 151.,58
SoftInstigate_restheart,org.restheart.mongodb.handlers.indexes,DeleteIndexHandler,handleRequest,Long Statement,The length of the statement "var httpCode=dbs.deleteIndex(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`indexId);" is 150.,56
SoftInstigate_restheart,org.restheart.mongodb.handlers.injectors,ETagPolicyInjector,isETagCheckRequired,Complex Method,Cyclomatic complexity of the method is 25,76
SoftInstigate_restheart,org.restheart.mongodb.handlers.injectors,ETagPolicyInjector,isETagCheckRequired,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@3f0b34f0,76
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkDeleteDocumentsHandler,handleRequest,Long Statement,The length of the statement "var result=this.documents.bulkDeleteDocuments(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getFiltersDocument()`Optional.ofNullable(request.getShardKey()));" is 231.,56
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkPatchDocumentsHandler,handleRequest,Long Statement,The length of the statement "var result=this.documents.bulkPatchDocuments(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getFiltersDocument()`Optional.ofNullable(request.getShardKey())`request.getContent().asDocument());" is 264.,55
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkPostCollectionHandler,handleRequest,Long Statement,The length of the statement "var result=this.documents.bulkPostDocuments(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`documents`Optional.ofNullable(request.getFiltersDocument())`Optional.ofNullable(request.getShardKey())`request.getWriteMode());" is 283.,61
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkPostCollectionHandler,checkId,Complex Conditional,The conditional expression document.isDocument() && document.asDocument().containsKey("_id") && document.asDocument().get("_id").isString()&& MongoRequest.isReservedDocumentId(request.getType()`document.asDocument().get("_id")) is complex.,129
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkPostCollectionHandler,checkId,Long Statement,The length of the statement "if (document.isDocument() && document.asDocument().containsKey("_id") && document.asDocument().get("_id").isString()&& MongoRequest.isReservedDocumentId(request.getType()`document.asDocument().get("_id"))) {" is 207.,129
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkPostCollectionHandler,checkId,Long Statement,The length of the statement "MongoResponse.of(exchange).setInError(HttpStatus.SC_FORBIDDEN`"id is reserved: " + document.asDocument().get("_id").asString().getValue());" is 139.,129
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkPostCollectionHandler,checkId,Long Statement,The length of the statement "MongoResponse.of(exchange).setInError(HttpStatus.SC_NOT_ACCEPTABLE`"_id in content body is mandatory for documents with id type " + request.getDocIdType().name());" is 163.,129
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addBulkResult,Long Statement,The length of the statement "rep.put("inserted"`new BsonInt32((wr.getUpserts() != null ? wr.getUpserts().size() : 0) + (wr.getInserts() != null ? wr.getInserts().size() : 0)));" is 147.,79
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addBulkResult,Long Statement,The length of the statement "wr.getUpserts().stream().forEach(update -> links.add(new BsonString(RepresentationUtils.getReferenceLink(requestPath`update.getId()))));" is 136.,79
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addBulkResult,Long Statement,The length of the statement "wr.getInserts().stream().forEach(update -> links.add(new BsonString(RepresentationUtils.getReferenceLink(requestPath`update.getId()))));" is 136.,79
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addWriteResult,Long Statement,The length of the statement "rep.put("inserted"`new BsonInt32((wr.getUpserts() != null ? wr.getUpserts().size() : 0) + (wr.getInserts() != null ? wr.getInserts().size() : 0)));" is 147.,115
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addWriteResult,Long Statement,The length of the statement "wr.getUpserts().stream().forEach(update -> links.add(new BsonString(RepresentationUtils.getReferenceLink(requestPath`update.getId()))));" is 136.,115
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addWriteResult,Long Statement,The length of the statement "wr.getInserts().stream().forEach(update -> links.add(new BsonString(RepresentationUtils.getReferenceLink(requestPath`update.getId()))));" is 136.,115
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addWriteErrors,Long Statement,The length of the statement "errorDoc.put("message"`new BsonString(ResponseHelper.getMessageFromErrorCode(error.getCode()) + ": " + error.getMessage()));" is 124.,149
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addWriteErrors,Magic Number,The method contains a magic number: 11000,149
SoftInstigate_restheart,org.restheart.mongodb.handlers.bulk,BulkResultRepresentationFactory,addWriteErrors,Magic Number,The method contains a magic number: 2,149
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,PostSessionHandler,handleRequest,Long Statement,The length of the statement "response.getHeaders().add(HttpString.tryFromString("Location")`RepresentationUtils.getReferenceLink(MongoURLUtils.getRemappedRequestURL(exchange)`new BsonString(sid.toString())));" is 179.,68
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,PostSessionHandler,options,Complex Conditional,The conditional expression _ops != null && _ops.isDocument() && _ops.asDocument().containsKey(SessionOptions.CAUSALLY_CONSISTENT_PROP) && _ops.asDocument().get(SessionOptions.CAUSALLY_CONSISTENT_PROP).isBoolean() is complex.,109
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,PostSessionHandler,options,Long Statement,The length of the statement "if (_ops != null && _ops.isDocument() && _ops.asDocument().containsKey(SessionOptions.CAUSALLY_CONSISTENT_PROP) && _ops.asDocument().get(SessionOptions.CAUSALLY_CONSISTENT_PROP).isBoolean()) {" is 192.,109
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,DeleteTxnHandler,handleRequest,Long Statement,The length of the statement "if (cs.getTxnServerStatus().getTxnId() != request.getTxnId() || cs.getTxnServerStatus().getStatus() != Txn.TransactionStatus.IN) {" is 130.,39
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,PatchTxnHandler,handleRequest,Long Statement,The length of the statement "var cs=TxnClientSessionFactory.getInstance().getTxnClientSession(sid`request.rsOps()`new Txn(txnId`Txn.TransactionStatus.IN));" is 126.,39
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,PostTxnsHandler,handleRequest,Complex Conditional,The conditional expression txn.getStatus() == ABORTED || txn.getStatus() == COMMITTED || txn.getStatus() == NONE is complex.,46
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,PostTxnsHandler,handleRequest,Long Statement,The length of the statement "var cs=TxnClientSessionFactory.getInstance().getTxnClientSession(sid`request.rsOps()`new Txn(nextTxnId`txn.getStatus()));" is 121.,46
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,PostTxnsHandler,handleRequest,Long Statement,The length of the statement "response.getHeaders().add(HttpString.tryFromString("Location")`getReferenceLink(request.getMappedRequestUri()`new BsonString("" + nextTxnId)));" is 143.,46
SoftInstigate_restheart,org.restheart.mongodb.handlers.sessions,GetTxnHandler,handleRequest,Long Statement,The length of the statement "currentTxn.append("id"`txn.getTxnId() > Integer.MAX_VALUE ? new BsonInt64(txn.getTxnId()) : new BsonInt32((int)txn.getTxnId()));" is 128.,44
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Complex Conditional,The conditional expression content.containsKey("_id") && content.get("_id").isString() && MongoRequest.isReservedDocumentId(request.getType()`content.get("_id")) is complex.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 12,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Long Statement,The length of the statement "if (content.containsKey("_id") && content.get("_id").isString() && MongoRequest.isReservedDocumentId(request.getType()`content.get("_id"))) {" is 141.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_NOT_ACCEPTABLE`"_id in content body is mandatory for documents with id type " + request.getDocIdType().name());" is 145.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Long Statement,The length of the statement "var result=documents.writeDocument(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getMethod()`request.getWriteMode()`Optional.ofNullable(content.get("_id"))`Optional.ofNullable(request.getFiltersDocument())`Optional.ofNullable(request.getShardKey())`content`request.getETag()`request.isETagCheckRequired());" is 380.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The document's ETag must be provided using the '" + Headers.IF_MATCH + "' header.");" is 128.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Long Statement,The length of the statement "response.getHeaders().add(HttpString.tryFromString("Location")`RepresentationUtils.getReferenceLink(MongoURLUtils.getRemappedRequestURL(exchange)`result.getNewData().get("_id")));" is 179.,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PostCollectionHandler,handleRequest,Magic Number,The method contains a magic number: 11000,63
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PatchCollectionHandler,handleRequest,Complex Conditional,The conditional expression request.getCollectionName().isEmpty() || (request.getCollectionName().startsWith("_") && !request.getCollectionName().equals(_SCHEMAS)) is complex.,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PatchCollectionHandler,handleRequest,Complex Method,Cyclomatic complexity of the method is 8,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PatchCollectionHandler,handleRequest,Long Statement,The length of the statement "if (request.getCollectionName().isEmpty() || (request.getCollectionName().startsWith("_") && !request.getCollectionName().equals(_SCHEMAS))) {" is 142.,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PatchCollectionHandler,handleRequest,Long Statement,The length of the statement "var result=dbs.upsertCollection(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getMethod()`request.getCollectionProps() != null`content`request.getETag()`request.isETagCheckRequired());" is 258.,60
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PutCollectionHandler,handleRequest,Long Statement,The length of the statement "var result=dbs.upsertCollection(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getMethod()`request.getCollectionProps() != null`content`request.getETag()`request.isETagCheckRequired());" is 258.,57
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,PutCollectionHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The collection's ETag must be provided using the '" + Headers.IF_MATCH + "' header.");" is 130.,57
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,DeleteCollectionHandler,handleRequest,Long Statement,The length of the statement "var etag=request.getETag() == null ? null : ObjectId.isValid(request.getETag()) ? new BsonObjectId(new ObjectId(request.getETag())) : new BsonObjectId();" is 153.,59
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,DeleteCollectionHandler,handleRequest,Long Statement,The length of the statement "var result=dbs.deleteCollection(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`etag`request.isETagCheckRequired());" is 180.,59
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,GetCollectionHandler,handleRequest,Long Statement,The length of the statement "size=dbs.getCollectionSize(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getFiltersDocument());" is 169.,65
SoftInstigate_restheart,org.restheart.mongodb.handlers.collection,GetCollectionHandler,handleRequest,Long Statement,The length of the statement "data=dbs.getCollectionData(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getCollectionName()`request.getPage()`request.getPagesize()`sort`filter`request.getHintDocument()`request.getProjectionDocument()`request.getCursorAllocationPolicy());" is 286.,65
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,PatchDBHandler,handleRequest,Long Statement,The length of the statement "var result=dbs.upsertDB(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getMethod()`request.getDbProps() != null`content`request.getETag()`request.isETagCheckRequired());" is 214.,59
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,PatchDBHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The database's ETag must be provided using the '" + Headers.IF_MATCH + "' header.");" is 128.,59
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,PutDBHandler,handleRequest,Long Statement,The length of the statement "var result=dbs.upsertDB(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`request.getMethod()`request.getDbProps() != null`content`request.getETag()`request.isETagCheckRequired());" is 214.,58
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,PutDBHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The database's ETag must be provided using the '" + Headers.IF_MATCH + "' header.");" is 128.,58
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,GetDBHandler,handleRequest,Long Statement,The length of the statement "var data=dbs.getDatabaseData(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`colls`request.getPage()`request.getPagesize()`request.isNoCache());" is 180.,56
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,DeleteDBHandler,handleRequest,Long Statement,The length of the statement "var etag=request.getETag() == null ? null : ObjectId.isValid(request.getETag()) ? new BsonObjectId(new ObjectId(request.getETag())) : new BsonObjectId();" is 153.,61
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,DeleteDBHandler,handleRequest,Long Statement,The length of the statement "var result=dbs.deleteDatabase(Optional.ofNullable(request.getClientSession())`request.rsOps()`request.getDBName()`etag`request.isETagCheckRequired());" is 150.,61
SoftInstigate_restheart,org.restheart.mongodb.handlers.database,DeleteDBHandler,handleRequest,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_CONFLICT`"The database's ETag must be provided using the '" + Headers.IF_MATCH + "' header.");" is 128.,61
SoftInstigate_restheart,org.restheart.mongodb.utils,LogUtils,boxedMessage,Long Parameter List,The method has 5 parameters. ,130
SoftInstigate_restheart,org.restheart.mongodb.utils,LogUtils,boxedMessage,Magic Number,The method contains a magic number: 66,130
SoftInstigate_restheart,org.restheart.mongodb.utils,LogUtils,header,Long Statement,The length of the statement "return ansi().a("\n").fg(color).a("*-------------------------------------------------------------------*\n" + "| |\n").reset();" is 127.,170
SoftInstigate_restheart,org.restheart.mongodb.utils,RequestHelper,isResponseInConflict,Long Statement,The length of the statement "MongoResponse.of(exchange).setInError(HttpStatus.SC_CONFLICT`"The ETag must be provided using the '" + Headers.IF_MATCH + "' header");" is 134.,115
SoftInstigate_restheart,org.restheart.mongodb.utils,RequestHelper,isResponseInConflict,Magic Number,The method contains a magic number: 11000,115
SoftInstigate_restheart,org.restheart.mongodb.utils,MongoURLUtils,getDocumentIdFromURI,Complex Method,Cyclomatic complexity of the method is 8,81
SoftInstigate_restheart,org.restheart.mongodb.utils,MongoURLUtils,getUriWithFilterMany,Long Statement,The length of the statement "sb.append("/").append(dbName).append("/").append(collName).append("?").append("filter={").append("'").append("_id").append("'").append(":").append("{'$in'").append(":").append(getIdsString(ids)).append("}}");" is 208.,195
SoftInstigate_restheart,org.restheart.mongodb.utils,MongoURLUtils,getUriWithFilterOne,Long Parameter List,The method has 5 parameters. ,221
SoftInstigate_restheart,org.restheart.mongodb.utils,MongoURLUtils,getUriWithFilterOne,Long Statement,The length of the statement "sb.append("/").append(dbName).append("/").append(collName).append("?").append("filter={").append("'").append(referenceField).append("'").append(":").append(getIdString(id)).append("}");" is 185.,221
SoftInstigate_restheart,org.restheart.mongodb.utils,MongoURLUtils,getUriWithFilterManyInverse,Long Parameter List,The method has 5 parameters. ,250
SoftInstigate_restheart,org.restheart.mongodb.utils,MongoURLUtils,getUriWithFilterManyInverse,Long Statement,The length of the statement "sb.append("/").append(dbName).append("/").append(collName).append("?").append("filter={'").append(referenceField).append("':{").append("'$elemMatch':{'$eq':").append(getIdString(id)).append("}}}");" is 197.,250
SoftInstigate_restheart,org.restheart.mongodb.security,ProjectResponse,projectExlcusions,Complex Conditional,The conditional expression first.length() > 0 && doc.containsKey(first) && doc.get(first).isDocument() is complex.,72
SoftInstigate_restheart,org.restheart.mongodb.security,ProjectResponse,projectInclusions,Complex Conditional,The conditional expression first.length() > 0 && doc.containsKey(first) && doc.get(first).isDocument() is complex.,89
SoftInstigate_restheart,org.restheart.mongodb.security,ProjectResponse,resolve,Complex Conditional,The conditional expression !request.isHandledBy("mongo") || response.getContent() == null || !request.isGet() is complex.,113
SoftInstigate_restheart,org.restheart.mongodb.security,FilterOperatorsBlacklist,contains,Long Statement,The length of the statement "var foundInSubDocs=doc.keySet().stream().filter(key -> doc.get(key).isDocument()).map(key -> doc.get(key).asDocument()).anyMatch(sdoc -> contains(sdoc`blacklist));" is 163.,77
SoftInstigate_restheart,org.restheart.mongodb.security,FilterOperatorsBlacklist,contains,Long Statement,The length of the statement "return doc.keySet().stream().filter(key -> doc.get(key).isArray()).map(key -> doc.get(key).asArray()).anyMatch(array -> contains(array`blacklist));" is 147.,77
SoftInstigate_restheart,org.restheart.mongodb.security,FilterOperatorsBlacklist,contains,Long Statement,The length of the statement "var foundInDocs=array.stream().filter(el -> el.isDocument()).map(el -> el.asDocument()).anyMatch(doc -> contains(doc`blacklist));" is 129.,109
SoftInstigate_restheart,org.restheart.mongodb.security,FilterOperatorsBlacklist,contains,Long Statement,The length of the statement "return array.stream().filter(el -> el.isArray()).map(el -> el.asArray()).anyMatch(subArray -> contains(subArray`blacklist));" is 124.,109
SoftInstigate_restheart,org.restheart.mongodb.security,RequestFilters,init,Long Statement,The length of the statement "var __maa=registry.getAuthorizers().stream().filter(a -> "mongoAclAuthorizer".equals(a.getName()) || "fileAclAuthorizer".equals(a.getName())).findFirst();" is 154.,45
SoftInstigate_restheart,org.restheart.mongodb.security,RequestFilters,handle,Complex Conditional,The conditional expression (request.isPatch() || request.isPut() || request.isPost()|| request.isDelete()) && mongoPermissions.getWriteFilter() != null is complex.,62
SoftInstigate_restheart,org.restheart.mongodb.security,RequestFilters,handle,Long Statement,The length of the statement "else if ((request.isPatch() || request.isPut() || request.isPost()|| request.isDelete()) && mongoPermissions.getWriteFilter() != null) {" is 136.,62
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,handle,Long Statement,The length of the statement "content.asArray().stream().filter(doc -> doc.isDocument()).map(doc -> doc.asDocument()).forEach(doc -> addProps(doc`args`request`response));" is 140.,68
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,resolve,Long Statement,The length of the statement "return request.isHandledBy("mongo") && !request.isGet() && !request.isOptions()&& !request.isDelete()&& request.getCollectionProps() != null && request.getCollectionProps().containsKey("addRequestProperties") && (request.getCollectionProps().get("addRequestProperties").isArray() || request.getCollectionProps().get("addRequestProperties").isDocument());" is 354.,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,addProps,Complex Method,Cyclomatic complexity of the method is 8,107
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,addProps,Long Statement,The length of the statement "response.addWarning("addRequestProperties wrong definition: " + "must be an object with an array field containing " + "the properties to inject. got "+ _args.toJson());" is 168.,107
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,addProps,Long Statement,The length of the statement "response.addWarning("addRequestProperties wrong definition: " + "must be an array containing " + "the properties to inject. got "+ BsonUtils.toJson(propNames));" is 160.,107
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,getPropsValues,Complex Conditional,The conditional expression Objects.nonNull(exchange.getSecurityContext()) && Objects.nonNull(exchange.getSecurityContext().getAuthenticatedAccount()) && Objects.nonNull(exchange.getSecurityContext().getAuthenticatedAccount().getRoles()) is complex.,170
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,getPropsValues,Long Statement,The length of the statement "if (Objects.nonNull(exchange.getSecurityContext()) && Objects.nonNull(exchange.getSecurityContext().getAuthenticatedAccount()) && Objects.nonNull(exchange.getSecurityContext().getAuthenticatedAccount().getRoles())) {" is 216.,170
SoftInstigate_restheart,org.restheart.mongodb.interceptors,AddRequestProperties,getPropsValues,Magic Number,The method contains a magic number: 1000,170
SoftInstigate_restheart,org.restheart.mongodb.interceptors,NamespacesResponseFlattener,handle,Long Statement,The length of the statement "content.stream().filter(doc -> doc.isDocument()).map(doc -> doc.asDocument()).map(doc -> doc.get("_id")).forEachOrdered(flatContent::add);" is 138.,44
SoftInstigate_restheart,org.restheart.mongodb.interceptors,NamespacesResponseFlattener,resolve,Long Statement,The length of the statement "return request.isHandledBy("mongo") && (request.getRepresentationFormat() == REPRESENTATION_FORMAT.STANDARD || request.getRepresentationFormat() == REPRESENTATION_FORMAT.S) && request.isGet()&& (request.isRoot() || request.isDb())&& response.getContent() != null && response.getContent().isArray() && !response.getContent().asArray().isEmpty();" is 344.,62
SoftInstigate_restheart,org.restheart.mongodb.interceptors,CollectionPropsInjector,handle,Complex Conditional,The conditional expression dbName != null && collName != null && !request.isDbMeta() is complex.,74
SoftInstigate_restheart,org.restheart.mongodb.interceptors,CollectionPropsInjector,handle,Complex Conditional,The conditional expression httpCode >= 500 && mce.getMessage() != null && !mce.getMessage().isBlank() is complex.,74
SoftInstigate_restheart,org.restheart.mongodb.interceptors,CollectionPropsInjector,handle,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_INTERNAL_SERVER_ERROR`"Error getting properties of collection " + dbName.concat(".").concat(collName)`e);" is 139.,74
SoftInstigate_restheart,org.restheart.mongodb.interceptors,CollectionPropsInjector,handle,Magic Number,The method contains a magic number: 500,74
SoftInstigate_restheart,org.restheart.mongodb.interceptors,CollectionPropsInjector,resolve,Long Statement,The length of the statement "return dbs != null && request.isHandledBy("mongo") && !(request.isInError() || request.isMetrics() || request.isDbSize()|| request.isTxn()|| request.isTxns());" is 159.,131
SoftInstigate_restheart,org.restheart.mongodb.interceptors,CollectionPropsInjector,checkCollection,Long Statement,The length of the statement "return !(request.isCollection() && request.isPut()) && !(request.isFilesBucket() && request.isPut()) && !(request.isSchemaStore() && request.isPut())&& !request.isRoot()&& !request.isDb()&& !request.isDbSize();" is 210.,166
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Complex Conditional,The conditional expression skipNotSupported != null && skipNotSupported.isBoolean() && skipNotSupported.asBoolean().getValue() is complex.,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Complex Method,Cyclomatic complexity of the method is 8,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_NOT_IMPLEMENTED`"'jsonSchema' checker does not support bulk PATCH requests. " + "Set 'skipNotSupported:true' to allow them.");" is 160.,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_INTERNAL_SERVER_ERROR`"wrong 'jsonSchema': " + "property " + SCHEMA_STORE_DB_PROPERTY + " must be a string");" is 143.,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_INTERNAL_SERVER_ERROR`"wrong 'jsonSchema': schema " + schemaStoreDb + "/"+ _SCHEMAS+ "/"+ BsonUtils.getIdAsString(schemaId`false)+ " not found");" is 179.,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_INTERNAL_SERVER_ERROR`"wrong 'jsonSchema': schema " + schemaStoreDb + "/"+ _SCHEMAS+ "/"+ BsonUtils.getIdAsString(schemaId`false)+ " not found");" is 179.,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"Request content violates schema " + BsonUtils.getIdAsString(schemaId`true) + ": "+ errMsg);" is 138.,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Magic Number,The method contains a magic number: 2,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Magic Number,The method contains a magic number: 2,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,handle,Magic Number,The method contains a magic number: 2,92
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,documentsToCheck,Long Statement,The length of the statement "content.asArray().stream().filter(doc -> doc.isDocument()).map(doc -> BsonUtils.toJson(doc`request.getJsonMode())).map(doc -> new JSONObject(doc)).forEachOrdered(ret::add);" is 172.,213
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaBeforeWriteChecker,resolve,Long Statement,The length of the statement "return request.isHandledBy("mongo") && ((request.isWriteDocument() && !request.isPatch()) || (request.isPatch() && request.isBulkDocuments())) && request.getCollectionProps() != null && request.getCollectionProps().containsKey("jsonSchema") && request.getCollectionProps().get("jsonSchema").isDocument();" is 304.,234
SoftInstigate_restheart,org.restheart.mongodb.interceptors,ContentSizeChecker,handle,Long Statement,The length of the statement "Integer min=request.getCollectionProps().get("checkContentSize").asDocument().containsKey("min") && request.getCollectionProps().get("checkContentSize").asDocument().get("min").isInt32() ? request.getCollectionProps().get("checkContentSize").asDocument().get("min").asInt32().intValue() : null;" is 294.,53
SoftInstigate_restheart,org.restheart.mongodb.interceptors,ContentSizeChecker,resolve,Long Statement,The length of the statement "return request.isWriteDocument() && request.getCollectionProps() != null && request.getCollectionProps().containsKey("checkContentSize") && request.getCollectionProps().get("checkContentSize").isDocument() && request.getCollectionProps().get("checkContentSize").asDocument().containsKey("max") && request.getCollectionProps().get("checkContentSize").asDocument().get("max").isInt32();" is 384.,121
SoftInstigate_restheart,org.restheart.mongodb.interceptors,MetadataCachesSingleton,setup,Long Statement,The length of the statement "this.dbPropsCache=CacheFactory.createLocalLoadingCache(MAX_CACHE_SIZE`Cache.EXPIRE_POLICY.AFTER_WRITE`ttl`( String key) -> dbs.getDatabaseProperties(Optional.empty()`Optional.empty()`key));" is 189.,80
SoftInstigate_restheart,org.restheart.mongodb.interceptors,MetadataCachesSingleton,setup,Long Statement,The length of the statement "this.collectionPropsCache=CacheFactory.createLocalLoadingCache(MAX_CACHE_SIZE`Cache.EXPIRE_POLICY.AFTER_WRITE`ttl`key -> {" is 122.,80
SoftInstigate_restheart,org.restheart.mongodb.interceptors,MetadataCachesSingleton,setup,Long Statement,The length of the statement "return this.dbs.getCollectionProperties(Optional.empty()`Optional.empty()`dbNameAndCollectionName[0]`dbNameAndCollectionName[1]);" is 129.,80
SoftInstigate_restheart,org.restheart.mongodb.interceptors,MetadataCachesSingleton,invalidateDb,Long Statement,The length of the statement "collectionPropsCache.asMap().keySet().stream().filter(k -> k.startsWith(dbName + SEPARATOR)).forEach(k -> collectionPropsCache.invalidate(k));" is 142.,176
SoftInstigate_restheart,org.restheart.mongodb.interceptors,DbPropsInjector,handle,Complex Conditional,The conditional expression httpCode >= 500 && mce.getMessage() != null && !mce.getMessage().isBlank() is complex.,69
SoftInstigate_restheart,org.restheart.mongodb.interceptors,DbPropsInjector,handle,Complex Conditional,The conditional expression dbProps == null && !(request.isDb() && request.isPut()) && !request.isRoot() is complex.,69
SoftInstigate_restheart,org.restheart.mongodb.interceptors,DbPropsInjector,handle,Magic Number,The method contains a magic number: 500,69
SoftInstigate_restheart,org.restheart.mongodb.interceptors,DbPropsInjector,resolve,Long Statement,The length of the statement "return this.dbs != null && request.isHandledBy("mongo") && !(request.isInError() || request.isSessions() || request.isTxn()|| request.isTxns()|| request.isRoot()|| request.isRootSize()|| request.isMetrics());" is 208.,127
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaAfterWriteChecker,resolve,Long Statement,The length of the statement "return request.isHandledBy("mongo") && request.getCollectionProps() != null && (request.isPatch() && !request.isBulkDocuments()) && request.getCollectionProps() != null && request.getCollectionProps().containsKey("jsonSchema") && request.getCollectionProps().get("jsonSchema").isDocument() && (response.getDbOperationResult() != null && response.getDbOperationResult().getHttpCode() < 300);" is 390.,65
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaAfterWriteChecker,resolve,Magic Number,The method contains a magic number: 300,65
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaAfterWriteChecker,documentToCheck,Long Statement,The length of the statement "return response.getDbOperationResult().getNewData() == null ? "{}" : BsonUtils.toJson(response.getDbOperationResult().getNewData()`request.getJsonMode());" is 154.,80
SoftInstigate_restheart,org.restheart.mongodb.interceptors,JsonSchemaAfterWriteChecker,documentsToCheck,Long Statement,The length of the statement "var content=response.getDbOperationResult().getNewData() == null ? new BsonDocument() : response.getDbOperationResult().getNewData();" is 133.,86
SoftInstigate_restheart,org.restheart.mongodb.services,CsvLoader,handle,Complex Method,Cyclomatic complexity of the method is 11,93
SoftInstigate_restheart,org.restheart.mongodb.services,CsvLoader,handle,Long Statement,The length of the statement "var mcoll=MongoClientSingleton.getInstance().getClient().getDatabase(params.db).getCollection(params.coll`BsonDocument.class);" is 126.,93
SoftInstigate_restheart,org.restheart.mongodb.services,CsvLoader,handle,Long Statement,The length of the statement "var docList=documents.stream().map(doc -> doc.asDocument()).map(doc -> addProps(params`doc)).collect(Collectors.toList());" is 122.,93
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,isHalOrJson,Long Statement,The length of the statement "return (contentTypes == null || contentTypes.isEmpty()) || (contentTypes.stream().anyMatch(ct -> ct.startsWith(Exchange.HAL_JSON_MEDIA_TYPE) || ct.startsWith(Exchange.JSON_MEDIA_TYPE)));" is 186.,73
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,isFormOrMultipart,Long Statement,The length of the statement "return contentTypes != null && !contentTypes.isEmpty() && contentTypes.stream().anyMatch(ct -> ct.startsWith(Exchange.APP_FORM_URLENCODED_TYPE) || ct.startsWith(Exchange.MULTIPART_FORM_DATA_TYPE));" is 197.,80
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,checkReservedId,Complex Conditional,The conditional expression MAX_KEY_ID.equalsIgnoreCase(_id) || MIN_KEY_ID.equalsIgnoreCase(_id) || NULL_KEY_ID.equalsIgnoreCase(_id)|| TRUE_KEY_ID.equalsIgnoreCase(_id)|| FALSE_KEY_ID.equalsIgnoreCase(_id) is complex.,87
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,checkReservedId,Complex Method,Cyclomatic complexity of the method is 9,87
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,checkReservedId,Long Statement,The length of the statement "if (MAX_KEY_ID.equalsIgnoreCase(_id) || MIN_KEY_ID.equalsIgnoreCase(_id) || NULL_KEY_ID.equalsIgnoreCase(_id)|| TRUE_KEY_ID.equalsIgnoreCase(_id)|| FALSE_KEY_ID.equalsIgnoreCase(_id)) {" is 185.,87
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,extractMetadata,Long Statement,The length of the statement "metadataString=formData.getFirst(FILE_METADATA) != null ? formData.getFirst(FILE_METADATA).getValue() : formData.getFirst(PROPERTIES) != null ? formData.getFirst(PROPERTIES).getValue() : null;" is 192.,152
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,inject,Complex Conditional,The conditional expression request.isGet() || request.isOptions() || request.isDelete() is complex.,215
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,inject,Complex Method,Cyclomatic complexity of the method is 16,215
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_NOT_ACCEPTABLE`"request data can be an array only for POST to collection resources (bulk post)");" is 131.,215
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_NOT_ACCEPTABLE`"the type of _id in request data is not supported: " + (_id == null ? "" : _id.getBsonType().name()));" is 151.,215
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_NOT_ACCEPTABLE`"the type of _id in request data is not supported: " + _id.getBsonType().name());" is 130.,215
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"update operators (but $currentDate) cannot be used on POST and PUT requests");" is 125.,215
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,injectBson,Complex Conditional,The conditional expression content != null && !content.isDocument() && !content.isArray() is complex.,300
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,injectBson,Long Statement,The length of the statement "throw new IllegalArgumentException("request data must be either a json object or an array` got " + content.getBsonType().name());" is 129.,300
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,injectMultipart,Complex Conditional,The conditional expression !((request.isPost() && request.isFilesBucket()) || (request.isPut() && request.isFile())) is complex.,341
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestContentInjector,injectMultipart,Long Identifier,The length of the field ERROR_INVALID_CONTENTTYPE_FILE is 30.,341
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Complex Conditional,The conditional expression sort_by.stream().anyMatch(s -> s.trim().equals("_last_updated_on") || s.trim().equals("+_last_updated_on") || s.trim().equals("-_last_updated_on")) is complex.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Complex Conditional,The conditional expression sort_by.stream().anyMatch(s -> s.trim().equals("_created_on") || s.trim().equals("_created_on") || s.trim().equals("_created_on")) is complex.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Complex Conditional,The conditional expression request.getType() == TYPE.BULK_DOCUMENTS && (request.isDelete() || request.isPatch()) && (filters == null || filters.isEmpty()) is complex.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Complex Method,Cyclomatic complexity of the method is 47,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Method,The method has 283 lines of code.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.addWarning("illegal rep parameter " + _rep + " (must be STANDARD` NESTED or HAL; S is an alias for STANDARD; PLAIN_JSON` PJ are aliases for NESTED)");" is 159.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"illegal database name` see https://www.mongodb.com/docs/manual/reference/limits/#naming-restrictions");" is 150.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"illegal collection name` see https://www.mongodb.com/docs/manual/reference/limits/#naming-restrictions");" is 152.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"illegal pagesize parameter` pagesize must be >= 0 and <= " + MAX_PAGESIZE);" is 122.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "if (sort_by.stream().anyMatch(s -> s.trim().equals("_last_updated_on") || s.trim().equals("+_last_updated_on") || s.trim().equals("-_last_updated_on"))) {" is 154.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.addWarning("unexepecting sorting; the _last_updated_on timestamp is generated from the _etag property if present");" is 124.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "if (sort_by.stream().anyMatch(s -> s.trim().equals("_created_on") || s.trim().equals("_created_on") || s.trim().equals("_created_on"))) {" is 137.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.addWarning("unexepecting sorting; the _created_on timestamp is generated from the _id property if it is an ObjectId");" is 127.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"illegal keys paramenter` it is not a json object: " + f + " => "+ f.getClass().getSimpleName());" is 143.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"illegal filter paramenter` it is not a json object: " + f + " => "+ f.getClass().getSimpleName());" is 145.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "if (request.getType() == TYPE.BULK_DOCUMENTS && (request.isDelete() || request.isPatch()) && (filters == null || filters.isEmpty())) {" is 134.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"illegal " + DOC_ID_TYPE_QPARAM_KEY + " paramenter; must be "+ Arrays.toString(DOC_ID_TYPE.values()));" is 148.,72
SoftInstigate_restheart,org.restheart.mongodb.exchange,MongoRequestPropsInjector,inject,Long Statement,The length of the statement "response.setInError(HttpStatus.SC_BAD_REQUEST`"illegal " + HAL_QPARAM_KEY + " paramenter; valid values are "+ Arrays.toString(HAL_MODE.values()));" is 146.,72
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,getRelFromJson,Long Identifier,The length of the field TARGET_COLLECTION_ELEMENT_NAME is 30.,127
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,getRelFromJson,Long Statement,The length of the statement "throw new InvalidMetadataException((_targetCollection == null ? "missing " : "invalid ") + TARGET_COLLECTION_ELEMENT_NAME + " element.");" is 137.,127
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,getRelFromJson,Long Statement,The length of the statement "throw new InvalidMetadataException((_referenceField == null ? "missing " : "invalid ") + REF_ELEMENT_NAME + " element.");" is 121.,127
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,Relationship,Long Parameter List,The method has 6 parameters. ,204
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,Relationship,Long Parameter List,The method has 6 parameters. ,228
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,Relationship,Long Statement,The length of the statement "throw new InvalidMetadataException("invalid type value: " + type + ". valid values are "+ Arrays.toString(TYPE.values())`iae);" is 126.,228
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,Relationship,Long Statement,The length of the statement "throw new InvalidMetadataException("invalid role value " + role + ". valid values are "+ Arrays.toString(ROLE.values())`iae);" is 125.,228
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,getRelationshipLink,Complex Method,Cyclomatic complexity of the method is 8,275
SoftInstigate_restheart,org.restheart.mongodb.metadata,Relationship,getRelationshipLink,Long Statement,The length of the statement "throw new IllegalArgumentException("in resource " + dbName + "/"+ collName+ "/"+ data.get("_id")+ " the "+ type.name()+ " relationship ref-field "+ this.referenceField+ " should be an array` but it is "+ _referenceValue);" is 221.,275
SoftInstigate_restheart,org.restheart.handlers.injectors,XForwardedHeadersInjector,handleRequest,Complex Conditional,The conditional expression exchange != null && exchange.getSecurityContext() != null && exchange.getSecurityContext().getAuthenticatedAccount() != null is complex.,72
SoftInstigate_restheart,org.restheart.handlers.injectors,XForwardedHeadersInjector,handleRequest,Long Statement,The length of the statement "if (exchange != null && exchange.getSecurityContext() != null && exchange.getSecurityContext().getAuthenticatedAccount() != null) {" is 131.,72
SoftInstigate_restheart,org.restheart.handlers.injectors,XForwardedHeadersInjector,handleRequest,Long Statement,The length of the statement "((BaseAccount)a).getRoles().stream().forEachOrdered(role -> exchange.getRequestHeaders().add(getXForwardedRolesHeaderName()`role));" is 131.,72
SoftInstigate_restheart,org.restheart.handlers.injectors,TokenInjector,handleRequest,Complex Conditional,The conditional expression this.tokenManager != null && exchange.getSecurityContext() != null && exchange.getSecurityContext().isAuthenticated() is complex.,45
SoftInstigate_restheart,org.restheart.handlers.injectors,TokenInjector,handleRequest,Long Statement,The length of the statement "if (this.tokenManager != null && exchange.getSecurityContext() != null && exchange.getSecurityContext().isAuthenticated()) {" is 124.,45
SoftInstigate_restheart,org.restheart.handlers.injectors,RequestContentInjector,shallInject,Long Statement,The length of the statement "return !isAlreadyInjected(exchange) && (policy == ALWAYS || (policy == ON_REQUIRES_CONTENT_AFTER_AUTH && isContentRequired(exchange`InterceptPoint.REQUEST_AFTER_AUTH)) || (policy == ON_REQUIRES_CONTENT_BEFORE_AUTH && isContentRequired(exchange`InterceptPoint.REQUEST_BEFORE_AUTH)));" is 282.,126
SoftInstigate_restheart,org.restheart.handlers.injectors,RequestContentInjector,isContentRequired,Long Statement,The length of the statement "LOGGER.warn("Error resolving interceptor {} for {} on intercept point {}"`ri.getClass().getSimpleName()`exchange.getRequestPath()`interceptPoint`e);" is 148.,132
SoftInstigate_restheart,org.restheart.graal,GenerateGraalvmReflectConfig,main,Long Statement,The length of the statement "try (var scanResult=new ClassGraph().acceptPackages("java.net.http"`"jdk.internal.net.http").rejectClasses("jdk.internal.net.http.common.SSLFlowDelegate"`"jdk.internal.net.http.common.SSLFlowDelegate$Monitor").acceptPackages("org.restheart.exchange").acceptClasses("org.restheart.mongodb.db.OperationResult"`"org.restheart.mongodb.db.BulkOperationResult").acceptClasses("org.restheart.security.BaseAccount"`"org.restheart.security.BaseAclPermission"`"org.restheart.security.BasePrincipal"`"org.restheart.security.FileRealmAccount"`"org.restheart.security.JwtAccount"`"org.restheart.security.MongoPermissions"`"org.restheart.security.MongoRealmAccount"`"org.restheart.security.PwdCredentialAccount").acceptClasses("org.restheart.utils.BsonUtils").acceptClasses("org.restheart.utils.BsonUtils$ArrayBuilder").acceptClasses("org.restheart.utils.BsonUtils$DocumentBuilder").acceptPackages("org.bson").rejectPackages("org.bson.codecs"`"org.bson.json"`"org.bson.io"`"org.bson.assertions"`"org.bson.conversions"`"org.bson.diagnostics"`"org.bson.internal"`"org.bson.types"`"org.bson.util").acceptPackages("com.mongodb.client"`"com.mongodb.internal"`"com.mongodb.client.internal").acceptClasses("com.mongodb.MongoClient"`"com.mongodb.client.internal.MongoCollectionImpl"`"com.mongodb.client.model.Filters").acceptClasses("org.slf4j.Logger"`"ch.qos.logback.classic.Logger"`"org.apache.commons.logging.LogFactory").acceptPackages("com.google.gson").rejectPackages("com.google.gson.internal"`"com.google.gson.stream"`"com.google.gson.annotations").enableSystemJarsAndModules().scan()){" is 1572.,44
SoftInstigate_restheart,org.restheart.graal,GenerateGraalvmReflectConfig,main,Long Statement,The length of the statement "if ("org.bson".equals(classInfo.getPackageName()) && classInfo.getSuperclasses().stream().noneMatch(ci -> "org.bson.BsonValue".equals(ci.getName()))) {" is 151.,44
SoftInstigate_restheart,org.restheart.graal,GenerateGraalvmReflectConfig,main,Long Statement,The length of the statement "else if ("com.google.gson".equals(classInfo.getPackageName()) && classInfo.getSuperclasses().stream().noneMatch(ci -> "com.google.gson.JsonElement".equals(ci.getName()))) {" is 172.,44
SoftInstigate_restheart,org.restheart.security.test.performance,AbstractPT,prepare,Complex Conditional,The conditional expression url != null && id != null && pwd != null is complex.,43
SoftInstigate_restheart,org.restheart.test.integration,ContentEncodingIT,init,Long Statement,The length of the statement "notDecompressingExecutor=Executor.newInstance(HttpClients.custom().disableContentCompression().build()).authPreemptive(HTTP_HOST).auth(new HttpHost(HTTP_HOST.getHostName())`"admin"`"secret");" is 191.,53
SoftInstigate_restheart,org.restheart.test.integration,ContentEncodingIT,testGzipAcceptEncoding,Long Statement,The length of the statement "Response resp=notDecompressingExecutor.execute(Request.Get(rootUri).addHeader(Headers.ACCEPT_ENCODING_STRING`Headers.GZIP.toString()));" is 135.,71
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 148.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 156.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Post(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 157.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Post(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 157.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Get(createdDocUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 127.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Post(addCheckEtag(collectionTmpUri)).bodyString("{_id:{\"$oid\":\"" + _id + "\"}` a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 203.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Post(collectionTmpUri).bodyString("{_id:{\"$oid\":\"" + _id + "\"}` a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`"pippoetag"));" is 236.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Post(collectionTmpUri).bodyString("{_id:{\"$oid\":\"" + _id + "\"}` a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`_etag));" is 230.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostCollection,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Post(collectionTmpUri).bodyString("{_id:{\"$oid\":\"" + _id + "\"}` a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 189.,58
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create collection " + DB.concat("/").concat(COLL)`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 127.,119
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostDocumentDotNotation,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{ '_id': 'docid1'` 'doc.number': 1 }").asString();" is 160.,140
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostDocumentOperators,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{ '_id': 'docid2'` '$push': {'array': 'a'}` '$inc': { 'count': 100 }}").asString();" is 193.,180
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostDocumentOperators,Long Statement,The length of the statement "Assert.assertEquals("check response status of create test data"`org.apache.http.HttpStatus.SC_BAD_REQUEST`resp.getStatus());" is 124.,180
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostDocumentOperators,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ '_id': 'docid2'` '$currentDate': {'timestamp': true } }").asString();" is 208.,180
SoftInstigate_restheart,org.restheart.test.integration,PostCollectionIT,testPostDocumentOperators,Long Statement,The length of the statement "Assert.assertEquals("check response status of create test data with $currentDate operator"`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 147.,180
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetIndexes,Magic Number,The method contains a magic number: 5,81
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetIndexes,Magic Number,The method contains a magic number: 5,81
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create collection " + DB.concat("/").concat(COLL)`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 127.,145
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"_indexes"`TEST_DB_PREFIX + "_idx_pos")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'keys': {'a':1}}").asString();" is 179.,145
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create index " + DB.concat("/").concat(COLL).concat("/_indexes/test_idx_pos")`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 155.,145
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"_indexes"`TEST_DB_PREFIX + "_idx_neg")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'keys':{'a':-1}}").asString();" is 179.,145
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create index " + DB.concat("/").concat(COLL).concat("/_indexes/test_idx_neg")`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 155.,145
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"one")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body("{'a':1}").asString();" is 163.,145
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"two")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body("{'a':2}").asString();" is 163.,145
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetHintStringFormat,Long Statement,The length of the statement "com.mashape.unirest.http.HttpResponse resp=Unirest.get(url(DB`COLL)).queryString("hint"`"a").queryString("sort"`"{}").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 159.,203
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetHintStringFormat,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).queryString("hint"`"-a").queryString("sort"`"{}").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 122.,203
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetHintStringFormat,Magic Number,The method contains a magic number: 2,203
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetHintObjectFormat,Long Statement,The length of the statement "com.mashape.unirest.http.HttpResponse resp=Unirest.get(url(DB`COLL)).queryString("hint"`"{'a':1}").queryString("sort"`"{}").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 165.,285
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetHintObjectFormat,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).queryString("hint"`"{'a':-1}").queryString("sort"`"{}").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 128.,285
SoftInstigate_restheart,org.restheart.test.integration,GetIndexesIT,testGetHintObjectFormat,Magic Number,The method contains a magic number: 2,285
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "assertTrue("check mtm link"`json.get("_links").asObject().get("mtm").asObject().get("href").asString().endsWith("?filter={'_id':{'$in':['doc2']}}"));" is 149.,86
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "assertTrue("check mto link"`json.get("_links").asObject().get("mto").asObject().get("href").asString().endsWith("/doc2"));" is 122.,86
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "assertTrue("check otm link"`json.get("_links").asObject().get("otm").asObject().get("href").asString().endsWith("?filter={'_id':{'$in':['doc2']}}"));" is 149.,86
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "assertTrue("check oto link"`json.get("_links").asObject().get("oto").asObject().get("href").asString().endsWith("/doc2"));" is 122.,86
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "URI _mtm=ub.setScheme(uri.getScheme()).setHost(uri.getHost()).setPort(uri.getPort()).setPath(mtms[0]).setCustomQuery(mtms[1]).build();" is 134.,86
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "URI _mto=ub.setScheme(uri.getScheme()).setHost(uri.getHost()).setPort(uri.getPort()).setPath(mtos[0]).setCustomQuery(mtos[1]).build();" is 134.,86
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "URI _otm=ub.setScheme(uri.getScheme()).setHost(uri.getHost()).setPort(uri.getPort()).setPath(otms[0]).setCustomQuery(otms[1]).build();" is 134.,86
SoftInstigate_restheart,org.restheart.test.integration,GetDocumentIT,testGetDocument,Long Statement,The length of the statement "URI _oto=ub.setScheme(uri.getScheme()).setHost(uri.getHost()).setPort(uri.getPort()).setPath(otos[0]).setCustomQuery(otos[1]).build();" is 134.,86
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Long Statement,The length of the statement "Response respSelf=adminExecutor.execute(Request.Get(docsCollectionUriCountAndPaging.resolve(links.get("self").asObject().get("href").asString())));" is 147.,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Long Statement,The length of the statement "Response respRhdb=adminExecutor.execute(Request.Get(docsCollectionUriCountAndPaging.resolve(links.get("rh:db").asObject().get("href").asString())));" is 148.,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Long Statement,The length of the statement "Response respNext=adminExecutor.execute(Request.Get(docsCollectionUriCountAndPaging.resolve(links.get("next").asObject().get("href").asString())));" is 147.,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Long Statement,The length of the statement "Response respPrevious=adminExecutor.execute(Request.Get(docsCollectionUriCountAndPaging.resolve(links.get("previous").asObject().get("href").asString())));" is 155.,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Long Statement,The length of the statement "Response respFirst=adminExecutor.execute(Request.Get(dbUriPaging.resolve(links.get("first").asObject().get("href").asString())));" is 129.,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Long Statement,The length of the statement "Response respLast=adminExecutor.execute(Request.Get(dbUriPaging.resolve(links.get("last").asObject().get("href").asString())));" is 127.,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Magic Number,The method contains a magic number: 2,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Magic Number,The method contains a magic number: 10,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionCountAndPaging,Magic Number,The method contains a magic number: 5,90
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionPaging,Long Statement,The length of the statement "Response respSelf=adminExecutor.execute(Request.Get(docsCollectionUriPaging.resolve(links.get("self").asObject().get("href").asString())));" is 139.,169
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionPaging,Long Statement,The length of the statement "Response respDb=adminExecutor.execute(Request.Get(docsCollectionUriPaging.resolve(links.get("rh:db").asObject().get("href").asString())));" is 138.,169
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionPaging,Long Statement,The length of the statement "Response respNext=adminExecutor.execute(Request.Get(docsCollectionUriPaging.resolve(links.get("next").asObject().get("href").asString())));" is 139.,169
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionPaging,Magic Number,The method contains a magic number: 2,169
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionFilter,Magic Number,The method contains a magic number: 2,388
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testGetCollectionFilter,Magic Number,The method contains a magic number: 2,388
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testBinaryProperty,Long Statement,The length of the statement "byte[] data="DqnEq7hiWZ1jHoYf/YJpNHevlGrRmT5V9NGN7daoPYetiTvgeP4C9n4j8Gu5mduhEYzWDFK2a3gO+CvzrDgM3BBFG07fF6qabHXDsGTo92m93QohjGtqn8nkNP6KVnWIcbgBbw==".getBytes();" is 162.,458
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testBinaryProperty,Long Statement,The length of the statement "MongoCollection<Document> coll=MongoClientSingleton.getInstance().getClient().getDatabase(dbName).getCollection(collection1Name);" is 129.,458
SoftInstigate_restheart,org.restheart.test.integration,GetCollectionIT,testBinaryProperty,Magic Number,The method contains a magic number: 200,458
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPostUnauthenticated,Long Statement,The length of the statement "Response resp=unauthExecutor.execute(Request.Post(collection1Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 161.,117
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPostUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Post(collection2Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,117
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutUnauthenticated,Long Statement,The length of the statement "Response resp=unauthExecutor.execute(Request.Put(rootUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 153.,132
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Put(collection1Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 151.,132
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Put(document1Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 149.,132
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Put(collection2Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 151.,132
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Put(document2Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 149.,132
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPatchUnauthenticated,Long Statement,The length of the statement "Response resp=unauthExecutor.execute(Request.Patch(rootUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 155.,163
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPatchUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Patch(collection1Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 153.,163
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPatchUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Patch(document1Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 151.,163
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPatchUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Patch(collection2Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 153.,163
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPatchUnauthenticated,Long Statement,The length of the statement "resp=unauthExecutor.execute(Request.Patch(document2Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 151.,163
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPostAsAdmin,Long Statement,The length of the statement "Response resp=adminExecutor.execute(Request.Post(collection1Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 160.,256
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPostAsAdmin,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Post(collection2Uri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 151.,256
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsAdmin,Long Statement,The length of the statement "Response resp=adminExecutor.execute(Request.Put(rootUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,271
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsAdmin,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,271
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsAdmin,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,271
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsAdmin,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 150.,271
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsPowerUser,Long Statement,The length of the statement "Response resp=user1Executor.execute(Request.Put(rootUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,325
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsPowerUser,Long Statement,The length of the statement "resp=user1Executor.execute(Request.Put(dbUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 141.,325
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsPowerUser,Long Statement,The length of the statement "resp=user1Executor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,325
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsPowerUser,Long Statement,The length of the statement "resp=user1Executor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,325
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPutAsPowerUser,Long Statement,The length of the statement "resp=user1Executor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 150.,325
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPathPefixAndRegexPredicates,Long Statement,The length of the statement "Response resp=user2Executor.execute(Request.Put(dbTmpUri2).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 154.,352
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPathPefixAndRegexPredicates,Long Statement,The length of the statement "resp=user2Executor.execute(Request.Put(dbTmpUri3).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 145.,352
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPathPefixAndRegexPredicates,Long Statement,The length of the statement "resp=user2Executor.execute(Request.Put(collectionTmpUserUri2).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 157.,352
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPathPefixAndRegexPredicates,Long Statement,The length of the statement "check("check path predicate creating user collection " + collectionTmpUserUri2 + " as user2"`resp`HttpStatus.SC_CREATED);" is 121.,352
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPathPefixAndRegexPredicates,Long Statement,The length of the statement "resp=user2Executor.execute(Request.Put(collectionTmpUserUri3).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 157.,352
SoftInstigate_restheart,org.restheart.test.integration,SecurityIT,testPathPefixAndRegexPredicates,Long Statement,The length of the statement "check("check regex predicate creating user collection " + collectionTmpUserUri3 + " as user2"`resp`HttpStatus.SC_CREATED);" is 122.,352
SoftInstigate_restheart,org.restheart.test.integration,DeleteDocumentIT,testDeleteDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteDocumentIT,testDeleteDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteDocumentIT,testDeleteDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 150.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteDocumentIT,testDeleteDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 150.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteDocumentIT,testDeleteDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(documentTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 124.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteDocumentIT,testDeleteDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(documentTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 124.,44
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(addCheckEtag(collectionTmpUri)).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 166.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`"pippoetag"));" is 199.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(collectionTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 126.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{b:2}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`etag));" is 192.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(collectionTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 126.,45
SoftInstigate_restheart,org.restheart.test.integration,PutCollectionIT,testPutCollection,Magic Number,The method contains a magic number: 2,45
SoftInstigate_restheart,org.restheart.test.integration,DeleteDBIT,testDeleteDB,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,44
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionInt,Long Statement,The length of the statement "Response resp1=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 154.,61
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionInt,Long Statement,The length of the statement "Response resp2=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 162.,61
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionInt,Long Statement,The length of the statement "URI collectionTmpUriInt=buildURI("/" + dbTmpName + "/"+ collectionTmpName`new NameValuePair[]{new BasicNameValuePair(DOC_ID_TYPE_QPARAM_KEY`DOC_ID_TYPE.NUMBER.name())});" is 169.,61
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionInt,Long Statement,The length of the statement "Response resp3=adminExecutor.execute(Request.Post(collectionTmpUriInt).bodyString("{_id:100` a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 175.,61
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionInt,Long Statement,The length of the statement "Response resp4=adminExecutor.execute(Request.Get(createdDocUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 133.,61
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionInt,Magic Number,The method contains a magic number: 100,61
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "Response resp1=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 154.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "Response resp2=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 162.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "URI collectionTmpUriInt=buildURI("/" + dbTmpName + "/"+ collectionTmpName`new NameValuePair[]{new BasicNameValuePair(DOC_ID_TYPE_QPARAM_KEY`DOC_ID_TYPE.STRING.name())});" is 169.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "Response resp3=adminExecutor.execute(Request.Post(collectionTmpUriInt).bodyString("{_id:{'$oid':'54c965cbc2e64568e235b711'}` a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 207.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "Response resp4=adminExecutor.execute(Request.Get(createdDocUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 133.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "assertTrue("check created doc content"`content.get("_id").asObject().get("$oid").asString().equals("54c965cbc2e64568e235b711"));" is 128.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "URI collectionTmpUriSearch=buildURI("/" + dbTmpName + "/"+ collectionTmpName`new NameValuePair[]{new BasicNameValuePair("filter"`"{'_id':'54c965cbc2e64568e235b711'}")});" is 169.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "Response resp5=adminExecutor.execute(Request.Get(collectionTmpUriSearch).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 142.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "collectionTmpUriSearch=buildURI("/" + dbTmpName + "/"+ collectionTmpName`new NameValuePair[]{new BasicNameValuePair("filter"`"{'_id':{'$oid':'54c965cbc2e64568e235b711'}}")});" is 174.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testPostCollectionString,Long Statement,The length of the statement "Response resp6=adminExecutor.execute(Request.Get(collectionTmpUriSearch).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 142.,112
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create collection ".concat(DB.concat("/").concat(COLL))`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 133.,187
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testComplexId,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body(body).asString();" is 126.,210
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testComplexId,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("filter"`"{'_id':{'a':1`'b':2}}").queryString("count"`"1").queryString("rep"`"pj").asString();" is 209.,210
SoftInstigate_restheart,org.restheart.test.integration,DocIdTypeIT,testComplexId,Long Statement,The length of the statement "Assert.assertTrue("check doc"`rbody != null && rbody.isObject() && rbody.asObject().get("_size") != null && rbody.asObject().get("_size").isNumber() && rbody.asObject().get("_size").asInt() == 1);" is 196.,210
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 148.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 156.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 154.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 154.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(addCheckEtag(documentTmpUri)).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 168.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`"pippoetag"));" is 201.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Get(documentTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 128.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{b:2}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`etag));" is 194.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Long Statement,The length of the statement "response=adminExecutor.execute(Request.Get(documentTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 128.,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocument,Magic Number,The method contains a magic number: 2,56
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create collection " + DB.concat("/").concat(COLL)`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 127.,106
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocumentWithNotMatchingFilter,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"testPutWithWrongFilter")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{'a':1}").asString();" is 182.,127
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocumentWithNotMatchingFilter,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"testPutWithWrongFilter")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").queryString("filter"`"{'a':2}").body("{'modified':true}").asString();" is 224.,127
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocumentDotNotation,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid1")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ 'doc.number': 1 }").asString();" is 178.,153
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocumentOperators,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid2")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ '$push': {'array': 'a'}` '$inc': { 'count': 100 } }").asString();" is 212.,194
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocumentOperators,Long Statement,The length of the statement "Assert.assertEquals("check response status of create test data"`org.apache.http.HttpStatus.SC_BAD_REQUEST`resp.getStatus());" is 124.,194
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocumentOperators,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid2")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ '$currentDate': {'timestamp': { '$type': 'date' }}}").asString();" is 212.,194
SoftInstigate_restheart,org.restheart.test.integration,PutDocumentIT,testPutDocumentOperators,Long Statement,The length of the statement "Assert.assertEquals("check response status of create test data with $currentDate operator"`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 147.,194
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,testGetAggregationPipeline,Long Statement,The length of the statement "String aggregationsMetadata="{\"aggrs\": [" + "{" + "\"type\":\"aggregation\"`"+ "\"uri\":\"" + uri + "\"`"+ "\"stages\":"+ "["+ "{\"$match\": { \"name\": { \"$exists\": true}}}`"+ "{\"$group\":"+ "{\"_id\": \"$name\"` \"value\": {\"$avg\": \"$age\"} }}"+ "]"+ "}]}";" is 267.,54
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,testGetAggregationPipelineDotNotation,Long Statement,The length of the statement "String aggregationsMetadata="{\"aggrs\": [" + "{" + "\"type\":\"aggregation\"`"+ "\"uri\":\"" + uri + "\"`"+ "\"stages\":"+ "["+ "{\"$match\": { \"obj.name\": { \"$exists\": true}}}`"+ "{\"$group\":"+ "{\"_id\": \"$obj.name\"` \"value\": {\"$avg\": \"$obj.age\"} }}"+ "]"+ "}]}";" is 279.,79
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,testGetMapReduce,Long Statement,The length of the statement "String aggregationsMetadata="{\"aggrs\": [" + "{" + "\"type\":\"mapReduce\"`"+ "\"uri\":\"" + uri + "\"`"+ "\"map\": \"function() { emit(this.name` this.age); }\""+ "`"+ "\"reduce\":\"function(key` values) { return Array.avg(values); }\""+ "`"+ "\"query\":{\"name\":{\"$exists\":true}}"+ "}]}";" is 294.,104
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,testGetMapReduceWithVariable,Long Statement,The length of the statement "String aggregationsMetadata="{\"aggrs\": [" + "{" + "\"type\":\"mapReduce\""+ "`"+ "\"uri\": \"" + uri + "\"`"+ "\"map\": \"function() { var minage = JSON.parse($vars).minage; if (this.age > minage ) { emit(this.name` this.age); }; }\"`"+ "\"reduce\":\"function(key` values) { return Array.avg(values); }\""+ "`"+ "\"query\":{\"name\":{\"$var\":\"name\"}}"+ "}]}";" is 364.,126
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,testGetMapReduceWithVariable,Long Statement,The length of the statement "URI aggrUri=buildURI("/" + dbTmpName + "/"+ collectionTmpName+ "/"+ _AGGREGATIONS+ "/"+ uri`new NameValuePair[]{new BasicNameValuePair("avars"`"{\"name\": \"a\"` \"minage\": 20}")});" is 182.,126
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,testUnboundVariable,Long Statement,The length of the statement "String aggregationsMetadata="{\"aggrs\": [" + "{" + "\"type\":\"mapReduce\""+ "`"+ "\"uri\": \"" + uri + "\"`"+ "\"map\": \"function() { emit(this.name` this.age) }\""+ "`"+ "\"reduce\":\"function(key` values) { return Array.avg(values) }\""+ "`"+ "\"query\":{\"name\":{\"$var\":\"name\"}}"+ "}]}";" is 298.,213
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,createTmpCollection,Long Statement,The length of the statement "Response resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 153.,252
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,createTmpCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{descr:\"temp coll\"}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 168.,252
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,createMetadataAndTestData,Long Statement,The length of the statement "String[] data=new String[]{"{\"name\":\"a\"`\"age\":10}"`"{\"name\":\"a\"`\"age\":20}"`"{\"name\":\"a\"`\"age\":30}"`"{\"name\":\"b\"`\"age\":40}"`"{\"name\":\"b\"`\"age\":50}"`"{\"name\":\"b\"`\"age\":60}"`"{\"obj\":{\"name\":\"x\"`\"age\":10}}"`"{\"obj\":{\"name\":\"x\"`\"age\":20}}"`"{\"obj\":{\"name\":\"y\"`\"age\":10}}"`"{\"obj\":{\"name\":\"y\"`\"age\":20}}"};" is 368.,262
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,createMetadataAndTestData,Long Statement,The length of the statement "Response resp=adminExecutor.execute(Request.Post(collectionTmpUri).bodyString(datum`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 160.,262
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,createMetadataAndTestData,Long Statement,The length of the statement "Response resp=adminExecutor.execute(Request.Patch(collectionTmpUri).bodyString(aggregationsMetadata`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`etag));" is 216.,262
SoftInstigate_restheart,org.restheart.test.integration,GetAggregationIT,_testGetAggregation,Magic Number,The method contains a magic number: 2,303
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDBPaging,Long Statement,The length of the statement "Response respSelf=adminExecutor.execute(Request.Get(dbUriPaging.resolve(links.get("self").asObject().get("href").asString())));" is 127.,78
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDBPaging,Long Statement,The length of the statement "Response respRoot=adminExecutor.execute(Request.Get(dbUriPaging.resolve(links.get("rh:root").asObject().get("href").asString())));" is 130.,78
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDBPaging,Long Statement,The length of the statement "Response respNext=adminExecutor.execute(Request.Get(dbUriPaging.resolve(links.get("next").asObject().get("href").asString())));" is 127.,78
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDBPaging,Long Statement,The length of the statement "Response respFirst=adminExecutor.execute(Request.Get(dbUriPaging.resolve(links.get("first").asObject().get("href").asString())));" is 129.,78
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDBPaging,Long Statement,The length of the statement "Response respLast=adminExecutor.execute(Request.Get(dbUriPaging.resolve(links.get("last").asObject().get("href").asString())));" is 127.,78
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDBPaging,Magic Number,The method contains a magic number: 3,78
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDBPaging,Magic Number,The method contains a magic number: 3,78
SoftInstigate_restheart,org.restheart.test.integration,GetDBIT,testGetDb,Long Statement,The length of the statement "assertTrue("check _embedded.rh:coll[0]._links.self to be a json object"`(rhcoll0Links.get("self") instanceof JsonObject));" is 122.,153
SoftInstigate_restheart,org.restheart.test.integration,SecurityAuthTokenIT,testAuthToken,Long Statement,The length of the statement "assertTrue("check not empty array auth token header value not null or empty"`_authToken[0] != null && _authToken[0].getValue() != null && !_authToken[0].getValue().isEmpty());" is 175.,58
SoftInstigate_restheart,org.restheart.test.integration,SecurityAuthTokenIT,testAuthToken,Long Statement,The length of the statement "assertTrue("check not empty array auth token valid value not null or empty"`_authTokenValid[0] != null && _authTokenValid[0].getValue() != null && !_authTokenValid[0].getValue().isEmpty());" is 189.,58
SoftInstigate_restheart,org.restheart.test.integration,SecurityAuthTokenIT,testAuthToken,Long Statement,The length of the statement "assertTrue("check not empty array auth token location not null or empty"`_authTokenLocation[0] != null && _authTokenLocation[0].getValue() != null && !_authTokenLocation[0].getValue().isEmpty());" is 195.,58
SoftInstigate_restheart,org.restheart.test.integration,SecurityAuthTokenIT,testAuthToken,Long Statement,The length of the statement "Response resp2=unauthExecutor.authPreemptive(HTTP_HOST).auth("admin"`_authToken[0].getValue()).execute(Request.Get(rootUri));" is 125.,58
SoftInstigate_restheart,org.restheart.test.integration,SecurityAuthTokenIT,testAuthTokenResourceLocation,Long Statement,The length of the statement "assertTrue("check content type"`entity.getContentType().getValue().equals(Exchange.HAL_JSON_MEDIA_TYPE) || entity.getContentType().getValue().equals(Exchange.JSON_MEDIA_TYPE));" is 176.,104
SoftInstigate_restheart,org.restheart.test.integration,PatchDBIT,testPatchDB,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchDBIT,testPatchDB,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(addCheckEtag(dbTmpUri)).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 160.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchDBIT,testPatchDB,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 146.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchDBIT,testPatchDB,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`"pippoetag"));" is 193.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchDBIT,testPatchDB,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(dbTmpUri).bodyString("{b:2}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`etag));" is 186.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchDBIT,testPatchDB,Magic Number,The method contains a magic number: 2,45
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,createTestData,Long Statement,The length of the statement "String body="{'rels': [" + "{ " + "'ref-field': '$.children.[*]'` "+ "'rel': 'children'` "+ "'role': 'OWNING'` "+ "'target-coll': 'children'` "+ "'type':'MANY_TO_MANY' "+ "}]}";" is 177.,49
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_PARENT)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body(body).asString();" is 132.,49
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create collection ".concat(DB.concat("/").concat(COLL_PARENT))`HttpStatus.SC_CREATED`resp.getStatus());" is 124.,49
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create collection ".concat(DB.concat("/").concat(COLL_CHILDREN))`HttpStatus.SC_CREATED`resp.getStatus());" is 126.,49
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,createTestData,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL_CHILDREN)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'_id': " + i + "}").asString();" is 151.,49
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_PARENT`"parent")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{'children': [0`1`2`3`4`5`6`7`8`9]}").asString();" is 201.,49
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,createTestData,Magic Number,The method contains a magic number: 10,49
SoftInstigate_restheart,org.restheart.test.integration,RelationshipsIT,testGetParent,Long Statement,The length of the statement "Assert.assertTrue("check _links"`rbody != null && rbody.isObject() && rbody.asObject().get("_links") != null && rbody.asObject().get("_links").isObject() && rbody.asObject().get("_links").asObject().get("children") != null && rbody.asObject().get("_links").asObject().get("children").isObject() && rbody.asObject().get("_links").asObject().get("children").asObject().get("href") != null && rbody.asObject().get("_links").asObject().get("children").asObject().get("href").isString());" is 483.,112
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(collectionTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 128.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(addCheckEtag(collectionTmpUri)).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 168.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 154.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`"pippoetag"));" is 201.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(collectionTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 126.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(collectionTmpUri).bodyString("{b:2}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`etag));" is 194.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(collectionTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 126.,45
SoftInstigate_restheart,org.restheart.test.integration,PatchCollectionIT,testPatchCollection,Magic Number,The method contains a magic number: 2,45
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB_REQUIRED)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'etagDocPolicy': 'required'}").asString();" is 156.,52
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create document " + DB_REQUIRED.concat("/").concat(COLL).concat("/docid")`HttpStatus.SC_CREATED`resp.getStatus());" is 135.,52
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_REQUIRED)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'etagDocPolicy': 'required'}").asString();" is 161.,52
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create document " + DB.concat("/").concat(COLL).concat("/docid")`HttpStatus.SC_CREATED`resp.getStatus());" is 126.,52
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateNotRequired,Long Statement,The length of the statement "resp=Unirest.delete(url(DB`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").asString();" is 125.,119
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateNotRequired,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body("{'a':1 }").asString();" is 166.,119
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_REQUIRED`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body("{'a':1 }").asString();" is 175.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_REQUIRED`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").header("If-Match"`"wrong etag").queryString("wm"`"upsert").body("{'a':1 }").asString();" is 207.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "Assert.assertEquals("check response status of update data with wrong etag"`HttpStatus.SC_PRECONDITION_FAILED`resp.getStatus());" is 127.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_REQUIRED`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("checkEtag"`"").queryString("wm"`"upsert").header("If-Match"`etag).body("{'a':1 }").asString();" is 227.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "resp=Unirest.put(url(DB_REQUIRED`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body("{'a':1 }").asString();" is 175.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "resp=Unirest.put(url(DB_REQUIRED`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").header("If-Match"`"wrong etag").queryString("wm"`"upsert").body("{'a':1 }").asString();" is 207.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "Assert.assertEquals("check response status of update data without etag"`HttpStatus.SC_PRECONDITION_FAILED`resp.getStatus());" is 124.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateRequired,Long Statement,The length of the statement "resp=Unirest.put(url(DB_REQUIRED`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("checkEtag"`"").queryString("wm"`"upsert").header("If-Match"`etag).body("{'a':1 }").asString();" is 227.,141
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateEtagQParam,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("checkEtag"`"").queryString("wm"`"insert").body("{'a':1 }").asString();" is 194.,213
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateEtagQParam,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("checkEtag"`"").queryString("wm"`"update").body("{'a':1 }").asString();" is 194.,213
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateEtagQParam,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("checkEtag"`"").queryString("wm"`"update").header("If-Match"`"wrong etag").body("{'a':1 }").asString();" is 226.,213
SoftInstigate_restheart,org.restheart.test.integration,ETagIT,testUpdateEtagQParam,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("checkEtag"`"").queryString("wm"`"update").header("content-type"`"application/json").header("If-Match"`etag).body("{'a':1 }").asString();" is 218.,213
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,setUpClass,Magic Number,The method contains a magic number: 5,480
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Identifier,The length of the field collection1UriRemappedCollection is 32.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Identifier,The length of the field collection2UriRemappedCollection is 32.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Identifier,The length of the field docsCollectionUriCountAndPaging is 31.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Identifier,The length of the field document1UriRemappedCollection is 30.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Identifier,The length of the field document2UriRemappedCollection is 30.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "dbUriPaging=buildURI("/" + dbName`new NameValuePair[]{new BasicNameValuePair("pagesize"`"1")`new BasicNameValuePair("hal"`"f")});" is 129.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "collection1UriRemappedAll=buildURI(REMAPPEDALL + "/" + dbName+ "/"+ collection1Name`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 140.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "collection1UriRemappedDb=buildURI(REMAPPEDDB + "/" + collection1Name`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 125.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "collection2UriRemappedAll=buildURI(REMAPPEDALL + "/" + dbName+ "/"+ collection2Name`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 140.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "collection2UriRemappedDb=buildURI(REMAPPEDDB + "/" + collection2Name`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 125.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "collectionTmpUri=buildURI("/" + dbTmpName + "/"+ collectionTmpName`new NameValuePair[]{new BasicNameValuePair("hal"`"f")`new BasicNameValuePair("wm"`"upsert")});" is 161.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "collectionTmpUserUri2=buildURI("/" + dbTmpName2 + "/"+ collectionTmpUserName2`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 134.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "collectionTmpUserUri3=buildURI("/" + dbTmpName3 + "/"+ collectionTmpUserName2`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 134.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "docsCollectionUri=buildURI("/" + dbName + "/"+ docsCollectionName`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 122.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "docsCollectionUriPaging=buildURI("/" + dbName + "/"+ docsCollectionName`new NameValuePair[]{new BasicNameValuePair("pagesize"`"2")`new BasicNameValuePair("hal"`"f")});" is 167.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "docsCollectionUriCountAndPaging=buildURI("/" + dbName + "/"+ docsCollectionName`new NameValuePair[]{new BasicNameValuePair("count"`null)`new BasicNameValuePair("page"`"2")`new BasicNameValuePair("pagesize"`"2")`new BasicNameValuePair("hal"`"f")});" is 247.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "docsCollectionUriSort=buildURI("/" + dbName + "/"+ docsCollectionName`new NameValuePair[]{new BasicNameValuePair("sort_by"`"surname")`new BasicNameValuePair("hal"`"f")});" is 170.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "docsCollectionUriFilter=buildURI("/" + dbName + "/"+ docsCollectionName`new NameValuePair[]{new BasicNameValuePair("filter"`"{'name':{'$regex':'.*k$'}}")`new BasicNameValuePair("sort_by"`"name")`new BasicNameValuePair("count"`null)`new BasicNameValuePair("hal"`"f")});" is 268.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "indexesUri=buildURI("/" + dbName + "/"+ docsCollectionName+ _INDEXES`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 125.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "indexesUriRemappedAll=buildURI(REMAPPEDALL + "/" + dbName+ "/"+ docsCollectionName+ _INDEXES`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 149.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "indexesUriRemappedDb=buildURI(REMAPPEDDB + "/" + docsCollectionName+ _INDEXES`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 134.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "indexesTmpUri=buildURI("/" + dbTmpName + "/"+ collectionTmpName+ _INDEXES`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 130.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "indexTmpUri=buildURI("/" + dbTmpName + "/"+ collectionTmpName+ _INDEXES+ "/new-index"`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 142.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "documentTmpUri=buildURI("/" + dbTmpName + "/"+ collectionTmpName+ "/"+ documentTmpId`new NameValuePair[]{new BasicNameValuePair("hal"`"f")`new BasicNameValuePair("wm"`"upsert")});" is 179.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document1Uri=buildURI("/" + dbName + "/"+ collection1Name+ "/"+ document1Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 132.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document1UriRemappedAll=buildURI(REMAPPEDALL + "/" + dbName+ "/"+ collection1Name+ "/"+ document1Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 156.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document1UriRemappedDb=buildURI(REMAPPEDDB + "/" + collection1Name+ "/"+ document1Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 141.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document1UriRemappedCollection=buildURI(REMAPPEDREFCOLL1 + "/" + document1Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 133.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document2Uri=buildURI("/" + dbName + "/"+ collection2Name+ "/"+ document2Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 132.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document2UriRemappedAll=buildURI(REMAPPEDALL + "/" + dbName+ "/"+ collection1Name+ "/"+ document2Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 156.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document2UriRemappedDb=buildURI(REMAPPEDDB + "/" + collection2Name+ "/"+ document2Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 141.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createURIs,Long Statement,The length of the statement "document2UriRemappedCollection=buildURI(REMAPPEDREFCOLL2 + "/" + document2Id`new NameValuePair[]{new BasicNameValuePair("hal"`"f")});" is 133.,508
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createTestData,Long Statement,The length of the statement "dbs.upsertCollection(Optional.empty()`Optional.empty()`dbName`collection1Name`METHOD.PUT`false`coll1Props`new ObjectId().toString()`false);" is 139.,759
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createTestData,Long Statement,The length of the statement "dbs.upsertCollection(Optional.empty()`Optional.empty()`dbName`collection2Name`METHOD.PUT`false`coll2Props`new ObjectId().toString()`false);" is 139.,759
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createTestData,Long Statement,The length of the statement "dbs.upsertCollection(Optional.empty()`Optional.empty()`dbName`docsCollectionName`METHOD.PUT`false`docsCollectionProps`new ObjectId().toString()`false);" is 151.,759
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createTestData,Long Statement,The length of the statement "documentDAO.writeDocument(Optional.empty()`Optional.empty()`dbName`collection1Name`METHOD.PUT`WRITE_MODE.UPSERT`Optional.of(new BsonString(document1Id))`Optional.empty()`Optional.empty()`document1Props`new ObjectId().toString()`false);" is 235.,759
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createTestData,Long Statement,The length of the statement "documentDAO.writeDocument(Optional.empty()`Optional.empty()`dbName`collection2Name`METHOD.PUT`WRITE_MODE.UPSERT`Optional.of(new BsonString(document2Id))`Optional.empty()`Optional.empty()`document2Props`new ObjectId().toString()`false);" is 235.,759
SoftInstigate_restheart,org.restheart.test.integration,HttpClientAbstactIT,createTestData,Long Statement,The length of the statement "documentDAO.writeDocument(Optional.empty()`Optional.empty()`dbName`docsCollectionName`METHOD.PUT`WRITE_MODE.UPSERT`Optional.of(new BsonObjectId(new ObjectId()))`Optional.empty()`Optional.empty()`BsonDocument.parse(doc)`new ObjectId().toString()`false);" is 252.,759
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostCreate,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("[{'seq': 1 }`{'seq': 2 }`{'seq': 3 }`{'seq': 4 }]").asString();" is 173.,72
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostCreate,Long Statement,The length of the statement "Assert.assertTrue("check rh:result element links json object to have rh:newdoc array with 4 elements"`newdoc != null && newdoc.isArray() && newdoc.asArray().size() == 4);" is 170.,72
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostCreate,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the 'inserted' numeric property equal to 4"`inserted != null && inserted.isNumber() && inserted.asInt() == 4);" is 160.,72
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostCreate,Magic Number,The method contains a magic number: 4,72
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostCreate,Magic Number,The method contains a magic number: 4,72
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostUpdate,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("[{'_id': 1 }`{'_id': 2 }`{'_id': 3 }`{'_id': 4 }]").asString();" is 173.,133
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostUpdate,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"update").body("[{'_id': 1 }`{'_id': 2 }`{'_id': 3 }`{'_id': 4 }]").asString();" is 200.,133
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostUpdate,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the 'modified' numeric property equal to 4"`modified != null && modified.isNumber() && modified.asInt() == 4);" is 160.,133
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostUpdate,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the 'matched' numeric property equal to 4"`matched != null && matched.isNumber() && matched.asInt() == 4);" is 156.,133
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostUpdate,Magic Number,The method contains a magic number: 4,133
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPostUpdate,Magic Number,The method contains a magic number: 4,133
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("[{'tobedeleted':true }`{'tobedeleted':true }`{'tobedeleted':true }`{'tobedeleted':false }]").asString();" is 214.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).queryString("filter"`"{'tobedeleted':{'$exists': true}}").queryString("count"`"").queryString("np"`"").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 175.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the '_size' numeric property equal to 4"`_size != null && _size.isNumber() && _size.asInt() == 4);" is 148.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "resp=Unirest.delete(url(DB`COLL`"*")).queryString("filter"`"{'tobedeleted':true}").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 124.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the 'deleted' numeric property equal to 3"`deleted != null && deleted.isNumber() && deleted.asInt() == 3);" is 156.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).queryString("filter"`"{'tobedeleted':{'$exists': true}}").queryString("count"`"").queryString("np"`"").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 175.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "Assert.assertTrue("check count request to have the 'count' numeric property equal to 1"`deleted != null && deleted.isNumber() && deleted.asInt() == 3);" is 151.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the '_size' numeric property equal to 1"`count != null && count.isNumber() && count.asInt() == 1);" is 148.,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Magic Number,The method contains a magic number: 4,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Magic Number,The method contains a magic number: 3,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkDelete,Magic Number,The method contains a magic number: 3,213
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("[{'tobepatched':true }`{'tobepatched':true }`{'tobepatched':true }`{'tobepatched':false }]").asString();" is 214.,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).queryString("filter"`"{'tobepatched':{'$exists': true}}").queryString("count"`"").queryString("np"`"").basicAuth(ADMIN_ID`ADMIN_PWD).asString();" is 175.,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the '_size' numeric property equal to 4"`_size != null && _size.isNumber() && _size.asInt() == 4);" is 148.,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL`"*")).queryString("filter"`"{'tobepatched':true}").basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'newprop': 0}").asString();" is 188.,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the 'modified' numeric property equal to 3"`modified != null && modified.isNumber() && modified.asInt() == 3);" is 160.,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Long Statement,The length of the statement "Assert.assertTrue("check rhresult element to have the 'matched' numeric property equal to 3"`matched != null && matched.isNumber() && matched.asInt() == 3);" is 156.,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Long Statement,The length of the statement "Assert.assertTrue("check patched doc to have the 'newprop' property"`newprop != null && newprop.isNumber() && newprop.asInt() == 0);" is 132.,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Magic Number,The method contains a magic number: 4,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Magic Number,The method contains a magic number: 3,322
SoftInstigate_restheart,org.restheart.test.integration,BulkRequestsIT,testBulkPatch,Magic Number,The method contains a magic number: 3,322
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"" + i)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{'n': " + i + "}").asString();" is 173.,50
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,createTestData,Magic Number,The method contains a magic number: 10,50
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetRoot,Long Statement,The length of the statement "Assert.assertTrue(body.asDocument().get("_embedded").asArray().size() == body.asDocument().get("_returned").asNumber().intValue());" is 131.,87
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetRootNp,Long Statement,The length of the statement "resp=Unirest.get(HTTP_HOST.toURI()).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("np"`"true").asString();" is 126.,130
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetDb,Long Statement,The length of the statement "Assert.assertTrue(body.asDocument().get("_embedded").asArray().size() == body.asDocument().get("_returned").asNumber().intValue());" is 131.,160
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetColl,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("count"`"true").asString();" is 124.,233
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetColl,Magic Number,The method contains a magic number: 10,233
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetColl,Magic Number,The method contains a magic number: 10,233
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetCollNpEmptyResultSet,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("np"`"true").queryString("page"`"2").asString();" is 145.,315
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetIndexes,Long Statement,The length of the statement "Assert.assertTrue(body.asDocument().get("_embedded").asArray().size() == body.asDocument().get("_returned").asNumber().intValue());" is 131.,346
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetDoc,Magic Number,The method contains a magic number: 3,386
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetDocNp,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL`"1")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("np"`"true").asString();" is 125.,410
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetDocNp,Magic Number,The method contains a magic number: 3,410
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetError,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("page"`"string").asString();" is 125.,435
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetDocError,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL`"1")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("page"`"string").asString();" is 129.,470
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testGetErrorNp,Long Statement,The length of the statement "resp=Unirest.get(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("np"`"true").queryString("page"`"string").asString();" is 150.,505
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregation,Long Statement,The length of the statement "final String _aggrs="{ \"aggrs\" : [ " + " { " + " \"stages\" : [ "+ " { \"$match\" : { \"n\" : { \"$gt\" : 4 } } }"+ " ]`\n"+ " \"type\" : \"pipeline\"`"+ " \"uri\" : \"test\""+ " }"+ " ]"+ "}";" is 195.,542
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregation,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body(_aggrs).asString();" is 129.,542
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregation,Long Statement,The length of the statement "final String _aggrs2="{ \"aggrs\" : [ " + " { " + " \"stages\" : [ "+ " { \"$match\" : { \"n\" : { \"$gt\" : 1000 } } }"+ " ]`\n"+ " \"type\" : \"pipeline\"`"+ " \"uri\" : \"test\""+ " }"+ " ]"+ "}";" is 199.,542
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregation,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body(_aggrs2).asString();" is 130.,542
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregation,Magic Number,The method contains a magic number: 5,542
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregation,Magic Number,The method contains a magic number: 5,542
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregationEmpty,Long Statement,The length of the statement "final String _aggrs2="{ \"aggrs\" : [ " + " { " + " \"stages\" : [ "+ " { \"$match\" : { \"n\" : { \"$gt\" : 1000 } } }"+ " ]`\n"+ " \"type\" : \"pipeline\"`"+ " \"uri\" : \"test\""+ " }"+ " ]"+ "}";" is 199.,643
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testAggregationEmpty,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body(_aggrs2).asString();" is 130.,643
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testBulkPost,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").header("content-type"`"application/json").body("[{'a':1}`{'a':2}]").asString();" is 165.,697
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testBulkPost,Magic Number,The method contains a magic number: 2,697
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testBulkPost,Magic Number,The method contains a magic number: 2,697
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testBulkPost,Magic Number,The method contains a magic number: 5,697
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testBulkPatch,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL`"*")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("rep"`"pj").queryString("filter"`"{'n': {'$gt':5}}").header("content-type"`"application/json").body("{'b': 1}]").asString();" is 203.,743
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testBulkPatch,Magic Number,The method contains a magic number: 4,743
SoftInstigate_restheart,org.restheart.test.integration,PlainJsonRepIT,testBulkPatch,Magic Number,The method contains a magic number: 4,743
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create schema store " + DB.concat("/").concat(SCHEMA_STORE)`HttpStatus.SC_CREATED`resp.getStatus());" is 121.,55
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`SCHEMA_STORE`"basic")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body(getResourceFile("schemas/basic.json")).asString();" is 201.,55
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`SCHEMA_STORE`"parent")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body(getResourceFile("schemas/parent.json")).asString();" is 203.,55
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`SCHEMA_STORE`"child")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body(getResourceFile("schemas/child.json")).asString();" is 201.,55
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_BASIC)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ 'jsonSchema': { 'schemaId': 'basic'` 'skipNotSupported': true } }").asString();" is 223.,55
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,createTestData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_CHILD)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ 'jsonSchema': { 'schemaId': 'child'` 'skipNotSupported': true } }").asString();" is 223.,55
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testGetSchamaStore,Long Statement,The length of the statement "Assert.assertTrue("schema store contains 3 schemas"`rbody.asObject().get("_returned") != null && rbody.asObject().get("_returned").isNumber() && rbody.asObject().get("_returned").asInt() == 3);" is 193.,124
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testGetSchamaStore,Magic Number,The method contains a magic number: 3,124
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPutSchemaWithBsonType,Long Statement,The length of the statement "resp=Unirest.put(url(DB`SCHEMA_STORE`"SchemaWithBsonType")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body(getResourceFile("schemas/schemaWithBsonType.json")).asString();" is 227.,163
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPutSchemaWithDollarAsObjectPropertyPrefix,Long Statement,The length of the statement "resp=Unirest.put(url(DB`SCHEMA_STORE`"SchemaWithDollarAsObjectPropertyPrefix")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body(getResourceFile("schemas/schemaWithDollarAsObjectPropertyPrefix.json")).asString();" is 267.,179
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,_testPostData,Long Statement,The length of the statement "resp=Unirest.post(url(DB`coll)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 'ciao'` 's': 'a' }").asString();" is 148.,216
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,_testPostData,Long Statement,The length of the statement "resp=Unirest.post(url(DB`coll)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 1` 's': 1 }").asString();" is 141.,216
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,_testPostData,Long Statement,The length of the statement "resp=Unirest.post(url(DB`coll)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'s': 'string' }").asString();" is 140.,216
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,_testPostData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`coll`"doc")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body("{'n': 1` 's': 'string' }").asString();" is 180.,216
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,_testPostData,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`coll`"doc")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 'string' }").asString();" is 147.,216
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,_testPostData,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`coll`"doc")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 100 }").asString();" is 142.,216
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPostInvalidDueToAdditionalProperty,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL_BASIC)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'s': 'string'` 'n':1` 'other': 2 }").asString();" is 165.,271
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPostDataDotNotation,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL_BASIC)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj.s': 'string' }").asString();" is 173.,286
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPostDataDotNotation,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL_BASIC)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj.s': 1 }").asString();" is 166.,286
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPostDataDotNotation,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL_BASIC)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj.a': 1 }").asString();" is 166.,286
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPostIncompleteDataDotNotation,Long Statement,The length of the statement "resp=Unirest.post(url(DB`COLL_BASIC)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj': {} }").asString();" is 165.,322
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPutDataDotNotation,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_BASIC`new ObjectId().toString())).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").queryString("wm"`"upsert").body("{'n': 1` 's': 'string'` 'obj.s': 'string' }").asString();" is 225.,337
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPutDataDotNotation,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_BASIC`new ObjectId().toString())).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj.s': 1 }").asString();" is 191.,337
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPutDataDotNotation,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_BASIC`new ObjectId().toString())).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj.a': 1 }").asString();" is 191.,337
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPatchData,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_BASIC`id)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj.s': 'string' }").asString();" is 202.,372
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPatchData,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL_BASIC`id)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'obj.s': 'new string' }").asString();" is 158.,372
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPatchData,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL_BASIC`id)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'other.s': 'new string' }").asString();" is 160.,372
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPatchData,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL_BASIC`id)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'obj.s': 1 }").asString();" is 147.,372
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPatchIncompleteObject,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL_BASIC`id)).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{'n': 1` 's': 'string'` 'obj.s': 'string' }").asString();" is 202.,418
SoftInstigate_restheart,org.restheart.test.integration,JsonSchemaCheckerIT,testPatchIncompleteObject,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL_BASIC`id)).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{'$unset': {'obj.s': true} }").asString();" is 162.,418
SoftInstigate_restheart,org.restheart.test.integration,PutDBIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,45
SoftInstigate_restheart,org.restheart.test.integration,PutDBIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(addCheckEtag(dbTmpUri)).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 158.,45
SoftInstigate_restheart,org.restheart.test.integration,PutDBIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,45
SoftInstigate_restheart,org.restheart.test.integration,PutDBIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`"pippoetag"));" is 191.,45
SoftInstigate_restheart,org.restheart.test.integration,PutDBIT,testPutCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{b:2}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`etag));" is 184.,45
SoftInstigate_restheart,org.restheart.test.integration,PutDBIT,testPutCollection,Magic Number,The method contains a magic number: 2,45
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 150.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(documentTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 126.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(addCheckEtag(documentTmpUri)).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 166.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(documentTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`"pippoetag"));" is 199.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(documentTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 124.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Patch(documentTmpUri).bodyString("{b:2}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE).addHeader(Headers.IF_MATCH_STRING`etag));" is 192.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(documentTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 124.,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocument,Magic Number,The method contains a magic number: 2,56
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,createTestData,Long Statement,The length of the statement "Assert.assertEquals("create collection " + DB.concat("/").concat(COLL)`org.apache.http.HttpStatus.SC_CREATED`resp.getStatus());" is 127.,110
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentDotNotation,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid1")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ 'array': [] }").asString();" is 174.,131
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentDotNotation,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL`"docid1")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{ 'doc.number': 1` 'array.0': {'string': 'ciao'} }").asString();" is 184.,131
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentDotNotation,Long Statement,The length of the statement "Assert.assertTrue("check the array element to have the 'string' property"`string != null && string.isString() && string.asString().equals("ciao"));" is 147.,131
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentOperators,Long Statement,The length of the statement "resp=Unirest.put(url(DB`COLL`"docid2")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ }").asString();" is 162.,199
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentOperators,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL`"docid2")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{ '$push': {'array': 'a'}` '$inc': { 'count': 100 }` '$currentDate': {'timestamp': true } }").asString();" is 225.,199
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentOperators,Long Statement,The length of the statement "Assert.assertTrue("check data to have the 'array' array with one element"`array != null && array.isArray() && array.asArray().size() == 1);" is 139.,199
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentOperators,Long Statement,The length of the statement "Assert.assertTrue("check array element to be the string 'a'"`element != null && element.isString() && element.asString().equals("a"));" is 134.,199
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentOperators,Magic Number,The method contains a magic number: 100,199
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentIssue232,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL`"issue232")).basicAuth(ADMIN_ID`ADMIN_PWD).queryString("wm"`"upsert").header("content-type"`"application/json").body("{ '$addToSet':{ 'addresses':{ 'addressType' : 'N'` 'line2':'line 2' } } }").asString();" is 236.,268
SoftInstigate_restheart,org.restheart.test.integration,PatchDocumentIT,testPatchDocumentIssue232,Long Statement,The length of the statement "resp=Unirest.patch(url(DB`COLL`"issue232")).basicAuth(ADMIN_ID`ADMIN_PWD).header("content-type"`"application/json").body("{ '$addToSet':{ 'addresses':{ 'addressType' : 'N'` 'line2':'line 2' } } }").asString();" is 209.,268
SoftInstigate_restheart,org.restheart.test.integration,PutIndexIT,testPutIndex,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,51
SoftInstigate_restheart,org.restheart.test.integration,PutIndexIT,testPutIndex,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,51
SoftInstigate_restheart,org.restheart.test.integration,PutIndexIT,testPutIndex,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(indexTmpUri).bodyString("{ keys: {a:1`b:2}` ops: { name: \"ciao\"} }"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 185.,51
SoftInstigate_restheart,org.restheart.test.integration,PutIndexIT,testPutIndex,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(indexesTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 123.,51
SoftInstigate_restheart,org.restheart.test.integration,PutIndexIT,testPutIndex,Magic Number,The method contains a magic number: 2,51
SoftInstigate_restheart,org.restheart.test.integration,PutIndexIT,testPutIndex,Magic Number,The method contains a magic number: 2,51
SoftInstigate_restheart,org.restheart.test.integration,DeleteCollectionIT,testDeleteCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(dbTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 144.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteCollectionIT,testDeleteCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Put(collectionTmpUri).bodyString("{a:1}"`halCT).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 152.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteCollectionIT,testDeleteCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(collectionTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 126.,44
SoftInstigate_restheart,org.restheart.test.integration,DeleteCollectionIT,testDeleteCollection,Long Statement,The length of the statement "resp=adminExecutor.execute(Request.Get(collectionTmpUri).addHeader(Headers.CONTENT_TYPE_STRING`Exchange.HAL_JSON_MEDIA_TYPE));" is 126.,44
SoftInstigate_restheart,org.restheart.test.performance,LoadGetPT,dbdirect,Long Statement,The length of the statement "data=dbs.getCollectionData(null`Optional.empty()`db`coll`page`pagesize`null`BsonDocument.parse(filter)`null`null`EAGER_CURSOR_ALLOCATION_POLICY.NONE);" is 150.,100
SoftInstigate_restheart,org.restheart.test.performance,LoadGetPT,getPagesRandomly,Magic Number,The method contains a magic number: 10000,236
SoftInstigate_restheart,org.restheart.test.performance,LoadPutPT,postWitId,Long Statement,The length of the statement "resp=req.header("content-type"`"application/json").body("{'_id': {'$oid': '" + new ObjectId().toString() + "'}` 'nanostamp': "+ System.nanoTime()+ "}").asString();" is 163.,84
SoftInstigate_restheart,org.restheart.test.performance,LoadPutPT,dbdirect,Long Statement,The length of the statement "Documents.get().writeDocument(Optional.empty()`Optional.empty()`db`coll`METHOD.POST`WRITE_MODE.UPSERT`Optional.empty()`Optional.empty()`Optional.empty()`content`null`false);" is 173.,165
SoftInstigate_restheart,org.restheart.test.performance,AbstractPT,prepare,Complex Conditional,The conditional expression url != null && id != null && pwd != null is complex.,77
SoftInstigate_restheart,org.restheart.test.performance,AbstractPT,prepare,Magic Number,The method contains a magic number: 8080,77
SoftInstigate_restheart,org.restheart.test.plugins.initializers,ExtraJwtVerifier,init,Long Statement,The length of the statement "var pr=registry.getAuthMechanisms().stream().filter(_am -> "jwtAuthenticationMechanism".equals(_am.getName())).findFirst();" is 123.,55
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,WriteResultInterceptor,handle,Long Statement,The length of the statement "resp.append("oldData"`response.getDbOperationResult().getOldData() == null ? new BsonNull() : response.getDbOperationResult().getOldData());" is 140.,38
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,WriteResultInterceptor,handle,Long Statement,The length of the statement "resp.append("newData"`response.getDbOperationResult().getNewData() == null ? new BsonNull() : response.getDbOperationResult().getNewData());" is 140.,38
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,WriteResultInterceptor,resolve,Long Statement,The length of the statement "return request.isHandledBy("mongo") && !request.isGet() && "xcoll".equals(request.getCollectionName())&& response.getDbOperationResult() != null;" is 145.,58
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,EchoProxyRequestInterceptor,handle,Long Statement,The length of the statement "request.getHeaders().add(HttpString.tryFromString("header")`"added by echoProxyRequestInterceptor " + request.getPath());" is 121.,56
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,EchoAsyncResponseInterceptor,handle,Long Statement,The length of the statement "scheduler.schedule(() -> LOGGER.info("This log message is written 2 seconds after response by echoAsyncResponseInterceptor")`2`TimeUnit.SECONDS);" is 145.,52
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,EchoAsyncResponseInterceptor,handle,Magic Number,The method contains a magic number: 2,52
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,SecretHider,resolve,Long Statement,The length of the statement "return request.isHandledBy("mongo") && !request.isAccountInRole("admin") && "/coll".equals(request.getCollectionName())&& (request.isPost() || request.isPatch() || request.isPut());" is 181.,60
SoftInstigate_restheart,org.restheart.test.plugins.interceptors,EchoProxyResponseInterceptor,handle,Long Statement,The length of the statement "response.getHeaders().add(HttpString.tryFromString("header")`"added by echoProxyResponseInterceptor " + request.getPath());" is 123.,62
SoftInstigate_restheart,org.restheart.test.plugins.services,EchoService,getTruncatedContent,Magic Number,The method contains a magic number: 1024,114
SoftInstigate_restheart,org.restheart.test.plugins.services,EchoService,getTruncatedContent,Magic Number,The method contains a magic number: 1023,114
SoftInstigate_restheart,org.restheart.test.plugins.services,FunctionalService,ok,Magic Number,The method contains a magic number: 201,52
SoftInstigate_restheart,org.restheart.test.plugins.services,FunctionalService,error,Magic Number,The method contains a magic number: 500,56
