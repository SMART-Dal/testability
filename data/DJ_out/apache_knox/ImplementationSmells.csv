Project Name,Package Name,Type Name,Method Name,Implementation Smell,Cause of the Smell,Method start line no
apache_knox,org.apache.knox.gateway.webappsec.filter,CSRFPreventionFilter,init,Long Identifier,The length of the field CUSTOM_METHODS_TO_IGNORE_PARAM is 30.,41
apache_knox,org.apache.knox.gateway.webappsec.filter,CSRFPreventionFilter,doFilter,Long Statement,The length of the statement "((HttpServletResponse)response).sendError(HttpServletResponse.SC_BAD_REQUEST`"Missing Required Header for Vulnerability Protection");" is 133.,56
apache_knox,org.apache.knox.gateway.webappsec,XContentTypeOptionsFilterTest,testDefaultOptionsValue,Long Statement,The length of the statement "Assert.assertEquals(XContentTypeOptionsFilter.X_CONTENT_TYPE_OPTIONS_HEADER + " value incorrect."`expectedDefaultValue`options);" is 128.,44
apache_knox,org.apache.knox.gateway.webappsec,StrictTransportFilterTest,testConfiguredOptionsValue,Long Statement,The length of the statement "Assert.assertEquals("Options value incorrect should be max-age=31536010; includeSubDomains but is: " + options`"max-age=31536010; includeSubDomains"`options);" is 158.,74
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Complex Method,Cyclomatic complexity of the method is 9,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Identifier,The length of the field XFRAME_OPTIONS_FILTER_CLASSNAME is 31.,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Identifier,The length of the field XCONTENT_TYPE_OPTIONS_FILTER_CLASSNAME is 38.,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Identifier,The length of the field XSS_PROTECTION_FILTER_CLASSNAME is 31.,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Identifier,The length of the field STRICT_TRANSPORT_FILTER_CLASSNAME is 33.,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Statement,The length of the statement "resource.addFilter().name(getName() + XFRAME_OPTIONS_SUFFIX).role(getRole()).impl(XFRAME_OPTIONS_FILTER_CLASSNAME).params(params);" is 130.,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Statement,The length of the statement "resource.addFilter().name(getName() + XCONTENT_TYPE_OPTIONS_SUFFIX).role(getRole()).impl(XCONTENT_TYPE_OPTIONS_FILTER_CLASSNAME).params(params);" is 144.,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Statement,The length of the statement "resource.addFilter().name(getName() + XSS_PROTECTION_SUFFIX).role(getRole()).impl(XSS_PROTECTION_FILTER_CLASSNAME).params(params);" is 130.,71
apache_knox,org.apache.knox.gateway.webappsec.deploy,WebAppSecContributor,contributeFilter,Long Statement,The length of the statement "resource.addFilter().name(getName() + STRICT_TRANSPORT_SUFFIX).role(getRole()).impl(STRICT_TRANSPORT_FILTER_CLASSNAME).params(params);" is 134.,71
apache_knox,org.apache.knox.examples,WordCount,main,Magic Number,The method contains a magic number: 2,70
apache_knox,org.apache.knox.examples,WordCount,main,Magic Number,The method contains a magic number: 2,70
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,getReportGenerationPeriod,Long Identifier,The length of the field PARAM_REPORT_GENERATION_PERIOD is 30.,110
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,getReportGenerationPeriod,Long Identifier,The length of the field DEFAULT_REPORT_GENERATION_PERIOD is 32.,110
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,getReportingTargetFolder,Long Identifier,The length of the field PARAM_REPORT_GENERATION_TARGET_FOLDER is 37.,114
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,getReportingTargetFolder,Long Statement,The length of the statement "return StringUtils.isBlank(targetFolder) ? configuration.getProperty(PARAM_REPORT_GENERATION_TARGET_FOLDER) : targetFolder;" is 123.,114
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,isReportingEngineEnabled,Long Statement,The length of the statement "return Boolean.parseBoolean(configuration.getProperty(REPORT_GENERATION_PREFIX + engineType + PARAM_ENABLED_POSTFIX`"false"));" is 126.,119
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,getUseCaseTopology,Long Identifier,The length of the field PARAM_USE_CASE_TOPOLOGY_POSTFIX is 31.,129
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,getUseCaseTopology,Long Statement,The length of the statement "return configuration.getProperty(USE_CASE_PREFIX + useCase + PARAM_USE_CASE_TOPOLOGY_POSTFIX+ topologyType`defaultUseCaseMap.get(useCase).get(topologyType));" is 157.,129
apache_knox,org.apache.knox.gateway.performance.test,PerformanceTestConfiguration,getUseCaseUrl,Long Statement,The length of the statement "return getGatewayUrl() + URL_PATH_SEPARATOR + getGatewayPath()+ URL_PATH_SEPARATOR+ getUseCaseTopology(useCase`topologyType);" is 125.,133
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenUseCaseRunner,execute,Long Statement,The length of the statement "final long testDuration=Long.parseLong(configuration.getUseCaseParam(getUseCaseName()`KnoxTokenWorkerThread.PARAM_DURATION_IN_SECONDS));" is 136.,51
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenUseCaseRunner,execute,Long Statement,The length of the statement "final long upperBound=Long.parseLong(configuration.getUseCaseParam(getUseCaseName()`KnoxTokenWorkerThread.PARAM_REQUEST_DELAY_UPPERBOUND));" is 139.,51
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenUseCaseRunner,execute,Magic Number,The method contains a magic number: 2,51
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenUseCaseRunner,execute,Magic Number,The method contains a magic number: 10,51
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenUseCaseRunner,execute,Magic Number,The method contains a magic number: 10,51
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,run,Long Identifier,The length of the field PARAM_REQUEST_DELAY_LOWERBOUND is 30.,66
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,run,Long Identifier,The length of the field PARAM_REQUEST_DELAY_UPPERBOUND is 30.,66
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,run,Long Statement,The length of the statement "final KnoxSession gatewayKnoxSession=KnoxSession.login(configuration.getUseCaseUrl(USE_CASE_NAME`"gateway")`configuration.getGatewayUser()`configuration.getGatewayPassword());" is 175.,66
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,run,Long Statement,The length of the statement "final KnoxSession tokenBasedKnoxSession=KnoxSession.login(configuration.getUseCaseUrl(USE_CASE_NAME`"tokenbased")`configuration.getGatewayUser()`configuration.getGatewayPassword());" is 181.,66
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,executeAction,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@11ec0ee9,94
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,calculateSleepTime,Long Statement,The length of the statement "final long sleepTime=ThreadLocalRandom.current().nextLong(KnoxTokenAction.ACQUIRE == this.action ? lowerBound : lowerBound * 2`KnoxTokenAction.ACQUIRE == this.action ? upperBound : upperBound * 2);" is 197.,121
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,calculateSleepTime,Magic Number,The method contains a magic number: 2,121
apache_knox,org.apache.knox.gateway.performance.test.knoxtoken,KnoxTokenWorkerThread,calculateSleepTime,Magic Number,The method contains a magic number: 2,121
apache_knox,org.apache.knox.gateway.performance.test.reporting,GatewayMetricsReporter,GatewayMetricsReporter,Long Identifier,The length of the field TOKEN_STATE_STATISTICS_OBJECT_NAME is 34.,59
apache_knox,org.apache.knox.gateway.performance.test.reporting,GatewayMetricsReporter,start,Long Statement,The length of the statement "executor.scheduleAtFixedRate(() -> generateReports(mbeanServerConnection)`configuration.getReportGenerationPeriod()`configuration.getReportGenerationPeriod()`TimeUnit.SECONDS);" is 176.,73
apache_knox,org.apache.knox.gateway.performance.test.reporting,GatewayMetricsReporter,onFinish,Empty catch clause,The method has an empty catch block.,79
apache_knox,org.apache.knox.gateway.performance.test.reporting,GatewayMetricsReporter,onFinish,Magic Number,The method contains a magic number: 10,79
apache_knox,org.apache.knox.gateway.performance.test.reporting,AbstractReportEngine,AbstractReportEngine,Abstract Function Call From Constructor,The constructor AbstractReportEngine calls a virtual method getType.,42
apache_knox,org.apache.knox.gateway.performance.test.reporting,AbstractReportEngine,generateReport,Long Statement,The length of the statement "FileUtils.writeStringToFile(reportFolderPath.resolve(reportFile).toFile()`getContent(reportMaterial)`StandardCharsets.UTF_8);" is 125.,50
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptUriProcessor,process,Complex Conditional,The conditional expression param != null && !param.isEmpty() && template != null && !template.isEmpty() is complex.,61
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptUriProcessor,encode,Long Statement,The length of the statement "EncryptionResult result=cryptoService.encryptForCluster(clusterName`EncryptUriDescriptor.PASSWORD_ALIAS`string.getBytes(StandardCharsets.UTF_8));" is 145.,82
apache_knox,org.apache.knox.gateway.encrypturi.impl,DecryptUriProcessor,decode,Long Statement,The length of the statement "byte[] clear=cryptoService.decryptForCluster(clusterName`EncryptUriDescriptor.PASSWORD_ALIAS`result.cipher`result.iv`result.salt);" is 130.,79
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptUriDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,78
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptUriDeploymentContributorTest,testDeployment,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,59
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptDecryptUriProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(as.getPasswordFromAliasForCluster(clusterName`passwordAlias)).andReturn(secret.toCharArray()).anyTimes();" is 121.,74
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptDecryptUriProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,74
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptDecryptUriProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn(clusterName).anyTimes();" is 122.,74
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptDecryptUriProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(as.getPasswordFromAliasForCluster(clusterName`passwordAlias)).andReturn(secret.toCharArray()).anyTimes();" is 121.,74
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptDecryptUriProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(decEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,74
apache_knox,org.apache.knox.gateway.encrypturi.impl,EncryptDecryptUriProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(decEnvironment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn(clusterName).anyTimes();" is 122.,74
apache_knox,org.apache.knox.gateway,GatewayTestDriver,getLocalHostName,Empty catch clause,The method has an empty catch block.,219
apache_knox,org.apache.knox.gateway,GatewayTestDriver,getUrl,Long Statement,The length of the statement "url="http://" + localHostName + ":"+ gateway.getAddresses()[0].getPort()+ "/"+ config.getGatewayPath()+ service.gatewayPath;" is 124.,229
apache_knox,org.apache.knox.gateway,GatewayTestDriver,getClusterUrl,Long Statement,The length of the statement "url="http://" + localHostName + ":"+ gateway.getAddresses()[0].getPort()+ "/"+ config.getGatewayPath()+ "/"+ clusterName;" is 121.,243
apache_knox,org.apache.knox.gateway,GatewayTestDriver,assertComplete,Long Statement,The length of the statement "assertThat("Service " + service.role + " has remaining expected interactions."`service.server.getCount()`Matchers.is(0));" is 121.,322
apache_knox,org.apache.knox.gateway,GatewayTestDriver,assertNotComplete,Long Statement,The length of the statement "assertThat("Service " + service.role + " has remaining expected interactions."`service.server.getCount()`Matchers.not(0));" is 122.,336
apache_knox,org.apache.knox.gateway,SecureClusterTest,setUpBeforeClass,Long Statement,The length of the statement "miniDFSCluster=new MiniDFSCluster.Builder(configuration).nameNodePort(TestUtils.findFreePort()).nameNodeHttpPort(nameNodeHttpPort).numDataNodes(0).format(true).racks(null).build();" is 180.,92
apache_knox,org.apache.knox.gateway,SecureClusterTest,initKdc,Magic Number,The method contains a magic number: 10,108
apache_knox,org.apache.knox.gateway,SecureClusterTest,setupJaasConf,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(file.toPath());Writer writer=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8)){" is 143.,222
apache_knox,org.apache.knox.gateway,SecureClusterTest,setupJaasConf,Long Statement,The length of the statement "String content=String.format(Locale.ROOT`"com.sun.security.jgss.initiate {\n" + "com.sun.security.auth.module.Krb5LoginModule required\n" + "renewTGT=true\n"+ "doNotPrompt=true\n"+ "useKeyTab=true\n"+ "keyTab=\"%s\"\n"+ "principal=\"%s\"\n"+ "isInitiator=true\n"+ "storeKey=true\n"+ "useTicketCache=true\n"+ "client=true;\n"+ "};\n"`keyTabFile`principal);" is 355.,222
apache_knox,org.apache.knox.gateway,SecureClusterTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("webappsec").addTag("name").addText("WebAppSec").addTag("enabled").addText("true").addTag("param").addTag("name").addText("csrf.enabled").addTag("value").addText("false").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("enabled").addText("true").addTag("name").addText("AclsAuthz").gotoParent().addTag("param").addTag("name").addText("webhdfs-acl").addTag("value").addText("hdfs;*;*").gotoParent().gotoRoot().addTag("service").addTag("role").addText("WEBHDFS").addTag("url").addText("http://localhost:" + nameNodeHttpPort + "/webhdfs/").gotoParent().gotoRoot();" is 1691.,250
apache_knox,org.apache.knox.gateway,SecureKnoxShellTest,setUpBeforeClass,Long Statement,The length of the statement "miniDFSCluster=new MiniDFSCluster.Builder(configuration).nameNodePort(TestUtils.findFreePort()).nameNodeHttpPort(nameNodeHttpPort).numDataNodes(2).format(true).racks(null).build();" is 180.,89
apache_knox,org.apache.knox.gateway,SecureKnoxShellTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2,89
apache_knox,org.apache.knox.gateway,SecureKnoxShellTest,initKdc,Magic Number,The method contains a magic number: 10,110
apache_knox,org.apache.knox.gateway,SecureKnoxShellTest,setupJaasConf,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(file.toPath());Writer writer=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8)){" is 143.,172
apache_knox,org.apache.knox.gateway,SecureKnoxShellTest,setupJaasConf,Long Statement,The length of the statement "String content=String.format(Locale.ROOT`"com.sun.security.jgss.initiate {\n" + "com.sun.security.auth.module.Krb5LoginModule required\n" + "renewTGT=true\n"+ "doNotPrompt=true\n"+ "useKeyTab=true\n"+ "keyTab=\"%s\"\n"+ "principal=\"%s\"\n"+ "isInitiator=true\n"+ "storeKey=true\n"+ "useTicketCache=true\n"+ "debug=false\n"+ "client=true;\n"+ "};\n"`keyTabFile`principal);" is 372.,172
apache_knox,org.apache.knox.gateway,SecureKnoxShellTest,createSecureTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("HadoopAuth").addTag("enabled").addText("true").addTag("param").addTag("name").addText("config.prefix").addTag("value").addText("hadoop.auth.config").gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.signature.secret").addTag("value").addText("knox").gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.type").addTag("value").addText("kerberos").gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.simple.anonymous.allowed").addTag("value").addText("false").gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.token.validity").addTag("value").addText("1800").gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.cookie.domain").addTag("value").addText("localhost").gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.cookie.path").addTag("value").addText("gateway/secure").gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.kerberos.principal").addTag("value").addText(spnegoPrincipal).gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.kerberos.keytab").addTag("value").addText(keytab).gotoParent().addTag("param").addTag("name").addText("hadoop.auth.config.kerberos.name.rules").addTag("value").addText("DEFAULT").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("enabled").addText("true").addTag("name").addText("AclsAuthz").gotoParent().gotoParent().gotoRoot().addTag("service").addTag("role").addText("WEBHDFS").addTag("url").addText("http://localhost:" + nameNodeHttpPort + "/webhdfs/").gotoParent().gotoRoot();" is 1921.,215
apache_knox,org.apache.knox.gateway,ShellTest,setUpBeforeClass,Long Statement,The length of the statement "miniDFSCluster=new MiniDFSCluster.Builder(configuration).nameNodePort(TestUtils.findFreePort()).nameNodeHttpPort(nameNodeHttpPort).numDataNodes(2).format(true).racks(null).build();" is 180.,59
apache_knox,org.apache.knox.gateway,ShellTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2,59
apache_knox,org.apache.knox.gateway,ShellTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("webappsec").addTag("name").addText("WebAppSec").addTag("enabled").addText("true").addTag("param").addTag("name").addText("csrf.enabled").addTag("value").addText("false").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("enabled").addText("true").addTag("name").addText("AclsAuthz").gotoParent().addTag("param").addTag("name").addText("webhdfs-acl").addTag("value").addText("hdfs;*;*").gotoParent().gotoRoot().addTag("service").addTag("role").addText("WEBHDFS").addTag("url").addText("http://localhost:" + nameNodeHttpPort + "/webhdfs/").gotoParent().gotoRoot();" is 1691.,124
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpClientMaxConnections,Magic Number,The method contains a magic number: 16,394
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getThreadPoolMax,Magic Number,The method contains a magic number: 254,434
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerRequestBuffer,Magic Number,The method contains a magic number: 16,439
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerRequestBuffer,Magic Number,The method contains a magic number: 1024,439
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerRequestHeaderBuffer,Magic Number,The method contains a magic number: 8,444
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerRequestHeaderBuffer,Magic Number,The method contains a magic number: 1024,444
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerResponseBuffer,Magic Number,The method contains a magic number: 32,449
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerResponseBuffer,Magic Number,The method contains a magic number: 1024,449
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerResponseHeaderBuffer,Magic Number,The method contains a magic number: 8,454
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getHttpServerResponseHeaderBuffer,Magic Number,The method contains a magic number: 1024,454
apache_knox,org.apache.knox.gateway,GatewayTestConfig,isWebsocketEnabled,Long Identifier,The length of the field DEFAULT_WEBSOCKET_FEATURE_ENABLED is 33.,528
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketMaxTextMessageSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_SIZE is 39.,533
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketMaxBinaryMessageSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_SIZE is 41.,538
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketMaxTextMessageBufferSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_BUFFER_SIZE is 46.,543
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketMaxBinaryMessageBufferSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_BUFFER_SIZE is 48.,548
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketInputBufferSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_INPUT_BUFFER_SIZE is 35.,553
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketAsyncWriteTimeout,Long Identifier,The length of the field DEFAULT_WEBSOCKET_ASYNC_WRITE_TIMEOUT is 37.,558
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketIdleTimeout,Long Identifier,The length of the field DEFAULT_WEBSOCKET_IDLE_TIMEOUT is 30.,563
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getWebsocketMaxWaitBufferCount,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_WAIT_BUFFER_COUNT is 39.,568
apache_knox,org.apache.knox.gateway,GatewayTestConfig,getClusterMonitorPollingInterval,Magic Number,The method contains a magic number: 600,713
apache_knox,org.apache.knox.gateway,GatewayForwardingServlet,doGet,Long Statement,The length of the statement "auditor.audit(AUDIT_ACTION`origPath`ResourceType.URI`ActionOutcome.UNAVAILABLE`RES.forwardToDefaultTopology(request.getMethod()`redirectToContext));" is 148.,89
apache_knox,org.apache.knox.gateway,GatewayCommandLine,printHelp,Long Statement,The length of the statement "new HelpFormatter().printHelp(printer`LINE_WIDTH`COMMAND_NAME`null`createCommandLine()`DEFAULT_LEFT_PAD`DEFAULT_DESC_PAD`null);" is 127.,49
apache_knox,org.apache.knox.gateway,GatewayServer,validateConfigurableGatewayDirectories,Long Statement,The length of the statement "checkIfDirectoryExistsAndCanBeRead(Paths.get(config.getGatewayConfDir())`GatewayConfig.KNOX_GATEWAY_CONF_DIR_VAR`errors);" is 121.,244
apache_knox,org.apache.knox.gateway,GatewayServer,checkIfFileExistsAndCanBeReadOrWrite,Long Parameter List,The method has 5 parameters. ,282
apache_knox,org.apache.knox.gateway,GatewayServer,loadBuildProperties,Empty catch clause,The method has an empty catch block.,304
apache_knox,org.apache.knox.gateway,GatewayServer,cleanupTopologyDeployments,Complex Conditional,The conditional expression ((verLimit >= 0) && (i > verLimit)) || ((ageLimit >= 0) && (file.lastModified() < keepTime)) is complex.,328
apache_knox,org.apache.knox.gateway,GatewayServer,startGateway,Long Statement,The length of the statement "((HttpConnectionFactory)x).getHttpConfiguration().addCustomizer(new org.eclipse.jetty.server.ForwardedRequestCustomizer());" is 123.,347
apache_knox,org.apache.knox.gateway,GatewayServer,createHandlers,Long Statement,The length of the statement "Arrays.asList(contexts.getHandlers()).stream().filter(h -> h instanceof WebAppContext).forEach(h -> contextToHandlerMap.put(((WebAppContext)h).getContextPath()`h));" is 164.,448
apache_knox,org.apache.knox.gateway,GatewayServer,checkPortConflict,Complex Method,Cyclomatic complexity of the method is 8,526
apache_knox,org.apache.knox.gateway,GatewayServer,checkPortConflict,Long Statement,The length of the statement "throw new IOException(String.format(Locale.ROOT`" Please map port %d using either \"gateway.port.mapping.sandbox\" or " + "\"default.app.topology.name\" property` " + "specifying both is not a valid configuration. "`port));" is 223.,526
apache_knox,org.apache.knox.gateway,GatewayServer,checkPortConflict,Long Statement,The length of the statement "throw new IOException(String.format(Locale.ROOT`" Port %d used by topology %s is used by other topology` ports for topologies (if defined) have to be unique. "`port`topologyName));" is 180.,526
apache_knox,org.apache.knox.gateway,GatewayServer,checkPortConflict,Long Statement,The length of the statement "if (config.getDefaultTopologyName() != null && config.getGatewayPortMappings().containsKey(config.getDefaultTopologyName())) {" is 126.,526
apache_knox,org.apache.knox.gateway,GatewayServer,checkPortConflict,Long Statement,The length of the statement "throw new IOException(String.format(Locale.ROOT`"Default topology cannot be in port mapping list` please remove %s from port mapping list or don't make it a default topology."`config.getDefaultTopologyName()));" is 210.,526
apache_knox,org.apache.knox.gateway,GatewayServer,start,Complex Method,Cyclomatic complexity of the method is 8,591
apache_knox,org.apache.knox.gateway,GatewayServer,start,Empty catch clause,The method has an empty catch block.,591
apache_knox,org.apache.knox.gateway,GatewayServer,start,Long Statement,The length of the statement "classlist.addBefore("org.eclipse.jetty.webapp.JettyWebXmlConfiguration"`"org.eclipse.jetty.annotations.AnnotationConfiguration");" is 129.,591
apache_knox,org.apache.knox.gateway,GatewayServer,run,Empty catch clause,The method has an empty catch block.,696
apache_knox,org.apache.knox.gateway,GatewayServer,handleHadoopXmlResources,Long Identifier,The length of the identifier advancedServiceDiscoveryConfigurationMonitor is 44.,707
apache_knox,org.apache.knox.gateway,GatewayServer,handleHadoopXmlResources,Long Statement,The length of the statement "final AdvancedServiceDiscoveryConfigurationMonitor advancedServiceDiscoveryConfigurationMonitor=new AdvancedServiceDiscoveryConfigurationMonitor(config);" is 153.,707
apache_knox,org.apache.knox.gateway,GatewayServer,createWebAppContext,Long Statement,The length of the statement "context.setAttribute("org.eclipse.jetty.server.webapp.ContainerIncludeJarPattern"`".*/[^/]*servlet-api-[^/]*\\.jar$|.*/javax.servlet.jsp.jstl-.*\\.jar$|.*/[^/]*taglibs.*\\.jar$");" is 179.,787
apache_knox,org.apache.knox.gateway,GatewayServer,mergeWebXmlOverrides,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(webXmlFile.toPath());OutputStreamWriter outputStreamWriter=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8)){" is 173.,825
apache_knox,org.apache.knox.gateway,GatewayServlet,createFilter,Long Statement,The length of the statement "GatewayServices gatewayServices=(GatewayServices)servletContext.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 121.,185
apache_knox,org.apache.knox.gateway,GatewayServlet,createFilter,Long Identifier,The length of the field GATEWAY_DESCRIPTOR_LOCATION_PARAM is 33.,213
apache_knox,org.apache.knox.gateway,GatewayServlet,createFilter,Long Identifier,The length of the field GATEWAY_DESCRIPTOR_LOCATION_DEFAULT is 35.,213
apache_knox,org.apache.knox.gateway,GatewayServlet,createFilter,Long Identifier,The length of the field GATEWAY_DESCRIPTOR_LOCATION_PARAM is 33.,229
apache_knox,org.apache.knox.gateway,GatewayServlet,createFilter,Long Identifier,The length of the field GATEWAY_DESCRIPTOR_LOCATION_DEFAULT is 35.,229
apache_knox,org.apache.knox.gateway,GatewayServerLifecycleListener,saveStatus,Long Statement,The length of the statement "final String message=DATE_FORMAT.get().format(new Date()) + System.getProperty("line.separator") + status.name()+ System.getProperty("line.separator");" is 151.,77
apache_knox,org.apache.knox.gateway,GatewayFilter,doFilter,Long Statement,The length of the statement "final String reqID=StringUtils.isBlank(((HttpServletRequest)servletRequest).getHeader(REQUEST_ID_HEADER_NAME)) ? UUID.randomUUID().toString() : ((HttpServletRequest)servletRequest).getHeader(REQUEST_ID_HEADER_NAME);" is 215.,109
apache_knox,org.apache.knox.gateway,GatewayFilter,doFilter,Long Statement,The length of the statement "auditor.audit(Action.ACCESS`contextWithPathAndQuery`ResourceType.URI`ActionOutcome.UNAVAILABLE`RES.requestMethod(((HttpServletRequest)servletRequest).getMethod()));" is 164.,109
apache_knox,org.apache.knox.gateway,GatewayFilter,getRemoteAddress,Long Statement,The length of the statement "GatewayConfig gatewayConfig=(GatewayConfig)servletRequest.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 131.,207
apache_knox,org.apache.knox.gateway,GatewayFilter,addFilter,Long Parameter List,The method has 5 parameters. ,238
apache_knox,org.apache.knox.gateway,GatewayFilter,addFilter,Long Parameter List,The method has 5 parameters. ,243
apache_knox,org.apache.knox.gateway,GatewayFilterTest,testDefaultServicePathTopologyRequestAttribute,Long Statement,The length of the statement "EasyMock.expect(request.getRequestURL()).andReturn(new StringBuffer("http://host:8443/gateway/sandbox/test-path/test-resource/")).anyTimes();" is 141.,253
apache_knox,org.apache.knox.gateway,GatewayPortMappingConfigTest,init,Magic Number,The method contains a magic number: 1240,65
apache_knox,org.apache.knox.gateway,GatewayPortMappingConfigTest,init,Magic Number,The method contains a magic number: 49151,65
apache_knox,org.apache.knox.gateway,GatewayPortMappingConfigTest,init,Magic Number,The method contains a magic number: 49151,65
apache_knox,org.apache.knox.gateway,GatewayPortMappingConfigTest,init,Magic Number,The method contains a magic number: 49151,65
apache_knox,org.apache.knox.gateway,GatewayPortMappingConfigTest,init,Magic Number,The method contains a magic number: 49151,65
apache_knox,org.apache.knox.gateway,GatewayPortMappingConfigTest,testCheckPortConflict,Long Statement,The length of the statement "exception.expectMessage(String.format(Locale.ROOT`" Port %d used by topology %s is used by other topology` ports for topologies (if defined) have to be unique. "`huronPort`"eerie"));" is 182.,136
apache_knox,org.apache.knox.gateway,GatewayGlobalConfigTest,testFullConfig,Magic Number,The method contains a magic number: 7777,45
apache_knox,org.apache.knox.gateway,GatewayGlobalConfigTest,testDemoConfig,Magic Number,The method contains a magic number: 8888,55
apache_knox,org.apache.knox.gateway,GatewayGlobalConfigTest,testSiteConfig,Magic Number,The method contains a magic number: 5555,64
apache_knox,org.apache.knox.gateway,GatewayGlobalConfigTest,testEmptyConfig,Magic Number,The method contains a magic number: 8888,75
apache_knox,org.apache.knox.gateway,GatewayForwardingServletTest,testRedirectDefaults,Magic Number,The method contains a magic number: 200,34
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoFiltersAudit,Long Statement,The length of the statement "EasyMock.expect(request.getAttribute(AbstractGatewayFilter.SOURCE_REQUEST_CONTEXT_URL_ATTRIBUTE_NAME)).andReturn(CONTEXT_PATH + PATH).anyTimes();" is 145.,98
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoFiltersAudit,Long Statement,The length of the statement "verifyAuditEvent(accessEvent`CONTEXT_PATH + PATH`ResourceType.URI`Action.ACCESS`accessEvent.getContextData().getValue("outcome")`null`accessEvent.getMessage().getFormattedMessage());" is 182.,98
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoFiltersAudit,Magic Number,The method contains a magic number: 99,98
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoFiltersAudit,Magic Number,The method contains a magic number: 9,98
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoFiltersAudit,Magic Number,The method contains a magic number: 5,98
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoFiltersAudit,Magic Number,The method contains a magic number: 2,98
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoopFilter,Long Statement,The length of the statement "verifyAuditEvent(accessEvent`CONTEXT_PATH + PATH`ResourceType.URI`Action.ACCESS`ActionOutcome.UNAVAILABLE`null`"Request method: GET");" is 134.,180
apache_knox,org.apache.knox.gateway,AuditLoggingTest,testNoopFilter,Magic Number,The method contains a magic number: 2,180
apache_knox,org.apache.knox.gateway,AuditLoggingTest,verifyAuditEvent,Long Parameter List,The method has 7 parameters. ,271
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,clusters,Long Statement,The length of the statement "mockAmbari.expect().method("GET").pathInfo("/api/v1/clusters").respond().status(HttpStatus.SC_OK).content(TestUtils.getResourceStream(DAT`"clusters-response.json")).contentType("text/plain");" is 191.,168
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,clusters,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").when().get(serviceUrl).asString();" is 161.,168
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,historyServer,Long Statement,The length of the statement "String serviceUrl=clusterUrl + "/ambari/api/v1/clusters/test/hosts/c6401.ambari.apache.org/host_components/HISTORYSERVER";" is 122.,204
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,historyServer,Long Statement,The length of the statement "mockAmbari.expect().method("GET").pathInfo("/api/v1/clusters/test/hosts/c6401.ambari.apache.org/host_components/HISTORYSERVER").respond().status(HttpStatus.SC_OK).content(TestUtils.getResourceStream(DAT`"history-server-response.json")).contentType("text/plain");" is 262.,204
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,historyServer,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").when().get(serviceUrl).asString();" is 161.,204
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,unwiseCharacterRequest,Long Statement,The length of the statement "mockAmbari.expect().method("GET").pathInfo("/api/v1/clusters/test/components").queryParam("ServiceComponentInfo/component_name"`"APP_TIMELINE_SERVER|ServiceComponentInfo/category=MASTER").respond().status(HttpStatus.SC_OK).content(TestUtils.getResourceStream(DAT`"unwise-character-response.json")).contentType("text/plain");" is 324.,238
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,unwiseCharacterRequest,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).queryParam("ServiceComponentInfo/component_name"`"APP_TIMELINE_SERVER|ServiceComponentInfo/category=MASTER").then().statusCode(HttpStatus.SC_OK).contentType("text/plain").when().get(serviceUrl).asString();" is 258.,238
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,encryptedResponse,Long Statement,The length of the statement "mockAmbari.expect().method("GET").pathInfo("/api/v1/persist/CLUSTER_CURRENT_STATUS").queryParam("_"`"1457977721091").respond().status(HttpStatus.SC_OK).content(TestUtils.getResourceStream(DAT`"encrypted-response.txt")).contentType("text/plain");" is 245.,265
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,encryptedResponse,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").when().get(serviceUrl).asString();" is 161.,265
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,postDataWithWrongContentType,Long Statement,The length of the statement "mockAmbari.expect().method("POST").pathInfo("/api/v1/stacks/HDP/versions/2.3/recommendations").content(TestUtils.getResourceStream(DAT`"post-data-wrong-type.json")).respond().status(HttpStatus.SC_OK).contentType("application/x-www-form-urlencoded");" is 249.,293
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,postDataWithWrongContentType,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).body(IOUtils.toByteArray(TestUtils.getResourceStream(DAT`"post-data-wrong-type.json"))).then().statusCode(HttpStatus.SC_OK).contentType("application/x-www-form-urlencoded").when().post(serviceUrl).asString();" is 273.,293
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,contextPathInViewsResponse,Long Statement,The length of the statement "String serviceUrl=clusterUrl + "/ambari/api/v1/views?fields=versions/instances/ViewInstanceInfo`versions/" + "ViewVersionInfo/label&versions/ViewVersionInfo/system=false&_=1461186937589";" is 187.,322
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,contextPathInViewsResponse,Long Statement,The length of the statement "mockAmbari.expect().method("GET").pathInfo("/api/v1/views").queryParam("_"`"1461186937589").queryParam("versions/ViewVersionInfo/system"`"false").queryParam("fields"`"versions/instances/ViewInstanceInfo`versions/ViewVersionInfo/label").respond().status(HttpStatus.SC_OK).content(TestUtils.getResourceStream(DAT`"views-response.json")).contentType("text/plain");" is 361.,322
apache_knox,org.apache.knox.gateway,AmbariServiceDefinitionTest,contextPathInViewsResponse,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").when().get(serviceUrl).asString();" is 161.,322
apache_knox,org.apache.knox.gateway,GatewayLdapDynamicGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,71
apache_knox,org.apache.knox.gateway,GatewayLdapDynamicGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 100,71
apache_knox,org.apache.knox.gateway,GatewayLdapDynamicGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,71
apache_knox,org.apache.knox.gateway,GatewayLdapDynamicGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 100,71
apache_knox,org.apache.knox.gateway,GatewayLdapDynamicGroupFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapGroupContextFactory").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory").addTag("value").addText("$ldapGroupContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemAuthenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.searchBase").addTag("value").addText("ou=groups`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupObjectClass").addTag("value").addText("groupofurls").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttribute").addTag("value").addText("memberurl").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttributeValueTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.clusterName").addTag("value").addText(cluster).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText("S{ALIAS=ldcSystemPassword}").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("name").addText("AclsAuthz").addTag("enabled").addText("true").addTag("param").addTag("name").addText("test-service-role.acl").addTag("value").addText("*;directors;*").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot().gotoRoot().addTag("service").addTag("role").addText("dummyService").gotoRoot();" is 3068.,91
apache_knox,org.apache.knox.gateway,GatewayLdapDynamicGroupFuncTest,testGroupMember,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(serviceUrl);" is 172.,174
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testSimpleStaticHelloAppDeployUndeploy,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/html").when().get(serviceUrl).asString();" is 160.,162
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testSimpleStaticHelloAppDeployUndeploy,Long Statement,The length of the statement "body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/html").when().get(serviceUrl).asString();" is 153.,162
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testSimpleStaticHelloAppDeployUndeploy,Long Statement,The length of the statement "body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/html").when().get(serviceUrl).asString();" is 153.,162
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testSimpleDynamicAppDeployUndeploy,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 183.,219
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testSimpleDynamicAppDeployUndeploy,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/dynamic-app-path");" is 141.,219
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testNakedAppDeploy,Long Statement,The length of the statement "given().then().statusCode(HttpStatus.SC_OK).body(is(gatewayUrl + "/test-topology/dynamic-app/?null")).when().get(gatewayUrl + "/test-topology/dynamic-app");" is 156.,254
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultAppName,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(clusterUrl + "/dynamic-app/?null")).when().get(clusterUrl + "/dynamic-app");" is 173.,275
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultAppName,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/dynamic-app");" is 136.,275
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/html").when().get(clusterUrl + "/static-hello-app-path/index.html").asString();" is 198.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "body=given().auth().preemptive().basic(username`password).then().contentType("").statusCode(HttpStatus.SC_OK).when().get(clusterUrl + "/static-json-app/one.json").asString();" is 174.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 183.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "body=given().auth().preemptive().basic(username`password).then().contentType("application/xml").statusCode(HttpStatus.SC_OK).when().get(clusterUrl + "/test.xml").asString();" is 173.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/static-hello-app-path/index.html");" is 157.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/static-json-app/one.json");" is 149.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/dynamic-app-path");" is 141.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testMultiApps,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/test.xml");" is 133.,313
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testServicesAndApplications,Long Statement,The length of the statement "mockWebHdfs.expect().method("GET").pathInfo("/v1/").queryParam("op"`"GETHOMEDIRECTORY").queryParam("user.name"`"guest").respond().status(HttpStatus.SC_OK).content("{\"path\":\"/users/guest\"}"`StandardCharsets.UTF_8).contentType("application/json");" is 249.,392
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testServicesAndApplications,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).queryParam("op"`"GETHOMEDIRECTORY").then().statusCode(HttpStatus.SC_OK).contentType("application/json").body("path"`is("/users/guest")).when().get(clusterUrl + "/webhdfs/v1");" is 228.,392
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testServicesAndApplications,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("application/xml").when().get(clusterUrl + "/static-xml-app/test.xml").asString();" is 195.,392
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testServicesAndApplications,Long Statement,The length of the statement "body=given().auth().preemptive().basic(username`password).then().contentType("").statusCode(HttpStatus.SC_OK).when().get(clusterUrl + "/app-two/one.json").asString();" is 166.,392
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testServicesAndApplications,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/app-one/index.html");" is 143.,392
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testServicesAndApplications,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/app-two/one.json");" is 141.,392
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testServicesAndApplications,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(clusterUrl + "/test.xml");" is 133.,392
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDeploymentCleanup,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 183.,471
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDeploymentCleanup,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 183.,471
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDeploymentCleanup,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 183.,471
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDeploymentCleanup,Magic Number,The method contains a magic number: 2,471
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDeploymentCleanup,Magic Number,The method contains a magic number: 2,471
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 183.,549
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 154.,549
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(gatewayUrl + "/test-topology" + "/dynamic-app-path/?null")).when().get(gatewayUrl + "/test-topology/dynamic-app-path");" is 216.,549
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(gatewayUrl + "/test-topology-2" + "/dynamic-app-path/?null")).when().get(gatewayUrl + "/test-topology-2/dynamic-app-path");" is 220.,549
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_FOUND).body(is(clusterUrl + "/dynamic-app-path/?null"));" is 145.,549
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(gatewayUrl + "/test-topology" + "/dynamic-app-path/?null")).when().get(gatewayUrl + "/test-topology/dynamic-app-path");" is 216.,549
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).body(is(gatewayUrl + "/test-topology-2" + "/dynamic-app-path/?null")).when().get(gatewayUrl + "/test-topology-2/dynamic-app-path");" is 220.,549
apache_knox,org.apache.knox.gateway,GatewayAppFuncTest,testDefaultTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().body(is(clusterUrl + "/dynamic-app-path/?null")).when().get(clusterUrl + "/dynamic-app-path");" is 154.,549
apache_knox,org.apache.knox.gateway,PortMappingHelper,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("webappsec").addTag("name").addText("WebAppSec").addTag("enabled").addText("true").addTag("param").addTag("name").addText("csrf.enabled").addTag("value").addText("true").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(ldapURL).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("enabled").addText("true").addTag("name").addText("AclsAuthz").gotoParent().addTag("param").addTag("name").addText("webhdfs-acl").addTag("value").addText("hdfs;*;*").gotoParent().addTag("provider").addTag("role").addText("ha").addTag("enabled").addText("true").addTag("name").addText("HaProvider").addTag("param").addTag("name").addText("WEBHDFS").addTag("value").addText("maxFailoverAttempts=3;failoverSleep=15;enabled=true").gotoParent().gotoRoot().addTag("service").addTag("role").addText(role).addTag("url").addText("http://localhost:" + gatewayPort + "/webhdfs").gotoRoot();" is 1915.,110
apache_knox,org.apache.knox.gateway,PortMappingHelper,test,Long Statement,The length of the statement "masterServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-liststatus-success.json")).contentType("application/json");" is 259.,172
apache_knox,org.apache.knox.gateway,PortMappingHelper,test,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().log().ifError().statusCode(HttpStatus.SC_OK).body("FileStatuses.FileStatus[0].pathSuffix"`is("app-logs")).when().get(url + "/v1/");" is 259.,172
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testDefaultJsonMimeTypeHandlingKnox678,Long Statement,The length of the statement "mock.expect().method("GET").respond().contentType("application/json").contentLength(-1).content("{\"msg\":\"H\u00eallo\"}"`StandardCharsets.UTF_8);" is 147.,157
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testDefaultJsonMimeTypeHandlingKnox678,Long Statement,The length of the statement "String json=given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_OK).contentType("application/json;charset=UTF-8").when().get(gatewayUrl + "/knox678/repeat").andReturn().asString();" is 207.,157
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testDefaultJsonMimeTypeHandlingKnox678,Long Statement,The length of the statement "mock.expect().method("GET").respond().contentType("application/octet-stream").contentLength(-1).content("H\u00eallo".getBytes(StandardCharsets.UTF_8));" is 151.,157
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testDefaultJsonMimeTypeHandlingKnox678,Long Statement,The length of the statement "byte[] bytes=given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_OK).contentType("application/octet-stream").when().get(gatewayUrl + "/knox678/repeat").andReturn().asByteArray();" is 205.,157
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testPostWithContentTypeKnox681,Long Statement,The length of the statement "mock.expect().method("PUT").pathInfo("/repeat-context/").respond().status(HttpStatus.SC_CREATED).content("{\"name\":\"value\"}".getBytes(StandardCharsets.UTF_8)).contentLength(-1).contentType("application/json;charset=UTF-8").header("Location"`gatewayUrl + "/knox681/repeat");" is 276.,207
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testPostWithContentTypeKnox681,Long Statement,The length of the statement "credsProvider.setCredentials(new AuthScope(targetHost.getHostName()`targetHost.getPort())`new UsernamePasswordCredentials(uname`pword));" is 136.,207
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testPostWithContentTypeKnox681,Long Statement,The length of the statement "mock.expect().method("PUT").pathInfo("/repeat-context/").respond().status(HttpStatus.SC_CREATED).content("<test-xml/>".getBytes(StandardCharsets.UTF_8)).contentType("application/xml; charset=UTF-8").header("Location"`gatewayUrl + "/knox681/repeat");" is 249.,207
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(gatewayUrl + "/knox694-1/test-service-path/test-resource-path");" is 218.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`invalidPword).then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(gatewayUrl + "/knox694-1/test-service-path/test-resource-path");" is 175.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(gatewayUrl + "/knox694-2/test-service-path/test-resource-path");" is 218.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`invalidPword).then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(gatewayUrl + "/knox694-2/test-service-path/test-resource-path");" is 175.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(gatewayUrl + "/knox694-3/test-service-path/test-resource-path");" is 218.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`invalidPword).then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(gatewayUrl + "/knox694-3/test-service-path/test-resource-path");" is 175.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(gatewayUrl + "/knox694-4/test-service-path/test-resource-path");" is 218.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`invalidPword).then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(gatewayUrl + "/knox694-4/test-service-path/test-resource-path");" is 175.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(gatewayUrl + "/knox694-5/test-service-path/test-resource-path");" is 218.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`invalidPword).then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(gatewayUrl + "/knox694-5/test-service-path/test-resource-path");" is 175.,292
apache_knox,org.apache.knox.gateway,GatewayMultiFuncTest,testLdapSearchConfigEnhancementsKnox694,Long Statement,The length of the statement "given().auth().preemptive().basic(uname`pword).then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(gatewayUrl + "/knox694-6/test-service-path/test-resource-path");" is 168.,292
apache_knox,org.apache.knox.gateway,KnoxCliLdapFuncTestNegative,createBadTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText("guest-password").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("KNOX").gotoRoot();" is 1450.,120
apache_knox,org.apache.knox.gateway,KnoxCliLdapFuncTestNegative,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapGroupContextFactory").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.searchBase").addTag("value").addText("ou=groups`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupObjectClass").addTag("value").addText("groupOfNames").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttributeValueTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttribute").addTag("value").addText("member").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText("guest-password").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.cachingEnabled").addTag("value").addText("false").gotoParent().addTag("param").addTag("name").addText("com.sun.jndi.ldap.connect.pool").addTag("value").addText("false").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 2536.,160
apache_knox,org.apache.knox.gateway,KnoxCliLdapFuncTestNegative,testBadTopology,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Your topology file may be incorrectly configured for group lookup"));" is 147.,223
apache_knox,org.apache.knox.gateway,KnoxCliLdapFuncTestNegative,testBadTopology,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Your topology file may be incorrectly configured for group lookup"));" is 147.,223
apache_knox,org.apache.knox.gateway,TestProviderDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,42
apache_knox,org.apache.knox.gateway,GatewayCorrelationIdTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 1147.,133
apache_knox,org.apache.knox.gateway,GatewayCorrelationIdTest,testTestService,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(serviceUrl);" is 172.,167
apache_knox,org.apache.knox.gateway,GatewayCorrelationIdTest,testTestService,Magic Number,The method contains a magic number: 99,167
apache_knox,org.apache.knox.gateway,GatewayCorrelationIdTest,testTestService,Magic Number,The method contains a magic number: 9,167
apache_knox,org.apache.knox.gateway,GatewayCorrelationIdTest,testTestService,Magic Number,The method contains a magic number: 5,167
apache_knox,org.apache.knox.gateway,GatewaySslFuncTest,testKnox674SslCipherSuiteConfig,Long Statement,The length of the statement "credsProvider.setCredentials(new AuthScope(targetHost.getHostName()`targetHost.getPort())`new UsernamePasswordCredentials(username`password));" is 142.,191
apache_knox,org.apache.knox.gateway,GatewaySslFuncTest,testKnox674SslCipherSuiteConfig,Long Statement,The length of the statement "CloseableHttpClient client=HttpClients.custom().setSSLSocketFactory(new SSLConnectionSocketFactory(createInsecureSslContext()`new String[]{"TLSv1.2"}`new String[]{"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256"}`new TrustAllHosts())).build();" is 234.,191
apache_knox,org.apache.knox.gateway,GatewaySslFuncTest,testKnox674SslCipherSuiteConfig,Long Statement,The length of the statement "client=HttpClients.custom().setSSLSocketFactory(new SSLConnectionSocketFactory(createInsecureSslContext()`new String[]{"TLSv1.2"}`new String[]{"TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256"}`new TrustAllHosts())).build();" is 214.,191
apache_knox,org.apache.knox.gateway,GatewaySslFuncTest,testKnox674SslCipherSuiteConfig,Long Statement,The length of the statement "client=HttpClients.custom().setSSLSocketFactory(new SSLConnectionSocketFactory(createInsecureSslContext()`new String[]{"TLSv1.2"}`new String[]{"TLS_DHE_RSA_WITH_AES_128_CBC_SHA"}`new TrustAllHosts())).build();" is 209.,191
apache_knox,org.apache.knox.gateway,GatewayShiroAuthTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls." + pattern).addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 1154.,138
apache_knox,org.apache.knox.gateway,GatewayShiroAuthTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.invalidRequest.blockSemicolon").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.invalidRequest.blockBackslash").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.invalidRequest.blockNonAscii").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls." + pattern).addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 1519.,138
apache_knox,org.apache.knox.gateway,GatewayShiroAuthTest,testShiroBlockUnsafeCharacters,Long Statement,The length of the statement "final String serviceUrl=gatewayUrl + '/' + TOPOLOGY_BLOCK_UNSAFE_CHARS+ SERVICE_RESOURCE_NAME+ ";jsessionid=OI24B9ASD7BSSD";" is 124.,228
apache_knox,org.apache.knox.gateway,GatewayShiroAuthTest,testInValidShiro,Long Statement,The length of the statement "testShiroAuthFailure(HttpStatus.SC_INTERNAL_SERVER_ERROR`serviceUrl`"Unable to determine authenticated user from Shiro` please check that your Knox Shiro configuration is correct");" is 181.,239
apache_knox,org.apache.knox.gateway,GatewayShiroAuthTest,testShiroAuthFailure,Long Statement,The length of the statement "given().auth().preemptive().basic(USERNAME`USERNAME).then().statusCode(failure_status_code).contentType("text/html").body(containsString(reason)).when().get(serviceUrl);" is 169.,248
apache_knox,org.apache.knox.gateway,GatewayShiroAuthTest,testShiroAuthSuccess,Long Statement,The length of the statement "given().auth().preemptive().basic(USERNAME`PASSWORD).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(containsString(expectedResponse)).when().get(serviceUrl);" is 177.,258
apache_knox,org.apache.knox.gateway,GatewayLdapPosixGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,67
apache_knox,org.apache.knox.gateway,GatewayLdapPosixGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 100,67
apache_knox,org.apache.knox.gateway,GatewayLdapPosixGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,67
apache_knox,org.apache.knox.gateway,GatewayLdapPosixGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 100,67
apache_knox,org.apache.knox.gateway,GatewayLdapPosixGroupFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapGroupContextFactory").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory").addTag("value").addText("$ldapGroupContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemAuthenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.searchBase").addTag("value").addText("ou=groups`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupObjectClass").addTag("value").addText("posixGroup").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttribute").addTag("value").addText("memberUid").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttributeValueTemplate").addTag("value").addText("uid={0}").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.clusterName").addTag("value").addText(cluster).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText("S{ALIAS=ldcSystemPassword}").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("name").addText("AclsAuthz").addTag("enabled").addText("true").addTag("param").addTag("name").addText("test-service-role.acl").addTag("value").addText("*;analyst;*").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot().gotoRoot().addTag("service").addTag("role").addText("dummyService").gotoRoot();" is 3028.,88
apache_knox,org.apache.knox.gateway,GatewayLdapPosixGroupFuncTest,testGroupMember,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(serviceUrl);" is 172.,171
apache_knox,org.apache.knox.gateway,GatewayPortMappingFuncTest,setup,Magic Number,The method contains a magic number: 1240,43
apache_knox,org.apache.knox.gateway,GatewayPortMappingFuncTest,setup,Magic Number,The method contains a magic number: 49151,43
apache_knox,org.apache.knox.gateway,KnoxCliSysBindTest,writeTopology,Long Parameter List,The method has 5 parameters. ,105
apache_knox,org.apache.knox.gateway,KnoxCliSysBindTest,createBadTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("KNOX").gotoRoot();" is 1238.,122
apache_knox,org.apache.knox.gateway,KnoxCliSysBindTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapGroupContextFactory").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.searchBase").addTag("value").addText("ou=groups`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupObjectClass").addTag("value").addText("groupOfNames").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttributeValueTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttribute").addTag("value").addText("member").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=" + username + "`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText(password).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 2302.,158
apache_knox,org.apache.knox.gateway,KnoxCliSysBindTest,testLDAPAuth,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Unable to successfully bind to LDAP server with topology credentials"));" is 150.,215
apache_knox,org.apache.knox.gateway,KnoxCliSysBindTest,testLDAPAuth,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Warn: main.ldapRealm.contextFactory.systemUsername is not present"));" is 147.,215
apache_knox,org.apache.knox.gateway,KnoxCliSysBindTest,testLDAPAuth,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Warn: main.ldapRealm.contextFactory.systemPassword is not present"));" is 147.,215
apache_knox,org.apache.knox.gateway,GatewayLdapGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,64
apache_knox,org.apache.knox.gateway,GatewayLdapGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 100,64
apache_knox,org.apache.knox.gateway,GatewayLdapGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,64
apache_knox,org.apache.knox.gateway,GatewayLdapGroupFuncTest,setupGateway,Magic Number,The method contains a magic number: 100,64
apache_knox,org.apache.knox.gateway,GatewayLdapGroupFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapGroupContextFactory").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory").addTag("value").addText("$ldapGroupContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemAuthenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.searchBase").addTag("value").addText("ou=groups`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupObjectClass").addTag("value").addText("groupofnames").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttribute").addTag("value").addText("member").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttributeValueTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.clusterName").addTag("value").addText(cluster).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText("S{ALIAS=ldcSystemPassword}").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("name").addText("AclsAuthz").addTag("enabled").addText("true").addTag("param").addTag("name").addText("test-service-role.acl").addTag("value").addText("*;analyst;*").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot().gotoRoot().addTag("service").addTag("role").addText("dummyService").gotoRoot();" is 3064.,84
apache_knox,org.apache.knox.gateway,GatewayLdapGroupFuncTest,testGroupMember,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(serviceUrl);" is 172.,167
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,createNormalTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("webappsec").addTag("name").addText("WebAppSec").addTag("enabled").addText("true").addTag("param").addTag("name").addText("csrf.enabled").addTag("value").addText("true").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("enabled").addText("true").addTag("name").addText("AclsAuthz").gotoParent().addTag("param").addTag("name").addText("webhdfs-acl").addTag("value").addText("hdfs;*;*").gotoParent().gotoRoot().addTag("service").addTag("role").addText("WEBHDFS").addTag("url").addText("http://localhost:50070/webhdfs/v1").gotoParent().gotoRoot();" is 1673.,151
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,createKnoxTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("name").addText("AclsAuthz").addTag("enabled").addText("true").addTag("param").addTag("name").addText("knox.acl").addTag("value").addText("admin;*;*").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("KNOX").gotoRoot();" is 1358.,199
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,createProviderConfiguration,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("name").addText("AclsAuthz").addTag("enabled").addText("true").addTag("param").addTag("name").addText("knox.acl").addTag("value").addText("admin;*;*").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot();" is 1279.,239
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,createDescriptor,Long Statement,The length of the statement "sb.append("\"discovery-type\":\"AMBARI\"`\n" + "\"discovery-address\":\"http://c6401.ambari.apache.org:8080\"`\n" + "\"discovery-user\":\"ambariuser\"`\n"+ "\"discovery-pwd-alias\":\"ambari.discovery.password\"`\n");" is 216.,283
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,createDescriptor,Long Statement,The length of the statement "sb.append("\"provider-config-ref\":\"").append(providerConfigRef).append("\"`\n\"cluster\":\"").append(clusterName).append("\"`\n" + "\"services\":[\n" + "{\"name\":\"NAMENODE\"}`\n"+ "{\"name\":\"JOBTRACKER\"}`\n"+ "{\"name\":\"WEBHDFS\"}`\n"+ "{\"name\":\"WEBHCAT\"}`\n"+ "{\"name\":\"OOZIE\"}`\n"+ "{\"name\":\"WEBHBASE\"}`\n"+ "{\"name\":\"HIVE\"}`\n"+ "{\"name\":\"RESOURCEMANAGER\"}`\n"+ "{\"name\":\"AMBARI\"` \"urls\":[\"http://c6401.ambari.apache.org:8080\"]}\n"+ "]\n}\n");" is 483.,283
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,createDescriptor,Magic Number,The method contains a magic number: 1024,283
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyCollection,Long Statement,The length of the statement "String href1=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).contentType(MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body("topologies.topology[0].name"`not(nullValue())).body("topologies.topology[1].name"`not(nullValue())).body("topologies.topology[0].uri"`not(nullValue())).body("topologies.topology[1].uri"`not(nullValue())).body("topologies.topology[0].href"`not(nullValue())).body("topologies.topology[1].href"`not(nullValue())).body("topologies.topology[0].timestamp"`not(nullValue())).body("topologies.topology[1].timestamp"`not(nullValue())).when().get(serviceUrl).thenReturn().getBody().path("topologies.topology.href[1]");" is 700.,316
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().body("topologies.topology.href[1]"`equalTo(href1)).statusCode(HttpStatus.SC_OK).when().get(serviceUrl);" is 206.,316
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_XML).when().get(serviceUrl);" is 151.,316
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType("application/json").body("topology.name"`equalTo("test-cluster")).when().get(href1);" is 229.,316
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyObject,Long Statement,The length of the statement "String hrefJson=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).when().get(serviceUrl).thenReturn().getBody().path("topologies.topology[1].href");" is 231.,372
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyObject,Long Statement,The length of the statement "String timestampJson=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType("application/json").when().get(serviceUrl).andReturn().getBody().path("topologies.topology[1].timestamp");" is 272.,372
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyObject,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body("topology.name"`equalTo("test-cluster")).body("topology.timestamp"`equalTo(Long.parseLong(timestampJson))).when().get(hrefJson);" is 266.,372
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyObject,Long Statement,The length of the statement "String hrefXml=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).when().get(serviceUrl).thenReturn().getBody().path("topologies.topology[1].href");" is 229.,372
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testTopologyObject,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).when().get(hrefXml);" is 152.,372
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,validateGeneratedElement,Long Statement,The length of the statement "String testClusterTopology=given().auth().preemptive().basic("admin"`"admin-password").header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).when().get(clusterUrl + "/api/v1/topologies/" + topologyName).thenReturn().getBody().asString();" is 262.,468
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPositiveAuthorization,Long Statement,The length of the statement "given().auth().preemptive().basic(adminUser`adminPass).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON).body("topologies.topology[0].name"`not(nullValue())).body("topologies.topology[1].name"`not(nullValue())).body("topologies.topology[0].uri"`not(nullValue())).body("topologies.topology[1].uri"`not(nullValue())).body("topologies.topology[0].href"`not(nullValue())).body("topologies.topology[1].href"`not(nullValue())).body("topologies.topology[0].timestamp"`not(nullValue())).body("topologies.topology[1].timestamp"`not(nullValue())).when().get(url);" is 613.,488
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeployTopology,Long Statement,The length of the statement "given().auth().preemptive().basic("admin"`"admin-password").header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body(containsString("ServerVersion")).when().get(gatewayUrl + "/admin/api/v1/version");" is 227.,598
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeployTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(user`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(url).getBody();" is 171.,598
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(url);" is 189.,652
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(url);" is 148.,652
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopology,Long Statement,The length of the statement "String JsonPut=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).get(clusterUrl + "/api/v1/topologies/test-cluster").getBody().asString();" is 185.,696
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopology,Long Statement,The length of the statement "String XML=given().auth().preemptive().basic(username`password).contentType(MediaType.APPLICATION_JSON).header("Accept"`MediaType.APPLICATION_XML).body(JsonPut).then().statusCode(HttpStatus.SC_OK).when().put(url).getBody().asString();" is 234.,696
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).body(equalTo(XML)).when().get(url).getBody().asString();" is 188.,696
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopology,Long Statement,The length of the statement "String XmlPut=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).get(clusterUrl + "/api/v1/topologies/test-cluster").getBody().asString();" is 183.,696
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopology,Long Statement,The length of the statement "String JSON=given().auth().preemptive().basic(username`password).contentType(MediaType.APPLICATION_XML).header("Accept"`MediaType.APPLICATION_JSON).body(XmlPut).then().statusCode(HttpStatus.SC_OK).when().put(url).getBody().asString();" is 234.,696
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopology,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body(equalTo(JSON)).when().get(url).getBody().asString();" is 190.,696
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopologyWithInvalidName,Long Statement,The length of the statement "String JsonPut=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).get(clusterUrl + "/api/v1/topologies/test-cluster").getBody().asString();" is 185.,767
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopologyWithInvalidName,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).contentType(MediaType.APPLICATION_JSON).header("Accept"`MediaType.APPLICATION_XML).body(JsonPut).then().statusCode(HttpStatus.SC_BAD_REQUEST).when().put(url).getBody().asString();" is 232.,767
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopologyWithEntityInjection,Long Statement,The length of the statement "final String XML_WITH_INJECTION="<?xml version=\"1.0\" encoding=\"utf-8\"?>\n" + "<!DOCTYPE foo [<!ENTITY xxeiltvf SYSTEM \"file:///etc/hosts\"> ]>\n" + "<topology>\n"+ " <gateway>\n"+ " <provider>\n"+ " <role>authentication</role>\n"+ " <name>ShiroProvider</name>\n"+ " <enabled>true</enabled>\n"+ " <param>\n"+ " <name>" + MALICIOUS_PARAM_NAME + "</name>\n"+ " <value>&xxeiltvf;</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>sessionTimeout</name>\n"+ " <value>30</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm</name>\n"+ " <value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapContextFactory</name>\n"+ " <value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.contextFactory</name>\n"+ " <value>$ldapContextFactory</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.userDnTemplate</name>\n"+ " <value>uid={0}`ou=people`dc=hadoop`dc=apache`dc=org</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.contextFactory.url</name>\n"+ " <value>ldap://localhost:33389</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.contextFactory.authenticationMechanism</name>\n"+ " <value>simple</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>urls./**</name>\n"+ " <value>authcBasic</value>\n"+ " </param>\n"+ " </provider>\n"+ " </gateway>\n"+ " <service>\n"+ " <role>NAMENODE</role>\n"+ " <url>hdfs://localhost:8020</url>\n"+ " </service>\n"+ "</topology>";" is 1536.,791
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopologyWithEntityInjection,Long Statement,The length of the statement "String XML_RESPONSE=given().auth().preemptive().basic(username`password).contentType(MediaType.APPLICATION_XML).header("Accept"`MediaType.APPLICATION_XML).body(XML_WITH_INJECTION).then().statusCode(HttpStatus.SC_OK).when().put(url).getBody().asString();" is 253.,791
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopologyWithEntityExpansion,Long Statement,The length of the statement "final String XML_WITH_INJECTION="<?xml version=\"1.0\" encoding=\"utf-8\"?>\n" + "<!DOCTYPE foo [<!ENTITY xeevowya0 \"b68et\"><!ENTITY xeevowya1 \"&xeevowya0;&xeevowya0;\"><!ENTITY xeevowya2 \"&xeevowya1;&xeevowya1;\"><!ENTITY xeevowya3 \"&xeevowya2;&xeevowya2;\">]>\n" + "<topology>\n"+ " <gateway>\n"+ " <provider>\n"+ " <role>authentication</role>\n"+ " <name>ShiroProvider</name>\n"+ " <enabled>true</enabled>\n"+ " <param>\n"+ " <name>" + MALICIOUS_PARAM_NAME + "</name>\n"+ " <value>&xeevowya3;</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>sessionTimeout</name>\n"+ " <value>30</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm</name>\n"+ " <value>org.apache.knox.gateway.shirorealm.KnoxLdapRealm</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapContextFactory</name>\n"+ " <value>org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.contextFactory</name>\n"+ " <value>$ldapContextFactory</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.userDnTemplate</name>\n"+ " <value>uid={0}`ou=people`dc=hadoop`dc=apache`dc=org</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.contextFactory.url</name>\n"+ " <value>ldap://localhost:33389</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>main.ldapRealm.contextFactory.authenticationMechanism</name>\n"+ " <value>simple</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>urls./**</name>\n"+ " <value>authcBasic</value>\n"+ " </param>\n"+ " </provider>\n"+ " </gateway>\n"+ " <service>\n"+ " <role>NAMENODE</role>\n"+ " <url>hdfs://localhost:8020</url>\n"+ " </service>\n"+ "</topology>";" is 1656.,872
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutTopologyWithEntityExpansion,Long Statement,The length of the statement "String XML_RESPONSE=given().auth().preemptive().basic(username`password).contentType(MediaType.APPLICATION_XML).header("Accept"`MediaType.APPLICATION_XML).body(XML_WITH_INJECTION).then().statusCode(HttpStatus.SC_OK).when().put(url).getBody().asString();" is 253.,872
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testXForwardedHeaders,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).header("X-Forwarded-Host"`host).header("X-Forwarded-Port"`port).header("X-Forwarded-Server"`server).header("X-Forwarded-Context"`context).header("X-Forwarded-Proto"`proto).then().statusCode(HttpStatus.SC_OK).body(containsString(newUrl)).body(containsString("test-cluster")).body(containsString("admin")).when().get(url);" is 416.,953
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testXForwardedHeaders,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).header("X-Forwarded-Host"`host).header("X-Forwarded-Server"`server).header("X-Forwarded-Context"`context).header("X-Forwarded-Proto"`proto).then().statusCode(HttpStatus.SC_OK).body(containsString(server)).body(containsString(context)).body(containsString(proto)).body(containsString(host)).body(containsString("test-cluster")).body(containsString("admin")).when().get(url);" is 469.,953
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testXForwardedHeaders,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).header("X-Forwarded-Host"`host).header("X-Forwarded-Port"`port).header("X-Forwarded-Context"`context).header("X-Forwarded-Proto"`proto).then().statusCode(HttpStatus.SC_OK).body(containsString(host)).body(containsString(port)).body(containsString(context)).body(containsString(proto)).body(containsString("test-cluster")).body(containsString("admin")).when().get(url);" is 463.,953
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testXForwardedHeaders,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).header("X-Forwarded-Host"`server).header("X-Forwarded-Port"`port).header("X-Forwarded-Context"`context).header("X-Forwarded-Proto"`proto).then().statusCode(HttpStatus.SC_OK).body(containsString(server)).body(containsString(port)).body(containsString(context)).body(containsString(proto)).body(containsString("test-cluster")).body(containsString("admin")).when().get(url);" is 467.,953
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testXForwardedHeaders,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).header("X-Forwarded-Host"`host).header("X-Forwarded-Port"`port).then().statusCode(HttpStatus.SC_OK).body(containsString(host)).body(containsString(port)).body(containsString("test-cluster")).body(containsString("admin")).when().get(url);" is 333.,953
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testXForwardedHeaders,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).body(containsString(url)).body(containsString("test-cluster")).body(containsString("admin")).when().get(url);" is 241.,953
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testXForwardedHeaders,Magic Number,The method contains a magic number: 777,953
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testGatewayPathChange,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).body(containsString(url + "/test-cluster")).when().get(url);" is 192.,1068
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testGatewayPathChange,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).body(containsString(newUrl + "/test-cluster")).when().get(newUrl);" is 198.,1068
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testProviderConfigurationCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_NOT_ACCEPTABLE).when().get(serviceUrl);" is 167.,1113
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testProviderConfigurationCollection,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1113
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testProviderConfigurationCollection,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 216.,1113
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testProviderConfigurationCollection,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 216.,1113
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testProviderConfigurationCollection,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_XML).when().get(href1).body();" is 209.,1113
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testProviderConfigurationCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(serviceUrl + "/not-a-real-provider-config");" is 194.,1113
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testProviderConfigurationCollection,Magic Number,The method contains a magic number: 2,1113
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_XML).body(newProviderConfigXML.toBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_CREATED).when().put(serviceUrl + "/" + newProviderConfigName);" is 262.,1211
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutProviderConfiguration,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1211
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutProviderConfiguration,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_XML).when().get(href).body();" is 208.,1211
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutProviderConfigurationWithInvalidName,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_XML).body(newProviderConfigXML.toBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_BAD_REQUEST).when().put(serviceUrl + "/" + newProviderConfigName);" is 266.,1270
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteProviderConfiguration,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1299
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteProviderConfiguration,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href1).body();" is 214.,1299
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteProviderConfiguration,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href2).body();" is 214.,1299
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).when().delete(serviceUrl + "/does-not-exist");" is 179.,1299
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteProviderConfiguration,Magic Number,The method contains a magic number: 2,1299
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Empty catch clause,The method has an empty catch block.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Empty catch clause,The method has an empty catch block.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Empty catch clause,The method has an empty catch block.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_CREATED).when().put(descriptorsUrl + "/" + descriptorName);" is 258.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_MODIFIED).when().delete(href1).body();" is 127.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(updatedDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_NO_CONTENT).when().put(descriptorsUrl + "/" + descriptorName);" is 265.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href1).body();" is 214.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(updatedDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_NO_CONTENT).when().put(descriptorsUrl + "/" + descriptorName);" is 265.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href2).body();" is 214.,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Magic Number,The method contains a magic number: 2,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Magic Number,The method contains a magic number: 10000,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Magic Number,The method contains a magic number: 10000,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteReferencedProviderConfiguration,Magic Number,The method contains a magic number: 10000,1376
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Empty catch clause,The method has an empty catch block.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Empty catch clause,The method has an empty catch block.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_CREATED).when().put(descriptorsUrl + "/" + descriptorName);" is 258.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_NOT_MODIFIED).when().delete(href1).body();" is 127.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href1 + "?force=true").body();" is 230.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(updatedDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_NO_CONTENT).when().put(descriptorsUrl + "/" + descriptorName);" is 265.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href2 + "?force=true").body();" is 230.,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Magic Number,The method contains a magic number: 2,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Magic Number,The method contains a magic number: 10000,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testForceDeleteReferencedProviderConfiguration,Magic Number,The method contains a magic number: 10000,1509
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_NOT_ACCEPTABLE).when().get(serviceUrl);" is 167.,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 216.,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 216.,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_XML).then().statusCode(HttpStatus.SC_NOT_ACCEPTABLE).when().get(href1).body();" is 169.,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(href1).body();" is 211.,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(serviceUrl + "/not-a-real-descriptor").body();" is 197.,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDescriptorCollection,Magic Number,The method contains a magic number: 2,1623
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptor,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_XML).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_UNSUPPORTED_MEDIA_TYPE).when().put(serviceUrl + "/" + newDescriptorName);" is 271.,1725
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptor,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_CREATED).when().put(serviceUrl + "/" + newDescriptorName);" is 257.,1725
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptor,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1725
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptor,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(href).body();" is 210.,1725
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptorWithValidEncodedName,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_CREATED).when().put(serviceUrl + "/" + encodedName);" is 251.,1792
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptorWithValidEncodedName,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1792
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptorWithFileExtension,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_CREATED).when().put(serviceUrl + "/" + newDescriptorFileName);" is 261.,1840
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptorWithFileExtension,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1840
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptorWithInvalidEncodedName,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_BAD_REQUEST).when().put(serviceUrl + "/" + encodedName);" is 255.,1887
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testPutDescriptorWithInvalidNameTooLong,Magic Number,The method contains a magic number: 101,1942
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,doTestPutDescriptorWithInvalidName,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Content-type"`MediaType.APPLICATION_JSON).body(newDescriptorJSON.getBytes(StandardCharsets.UTF_8.name())).then().statusCode(HttpStatus.SC_BAD_REQUEST).when().put(serviceUrl + "/" + newDescriptorName);" is 261.,1956
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,doTestPutDescriptorWithInvalidName,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1956
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteDescriptor,Long Statement,The length of the statement "ResponseBody responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).body();" is 229.,1995
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteDescriptor,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href1).body();" is 214.,1995
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteDescriptor,Long Statement,The length of the statement "responseBody=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().delete(href2).body();" is 214.,1995
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteDescriptor,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).when().delete(serviceUrl + "/does-not-exist");" is 179.,1995
apache_knox,org.apache.knox.gateway,GatewayAdminTopologyFuncTest,testDeleteDescriptor,Magic Number,The method contains a magic number: 2,1995
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("KNOX").gotoRoot();" is 1134.,116
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAdminService,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).when().get(serviceUrl);" is 156.,150
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPI,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).param("value"`"mysecret").then().statusCode(HttpStatus.SC_CREATED).body(is("{ \"created\" : { \"topology\": \"test-cluster\"` \"alias\": \"myalias\" } }")).when().post(addAliasUrl);" is 278.,170
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPI,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).body("mysecret").then().statusCode(HttpStatus.SC_CREATED).body(is("{ \"created\" : { \"topology\": \"test-cluster\"` \"alias\": \"putalias\" } }")).when().put(putAliasUrl);" is 269.,170
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPI,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body(is("{\"topology\":\"test-cluster\"`\"aliases\":[\"putalias\"`\"myalias\"`\"encryptquerystring\"]}")).when().get(getAliasUrl);" is 263.,170
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPI,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body(is("{ \"deleted\" : { \"topology\": \"test-cluster\"` \"alias\": \"myalias\" } }")).when().delete(deleteAliasUrl);" is 252.,170
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPI,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body(is("{\"topology\":\"test-cluster\"`\"aliases\":[\"putalias\"`\"encryptquerystring\"]}")).when().get(getAliasUrl);" is 251.,170
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPIFail,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_BAD_REQUEST).body(is("Alias value cannot be null or blank")).when().post(addAliasUrl);" is 215.,216
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPIFail,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_BAD_REQUEST).body(is("Alias value cannot be null or blank")).when().put(putAliasUrl);" is 214.,216
apache_knox,org.apache.knox.gateway,GatewayAdminFuncTest,testAliasAPIFail,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("Accept"`MediaType.APPLICATION_JSON).then().statusCode(HttpStatus.SC_OK).body(is("{\"topology\":\"no-cluster\"`\"aliases\":[]}")).when().get(getAliasUrl);" is 214.,216
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("webappsec").addTag("name").addText("WebAppSec").addTag("enabled").addText("true").addTag("param").addTag("name").addText("csrf.enabled").addTag("value").addText("true").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("OOZIEUI").addTag("url").addText(driver.getRealUrl("OOZIEUI")).gotoParent();" is 1410.,90
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 213.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + path + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 238.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 213.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + path + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 238.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 213.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + path + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 238.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 213.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + path + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 238.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 213.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + path + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 238.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 213.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + path + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 238.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 213.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + path + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 238.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "driver.getMock("OOZIEUI").expect().method("GET").pathInfo("/").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 212.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"test-xsrf-header-value").then().statusCode(200).when().get(driver.getUrl("OOZIEUI") + (driver.isUseGateway() ? "" : "?user.name=" + username)).asString();" is 231.,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayUIFuncTest,testOozieUIRoutesAndRewriteRules,Magic Number,The method contains a magic number: 200,135
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("webappsec").addTag("name").addText("WebAppSec").addTag("enabled").addText("true").addTag("param").addTag("name").addText("csrf.enabled").addTag("value").addText("true").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("enabled").addText("true").addTag("name").addText("AclsAuthz").gotoParent().addTag("param").addTag("name").addText("webhdfs-acl").addTag("value").addText("hdfs;*;*").gotoParent().gotoRoot().addTag("service").addTag("role").addText("WEBHDFS").addTag("url").addText(driver.getRealUrl("WEBHDFS")).gotoParent().addTag("service").addTag("role").addText("NAMENODE").addTag("url").addText(driver.getRealUrl("NAMENODE")).gotoParent().addTag("service").addTag("role").addText("DATANODE").addTag("url").addText(driver.getRealUrl("DATANODE")).gotoParent().addTag("service").addTag("role").addText("JOBTRACKER").addTag("url").addText(driver.getRealUrl("JOBTRACKER")).gotoParent().addTag("service").addTag("role").addText("WEBHCAT").addTag("url").addText(driver.getRealUrl("WEBHCAT")).gotoParent().addTag("service").addTag("role").addText("OOZIE").addTag("url").addText(driver.getRealUrl("OOZIE")).gotoParent().addTag("service").addTag("role").addText("HIVE").addTag("url").addText(driver.getRealUrl("HIVE")).gotoParent().addTag("service").addTag("role").addText("WEBHBASE").addTag("url").addText(driver.getRealUrl("WEBHBASE")).gotoParent().addTag("service").addTag("role").addText("RESOURCEMANAGER").addTag("url").addText(driver.getRealUrl("RESOURCEMANAGER")).gotoParent().addTag("service").addTag("role").addText("FALCON").addTag("url").addText(driver.getRealUrl("FALCON")).gotoParent().addTag("service").addTag("role").addText("STORM").addTag("url").addText(driver.getRealUrl("STORM")).gotoParent().addTag("service").addTag("role").addText("STORM-LOGVIEWER").addTag("url").addText(driver.getRealUrl("STORM-LOGVIEWER")).gotoParent().addTag("service").addTag("role").addText("SOLR").addTag("url").addText(driver.getRealUrl("SOLR")).gotoParent().addTag("service").addTag("role").addText("KAFKA").addTag("url").addText(driver.getRealUrl("KAFKA")).gotoParent().addTag("service").addTag("role").addText("SERVICE-TEST").gotoRoot();" is 3262.,186
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicJsonUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + root + "/dir").queryParam("op"`"MKDIRS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-success.json")).contentType("application/json");" is 264.,280
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicJsonUseCase,Long Statement,The length of the statement "Cookie cookie=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"MKDIRS").then().statusCode(HttpStatus.SC_OK).contentType("application/json").body("boolean"`is(true)).when().put(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir").getDetailedCookie(GatewayServer.KNOXSESSIONCOOKIENAME);" is 339.,280
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicJsonUseCase,Magic Number,The method contains a magic number: 16,280
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicOutboundHeaderUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + root + "/dir/file").header("Host"`driver.getRealAddr("WEBHDFS")).queryParam("op"`"CREATE").queryParam("user.name"`username).respond().status(HttpStatus.SC_TEMPORARY_REDIRECT).header("Location"`driver.getRealUrl("DATANODE") + "/v1" + root+ "/dir/file?op=CREATE&user.name=hdfs");" is 343.,326
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicOutboundHeaderUseCase,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"CREATE").then().statusCode(HttpStatus.SC_TEMPORARY_REDIRECT).when().put(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir/file");" is 252.,326
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicOutboundHeaderUseCase,Long Statement,The length of the statement "assertThat(location`anyOf(startsWith("http://" + gatewayHostName + ":"+ gatewayAddress.getPort()+ "/")`startsWith("http://" + gatewayAddrName + ":"+ gatewayAddress.getPort()+ "/")));" is 182.,326
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicOutboundEncodedHeaderUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + root + "/dir/fileレポー").header("Host"`driver.getRealAddr("WEBHDFS")).queryParam("op"`"CREATE").queryParam("user.name"`username).respond().status(HttpStatus.SC_TEMPORARY_REDIRECT).header("Location"`driver.getRealUrl("DATANODE") + "/v1" + root+ "/dir/file%E3%83%AC%E3%83%9D%E3%83%BC?op=CREATE&user.name=hdfs");" is 373.,368
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicOutboundEncodedHeaderUseCase,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"CREATE").then().statusCode(HttpStatus.SC_TEMPORARY_REDIRECT).when().put(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir/fileレポー");" is 255.,368
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHdfsTildeUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("DELETE").from("testHdfsTildeUseCase").pathInfo("/v1/user/hdfs" + root).queryParam("op"`"DELETE").queryParam("user.name"`username).queryParam("recursive"`"true").respond().status(HttpStatus.SC_OK);" is 239.,403
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHdfsTildeUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"DELETE").queryParam("recursive"`"true").then().statusCode(HttpStatus.SC_OK).when().delete(driver.getUrl("WEBHDFS") + "/v1/~" + root+ (driver.isUseGateway() ? "" : "?user.name=" + username));" is 298.,403
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHdfsTildeUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1/user/hdfs/dir").queryParam("op"`"MKDIRS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-success.json")).contentType("application/json");" is 262.,403
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHdfsTildeUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"MKDIRS").then().statusCode(HttpStatus.SC_OK).contentType("application/json").body("boolean"`is(true)).when().put(driver.getUrl("WEBHDFS") + "/v1/~/dir");" is 261.,403
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("DELETE").from("testBasicHdfsUseCase-1").pathInfo("/v1" + root).queryParam("op"`"DELETE").queryParam("user.name"`username).queryParam("recursive"`"true").respond().status(HttpStatus.SC_OK);" is 231.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"DELETE").queryParam("recursive"`"true").then().statusCode(HttpStatus.SC_OK).when().delete(driver.getUrl("WEBHDFS") + "/v1" + root+ (driver.isUseGateway() ? "" : "?user.name=" + username));" is 296.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + root + "/dir").queryParam("op"`"MKDIRS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-success.json")).contentType("application/json");" is 264.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"MKDIRS").then().statusCode(HttpStatus.SC_OK).contentType("application/json").body("boolean"`is(true)).when().put(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir");" is 270.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("GET").pathInfo("/v1" + root).queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-liststatus-test.json")).contentType("application/json");" is 267.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_OK).body("FileStatuses.FileStatus[0].pathSuffix"`is("dir")).when().get(driver.getUrl("WEBHDFS") + "/v1" + root);" is 265.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`"invalid-password").header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(driver.getUrl("WEBHDFS") + "/v1" + root);" is 229.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic("hdfs-user"`"hdfs-password").header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(driver.getUrl("WEBHDFS") + "/v1" + root);" is 229.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic("mapred-user"`"mapred-password").header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(driver.getUrl("WEBHDFS") + "/v1" + root);" is 233.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + root + "/dir/file").queryParam("op"`"CREATE").queryParam("user.name"`username).respond().status(HttpStatus.SC_TEMPORARY_REDIRECT).header("Location"`driver.getRealUrl("DATANODE") + "/v1" + root+ "/dir/file?op=CREATE&user.name=hdfs");" is 298.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("PUT").pathInfo("/v1" + root + "/dir/file").queryParam("op"`"CREATE").queryParam("user.name"`username).contentType("text/plain").content(driver.getResourceBytes("test.txt")).respond().status(HttpStatus.SC_CREATED).header("Location"`"webhdfs://" + driver.getRealAddr("DATANODE") + "/v1"+ root+ "/dir/file");" is 349.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"CREATE").then().statusCode(HttpStatus.SC_TEMPORARY_REDIRECT).when().put(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir/file");" is 252.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "assertThat(location`anyOf(startsWith("http://" + gatewayHostName + ":"+ gatewayAddress.getPort()+ "/")`startsWith("http://" + gatewayAddrName + ":"+ gatewayAddress.getPort()+ "/")));" is 182.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("test.txt")).contentType("text/plain").then().statusCode(HttpStatus.SC_CREATED).when().put(location);" is 230.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "assertThat(location`anyOf(startsWith("http://" + gatewayHostName + ":"+ gatewayAddress.getPort()+ "/")`startsWith("http://" + gatewayAddrName + ":"+ gatewayAddress.getPort()+ "/")));" is 182.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("GET").pathInfo("/v1" + root + "/dir/file").queryParam("op"`"OPEN").queryParam("user.name"`username).respond().status(HttpStatus.SC_TEMPORARY_REDIRECT).header("Location"`driver.getRealUrl("DATANODE") + "/v1" + root+ "/dir/file?op=OPEN&user.name=hdfs");" is 294.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("GET").pathInfo("/v1" + root + "/dir/file").queryParam("op"`"OPEN").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).contentType("text/plain").content(driver.getResourceBytes("test.txt"));" is 250.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"OPEN").then().statusCode(HttpStatus.SC_OK).body(is("TEST")).when().get(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir/file");" is 233.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().from("testBasicHdfsUseCase-1").method("DELETE").pathInfo("/v1" + root).queryParam("op"`"DELETE").queryParam("user.name"`username).queryParam("recursive"`"true").respond().status(HttpStatus.SC_OK);" is 231.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHdfsUseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"DELETE").queryParam("recursive"`"true").then().statusCode(HttpStatus.SC_OK).when().delete(driver.getUrl("WEBHDFS") + "/v1" + root);" is 239.,467
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Long Statement,The length of the statement "given().auth().preemptive().basic(userA`"invalid-password").header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"OPEN").then().statusCode(HttpStatus.SC_UNAUTHORIZED).when().get(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dirA700/fileA700");" is 241.,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 200,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 403,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 307,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPmHdfsM1UseCase,Magic Number,The method contains a magic number: 201,754
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Long Statement,The length of the statement "createFile(user`pass`null`root + "/hadoop-examples.jar"`"777"`"application/octet-stream"`findHadoopExamplesJar()`307`201`200);" is 126.,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Long Statement,The length of the statement "String job=submitJava(user`pass`root + "/hadoop-examples.jar"`"org.apache.org.apache.hadoop.examples.WordCount"`root + "/input"`root + "/output"`200);" is 150.,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 307,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 201,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 200,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 307,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 201,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 200,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 200,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 200,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testJavaMapReduceViaWebHCat,Magic Number,The method contains a magic number: 200,865
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 200,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 404,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 307,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 201,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 200,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 307,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 201,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 200,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 200,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 200,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 200,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPigViaWebHCat,Magic Number,The method contains a magic number: 200,920
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHiveViaWebHCat,Magic Number,The method contains a magic number: 200,951
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHiveViaWebHCat,Magic Number,The method contains a magic number: 404,951
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHiveViaWebHCat,Magic Number,The method contains a magic number: 307,951
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHiveViaWebHCat,Magic Number,The method contains a magic number: 201,951
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHiveViaWebHCat,Magic Number,The method contains a magic number: 200,951
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHiveViaWebHCat,Magic Number,The method contains a magic number: 200,951
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHiveViaWebHCat,Magic Number,The method contains a magic number: 200,951
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Long Statement,The length of the statement "createFile(user`pass`group`root + "/lib/hadoop-examples.jar"`"777"`"application/octet-stream"`findHadoopExamplesJar()`307`201`200);" is 131.,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 307,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 201,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 200,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 307,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 201,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 200,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 307,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 201,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 200,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 201,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 1000,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 1000,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 60,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testOozieJobSubmission,Magic Number,The method contains a magic number: 200,978
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/open-session-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/open-session-result.bin")).contentType("application/x-thrift");" is 334.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/open-session-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 315.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/execute-set-fetch-output-serde-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/execute-set-fetch-output-serde-result.bin")).contentType("application/x-thrift");" is 370.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/execute-set-fetch-output-serde-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 324.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/close-operation-1-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/close-operation-1-result.bin")).contentType("application/x-thrift");" is 344.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/close-operation-1-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 311.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/execute-set-server2-http-path-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/execute-set-server2-http-path-result.bin")).contentType("application/x-thrift");" is 368.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/execute-set-server2-http-path-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 323.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/close-operation-2-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/close-operation-2-result.bin")).contentType("application/x-thrift");" is 344.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/close-operation-2-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 311.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/execute-set-server2-servermode-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/execute-set-server2-servermode-result.bin")).contentType("application/x-thrift");" is 370.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/execute-set-server2-servermode-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 324.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/close-operation-3-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/close-operation-3-result.bin")).contentType("application/x-thrift");" is 344.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/close-operation-3-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 311.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/execute-set-security-authorization-enabled-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/execute-set-security-authorization-enabled-result.bin")).contentType("application/x-thrift");" is 394.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/execute-set-security-authorization-enabled-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 336.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "assertThat(response.body().asByteArray()`is(driver.getResourceBytes("hive/execute-set-security-authorization-enabled-result.bin")));" is 132.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/close-operation-4-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/close-operation-4-result.bin")).contentType("application/x-thrift");" is 344.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/close-operation-4-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 311.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/execute-create-table-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/execute-create-table-result.bin")).contentType("application/x-thrift");" is 350.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/execute-create-table-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 314.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/close-operation-5-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/close-operation-5-result.bin")).contentType("application/x-thrift");" is 344.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/close-operation-5-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 311.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/execute-select-from-table-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/execute-select-from-table-result.bin")).contentType("application/x-thrift");" is 360.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/execute-select-from-table-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 319.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/get-result-set-metadata-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/get-result-set-metadata-result.bin")).contentType("application/x-thrift");" is 356.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/get-result-set-metadata-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 317.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/fetch-results-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/fetch-results-result.bin")).contentType("application/x-thrift");" is 336.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/fetch-results-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 307.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/close-operation-6-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/close-operation-6-result.bin")).contentType("application/x-thrift");" is 344.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/close-operation-6-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 311.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "driver.getMock("HIVE").expect().method("POST").content(driver.getResourceBytes("hive/close-session-request.bin")).contentType("application/x-thrift").respond().characterEncoding(StandardCharsets.UTF_8.name()).status(HttpStatus.SC_OK).content(driver.getResourceBytes("hive/close-session-result.bin")).contentType("application/x-thrift");" is 336.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testBasicHiveJDBCUseCase,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes("hive/close-session-request.bin")).contentType("application/x-thrift").then().statusCode(HttpStatus.SC_OK).contentType("application/x-thrift").when().post(driver.getUrl("HIVE"));" is 307.,1048
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableList,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo("/").header("Accept"`ContentType.XML.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString());" is 239.,1449
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableList,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.XML).when().get(driver.getUrl("WEBHBASE"));" is 256.,1449
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableList,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo("/").header("Accept"`ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString());" is 242.,1449
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableList,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON).when().get(driver.getUrl("WEBHBASE"));" is 249.,1449
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableList,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo("/").header("Accept"`"application/x-protobuf").respond().status(HttpStatus.SC_OK).content(driver.getResourceString(resourceName + ".protobuf")`StandardCharsets.UTF_8).contentType("application/x-protobuf");" is 264.,1449
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableList,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`"application/x-protobuf").then().statusCode(HttpStatus.SC_OK).contentType("application/x-protobuf").body(is(driver.getResourceString(resourceName + ".protobuf"))).when().get(driver.getUrl("WEBHBASE"));" is 308.,1449
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseCreateTableAndVerifySchema,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").pathInfo(path).respond().status(HttpStatus.SC_CREATED).content(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString()).header("Location"`driver.getRealUrl("WEBHBASE") + path);" is 257.,1525
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseCreateTableAndVerifySchema,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_CREATED).contentType(ContentType.XML).header("Location"`startsWith(driver.getUrl("WEBHBASE") + path)).when().put(driver.getUrl("WEBHBASE") + path);" is 270.,1525
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseCreateTableAndVerifySchema,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").pathInfo(path).respond().status(HttpStatus.SC_CREATED).content(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString()).header("Location"`driver.getRealUrl("WEBHBASE") + path);" is 259.,1525
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseCreateTableAndVerifySchema,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_CREATED).contentType(ContentType.JSON).header("Location"`startsWith(driver.getUrl("WEBHBASE") + path)).when().put(driver.getUrl("WEBHBASE") + path);" is 271.,1525
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseCreateTableAndVerifySchema,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").pathInfo(path).respond().status(HttpStatus.SC_CREATED).content(driver.getResourceBytes(resourceName + ".protobuf")).contentType("application/x-protobuf").header("Location"`driver.getRealUrl("WEBHBASE") + path);" is 260.,1525
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseCreateTableAndVerifySchema,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_CREATED).contentType("application/x-protobuf").header("Location"`startsWith(driver.getUrl("WEBHBASE") + path)).when().put(driver.getUrl("WEBHBASE") + path);" is 279.,1525
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableSchema,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(path).header("Accept"`ContentType.XML.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString());" is 240.,1596
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableSchema,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.XML).when().get(driver.getUrl("WEBHBASE") + path);" is 263.,1596
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableSchema,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(path).header("Accept"`ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString());" is 243.,1596
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableSchema,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON).when().get(driver.getUrl("WEBHBASE") + path);" is 256.,1596
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableSchema,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(path).header("Accept"`"application/x-protobuf").respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".protobuf")).contentType("application/x-protobuf");" is 241.,1596
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseGetTableSchema,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`"application/x-protobuf").then().statusCode(HttpStatus.SC_OK).contentType("application/x-protobuf").when().get(driver.getUrl("WEBHBASE") + path);" is 261.,1596
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testEncodedForwardSlash,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").requestURI(singleRowPath).contentType(ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK);" is 152.,1675
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testEncodedForwardSlash,Long Statement,The length of the statement "try (CloseableHttpClient httpClient=HttpClients.custom().setDefaultCredentialsProvider(credentialsProvider).setDefaultRequestConfig(requestConfig).build()){" is 156.,1675
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testEncodedForwardSlash,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").requestURI(singleRowPath).contentType(ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK);" is 152.,1675
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testEncodedForwardSlash,Long Statement,The length of the statement "given().urlEncodingEnabled(false).auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).when().put(driver.getUrl("WEBHBASE") + singleRowPath);" is 302.,1675
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testEncodedForwardSlash,Magic Number,The method contains a magic number: 200,1675
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").pathInfo(multipleRowPath).content(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString()).respond().status(HttpStatus.SC_OK);" is 207.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).when().put(driver.getUrl("WEBHBASE") + multipleRowPath);" is 276.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").pathInfo(singleRowPath).contentType(ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK);" is 150.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).when().put(driver.getUrl("WEBHBASE") + singleRowPath);" is 276.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("PUT").pathInfo(multipleRowPath).contentType("application/x-protobuf").content(driver.getResourceBytes(resourceName + ".protobuf")).respond().status(HttpStatus.SC_OK);" is 210.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resourceName + ".protobuf")).contentType("application/x-protobuf").then().statusCode(HttpStatus.SC_OK).when().put(driver.getUrl("WEBHBASE") + multipleRowPath);" is 279.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("POST").pathInfo(multipleRowPath).content(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString()).respond().status(HttpStatus.SC_OK);" is 208.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).when().post(driver.getUrl("WEBHBASE") + multipleRowPath);" is 277.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("POST").pathInfo(singleRowPath).contentType(ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK);" is 151.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).when().post(driver.getUrl("WEBHBASE") + singleRowPath);" is 277.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("POST").pathInfo(multipleRowPath).content(driver.getResourceBytes(resourceName + ".protobuf")).contentType("application/x-protobuf").respond().status(HttpStatus.SC_OK);" is 211.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseInsertDataIntoTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resourceName + ".protobuf")).contentType("application/x-protobuf").then().statusCode(HttpStatus.SC_OK).when().post(driver.getUrl("WEBHBASE") + multipleRowPath);" is 280.,1743
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseDeleteDataFromTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().from("testHBaseDeleteDataFromTable-1").method("DELETE").pathInfo("/" + tableId + "/"+ rowId).respond().status(HttpStatus.SC_OK);" is 164.,1883
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseDeleteDataFromTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).when().delete(driver.getUrl("WEBHBASE") + "/" + tableId+ "/"+ rowId);" is 196.,1883
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseDeleteDataFromTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().from("testHBaseDeleteDataFromTable-2").method("DELETE").pathInfo("/" + tableId + "/"+ rowId+ "/"+ familyId).respond().status(HttpStatus.SC_OK);" is 179.,1883
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseDeleteDataFromTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).when().delete(driver.getUrl("WEBHBASE") + "/" + tableId+ "/"+ rowId+ "/"+ familyId);" is 211.,1883
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseDeleteDataFromTable,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().from("testHBaseDeleteDataFromTable-3").method("DELETE").pathInfo("/" + tableId + "/"+ rowId+ "/"+ familyId+ ":"+ columnId).respond().status(HttpStatus.SC_OK);" is 194.,1883
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseDeleteDataFromTable,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).when().delete(driver.getUrl("WEBHBASE") + "/" + tableId+ "/"+ rowId+ "/"+ familyId+ ":"+ columnId);" is 226.,1883
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(allRowsPath).header("Accept"`ContentType.XML.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString());" is 247.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.XML).when().get(driver.getUrl("WEBHBASE") + allRowsPath);" is 270.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(rowsStartsWithPath).header("Accept"`ContentType.XML.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".xml")).contentType(ContentType.XML.toString());" is 254.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.XML).when().get(driver.getUrl("WEBHBASE") + rowsStartsWithPath);" is 268.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(rowsWithKeyPath).header("Accept"`ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString());" is 254.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON).when().get(driver.getUrl("WEBHBASE") + rowsWithKeyPath);" is 267.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(rowsWithKeyAndColumnPath).header("Accept"`ContentType.JSON.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName + ".json")).contentType(ContentType.JSON.toString());" is 263.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseQueryTableData,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON).when().get(driver.getUrl("WEBHBASE") + rowsWithKeyAndColumnPath);" is 276.,1945
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseUseScanner,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Content-Type"`ContentType.XML.toString()).body(driver.getResourceBytes(scannerDefinitionResourceName + ".xml")).then().statusCode(HttpStatus.SC_CREATED).when().put(driver.getUrl("WEBHBASE") + scannerPath);" is 304.,2052
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseUseScanner,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().method("GET").pathInfo(scannerPath + "/" + scannerId).header("Accept"`ContentType.XML.toString()).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(tableDataResourceName + ".xml")).contentType(ContentType.XML.toString());" is 274.,2052
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseUseScanner,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.XML).when().get(driver.getUrl("WEBHBASE") + scannerPath + "/"+ scannerId);" is 287.,2052
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseUseScanner,Long Statement,The length of the statement "assertThat(the(response.getBody().asString())`isEquivalentTo(the(driver.getResourceString(tableDataResourceName + ".xml"))));" is 125.,2052
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseUseScanner,Long Statement,The length of the statement "driver.getMock("WEBHBASE").expect().from("testHBaseUseScanner").method("DELETE").pathInfo(scannerPath + "/" + scannerId).respond().status(HttpStatus.SC_OK);" is 156.,2052
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testHBaseUseScanner,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).when().delete(driver.getUrl("WEBHBASE") + scannerPath + "/"+ scannerId);" is 199.,2052
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCrossSiteRequestForgeryPreventionPUT,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).queryParam("op"`"MKDIRS").then().statusCode(HttpStatus.SC_BAD_REQUEST).when().put(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir");" is 184.,2127
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCrossSiteRequestForgeryPreventionGET,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("GET").pathInfo("/v1" + root + "/dir").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK);" is 179.,2146
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCrossSiteRequestForgeryPreventionGET,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_OK).when().get(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir");" is 179.,2146
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmApps,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@6df577d9,2233
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnApplicationLifecycle,Long Statement,The length of the statement "driver.getMock("RESOURCEMANAGER").expect().method("POST").respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resource)).contentType("application/json");" is 168.,2306
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnApplicationLifecycle,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).contentType("application/json").when().post(driver.getUrl("RESOURCEMANAGER") + path + (driver.isUseGateway() ? "" : "?user.name=" + username));" is 288.,2306
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnApplicationLifecycle,Long Statement,The length of the statement "driver.getMock("RESOURCEMANAGER").expect().method("POST").content(driver.getResourceBytes(resource)).contentType("application/json").respond().status(HttpStatus.SC_OK).contentType("application/json");" is 200.,2306
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnApplicationLifecycle,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resource)).contentType("application/json").then().statusCode(HttpStatus.SC_OK).contentType("application/json").when().post(driver.getUrl("RESOURCEMANAGER") + path + (driver.isUseGateway() ? "" : "?user.name=" + username));" is 342.,2306
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnApplicationLifecycle,Long Statement,The length of the statement "driver.getMock("RESOURCEMANAGER").expect().method("PUT").content(driver.getResourceBytes(resource)).contentType("application/json").respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resource)).contentType("application/json");" is 242.,2306
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnApplicationLifecycle,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").body(driver.getResourceBytes(resource)).contentType("application/json").then().statusCode(HttpStatus.SC_OK).contentType("application/json").when().put(driver.getUrl("RESOURCEMANAGER") + path + (driver.isUseGateway() ? "" : "?user.name=" + username));" is 350.,2306
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmApp,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@7aaeec9b,2386
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmResource,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@5accb081,2461
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmResource,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@4975934,2461
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmAppattempts,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@421abdc0,2521
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmNodes,Long Statement,The length of the statement "MockRequestMatcher mockRequestMatcher=driver.getMock("RESOURCEMANAGER").expect().method("GET").pathInfo(path).queryParam("user.name"`username);" is 143.,2579
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmNodes,Long Statement,The length of the statement "mockRequestMatcher.respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(nodesResource + (contentType == ContentType.JSON ? ".json" : ".xml"))).contentType(contentType.toString());" is 193.,2579
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmNodes,Long Statement,The length of the statement "String encryptedNodeId=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).contentType(contentType).body("nodes.node[0].id"`not(containsString(nodeId))).body("nodes.node[0].nodeHostName"`is(emptyString())).body("nodes.node[0].nodeHTTPAddress"`is(emptyString())).when().get(gatewayPath + gatewayPathQuery).getBody().path("nodes.node[0].id");" is 415.,2579
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmNodes,Long Statement,The length of the statement "driver.getMock("RESOURCEMANAGER").expect().method("GET").pathInfo(path + nodeId).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(nodeResource + (contentType == ContentType.JSON ? ".json" : ".xml"))).contentType(contentType.toString());" is 287.,2579
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmNodes,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).contentType(contentType).body("node.id"`not(containsString(nodeId))).body("node.nodeHostName"`is(emptyString())).body("node.nodeHTTPAddress"`is(emptyString())).when().get(gatewayPath + encryptedNodeId);" is 329.,2579
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "driver.getMock("RESOURCEMANAGER").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(request.getBytes(StandardCharsets.UTF_8)).contentType(ContentType.JSON.toString());" is 231.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "String encryptedTrackingUrl=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON).when().get(gatewayPath + (driver.isUseGateway() ? "" : "?user.name=" + username)).getBody().path("app.trackingUrl");" is 301.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(encryptedTrackingUrl);" is 167.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "path="/proxy/application_1399541193872_0036/ws/v1/mapreduce/jobs/job_1399541193872_0036/tasks/task_1399541193872_0036_r_00";" is 124.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "path="/proxy/application_1399541193872_0036/ws/v1/mapreduce/jobs/job_1399541193872_0036/tasks/task_1399541193872_0036_r_00/counters";" is 133.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "path="/proxy/application_1399541193872_0036/ws/v1/mapreduce/jobs/job_1399541193872_0036/tasks/task_1399541193872_0036_r_00/attempts";" is 133.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "path="/proxy/application_1399541193872_0036/ws/v1/mapreduce/jobs/job_1399541193872_0036/tasks/task_1399541193872_0036_r_00/attempts/attempt_1399541193872_0036_r_000000_0";" is 171.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testYarnRmProxy,Long Statement,The length of the statement "path="/proxy/application_1399541193872_0036/ws/v1/mapreduce/jobs/job_1399541193872_0036/tasks/task_1399541193872_0036_r_00/attempts/attempt_1399541193872_0036_r_000000_0/counters";" is 180.,2655
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmProxyData,Complex Method,Cyclomatic complexity of the method is 8,2813
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmProxyData,Long Parameter List,The method has 5 parameters. ,2813
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmProxyData,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@4fdd4b2c,2813
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmProxyData,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@70aab2ee,2813
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,getYarnRmProxyJobConf,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@4eca1b36,2871
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testFalconAdmin,Long Statement,The length of the statement "driver.getMock("FALCON").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.TEXT.toString());" is 219.,2933
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testFalconAdmin,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).when().get(gatewayPath);" is 169.,2933
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testFalconMetadataLineage,Long Statement,The length of the statement "driver.getMock("FALCON").expect().method("GET").pathInfo(path).queryParam("user.name"`username).queryParam("key"`"name").queryParam("value"`"rawEmailIngestProcess").respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.JSON.toString());" is 288.,3057
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testFalconMetadataLineage,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").then().statusCode(HttpStatus.SC_OK).when().get(gatewayPath);" is 169.,3057
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testGetFalconResource,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@59a95b92,3128
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testGetFalconResource,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@7c88efa0,3128
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPostFalconResource,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@59901f1d,3180
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testStormUiApi,Long Statement,The length of the statement "driver.getMock("STORM").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.JSON.toString());" is 218.,3245
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testStormUiApi,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON.toString()).when().get(gatewayPath);" is 255.,3245
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testStormUiApi,Long Statement,The length of the statement "assertThat(link`anyOf(startsWith("http://" + gatewayHostName + ":"+ gatewayAddress.getPort()+ "/")`startsWith("http://" + gatewayAddrName + ":"+ gatewayAddress.getPort()+ "/")));" is 178.,3245
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testStormUiApi,Long Statement,The length of the statement "driver.getMock("STORM").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.JSON.toString());" is 218.,3245
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testStormUiApi,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON.toString()).when().get(gatewayPath);" is 246.,3245
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testStormUiApi,Long Statement,The length of the statement "assertThat(link`anyOf(startsWith("http://" + gatewayHostName + ":"+ gatewayAddress.getPort()+ "/")`startsWith("http://" + gatewayAddrName + ":"+ gatewayAddress.getPort()+ "/")));" is 178.,3245
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testGetStormResource,Long Statement,The length of the statement "driver.getMock("STORM").expect().method("GET").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.JSON.toString());" is 218.,3348
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testGetStormResource,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON.toString()).when().get(gatewayPath);" is 255.,3348
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPostStormResource,Long Statement,The length of the statement "driver.getMock("STORM").expect().method("POST").pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_MOVED_TEMPORARILY).contentType(ContentType.JSON.toString());" is 187.,3378
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testPostStormResource,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("X-CSRF-Token"`"H/8xIWCYQo4ZDWLvV9k0FAkjD0omWI8beVTp2mEPRxCbJmWBTYhRMhIV9LGIY3E51OAj+s6T7eQChpGJ").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_MOVED_TEMPORARILY).contentType(ContentType.JSON.toString()).when().post(gatewayPath);" is 359.,3378
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersPopulate,Long Statement,The length of the statement "driver.getMock("STORM").expect().method("GET").header("X-Forwarded-Host"`Matchers.is(oneOf(gatewayHostName + ":" + gatewayPort`gatewayAddrName + ":" + gatewayPort))).header("X-Forwarded-Proto"`"http").header("X-Forwarded-Port"`Integer.toString(gatewayPort)).header("X-Forwarded-Context"`"/gateway/cluster").header("X-Forwarded-Server"`Matchers.is(oneOf(gatewayHostName`gatewayAddrName))).header("X-Forwarded-For"`Matchers.is(oneOf(gatewayHostName`gatewayAddrName))).pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.JSON.toString());" is 637.,3406
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersPopulate,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON.toString()).when().get(gatewayPath);" is 255.,3406
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersPopulate,Long Statement,The length of the statement "assertThat(link`anyOf(startsWith("http://" + gatewayHostName + ":"+ gatewayPort+ "/")`startsWith("http://" + gatewayAddrName + ":"+ gatewayPort+ "/")));" is 152.,3406
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersRewrite,Long Statement,The length of the statement "driver.getMock("STORM").expect().method("GET").header("X-Forwarded-Host"`host).header("X-Forwarded-Proto"`scheme).header("X-Forwarded-Port"`port).header("X-Forwarded-Context"`"/gateway/cluster").header("X-Forwarded-Server"`host).header("X-Forwarded-For"`Matchers.containsString("what` boo")).pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.JSON.toString());" is 463.,3457
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersRewrite,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).header("X-Forwarded-Host"`host).header("X-Forwarded-Proto"`scheme).header("X-Forwarded-Port"`port).header("X-Forwarded-Server"`"what").header("X-Forwarded-For"`"what` boo").then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON.toString()).when().get(gatewayPath);" is 428.,3457
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersRewrite,Long Statement,The length of the statement "driver.getMock("STORM").expect().method("GET").header("X-Forwarded-Host"`host).header("X-Forwarded-Proto"`scheme).header("X-Forwarded-Port"`port).header("X-Forwarded-Context"`"/gateway/cluster").header("X-Forwarded-Server"`host).header("X-Forwarded-For"`Matchers.containsString("what` boo")).pathInfo(path).queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.JSON.toString());" is 463.,3457
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersRewrite,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.JSON.toString()).header("X-Forwarded-Host"`host).header("X-Forwarded-Proto"`scheme).header("X-Forwarded-Port"`port).header("X-Forwarded-Server"`host).header("X-Forwarded-For"`"what` boo").then().statusCode(HttpStatus.SC_OK).contentType(ContentType.JSON.toString()).when().get(gatewayPath);" is 417.,3457
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersRewrite,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + root + "/dir/file").header("Host"`driver.getRealAddr("WEBHDFS")).header("X-Forwarded-Host"`host).header("X-Forwarded-Proto"`scheme).header("X-Forwarded-Port"`port).header("X-Forwarded-Context"`"/gateway/cluster").header("X-Forwarded-Server"`host).header("X-Forwarded-For"`Matchers.containsString("what` boo")).queryParam("op"`"CREATE").queryParam("user.name"`username).respond().status(HttpStatus.SC_TEMPORARY_REDIRECT).header("Location"`driver.getRealUrl("DATANODE") + "/v1" + root+ "/dir/file?op=CREATE&user.name=hdfs");" is 588.,3457
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testXForwardHeadersRewrite,Long Statement,The length of the statement "response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("X-Forwarded-Host"`host).header("X-Forwarded-Proto"`scheme).header("X-Forwarded-Port"`port).header("X-Forwarded-Server"`host).header("X-Forwarded-For"`"what` boo").queryParam("op"`"CREATE").then().statusCode(HttpStatus.SC_TEMPORARY_REDIRECT).when().put(driver.getUrl("WEBHDFS") + "/v1" + root+ "/dir/file");" is 414.,3457
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testServiceTestAPI,Long Statement,The length of the statement "given().header(new Header("Accept"`MediaType.APPLICATION_XML)).then().contentType(MediaType.APPLICATION_XML).statusCode(HttpStatus.SC_OK).body(not(containsString("<httpCode>401"))).body(not(containsString("<httpCode>404"))).body(not(containsString("<httpCode>403"))).body(containsString("<httpCode>200")).when().get(testUrl + queryString);" is 339.,3597
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testServiceTestAPI,Long Statement,The length of the statement "given().header(new Header("Accept"`MediaType.APPLICATION_JSON)).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).body(not(containsString("\"httpCode\" : 401"))).body(not(containsString("\"httpCode\" : 404"))).body(not(containsString("\"httpCode\" : 403"))).body(containsString("\"httpCode\" : 200")).when().get(testUrl + queryString);" is 361.,3597
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testServiceTestAPI,Long Statement,The length of the statement "given().header(new Header("Accept"`MediaType.APPLICATION_JSON)).auth().preemptive().basic("kminder"`"kminder-password").then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).body(not(containsString("\"httpCode\" : 401"))).body(not(containsString("\"httpCode\" : 404"))).body(not(containsString("\"httpCode\" : 403"))).body(containsString("\"httpCode\" : 200")).when().get(testUrl);" is 403.,3597
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testServiceTestAPI,Long Statement,The length of the statement "given().header(new Header("Accept"`MediaType.APPLICATION_JSON)).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).body(not(containsString("\"httpCode\" : 200"))).body(not(containsString("\"httpCode\" : 404"))).body(not(containsString("\"httpCode\" : 403"))).body(containsString("\"httpCode\" : 401")).when().get(testUrl + "?username=bad-user&password=bad-password");" is 392.,3597
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testServiceTestAPI,Long Statement,The length of the statement "given().header(new Header("Accept"`MediaType.APPLICATION_JSON)).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).body(not(containsString("\"httpCode\" : 401"))).body(not(containsString("\"httpCode\" : 404"))).body(not(containsString("\"httpCode\" : 403"))).when().get(testUrl + "?username=mapred&password=mapred-password");" is 350.,3597
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "String[] args={"service-test"`"--master"`"knox"`"--cluster"`driver.clusterName`"--hostname"`gatewayAddress.getHostName()`"--port"`gatewayPort`"--u"`"kminder"`"--p"`"kminder-password"};" is 184.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "Assume.assumeTrue("Gateway port should not contain status code"`!gatewayPort.contains("404") && !gatewayPort.contains("403"));" is 126.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "String[] args2={"service-test"`"--master"`"knox"`"--cluster"`driver.clusterName`"--hostname"`gatewayAddress.getHostName()`"--port"`gatewayPort};" is 144.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`(containsString("Username and/or password not supplied. Expect HTTP 401 Unauthorized responses.")));" is 162.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "String[] args3={"service-test"`"--master"`"knox"`"--cluster"`driver.clusterName`"--hostname"`"bad-host"`"--port"`"0"`"--u"`"guest"`"--p"`"guest-password"};" is 155.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name()).toLowerCase(Locale.ROOT)`either(containsString("nodename nor servname provided")).or(containsString("name or service not known")).or(containsString("//bad-host:0/")));" is 229.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "String[] args4={"service-test"`"--master"`"knox"`"--cluster"`driver.clusterName`"--hostname"`gatewayAddress.getHostName()`"--port"`"543"`"--u"`"mapred"`"--p"`"mapred-password"};" is 177.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testCLIServiceTest,Long Statement,The length of the statement "String[] args5={"service-test"`"--master"`"knox"`"--hostname"`gatewayAddress.getHostName()`"--port"`"543"`"--u"`"mapred"`"--p"`"mapred-password"};" is 146.,3697
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testSolrRESTAPI,Long Statement,The length of the statement "driver.getMock("SOLR").expect().method("GET").pathInfo("/gettingstarted/select").queryParam("q"`"author_s:William+Shakespeare").respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes(resourceName)).contentType(ContentType.XML.toString());" is 250.,3765
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testSolrRESTAPI,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").header("Accept"`ContentType.XML.toString()).then().statusCode(HttpStatus.SC_OK).contentType(ContentType.XML.toString()).when().get(gatewayPath);" is 253.,3765
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,testKafka,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"GET").then().statusCode(HttpStatus.SC_OK).when().get(driver.getUrl("KAFKA") + "/topics");" is 197.,3798
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,setupResource,Long Statement,The length of the statement "driver.getMock(serviceRole).expect().method("GET").pathInfo(path).respond().status(HttpStatus.SC_OK).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name());" is 182.,3823
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileNN,Long Parameter List,The method has 5 parameters. ,3869
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileNN,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + file).queryParam("user.name"`user).queryParam("op"`"CREATE").respond().status(status).header("Location"`driver.getRealUrl("DATANODE") + file + "?op=CREATE&user.name="+ user);" is 240.,3869
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileNN,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + file).queryParam("user.name"`user).queryParam("op"`"CREATE").respond().status(status);" is 152.,3869
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileNN,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"CREATE").queryParam("permission"`permsOctal).then().statusCode(status).when().put(driver.getUrl("WEBHDFS") + "/v1" + file+ (driver.isUseGateway() ? "" : "?user.name=" + user));" is 298.,3869
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileDN,Long Parameter List,The method has 7 parameters. ,3906
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileDN,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("PUT").pathInfo(path).queryParam("user.name"`user).queryParam("op"`"CREATE").contentType(contentType).content(driver.getResourceBytes(resource)).respond().status(status).header("Location"`"webhdfs://" + driver.getRealAddr("DATANODE") + "/v1"+ path);" is 292.,3906
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileDN,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("PUT").pathInfo(path).queryParam("user.name"`user).queryParam("op"`"CREATE").contentType(contentType).content(driver.getResourceStream(resource)).respond().status(status);" is 214.,3906
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFileDN,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").contentType(contentType).body(driver.getResourceBytes(resource)).then().statusCode(status).when().put(location);" is 217.,3906
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFile,Long Parameter List,The method has 10 parameters. ,3944
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createFile,Magic Number,The method contains a magic number: 300,3944
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,readFile,Long Parameter List,The method has 6 parameters. ,3961
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,readFile,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("GET").pathInfo("/v1" + file).queryParam("user.name"`user).queryParam("op"`"OPEN").respond().status(HttpStatus.SC_TEMPORARY_REDIRECT).header("Location"`driver.getRealUrl("DATANODE") + file + "?op=OPEN&user.name="+ user);" is 262.,3961
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,readFile,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("GET").pathInfo(file).queryParam("user.name"`user).queryParam("op"`"OPEN").respond().status(status).contentType(contentType).content(driver.getResourceBytes(resource));" is 211.,3961
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,readFile,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("GET").pathInfo(file).queryParam("user.name"`user).queryParam("op"`"OPEN").respond().status(status);" is 143.,3961
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,readFile,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"OPEN").then().statusCode(status).when().get(driver.getUrl("WEBHDFS") + "/v1" + file+ (driver.isUseGateway() ? "" : "?user.name=" + user));" is 260.,3961
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,chownFile,Long Parameter List,The method has 6 parameters. ,4009
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,chownFile,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + file).queryParam("op"`"SETOWNER").queryParam("user.name"`user).queryParam("owner"`owner).queryParam("group"`group).respond().status(HttpStatus.SC_OK);" is 216.,4009
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,chownFile,Long Statement,The length of the statement "given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"SETOWNER").queryParam("owner"`owner).queryParam("group"`group).then().statusCode(status).when().put(driver.getUrl("WEBHDFS") + "/v1" + file+ (driver.isUseGateway() ? "" : "?user.name=" + user));" is 298.,4009
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,chmodFile,Long Parameter List,The method has 5 parameters. ,4034
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,chmodFile,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + file).queryParam("op"`"SETPERMISSION").queryParam("user.name"`user).queryParam("permission"`permsOctal).respond().status(HttpStatus.SC_OK);" is 205.,4034
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,chmodFile,Long Statement,The length of the statement "given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"SETPERMISSION").queryParam("permission"`permsOctal).then().statusCode(status).when().put(driver.getUrl("WEBHDFS") + "/v1" + file+ (driver.isUseGateway() ? "" : "?user.name=" + user));" is 287.,4034
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFile,Long Parameter List,The method has 7 parameters. ,4057
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileNN,Long Parameter List,The method has 5 parameters. ,4067
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileNN,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + file).queryParam("op"`"CREATE").queryParam("user.name"`user).queryParam("overwrite"`"true").respond().status(status).header("Location"`driver.getRealUrl("DATANODE") + file + "?op=CREATE&user.name="+ user);" is 271.,4067
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileNN,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("v1" + file).queryParam("user.name"`user).queryParam("op"`"CREATE").respond().status(status);" is 151.,4067
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileNN,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"CREATE").queryParam("overwrite"`"true").body(driver.getResourceBytes(resource)).then().statusCode(status).when().put(driver.getUrl("WEBHDFS") + "/v1" + file+ (driver.isUseGateway() ? "" : "?user.name=" + user));" is 333.,4067
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileDN,Long Parameter List,The method has 7 parameters. ,4105
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileDN,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("PUT").pathInfo(path).queryParam("user.name"`user).queryParam("op"`"CREATE").contentType(contentType).content(driver.getResourceBytes(resource)).respond().status(status).header("Location"`"webhdfs://" + driver.getRealAddr("DATANODE") + "/v1"+ path);" is 292.,4105
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileDN,Long Statement,The length of the statement "driver.getMock("DATANODE").expect().method("PUT").pathInfo(path).queryParam("user.name"`user).queryParam("op"`"CREATE").contentType(contentType).content(driver.getResourceBytes(resource)).respond().status(status);" is 213.,4105
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,updateFileDN,Long Statement,The length of the statement "given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"CREATE").queryParam("overwrite"`"true").contentType(contentType).body(driver.getResourceBytes(resource)).then().statusCode(status).when().put(location);" is 256.,4105
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,deleteFile,Long Parameter List,The method has 5 parameters. ,4144
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,deleteFile,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("DELETE").pathInfo("/v1" + file).queryParam("user.name"`user).queryParam("op"`"DELETE").queryParam("recursive"`recursive).respond().status(status[0]);" is 192.,4144
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,deleteFile,Long Statement,The length of the statement "given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"DELETE").queryParam("recursive"`recursive).then().statusCode(Matchers.is(in(ArrayUtils.toObject(status)))).when().delete(driver.getUrl("WEBHDFS") + "/v1" + file+ (driver.isUseGateway() ? "" : "?user.name=" + user));" is 319.,4144
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createDir,Long Parameter List,The method has 5 parameters. ,4167
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createDir,Long Statement,The length of the statement "driver.getMock("WEBHDFS").expect().method("PUT").pathInfo("/v1" + dir).queryParam("op"`"MKDIRS").queryParam("user.name"`user).queryParam("permission"`permsOctal).respond().status(HttpStatus.SC_OK).contentType("application/json").content("{\"boolean\": true}".getBytes(StandardCharsets.UTF_8));" is 293.,4167
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createDir,Long Statement,The length of the statement "Response response=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"MKDIRS").queryParam("permission"`permsOctal).then().statusCode(status).contentType("application/json").body("boolean"`CoreMatchers.equalTo(true)).when().put(driver.getUrl("WEBHDFS") + "/v1" + dir+ (driver.isUseGateway() ? "" : "?user.name=" + user));" is 372.,4167
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,createDir,Long Parameter List,The method has 7 parameters. ,4195
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitJava,Long Parameter List,The method has 7 parameters. ,4203
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitJava,Long Statement,The length of the statement "driver.getMock("WEBHCAT").expect().method("POST").pathInfo("/v1/mapreduce/jar").formParam("user.name"`user).formParam("jar"`jar).formParam("class"`main).formParam("arg"`input`output).respond().status(status).contentType("application/json").content("{\"id\":\"job_201210301335_0086\"}".getBytes(StandardCharsets.UTF_8));" is 319.,4203
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitJava,Long Statement,The length of the statement "String json=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").formParam("user.name"`user).formParam("jar"`jar).formParam("class"`main).formParam("arg"`input`output).then().statusCode(status).when().post(driver.getUrl("WEBHCAT") + "/v1/mapreduce/jar" + (driver.isUseGateway() ? "" : "?user.name=" + user)).asString();" is 353.,4203
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitPig,Long Parameter List,The method has 7 parameters. ,4235
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitPig,Long Statement,The length of the statement "driver.getMock("WEBHCAT").expect().method("POST").pathInfo("/v1/pig").respond().status(status[0]).contentType("application/json").content("{\"id\":\"job_201210301335_0086\"}".getBytes(StandardCharsets.UTF_8));" is 209.,4235
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitPig,Long Statement,The length of the statement "String json=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").formParam("user.name"`user).formParam("group"`group).formParam("file"`file).formParam("arg"`arg).formParam("statusdir"`statusDir).then().statusCode(Matchers.is(in(ArrayUtils.toObject(status)))).contentType("application/json").when().post(driver.getUrl("WEBHCAT") + "/v1/pig" + (driver.isUseGateway() ? "" : "?user.name=" + user)).asString();" is 440.,4235
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitHive,Long Parameter List,The method has 6 parameters. ,4269
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitHive,Long Statement,The length of the statement "driver.getMock("WEBHCAT").expect().method("POST").pathInfo("/v1/hive").respond().status(status[0]).contentType("application/json").content("{\"id\":\"job_201210301335_0086\"}".getBytes(StandardCharsets.UTF_8));" is 210.,4269
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,submitHive,Long Statement,The length of the statement "String json=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").formParam("user.name"`user).formParam("group"`group).formParam("group"`group).formParam("file"`file).formParam("statusdir"`statusDir).then().statusCode(Matchers.is(in(ArrayUtils.toObject(status)))).contentType("application/json").when().post(driver.getUrl("WEBHCAT") + "/v1/hive" + (driver.isUseGateway() ? "" : "?user.name=" + user)).asString();" is 445.,4269
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,queryQueue,Long Statement,The length of the statement "driver.getMock("WEBHCAT").expect().method("GET").pathInfo("/v1/jobs/" + job).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhcat-job-status.json")).contentType("application/json");" is 204.,4302
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,queryQueue,Long Statement,The length of the statement "String status=given().auth().preemptive().basic(user`password).header("X-XSRF-Header"`"jksdhfkhdsf").pathParam("job"`job).then().body("status.jobId"`CoreMatchers.equalTo(job)).statusCode(HttpStatus.SC_OK).when().get(driver.getUrl("WEBHCAT") + "/v1/jobs/{job}" + (driver.isUseGateway() ? "" : "?user.name=" + user)).asString();" is 326.,4302
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,oozieSubmitJob,Long Statement,The length of the statement "driver.getMock("OOZIE").expect().method("POST").pathInfo("/v1/jobs").respond().status(HttpStatus.SC_CREATED).content(driver.getResourceBytes("oozie-jobs-submit-response.json")).contentType("application/json");" is 209.,4389
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,oozieSubmitJob,Long Statement,The length of the statement "StringEntity entity=new StringEntity(request`org.apache.http.entity.ContentType.create("application/xml"`StandardCharsets.UTF_8.name()));" is 137.,4389
apache_knox,org.apache.knox.gateway,GatewayBasicFuncTest,oozieQueryJobStatus,Long Statement,The length of the statement "driver.getMock("OOZIE").expect().method("GET").pathInfo("/v1/job/" + id).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("oozie-job-show-info.json")).contentType("application/json");" is 201.,4479
apache_knox,org.apache.knox.gateway,GatewayPortMappingFailTest,setup,Magic Number,The method contains a magic number: 1240,47
apache_knox,org.apache.knox.gateway,GatewayPortMappingFailTest,setup,Magic Number,The method contains a magic number: 49151,47
apache_knox,org.apache.knox.gateway,GatewayPortMappingFailTest,testMultiPortOperationFail,Long Statement,The length of the statement "masterServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-liststatus-success.json")).contentType("application/json");" is 259.,71
apache_knox,org.apache.knox.gateway,GatewayPortMappingFailTest,testMultiPortOperationFail,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_NOT_FOUND).when().get(url + "/v1/");" is 189.,71
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot().addTag("service").addTag("role").addText("dummyService").gotoRoot();" is 1215.,131
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 200,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 4,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 1000,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 100,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 2,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 1000,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 100,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 3,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 2,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 1000,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,testDeployRedeployUndeploy,Magic Number,The method contains a magic number: 100,169
apache_knox,org.apache.knox.gateway,GatewayDeployFuncTest,waitForFiles,Long Parameter List,The method has 5 parameters. ,270
apache_knox,org.apache.knox.gateway,GatewayLocalServiceFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-jersey-service-role").gotoRoot();" is 1154.,119
apache_knox,org.apache.knox.gateway,GatewayLocalServiceFuncTest,testJerseyService,Long Statement,The length of the statement "assertThat(ClassLoader.getSystemClassLoader().loadClass("org.glassfish.jersey.servlet.ServletContainer")`notNullValue());" is 121.,153
apache_knox,org.apache.knox.gateway,GatewayLocalServiceFuncTest,testJerseyService,Long Statement,The length of the statement "assertThat(ClassLoader.getSystemClassLoader().loadClass("org.apache.knox.gateway.jersey.JerseyDispatchDeploymentContributor")`notNullValue());" is 142.,153
apache_knox,org.apache.knox.gateway,GatewayLocalServiceFuncTest,testJerseyService,Long Statement,The length of the statement "assertThat(ClassLoader.getSystemClassLoader().loadClass("org.apache.knox.gateway.jersey.JerseyServiceDeploymentContributorBase")`notNullValue());" is 145.,153
apache_knox,org.apache.knox.gateway,GatewayLocalServiceFuncTest,testJerseyService,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-jersey-resource-response")).when().get(serviceUrl);" is 180.,153
apache_knox,org.apache.knox.gateway,GatewaySampleFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 1147.,117
apache_knox,org.apache.knox.gateway,GatewaySampleFuncTest,testTestService,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(serviceUrl);" is 172.,151
apache_knox,org.apache.knox.gateway,Knox242FuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,72
apache_knox,org.apache.knox.gateway,Knox242FuncTest,setupGateway,Magic Number,The method contains a magic number: 100,72
apache_knox,org.apache.knox.gateway,Knox242FuncTest,setupGateway,Magic Number,The method contains a magic number: 10000,72
apache_knox,org.apache.knox.gateway,Knox242FuncTest,setupGateway,Magic Number,The method contains a magic number: 100,72
apache_knox,org.apache.knox.gateway,Knox242FuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapGroupContextFactory").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory").addTag("value").addText("$ldapGroupContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.searchBase").addTag("value").addText("dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userSearchAttributeName").addTag("value").addText("uid").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userObjectClass").addTag("value").addText("person").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userSearchBase").addTag("value").addText("dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupSearchBase").addTag("value").addText("ou=groups`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemAuthenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupObjectClass").addTag("value").addText("groupofurls").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttribute").addTag("value").addText("memberurl").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttributeValueTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.clusterName").addTag("value").addText(cluster).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText("S{ALIAS=ldcSystemPassword}").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("name").addText("AclsAuthz").addTag("enabled").addText("true").addTag("param").addTag("name").addText("test-service-role.acl").addTag("value").addText("*;directors;*").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot().gotoRoot().addTag("service").addTag("role").addText("dummyService").gotoRoot();" is 3592.,92
apache_knox,org.apache.knox.gateway,Knox242FuncTest,testGroupMember,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType("text/plain").body(is("test-service-response")).when().get(serviceUrl);" is 172.,190
apache_knox,org.apache.knox.gateway,GatewayHealthFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText("ldap://localhost:" + ldapTransport.getAcceptor().getLocalAddress().getPort()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("HEALTH").gotoRoot();" is 1194.,139
apache_knox,org.apache.knox.gateway,GatewayHealthFuncTest,testPingResource,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).header("Accept"`MediaType.TEXT_PLAIN).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.TEXT_PLAIN).when().get(serviceUrl).asString();" is 207.,173
apache_knox,org.apache.knox.gateway,GatewayHealthFuncTest,testMetricsResource,Long Statement,The length of the statement "String body=given().auth().preemptive().basic(username`password).then().statusCode(HttpStatus.SC_OK).contentType(MediaType.APPLICATION_JSON).when().get(serviceUrl).asString();" is 175.,190
apache_knox,org.apache.knox.gateway,GatewayHealthFuncTest,testMetricsResource,Long Statement,The length of the statement "Assert.assertTrue(hm.keySet().containsAll(new HashSet<>(Arrays.asList(new String[]{"timers"`"histograms"`"counters"`"gauges"`"version"`"meters"}))));" is 149.,190
apache_knox,org.apache.knox.gateway,GatewayHealthFuncTest,testMetricsResource,Magic Number,The method contains a magic number: 6,190
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(registry.lookupServiceURL("test-cluster"`"NAMENODE")).andReturn("test-scheme://test-host:42").anyTimes();" is 121.,53
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriteProcessor).anyTimes();" is 143.,53
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn("test-cluster").anyTimes();" is 125.,53
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(servletRequest.getInputStream()).andReturn(new MockServletInputStream(TestUtils.getResourceStream(OozieServiceDefinitionTest.class`testResource))).anyTimes();" is 174.,53
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(UrlRewriteServletFilter.REQUEST_BODY_FILTER_PARAM)).andReturn("OOZIE/oozie/configuration").anyTimes();" is 148.,53
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralTemplateValuesBugKnox394,Long Statement,The length of the statement "assertThat(document`hasXPath("/configuration/property[name='oozie.wf.application.path']/value"`equalTo("${appPath}/workflow.xml")));" is 132.,53
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralComplexTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(registry.lookupServiceURL("test-cluster"`"NAMENODE")).andReturn("test-scheme://test-host:42").anyTimes();" is 121.,107
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralComplexTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriteProcessor).anyTimes();" is 143.,107
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralComplexTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn("test-cluster").anyTimes();" is 125.,107
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralComplexTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(servletRequest.getInputStream()).andReturn(new MockServletInputStream(TestUtils.getResourceStream(OozieServiceDefinitionTest.class`testResource))).anyTimes();" is 174.,107
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralComplexTemplateValuesBugKnox394,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(UrlRewriteServletFilter.REQUEST_BODY_FILTER_PARAM)).andReturn("OOZIE/oozie/configuration").anyTimes();" is 148.,107
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForLiteralComplexTemplateValuesBugKnox394,Long Statement,The length of the statement "assertThat(document`hasXPath("/configuration/property[name='oozie.wf.application.path']/value"`equalTo("${nameNode}/user/${user.name}/${examplesRoot}/apps/hive")));" is 164.,107
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForValuesRelativeToServiceRegistry,Long Statement,The length of the statement "EasyMock.expect(registry.lookupServiceURL("test-cluster"`"NAMENODE")).andReturn("test-scheme://test-host:42").anyTimes();" is 121.,160
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForValuesRelativeToServiceRegistry,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriteProcessor).anyTimes();" is 143.,160
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForValuesRelativeToServiceRegistry,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn("test-cluster").anyTimes();" is 125.,160
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForValuesRelativeToServiceRegistry,Long Statement,The length of the statement "EasyMock.expect(servletRequest.getInputStream()).andReturn(new MockServletInputStream(TestUtils.getResourceStream(OozieServiceDefinitionTest.class`testResource))).anyTimes();" is 174.,160
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForValuesRelativeToServiceRegistry,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(UrlRewriteServletFilter.REQUEST_BODY_FILTER_PARAM)).andReturn("OOZIE/oozie/configuration").anyTimes();" is 148.,160
apache_knox,org.apache.knox.gateway,OozieServiceDefinitionTest,testOozieRewriteRulesForValuesRelativeToServiceRegistry,Long Statement,The length of the statement "assertThat(document`hasXPath("/configuration/property[name='oozie.wf.application.path']/value"`equalTo("test-scheme://test-host:42/workflow.xml")));" is 148.,160
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("webappsec").addTag("name").addText("WebAppSec").addTag("enabled").addText("true").addTag("param").addTag("name").addText("csrf.enabled").addTag("value").addText("true").gotoParent().gotoParent().addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").addTag("role").addText("authorization").addTag("enabled").addText("true").addTag("name").addText("AclsAuthz").gotoParent().addTag("param").addTag("name").addText("webhdfs-acl").addTag("value").addText("hdfs;*;*").gotoParent().addTag("provider").addTag("role").addText("ha").addTag("enabled").addText("true").addTag("name").addText("HaProvider").addTag("param").addTag("name").addText("WEBHDFS").addTag("value").addText("maxFailoverAttempts=3;failoverSleep=15;enabled=true").gotoParent().gotoRoot().addTag("service").addTag("role").addText("WEBHDFS").addTag("url").addText("http://localhost:" + masterServer.getPort() + "/webhdfs").addTag("url").addText("http://localhost:" + standbyServer.getPort() + "/webhdfs").gotoParent().gotoRoot();" is 2038.,92
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testBasicListOperation,Long Statement,The length of the statement "masterServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-liststatus-success.json")).contentType("application/json");" is 259.,154
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testBasicListOperation,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().log().ifError().statusCode(HttpStatus.SC_OK).body("FileStatuses.FileStatus[0].pathSuffix"`is("app-logs")).when().get(driver.getUrl("WEBHDFS") + "/v1/");" is 280.,154
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testFailoverListOperation,Long Statement,The length of the statement "standbyServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-liststatus-success.json")).contentType("application/json");" is 260.,181
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testFailoverListOperation,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().log().ifError().statusCode(HttpStatus.SC_OK).body("FileStatuses.FileStatus[0].pathSuffix"`is("app-logs")).when().get(driver.getUrl("WEBHDFS") + "/v1/");" is 280.,181
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testFailoverLimit,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_INTERNAL_SERVER_ERROR).when().get(driver.getUrl("WEBHDFS") + "/v1/");" is 222.,212
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandby,Long Statement,The length of the statement "masterServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-liststatus-standby.json")).contentType("application/json");" is 266.,234
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandby,Long Statement,The length of the statement "standbyServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-liststatus-success.json")).contentType("application/json");" is 260.,234
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandby,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().log().ifError().statusCode(HttpStatus.SC_OK).body("FileStatuses.FileStatus[0].pathSuffix"`is("app-logs")).when().get(driver.getUrl("WEBHDFS") + "/v1/");" is 280.,234
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandbyFailoverLimit,Long Statement,The length of the statement "masterServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-liststatus-standby.json")).contentType("application/json");" is 266.,274
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandbyFailoverLimit,Long Statement,The length of the statement "standbyServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-liststatus-standby.json")).contentType("application/json");" is 267.,274
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandbyFailoverLimit,Long Statement,The length of the statement "masterServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-liststatus-standby.json")).contentType("application/json");" is 266.,274
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandbyFailoverLimit,Long Statement,The length of the statement "standbyServer.expect().method("GET").pathInfo("/webhdfs/v1/").queryParam("op"`"LISTSTATUS").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-liststatus-standby.json")).contentType("application/json");" is 267.,274
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInStandbyFailoverLimit,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"LISTSTATUS").then().statusCode(HttpStatus.SC_INTERNAL_SERVER_ERROR).when().get(driver.getUrl("WEBHDFS") + "/v1/");" is 222.,274
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInSafeMode,Long Statement,The length of the statement "masterServer.expect().method("POST").pathInfo("/webhdfs/v1/user/hdfs/foo.txt").queryParam("op"`"RENAME").queryParam("destination"`"/user/hdfs/foo.txt").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-rename-safemode.json")).contentType("application/json");" is 324.,329
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInSafeMode,Long Statement,The length of the statement "masterServer.expect().method("POST").pathInfo("/webhdfs/v1/user/hdfs/foo.txt").queryParam("op"`"RENAME").queryParam("destination"`"/user/hdfs/foo.txt").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-rename-safemode-off.json")).contentType("application/json");" is 321.,329
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInSafeMode,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"RENAME").queryParam("destination"`"/user/hdfs/foo.txt").then().log().ifError().statusCode(HttpStatus.SC_INTERNAL_SERVER_ERROR).when().post(driver.getUrl("WEBHDFS") + "/v1/user/hdfs/foo.txt");" is 299.,329
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInSafeModeFailover,Long Statement,The length of the statement "masterServer.expect().method("POST").pathInfo("/webhdfs/v1/user/hdfs/new").queryParam("op"`"MKDIRS").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-mkdirs-safemode.json")).contentType("application/json");" is 273.,368
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInSafeModeFailover,Long Statement,The length of the statement "standbyServer.expect().method("POST").pathInfo("/webhdfs/v1/user/hdfs/new").queryParam("op"`"MKDIRS").queryParam("user.name"`username).respond().status(HttpStatus.SC_FORBIDDEN).content(driver.getResourceBytes("webhdfs-liststatus-standby.json")).contentType("application/json");" is 277.,368
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInSafeModeFailover,Long Statement,The length of the statement "masterServer.expect().method("POST").pathInfo("/webhdfs/v1/user/hdfs/new").queryParam("op"`"MKDIRS").queryParam("user.name"`username).respond().status(HttpStatus.SC_OK).content(driver.getResourceBytes("webhdfs-rename-safemode-off.json")).contentType("application/json");" is 270.,368
apache_knox,org.apache.knox.gateway,WebHdfsHaFuncTest,testServerInSafeModeFailover,Long Statement,The length of the statement "given().auth().preemptive().basic(username`password).header("X-XSRF-Header"`"jksdhfkhdsf").queryParam("op"`"MKDIRS").then().log().ifError().statusCode(HttpStatus.SC_OK).body("boolean"`is(true)).when().post(driver.getUrl("WEBHDFS") + "/v1/user/hdfs/new");" is 254.,368
apache_knox,org.apache.knox.gateway,SimpleDescriptorHandlerFuncTest,testSimpleDescriptorHandlerQueryStringCredentialAliasCreation,Long Statement,The length of the statement "EasyMock.expect(gatewayServices.getService(ServiceType.SERVICE_DEFINITION_REGISTRY)).andReturn(serviceDefinitionRegistry).anyTimes();" is 133.,121
apache_knox,org.apache.knox.gateway,SimpleDescriptorHandlerFuncTest,testSimpleDescriptorHandlerQueryStringCredentialAliasCreation,Long Statement,The length of the statement "Map<String`File> files=SimpleDescriptorHandler.handle(config`testDescriptor`providerConfig.getParentFile()`destDir`GatewayServer.getGatewayServices());" is 151.,121
apache_knox,org.apache.knox.gateway,SimpleDescriptorHandlerFuncTest,testSimpleDescriptorHandlerQueryStringCredentialAliasCreation,Long Statement,The length of the statement "assertEquals("Unexpected cluster name for the alias (should be the topology name)."`testDescriptor.getName()`capturedCluster.getValue());" is 137.,121
apache_knox,org.apache.knox.gateway,SimpleDescriptorHandlerFuncTest,testSimpleDescriptorHandlerQueryStringCredentialAliasCreation,Long Statement,The length of the statement "assertEquals("Unexpected alias value (should be master secret + topology name."`testMasterSecret + testDescriptor.getName()`capturedPwd.getValue());" is 148.,121
apache_knox,org.apache.knox.gateway,SimpleDescriptorHandlerFuncTest,testSimpleDescriptorHandlerQueryStringCredentialAliasCreation,Magic Number,The method contains a magic number: 200,121
apache_knox,org.apache.knox.gateway,KnoxCliLdapFuncTestPositive,createBadTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("KNOX").gotoRoot();" is 1238.,120
apache_knox,org.apache.knox.gateway,KnoxCliLdapFuncTestPositive,createTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapGroupContextFactory").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.searchBase").addTag("value").addText("ou=groups`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.groupObjectClass").addTag("value").addText("groupOfNames").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttributeValueTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.memberAttribute").addTag("value").addText("member").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.authorizationEnabled").addTag("value").addText("true").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemUsername").addTag("value").addText("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.systemPassword").addTag("value").addText("guest-password").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText(driver.getLdapUrl()).gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 2299.,156
apache_knox,org.apache.knox.gateway,GatewayPortMappingDisableFeatureTest,setup,Magic Number,The method contains a magic number: 1240,49
apache_knox,org.apache.knox.gateway,GatewayPortMappingDisableFeatureTest,setup,Magic Number,The method contains a magic number: 49151,49
apache_knox,org.apache.knox.gateway.filter.rewrite.spi,UrlRewriteStreamFilter,filter,Long Parameter List,The method has 6 parameters. ,34
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteFunctionProcessorFactory,loadProcessors,Long Statement,The length of the statement "Map<Class<? extends UrlRewriteFunctionDescriptor>`Map<String`Class<? extends UrlRewriteFunctionProcessor>>> descriptorMap=new HashMap<>();" is 138.,63
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteFunctionProcessorFactory,loadProcessors,Long Statement,The length of the statement "Map<String`Class<? extends UrlRewriteFunctionProcessor>> typeMap=descriptorMap.computeIfAbsent(descriptorInterface`k -> new HashMap<>());" is 137.,63
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,CookieScopeResponseWrapper,generateIfValidSegment,Complex Conditional,The conditional expression pathSegment == null || pathSegment.isEmpty() || "/".equals(pathSegment) is complex.,66
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteUtil,pickFirstRuleWithEqualsIgnoreCasePathMatch,Complex Conditional,The conditional expression config != null && !config.getSelectors().isEmpty() && name != null is complex.,33
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,UrlRewriteResponse,Long Statement,The length of the statement "this.headersFilterConfig=getRewriteFilterConfig(rewriter.getConfig()`headersFilterName`UrlRewriteServletFilter.HEADERS_MIME_TYPE);" is 130.,97
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,streamResponse,Complex Conditional,The conditional expression len == 2 && signature[0] == (byte)0x1f && signature[1] == (byte)0x8b is complex.,160
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,streamResponse,Long Statement,The length of the statement "UrlRewriteFilterContentDescriptor filterContentConfig=getRewriteFilterConfig(rewriter.getConfig()`bodyFilterName`mimeType);" is 123.,160
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,streamResponse,Magic Number,The method contains a magic number: 2,160
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,streamResponse,Magic Number,The method contains a magic number: 2,160
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,streamResponse,Magic Number,The method contains a magic number: 2,160
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,streamResponse,Magic Number,The method contains a magic number: 0x1f,160
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,streamResponse,Magic Number,The method contains a magic number: 0x8b,160
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,getRequestLocalHostName,Empty catch clause,The method has an empty catch block.,249
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponse,getGatewayParam,Complex Method,Cyclomatic complexity of the method is 9,259
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteStepProcessorFactory,loadStepProcessors,Long Statement,The length of the statement "Map<Class<? extends UrlRewriteStepDescriptor>`Map<String`Class<? extends UrlRewriteStepProcessor>>> descriptorMap=new HashMap<>();" is 130.,59
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteStepProcessorFactory,loadStepProcessors,Long Statement,The length of the statement "Map<String`Class<? extends UrlRewriteStepProcessor>> typeMap=descriptorMap.computeIfAbsent(descriptorInterface`k -> new HashMap<>());" is 133.,59
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteDeploymentContributor,finalizeContribution,Long Statement,The length of the statement "context.getWebArchive().addAsWebInfResource(new StringAsset(asset)`UrlRewriteServletContextListener.DESCRIPTOR_DEFAULT_FILE_NAME);" is 130.,66
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteDeploymentContributor,finalizeContribution,Long Statement,The length of the statement "context.getWebAppDescriptor().createContextParam().paramName(UrlRewriteServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME).paramValue(UrlRewriteServletContextListener.DESCRIPTOR_DEFAULT_LOCATION);" is 204.,66
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,92
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessor,initialize,Long Statement,The length of the statement "resolvers.put("topology"`new FixedResolver((String)environment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)));" is 121.,47
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteStepProcessorHolder,process,Complex Conditional,The conditional expression UrlRewriteStepStatus.SUCCESS == status && descriptor instanceof UrlRewriteFlowDescriptor && !childProcessors.isEmpty() is complex.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteStepProcessorHolder,process,Long Statement,The length of the statement "if (UrlRewriteStepStatus.SUCCESS == status && descriptor instanceof UrlRewriteFlowDescriptor && !childProcessors.isEmpty()) {" is 125.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteContextImpl,UrlRewriteContextImpl,Long Parameter List,The method has 5 parameters. ,49
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequest,getSourceUrl,Long Statement,The length of the statement "urlString.append(getScheme()).append("://").append(getServerName()).append(':').append(getServerPort()).append(super.getRequestURI());" is 134.,88
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequest,getSourceUrl,Magic Number,The method contains a magic number: 128,88
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequest,getHeaders,Long Statement,The length of the statement "return new EnumerationRewriter(rewriter`super.getHeaders(name)`pickFirstRuleWithEqualsIgnoreCasePathMatch(headersFilterConfig`name));" is 133.,201
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequest,getInputStream,Long Statement,The length of the statement "if (!StringUtils.isBlank(contentEncoding) && StringUtils.containsAny(contentEncoding`"gzip"`"compress"`"deflate"`"br")) {" is 121.,235
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,CookieScopeResponseWrapperTest,testAlreadyScopedPath,Long Statement,The length of the statement "Assert.assertEquals("SESSIONID=jn0zexg59r1jo1n66hd7tg5anl; Path=/some/path/already-scoped/; HttpOnly;"`captureValue.getValue());" is 128.,72
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,CookieScopeResponseWrapperTest,testWithPathAndTopologyName,Long Statement,The length of the statement "Assert.assertEquals("SESSIONID=jn0zexg59r1jo1n66hd7tg5anl; Path=/some/path/dp-proxy/; HttpOnly;"`captureValue.getValue());" is 122.,90
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testResolve,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,49
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testResolve,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("test-filter-init-param-name")).andReturn("test-filter-init-param-value").anyTimes();" is 125.,49
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testResolveGatewayParams,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,75
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testResolveGatewayParams,Magic Number,The method contains a magic number: 42,75
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testStreamXmlUnicodeResponse,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,119
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testStreamXmlUnicodeResponse,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter(UrlRewriteServletFilter.RESPONSE_BODY_FILTER_PARAM)).andReturn("test-filter").anyTimes();" is 129.,119
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testStreamResponse,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,143
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testStreamResponse,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter(UrlRewriteServletFilter.RESPONSE_BODY_FILTER_PARAM)).andReturn("test-filter").anyTimes();" is 129.,143
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testStreamResponse,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(inputFile);OutputStream outStream="gzip".equalsIgnoreCase(contentType) ? new GZIPOutputStream(outputStream) : "deflate".equalsIgnoreCase(contentType) ? new DeflaterOutputStream(outputStream) : outputStream){" is 260.,168
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteResponseTest,testStreamResponse,Long Statement,The length of the statement "try (InputStream inputStream=Files.newInputStream(outputFile);InputStream inStream="gzip".equalsIgnoreCase(contentType) ? new GZIPInputStream(inputStream) : "deflate".equalsIgnoreCase(contentType) ? new InflaterInputStream(inputStream) : inputStream){" is 251.,168
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testResolve,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,56
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testResolve,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("test-filter-init-param-name")).andReturn("test-filter-init-param-value").anyTimes();" is 125.,56
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testResolve,Long Statement,The length of the statement "EasyMock.expect(request.getAttribute(AbstractGatewayFilter.TARGET_REQUEST_URL_ATTRIBUTE_NAME)).andReturn(target).anyTimes();" is 124.,56
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testResolve,Magic Number,The method contains a magic number: 80,56
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testResolve,Magic Number,The method contains a magic number: 80,56
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testEmptyPayload,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,105
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testEmptyPayload,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("test-filter-init-param-name")).andReturn("test-filter-init-param-value").anyTimes();" is 125.,105
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testEmptyPayload,Magic Number,The method contains a magic number: 80,105
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Long Statement,The length of the statement "EasyMock.expect(environment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 124.,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Long Statement,The length of the statement "EasyMock.expect(environment.getAttribute("org.apache.knox.gateway.frontend.uri")).andReturn(new URI("https://test-location")).anyTimes();" is 137.,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Long Statement,The length of the statement "EasyMock.expect(environment.resolve("cluster.name")).andReturn(Collections.singletonList("test-cluster-name")).anyTimes();" is 122.,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("test-filter-init-param-name")).andReturn("test-filter-init-param-value").anyTimes();" is 125.,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Magic Number,The method contains a magic number: 80,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Magic Number,The method contains a magic number: 80,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testContentEncoding,Magic Number,The method contains a magic number: 80,185
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testUnicodePayload,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,318
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testUnicodePayload,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("test-filter-init-param-name")).andReturn("test-filter-init-param-value").anyTimes();" is 125.,318
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteRequestTest,testUnicodePayload,Magic Number,The method contains a magic number: 80,318
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testNullHandling,Long Statement,The length of the statement "EasyMock.expect(goodEnv.getAttribute(FrontendFunctionDescriptor.FRONTEND_URI_ATTRIBUTE)).andReturn(new URI("http://mock-host:80/mock-root/mock-topo")).anyTimes();" is 162.,105
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testSetup,Long Statement,The length of the statement "EasyMock.expect(mockServiceRegistry.lookupServiceURL("test-cluster"`"NAMENODE")).andReturn("test-nn-scheme://test-nn-host:411").anyTimes();" is 139.,127
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testSetup,Long Statement,The length of the statement "EasyMock.expect(mockServiceRegistry.lookupServiceURL("test-cluster"`"JOBTRACKER")).andReturn("test-jt-scheme://test-jt-host:511").anyTimes();" is 141.,127
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testSetup,Long Statement,The length of the statement "EasyMock.expect(mockGatewayServices.getService(ServiceType.SERVICE_REGISTRY_SERVICE)).andReturn(mockServiceRegistry).anyTimes();" is 128.,127
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testSetup,Long Statement,The length of the statement "server.getContext().setInitParameter(UrlRewriteServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME`descriptorUrl);" is 121.,127
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsOnJsonRequestBody,Long Statement,The length of the statement "String input=TestUtils.getResourceString(FrontendFunctionProcessorTest.class`"test-input-body.json"`StandardCharsets.UTF_8);" is 124.,175
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsOnJsonRequestBody,Long Statement,The length of the statement "interaction.respond().status(200).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name()).content(input`StandardCharsets.UTF_8);" is 153.,175
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsOnJsonRequestBody,Magic Number,The method contains a magic number: 200,175
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsOnJsonRequestBody,Magic Number,The method contains a magic number: 200,175
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsWithFrontendUriConfigOnJsonRequestBody,Long Statement,The length of the statement "attributes.setAttribute(FrontendFunctionDescriptor.FRONTEND_URI_ATTRIBUTE`new URI("mock-frontend-scheme://mock-frontend-host:777/mock-frontend-path"));" is 151.,214
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsWithFrontendUriConfigOnJsonRequestBody,Long Statement,The length of the statement "String input=TestUtils.getResourceString(FrontendFunctionProcessorTest.class`"test-input-body.json"`StandardCharsets.UTF_8);" is 124.,214
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsWithFrontendUriConfigOnJsonRequestBody,Long Statement,The length of the statement "interaction.respond().status(200).contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name()).content(input`StandardCharsets.UTF_8);" is 153.,214
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsWithFrontendUriConfigOnJsonRequestBody,Magic Number,The method contains a magic number: 200,214
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,FrontendFunctionProcessorTest,testFrontendFunctionsWithFrontendUriConfigOnJsonRequestBody,Magic Number,The method contains a magic number: 200,214
apache_knox,org.apache.knox.gateway.filter.rewrite.impl,UrlRewriteContextImplTest,testResolve,Long Statement,The length of the statement "EasyMock.expect(environment.resolve("test-env-param-name")).andReturn(Collections.singletonList("test-env-param-value")).anyTimes();" is 132.,41
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlUrlRewriteFilterReader,XmlUrlRewriteFilterReader,Long Parameter List,The method has 5 parameters. ,43
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlUrlRewriteStreamFilter,filter,Long Parameter List,The method has 6 parameters. ,47
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlUrlRewriteStreamFilter,filter,Long Statement,The length of the statement "return new ReaderInputStream(new XmlUrlRewriteFilterReader(new InputStreamReader(stream`encoding)`rewriter`resolver`direction`config)`encoding);" is 144.,47
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReader,processEvent,Complex Method,Cyclomatic complexity of the method is 17,148
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReader,processEvent,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@547b1a18,148
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReader,processBufferedElement,Complex Method,Cyclomatic complexity of the method is 13,334
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReaderTest,testCombined,Long Statement,The length of the statement "String inputXml="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" + "<!-- Comment -->\n" + "<ns1:root xmlns:ns1='http://hortonworks.com/xml/ns1' attr1='attr1-input' ns1:attr2='attr2-input'>\n"+ " root-input1\n"+ " <child1 attr3='attr3-input' ns1:attr4='attr4-input'>\n"+ " child1-input\n"+ " </child1>\n"+ " root-input2\n"+ " <ns2:child2 xmlns:ns2='http://hortonworks.com/xml/ns2' attr5='attr5-input' ns1:attr6='attr6-input' ns2:attr7='attr7-input'>\n"+ " child2-input\n"+ " </ns2:child2>\n"+ " root-input3\n"+ "</ns1:root>";" is 541.,257
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReaderTest,testInvalidConfigShouldThrowException,Long Statement,The length of the statement "String input="<root url='http://mock-host:42/test-input-path-1'><url>http://mock-host:42/test-input-path-2</url></root>";" is 121.,839
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReaderTest,testDefaultNamespace,Long Statement,The length of the statement "assertThat(the(output)`hasXPath("/*[namespace-uri()='ns' and name()='root']/*[namespace-uri()='ns' and name()='node']"`equalTo("nodevalue")));" is 142.,863
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReaderTest,testDefaultNamespace,Long Statement,The length of the statement "assertThat(the(output)`hasXPath("/*[namespace-uri()='ns' and name()='root']/*[namespace-uri()='ns' and name()='node']/@attribute"`equalTo("attr")));" is 148.,863
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReaderTest,testEscapeCharactersBugKnox616,Long Statement,The length of the statement "assertThat(output`containsString("<?xml version=\"1.0\" standalone=\"no\"?><document><empty/><![CDATA[<xyz>wibble</xyz>]]></document>"));" is 137.,875
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReaderTest,testEscapeCharactersBugKnox616,Long Statement,The length of the statement "input="<?xml version=\"1.0\" standalone=\"no\"?>" + "<document>" + " <noempty test=\"a\"> </noempty>"+ " <!-- This is the first comment -->"+ " <empty/>"+ " <![CDATA[<xyz>wibble</xyz>]]>"+ " <here>"+ " <moreempty/>"+ " <!-- This is the second comment -->"+ " <![CDATA[<xyz>noop</xyz>]]>"+ " </here>"+ "</document>";" is 315.,875
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.xml,XmlFilterReaderTest,testEscapeCharactersBugKnox616,Long Statement,The length of the statement "assertThat(output`containsString("<?xml version=\"1.0\" standalone=\"no\"?><document> <noempty test=\"a\"> </noempty> <!-- This is the first comment --> <empty/> <![CDATA[<xyz>wibble</xyz>]]> <here> <moreempty/> <!-- This is the second comment --> <![CDATA[<xyz>noop</xyz>]]> </here></document>"));" is 298.,875
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteFunctionDescriptorFactory,loadDescriptors,Long Statement,The length of the statement "ServiceLoader<? extends UrlRewriteFunctionDescriptor> descriptors=ServiceLoader.load(UrlRewriteFunctionDescriptor.class);" is 121.,43
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteStreamFilterFactory,create,Long Parameter List,The method has 7 parameters. ,41
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessor,rewrite,Complex Method,Cyclomatic complexity of the method is 11,124
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletContextListener,locateDescriptor,Long Identifier,The length of the field DESCRIPTOR_LOCATION_INIT_PARAM_NAME is 35.,69
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletContextListenerTest,setUp,Long Statement,The length of the statement "server.getContext().setInitParameter(UrlRewriteServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME`descriptorUrl);" is 121.,43
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletContextListenerTest,setUp,Long Statement,The length of the statement "servlet.setInitParameter(UrlRewriteServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME`getTestResource("rewrite.xml").toExternalForm());" is 143.,43
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testSetUp,Long Statement,The length of the statement "server.getContext().setInitParameter(UrlRewriteServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME`descriptorUrl);" is 121.,71
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundRequestUrlRewrite,Magic Number,The method contains a magic number: 200,109
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundRequestUrlRewrite,Magic Number,The method contains a magic number: 200,109
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHeaderRewrite,Long Statement,The length of the statement "interaction.expect().method("GET").requestUrl("http://mock-host:1/test-output-path-1").header("Location"`"http://mock-host:1/test-output-path-1");" is 146.,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHeaderRewrite,Magic Number,The method contains a magic number: 200,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHeaderRewrite,Magic Number,The method contains a magic number: 200,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testOutboundHeaderRewrite,Magic Number,The method contains a magic number: 201,155
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testOutboundHeaderRewrite,Magic Number,The method contains a magic number: 201,155
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundJsonBodyRewrite,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:1/test-output-path-1").content(inputJson`StandardCharsets.UTF_8);" is 129.,234
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundJsonBodyRewrite,Magic Number,The method contains a magic number: 200,234
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundJsonBodyRewrite,Magic Number,The method contains a magic number: 200,234
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundXmlBodyRewrite,Long Statement,The length of the statement "output="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"no\"?><root attribute=\"http://mock-host:1/test-output-path-1\">http://mock-host:1/test-output-path-1</root>";" is 172.,262
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundXmlBodyRewrite,Long Statement,The length of the statement "output="<?xml version=\"1.0\" standalone=\"no\"?><root attribute=\"http://mock-host:1/test-output-path-1\">http://mock-host:1/test-output-path-1</root>";" is 153.,262
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundXmlBodyRewrite,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:1/test-output-path-1").content(output`StandardCharsets.UTF_8);" is 126.,262
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundXmlBodyRewrite,Magic Number,The method contains a magic number: 200,262
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundXmlBodyRewrite,Magic Number,The method contains a magic number: 200,262
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testOutboundJsonBodyRewrite,Magic Number,The method contains a magic number: 200,295
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testOutboundJsonBodyRewrite,Magic Number,The method contains a magic number: 200,295
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testOutboundHtmlBodyRewrite,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:1/test-output-path-1").content(output`StandardCharsets.UTF_8);" is 126.,324
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testOutboundHtmlBodyRewrite,Magic Number,The method contains a magic number: 200,324
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testOutboundHtmlBodyRewrite,Magic Number,The method contains a magic number: 200,324
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHtmlFormRewrite,Long Statement,The length of the statement "String input="Name=Jonathan+Doe&Age=23&Formula=a+%2B+b+%3D%3D+13%25%21&url=http%3A%2F%2Fmock-host%3A1%2Ftest-input-path";" is 121.,353
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHtmlFormRewrite,Long Statement,The length of the statement "String expect="Name=Jonathan+Doe&Age=23&Formula=a+%2B+b+%3D%3D+13%25%21&url=http%3A%2F%2Fmock-host%3A1%2Ftest-output-path-1";" is 125.,353
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHtmlFormRewrite,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:1/test-output-path-1").content(expect`StandardCharsets.UTF_8);" is 126.,353
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHtmlFormRewrite,Magic Number,The method contains a magic number: 200,353
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testInboundHtmlFormRewrite,Magic Number,The method contains a magic number: 200,353
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestUrlRewriteWithFilterInitParam,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:42/test-output-path-2").contentType("text/xml").characterEncoding(StandardCharsets.UTF_8.name()).content(expect`StandardCharsets.UTF_8);" is 200.,382
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestUrlRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,382
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestUrlRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,382
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestHeaderRewriteWithFilterInitParam,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:42/test-output-path-1").contentType("text/xml").characterEncoding(StandardCharsets.UTF_8.name()).content(expect`StandardCharsets.UTF_8).header("Location"`"http://mock-host:42/test-output-path-2");" is 260.,415
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestHeaderRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,415
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestHeaderRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,415
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestJsonBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:42/test-output-path-1").contentType("application/json").content(expectJson`StandardCharsets.UTF_8);" is 163.,457
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestJsonBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,457
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestJsonBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,457
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "String input="<root url='http://mock-host:42/test-input-path-1'><url>http://mock-host:42/test-input-path-1</url></root>";" is 121.,491
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "String expect="<root url='http://mock-host:42/test-output-path-2'><url>http://mock-host:42/test-output-path-2</url></root>";" is 124.,491
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:42/test-output-path-1").contentType("text/xml").characterEncoding(StandardCharsets.UTF_8.name()).content(expect`StandardCharsets.UTF_8);" is 200.,491
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,491
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,491
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParamForInvalidFilterConfig,Long Statement,The length of the statement "String input="<root url='http://mock-host:42/test-input-path-1'><url>http://mock-host:42/test-input-path-2</url></root>";" is 121.,524
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParamForInvalidFilterConfig,Long Statement,The length of the statement "String expect="<root url='http://mock-host:42/test-input-path-2'><url>http://mock-host:42/test-input-path-2</url></root>";" is 122.,524
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParamForInvalidFilterConfig,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:42/test-output-path-1").contentType("text/xml").characterEncoding(StandardCharsets.UTF_8.name()).content(expect`StandardCharsets.UTF_8);" is 200.,524
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParamForInvalidFilterConfig,Magic Number,The method contains a magic number: 200,524
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestXmlBodyRewriteWithFilterInitParamForInvalidFilterConfig,Magic Number,The method contains a magic number: 500,524
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestFormBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "String input="Name=Jonathan+Doe&Age=23&Formula=a+%2B+b+%3D%3D+13%25%21&url=http%3A%2F%2Fmock-host%3A1%2Ftest-input-path";" is 121.,557
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestFormBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "String expect="Name=Jonathan+Doe&Age=23&Formula=a+%2B+b+%3D%3D+13%25%21&url=http%3A%2F%2Fmock-host%3A1%2Ftest-output-path-2";" is 125.,557
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestFormBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://mock-host:1/test-output-path-1").content(expect`StandardCharsets.UTF_8).characterEncoding(StandardCharsets.UTF_8.name());" is 175.,557
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestFormBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,557
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testRequestFormBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,557
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHeaderRewriteWithFilterInitParam,Long Statement,The length of the statement "String output="<root url='http://mock-host:42/test-input-path-2'><url>http://mock-host:42/test-input-path-3</url></root>";" is 122.,589
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHeaderRewriteWithFilterInitParam,Long Statement,The length of the statement "interaction.respond().content(output`StandardCharsets.UTF_8).contentType("text/xml").header("Location"`"http://mock-host:42/test-input-path-4").status(307);" is 156.,589
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHeaderRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 307,589
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHeaderRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 307,589
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseJsonBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,631
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseJsonBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,631
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "String responseHtml="<!DOCTYPE html>\n" + "<html>\n" + " <head>\n"+ " <meta charset=\"UTF-8\">\n"+ " <link rel=\"stylesheet\" href=\"pretty.css\">\n"+ " <script src=\"script.js\"></script>\n"+ " </head>\n"+ " <body>\n"+ " </body>\n"+ "</html>";" is 244.,664
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "String rewrittenResponseHtml="<!DOCTYPE html>\n" + "<html>\n" + " <head>\n"+ " <meta charset=\"UTF-8\">\n"+ " <link rel=\"stylesheet\" href=\"http://someotherhost/stylesheets/pretty.css\">\n"+ " <script src=\"script.js\"></script>\n"+ " </head>\n"+ " <body>\n"+ " </body>\n"+ "</html>";" is 286.,664
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,664
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,664
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseXmlBodyRewriteWithFilterInitParam,Long Statement,The length of the statement "String output="<root url='http://mock-host:42/test-input-path-1'><url>http://mock-host:42/test-input-path-1</url></root>";" is 122.,715
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseXmlBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,715
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseXmlBodyRewriteWithFilterInitParam,Magic Number,The method contains a magic number: 200,715
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteCSSImport,Long Statement,The length of the statement "String responseHtml="<html>" + " <head>" + " <style type=\"text/css\">@import \"pretty.css\";</style>"+ " </head>"+ "</html>";" is 126.,749
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteCSSImport,Long Statement,The length of the statement "String responseHtmlOne="<html>" + " <head>" + " <style type=\"text/css\">@import \"http://0.0.0.0:0/stylesheets/pretty.css\";</style>"+ " </head>"+ "</html>";" is 158.,749
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteCSSImport,Long Statement,The length of the statement "String responseHtmlTwo="<html>" + " <head>" + " <style type=\"text/css\">@import \"http://localhost:0/stylesheets/pretty.css\";</style>"+ " </head>"+ "</html>";" is 160.,749
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteCSSImport,Magic Number,The method contains a magic number: 200,749
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewriteCSSImport,Magic Number,The method contains a magic number: 200,749
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewritePrefixFunctionTestPrefix,Long Statement,The length of the statement "String responseHtmlOne="<html><div src=\"'http://0.0.0.0:0/zeppelin/components/navbar/navbar.html?v=1496201914075\"></div></html>";" is 131.,801
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewritePrefixFunctionTestPrefix,Magic Number,The method contains a magic number: 200,801
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlBodyRewritePrefixFunctionTestPrefix,Magic Number,The method contains a magic number: 200,801
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestPostfix,Long Statement,The length of the statement "String locationHeader="https://localhost:8443/gateway/knoxsso/api/v1/websso?originalUrl=http://localhost:20070/index.html&doAs=anonymous";" is 138.,839
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestPostfix,Long Statement,The length of the statement "String expectedLocationHeader="https://localhost:8443/gateway/knoxsso/api/v1/websso?originalUrl=http%3A%2F%2F0.0.0.0%3A0%2Fsparkhistory%2F";" is 140.,839
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestPostfix,Long Statement,The length of the statement "interaction.respond().contentType("application/html").header("Location"`locationHeader).content(responseHtml`StandardCharsets.UTF_8).status(200);" is 145.,839
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestPostfix,Magic Number,The method contains a magic number: 200,839
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestPostfix,Magic Number,The method contains a magic number: 200,839
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestInfix,Long Statement,The length of the statement "String expectedCustomHeader="https://localhost:8443/gateway/sandbox/?query=%27http%3A%2F%2F0.0.0.0%3A0%2Fsparkhistory%2F%27";" is 125.,879
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestInfix,Long Statement,The length of the statement "interaction.respond().contentType("application/html").header("CustomHeader"`customHeader).content(responseHtml`StandardCharsets.UTF_8).status(200);" is 147.,879
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestInfix,Magic Number,The method contains a magic number: 200,879
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testFunctionTestInfix,Magic Number,The method contains a magic number: 200,879
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlAttributeEscaping,Long Statement,The length of the statement "final String responseHtml="<!DOCTYPE html>\n" + "<html>\n" + " <head>\n"+ " <meta charset=\"UTF-8\">\n"+ " <link rel=\"stylesheet\" href=\"pretty.css\">\n"+ " <script escaped-data=\"&lt;&gt;\" src=\"script.js\"></script>\n"+ " </head>\n"+ " <body>\n"+ " </body>\n"+ "</html>";" is 276.,917
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlAttributeEscaping,Long Statement,The length of the statement "final String rewrittenResponseHtml="<!DOCTYPE html>\n" + "<html>\n" + " <head>\n"+ " <meta charset=\"UTF-8\">\n"+ " <link rel=\"stylesheet\" href=\"http://someotherhost/stylesheets/pretty.css\">\n"+ " <script escaped-data=\"&lt;&gt;\" src=\"script.js\"></script>\n"+ " </head>\n"+ " <body>\n"+ " </body>\n"+ "</html>";" is 318.,917
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlAttributeEscaping,Magic Number,The method contains a magic number: 200,917
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteServletFilterTest,testResponseHtmlAttributeEscaping,Magic Number,The method contains a magic number: 200,917
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testCreate,Magic Number,The method contains a magic number: 2,52
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testLoadEmptyFile,Long Statement,The length of the statement "assertEquals("org.xml.sax.SAXParseException; lineNumber: 16; " + "columnNumber: 4; Premature end of file."`e.getMessage());" is 123.,100
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testLoadInvalidFile,Long Statement,The length of the statement "assertEquals("org.xml.sax.SAXParseException; lineNumber: 18; columnNumber: 2; " + "The markup in the document preceding the root element must be well-formed."`e.getMessage());" is 175.,120
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testLoadSimpleFilterFile,Long Statement,The length of the statement "UrlRewriteRulesDescriptor config=UrlRewriteRulesDescriptorFactory.load("xml"`getTestResourceReader("filter-simple.xml"));" is 121.,154
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testLoadStoreCompleteFilterFile,Long Statement,The length of the statement "UrlRewriteRulesDescriptor config=UrlRewriteRulesDescriptorFactory.load("xml"`getTestResourceReader("filter-complete.xml"));" is 123.,165
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testLoadStoreCompleteFilterFile,Magic Number,The method contains a magic number: 3,165
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testLoadStoreCompleteFilterFile,Magic Number,The method contains a magic number: 2,165
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteRulesDescriptorFactoryTest,testLoadStoreCompleteFilterFile,Magic Number,The method contains a magic number: 2,165
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testBasicPathRewrite,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("test-scheme://test-host:1/test-output-path"));" is 128.,70
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testMultipleIdenticalRewriteOutputRules,Long Statement,The length of the statement "UrlRewriteRulesDescriptor config=UrlRewriteRulesDescriptorFactory.load("xml"`getTestResourceReader("rewrite-with-same-rules.xml"));" is 131.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testMultipleIdenticalRewriteOutputRules,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("output-mock-scheme-1://output-mock-host-1:42/test-input-path"));" is 146.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testMultipleIdenticalRewriteOutputRules,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("mock-scheme://output-mock-host-3:42/no-query"));" is 130.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testMultipleIdenticalRewriteOutputRules,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("mock-scheme://output-mock-host-4:42/no-query"));" is 130.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testIdenticalRewriteOutputRulesWithScopes,Long Statement,The length of the statement "UrlRewriteRulesDescriptor config=UrlRewriteRulesDescriptorFactory.load("xml"`getTestResourceReader("rewrite-with-same-rules-different-scope.xml"));" is 147.,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testIdenticalRewriteOutputRulesWithScopes,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("output-mock-scheme-2://output-mock-host-2:42/test-input-path"));" is 146.,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testIdenticalRewriteOutputRulesWithScopes,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("mock-scheme://output-mock-host-5:42/no-query"));" is 130.,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testIdenticalRewriteOutputRulesWithScopes,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("mock-scheme://output-mock-host-4:42/no-query"));" is 130.,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testIdenticalRewriteOutputRulesWithScopes,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("mock-scheme://output-mock-host-4:42/no-query"));" is 130.,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testIdenticalRewriteOutputRulesWithScopes,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("input-mock-scheme-2://input-mock-host-2:42/test-input-path"));" is 144.,131
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleNameWithAmbiguousRules,Long Statement,The length of the statement "UrlRewriteRulesDescriptor config=UrlRewriteRulesDescriptorFactory.load("xml"`getTestResourceReader("rewrite-with-same-rules.xml"));" is 131.,211
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleNameWithAmbiguousRules,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("output-mock-scheme-2://output-mock-host-2:42/test-input-path"));" is 146.,211
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleNameWithAmbiguousRules,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("output-mock-scheme-1://output-mock-host-1:42/test-input-path"));" is 146.,211
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleWithComplexFlow,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("test-scheme-output://test-host-output:42/test-path-output/test-path"));" is 153.,243
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleWithComplexFlow,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("test-scheme-output://test-host-output:777/test-path-output/test-home/test-path"));" is 164.,243
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleWithWildcardTemplateAndOptionalQuery,Long Statement,The length of the statement "inputUrl=Parser.parseLiteral("test-scheme-input://test-host-input:42/test-path-input-one/test-path-input-two?test-query-name=test-query-value");" is 144.,273
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleWithWildcardTemplateAndOptionalQuery,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path and query."`outputUrl.toString()`is("test-scheme-output://test-host-output:777/test-path-output/test-path-input-one/test-path-input-two?test-query-name=test-query-value"));" is 227.,273
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testRewriteViaRuleWithWildcardTemplateAndOptionalQuery,Long Statement,The length of the statement "assertThat("Expect rewrite to contain the correct path."`outputUrl.toString()`is("test-scheme-output://test-host-output:777/test-path-output/test-path-input-one/test-path-input-two"));" is 184.,273
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testSolrRewrite,Long Statement,The length of the statement "inputUri=new URI("https://hortonworks.sandbox.hdp.24.test:8443/gateway/sandbox/solr/TestCollection/select?q=*.*&wt=json&indent=true");" is 134.,308
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testSolrRewriteDefaultPort,Long Statement,The length of the statement "inputUri=new URI("https://hortonworks.sandbox.hdp.24.test/gateway/sandbox/solr/TestCollection/select?q=*.*&wt=json&indent=true");" is 129.,351
apache_knox,org.apache.knox.gateway.filter.rewrite.api,UrlRewriteProcessorTest,testNoMatchOutput,Long Statement,The length of the statement "UrlRewriteRulesDescriptor config=UrlRewriteRulesDescriptorFactory.load("xml"`getTestResourceReader("rewrite-no-match.xml"));" is 124.,393
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jIdentityAdapter,doFilter,Long Statement,The length of the statement "final JEEContext context=new JEEContext(request`response`((Config)request.getAttribute(PAC4J_CONFIG)).getSessionStore());" is 121.,81
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Complex Conditional,The conditional expression cryptoService == null || aliasService == null || clusterName == null is complex.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Complex Conditional,The conditional expression AzureAdClient.class.getSimpleName().equals(clientNameParameter) || (!StringUtils.isBlank(oidcType) && PAC4J_OICD_TYPE_AZURE.equals(oidcType)) is complex.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Complex Method,Cyclomatic complexity of the method is 11,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_GROUPS is 34.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_GROUPS_DEFAULT is 42.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_ROLES is 33.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_ROLES_DEFAULT is 41.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_PERMISSIONS is 39.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_PERMISSIONS_DEFAULT is 47.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES is 45.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES_DEFAULT is 53.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_CLIENT_CONFIGURATION_DECORATOR is 36.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Identifier,The length of the field PAC4J_COOKIE_DOMAIN_SUFFIX_PARAM is 32.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Statement,The length of the statement "if (AzureAdClient.class.getSimpleName().equals(clientNameParameter) || (!StringUtils.isBlank(oidcType) && PAC4J_OICD_TYPE_AZURE.equals(oidcType))) {" is 148.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Statement,The length of the statement "final IndirectBasicAuthClient indirectBasicAuthClient=new IndirectBasicAuthClient(new SimpleTestUsernamePasswordAuthenticator());" is 129.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Statement,The length of the statement "setSessionStoreConfig(filterConfig`PAC4J_SESSION_STORE_EXCLUDE_PERMISSIONS`PAC4J_SESSION_STORE_EXCLUDE_PERMISSIONS_DEFAULT);" is 124.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,init,Long Statement,The length of the statement "setSessionStoreConfig(filterConfig`PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES`PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES_DEFAULT);" is 136.,127
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,doFilter,Complex Conditional,The conditional expression request.getParameter(PAC4J_CALLBACK_PARAMETER) != null || (request.getContextPath() != null && request.getRequestURI().contains(PAC4J_CALLBACK_PARAMETER)) is complex.,310
apache_knox,org.apache.knox.gateway.pac4j.filter,Pac4jDispatcherFilter,doFilter,Long Statement,The length of the statement "if (request.getParameter(PAC4J_CALLBACK_PARAMETER) != null || (request.getContextPath() != null && request.getRequestURI().contains(PAC4J_CALLBACK_PARAMETER))) {" is 161.,310
apache_knox,org.apache.knox.gateway.pac4j.config,SAML2ClientConfigurationDecorator,setUseNameQualifierFlag,Long Identifier,The length of the field CONFIG_NAME_USE_NAME_QUALIFIER is 30.,55
apache_knox,org.apache.knox.gateway.pac4j.config,SAML2ClientConfigurationDecorator,setNameIdPolicyFormat,Long Identifier,The length of the field CONFIG_NAME_NAMEID_POLICY_FORMAT is 32.,76
apache_knox,org.apache.knox.gateway.pac4j.config,Pac4jClientConfigurationDecoratorTest,testClientConfigDecoration,Long Statement,The length of the statement "final Pac4jClientConfigurationDecorator pac4jConfigurationDecorator=new Pac4jClientConfigurationDecorator(Arrays.asList(passiveDecorator`activeDecorator));" is 155.,34
apache_knox,org.apache.knox.gateway.pac4j.config,Pac4jClientConfigurationDecoratorTest,testClientConfigDecoration,Magic Number,The method contains a magic number: 2,34
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD`true)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 163.,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 158.,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Long Statement,The length of the statement "assertEquals(PAC4J_CALLBACK_URL + "?" + Pac4jDispatcherFilter.PAC4J_CALLBACK_PARAMETER+ "=true&"+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ CLIENT_CLASS`response.getHeaders().get("Location"));" is 201.,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Long Statement,The length of the statement "final Cookie requestedUrlCookie=cookies.stream().filter(c -> (KnoxSessionStore.PAC4J_SESSION_PREFIX + Pac4jConstants.REQUESTED_URL).equals(c.getName())).collect(Collectors.toList()).get(0);" is 189.,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Long Statement,The length of the statement "request.setRequestURL(PAC4J_CALLBACK_URL + "?" + Pac4jDispatcherFilter.PAC4J_CALLBACK_PARAMETER+ "=true&"+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ CLIENT_CLASS);" is 223.,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Long Statement,The length of the statement "final Cookie userProfileCookie=cookies.stream().filter(c -> (KnoxSessionStore.PAC4J_SESSION_PREFIX + Pac4jConstants.USER_PROFILES).equals(c.getName())).collect(Collectors.toList()).get(0);" is 188.,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Magic Number,The method contains a magic number: 302,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Magic Number,The method contains a magic number: 3,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Magic Number,The method contains a magic number: 302,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Magic Number,The method contains a magic number: 2,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,test,Magic Number,The method contains a magic number: 3,65
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD`true)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 163.,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 158.,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Long Statement,The length of the statement "assertEquals(PAC4J_CALLBACK_URL + "?" + Pac4jDispatcherFilter.PAC4J_CALLBACK_PARAMETER+ "=true&"+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ CLIENT_CLASS`response.getHeaders().get("Location"));" is 201.,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Long Statement,The length of the statement "final Cookie requestedUrlCookie=cookies.stream().filter(c -> (KnoxSessionStore.PAC4J_SESSION_PREFIX + Pac4jConstants.REQUESTED_URL).equals(c.getName())).collect(Collectors.toList()).get(0);" is 189.,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Long Statement,The length of the statement "request.setRequestURL(PAC4J_CALLBACK_URL + "?" + Pac4jDispatcherFilter.PAC4J_CALLBACK_PARAMETER+ "=true&"+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ CLIENT_CLASS);" is 223.,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Long Statement,The length of the statement "final Cookie userProfileCookie=cookies.stream().filter(c -> (KnoxSessionStore.PAC4J_SESSION_PREFIX + Pac4jConstants.USER_PROFILES).equals(c.getName())).collect(Collectors.toList()).get(0);" is 188.,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Magic Number,The method contains a magic number: 302,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Magic Number,The method contains a magic number: 3,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Magic Number,The method contains a magic number: 302,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Magic Number,The method contains a magic number: 2,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testValidIdAttribute,Magic Number,The method contains a magic number: 3,167
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD`true)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 163.,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 158.,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Long Statement,The length of the statement "assertEquals(PAC4J_CALLBACK_URL + "?" + Pac4jDispatcherFilter.PAC4J_CALLBACK_PARAMETER+ "=true&"+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ CLIENT_CLASS`response.getHeaders().get("Location"));" is 201.,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Long Statement,The length of the statement "final Cookie requestedUrlCookie=cookies.stream().filter(c -> (KnoxSessionStore.PAC4J_SESSION_PREFIX + Pac4jConstants.REQUESTED_URL).equals(c.getName())).collect(Collectors.toList()).get(0);" is 189.,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Long Statement,The length of the statement "request.setRequestURL(PAC4J_CALLBACK_URL + "?" + Pac4jDispatcherFilter.PAC4J_CALLBACK_PARAMETER+ "=true&"+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ Pac4jConstants.DEFAULT_CLIENT_NAME_PARAMETER+ "="+ CLIENT_CLASS);" is 223.,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Long Statement,The length of the statement "final Cookie userProfileCookie=cookies.stream().filter(c -> (KnoxSessionStore.PAC4J_SESSION_PREFIX + Pac4jConstants.USER_PROFILES).equals(c.getName())).collect(Collectors.toList()).get(0);" is 188.,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Magic Number,The method contains a magic number: 302,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Magic Number,The method contains a magic number: 3,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Magic Number,The method contains a magic number: 302,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Magic Number,The method contains a magic number: 2,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testInvalidIdAttribute,Magic Number,The method contains a magic number: 3,269
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testResolvesAlias,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD`true)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 163.,372
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testResolvesAlias,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`KnoxSessionStore.PAC4J_PASSWORD)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 158.,372
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testResolvesAlias,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`"my-secret-alias")).andReturn("my-oidc-secret".toCharArray()).atLeastOnce();" is 149.,372
apache_knox,org.apache.knox.gateway.pac4j,Pac4jProviderTest,testResolvesAlias,Long Statement,The length of the statement "new Pac4jDispatcherFilter().init(new FilterConfigStub(context).addInitParam(Pac4jDispatcherFilter.PAC4J_CALLBACK_URL`PAC4J_CALLBACK_URL).addInitParam("clientName"`"OidcClient").addInitParam("oidc.secret"`"${ALIAS=my-secret-alias}").addInitParam("oidc.id"`"test-id"));" is 267.,372
apache_knox,org.apache.knox.gateway.pac4j,MockHttpServletResponse,sendRedirect,Magic Number,The method contains a magic number: 302,71
apache_knox,org.apache.knox.gateway.pac4j.deploy,Pac4jFederationProviderContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,64
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,compressEncryptBase64,Complex Conditional,The conditional expression o == null || o.equals("") || (o instanceof Map<?`?> && ((Map<?`?>)o).isEmpty()) is complex.,136
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,compressEncryptBase64,Magic Number,The method contains a magic number: 3000,136
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,set,Long Statement,The length of the statement "final String[] parts=((JEEContext)context).getNativeRequest().getRequestURI().split("websso" + Pac4jDispatcherFilter.URL_PATH_SEPARATOR + Pac4jDispatcherFilter.PAC4J_CALLBACK_PARAMETER);" is 186.,160
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,unCompress,Long Statement,The length of the statement "try (ByteArrayInputStream inputStream=new ByteArrayInputStream(data);GZIPInputStream gzip=new GZIPInputStream(inputStream)){" is 124.,222
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,clearUserProfile,Long Statement,The length of the statement "if (sessionStoreConfigs.getOrDefault(PAC4J_SESSION_STORE_EXCLUDE_GROUPS`PAC4J_SESSION_STORE_EXCLUDE_GROUPS_DEFAULT).equalsIgnoreCase("true")) {" is 143.,237
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,clearUserProfile,Long Statement,The length of the statement "if (sessionStoreConfigs.getOrDefault(PAC4J_SESSION_STORE_EXCLUDE_ROLES`PAC4J_SESSION_STORE_EXCLUDE_ROLES_DEFAULT).equalsIgnoreCase("true")) {" is 141.,237
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,clearUserProfile,Long Statement,The length of the statement "if (sessionStoreConfigs.getOrDefault(PAC4J_SESSION_STORE_EXCLUDE_PERMISSIONS`PAC4J_SESSION_STORE_EXCLUDE_PERMISSIONS_DEFAULT).equalsIgnoreCase("true")) {" is 153.,237
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,clearUserProfile,Long Statement,The length of the statement "if (!StringUtils.isBlank(sessionStoreConfigs.getOrDefault(PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES`PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES_DEFAULT))) {" is 162.,237
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStore,clearUserProfile,Long Statement,The length of the statement "final String customAttributes=sessionStoreConfigs.getOrDefault(PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES`PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES_DEFAULT);" is 164.,237
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStoreTest,filterConfigParamsTest,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`PAC4J_PASSWORD`true)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 146.,50
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStoreTest,filterConfigParamsTest,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(CLUSTER_NAME`PAC4J_PASSWORD)).andReturn(PAC4J_PASSWORD.toCharArray()).anyTimes();" is 141.,50
apache_knox,org.apache.knox.gateway.pac4j.session,KnoxSessionStoreTest,filterConfigParamsTest,Long Statement,The length of the statement "sessionStoreConfigs.put(PAC4J_SESSION_STORE_EXCLUDE_CUSTOM_ATTRIBUTES`"https://knox.apache.org/SAML/Attributes/groups` https://knox.apache.org/SAML/Attributes/groups2");" is 169.,50
apache_knox,org.apache.knox.gateway.preauth.filter,PreAuthFederationFilter,doFilter,Long Statement,The length of the statement "((HttpServletResponse)response).sendError(HttpServletResponse.SC_BAD_REQUEST`"Missing Required Header for SSO Validation");" is 123.,48
apache_knox,org.apache.knox.gateway.preauth.filter,PreAuthFederationFilter,doFilter,Long Statement,The length of the statement "((HttpServletResponse)response).sendError(HttpServletResponse.SC_BAD_REQUEST`"Missing Required Header for PreAuth SSO Federation");" is 131.,48
apache_knox,org.apache.knox.gateway.preauth.filter,DefaultValidator,getName,Long Identifier,The length of the field DEFAULT_VALIDATION_METHOD_VALUE is 31.,41
apache_knox,org.apache.knox.gateway.preauth.filter,AbstractPreAuthFederationFilter,doFilter,Long Statement,The length of the statement "((HttpServletResponse)response).sendError(HttpServletResponse.SC_FORBIDDEN`"Missing Required Header for PreAuth SSO Federation");" is 129.,72
apache_knox,org.apache.knox.gateway.preauth.deploy,HeaderPreAuthContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,54
apache_knox,org.apache.knox.gateway.provider.federation,HeaderPreAuthFederationFilterTest,testDefaultValidator,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(PreAuthService.VALIDATION_METHOD_PARAM)).andReturn(DefaultValidator.DEFAULT_VALIDATION_METHOD_VALUE);" is 147.,39
apache_knox,org.apache.knox.gateway.provider.federation,HeaderPreAuthFederationFilterTest,testIPValidator,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(IPValidator.IP_ADDRESSES_PARAM)).andReturn("5.4.3.2`10.1.23.42").anyTimes();" is 122.,56
apache_knox,org.apache.knox.gateway.provider.federation,HeaderPreAuthFederationFilterTest,testIPValidator,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(PreAuthService.VALIDATION_METHOD_PARAM)).andReturn(IPValidator.IP_VALIDATION_METHOD_VALUE).anyTimes();" is 148.,56
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testValidatorMap,Long Statement,The length of the statement "assertEquals(valMap.get(DefaultValidator.DEFAULT_VALIDATION_METHOD_VALUE).getName()`DefaultValidator.DEFAULT_VALIDATION_METHOD_VALUE);" is 134.,42
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testDefaultValidator,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(PreAuthService.VALIDATION_METHOD_PARAM)).andReturn(DefaultValidator.DEFAULT_VALIDATION_METHOD_VALUE);" is 147.,54
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testIPValidator,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(IPValidator.IP_ADDRESSES_PARAM)).andReturn("5.4.3.2`10.1.23.42").anyTimes();" is 122.,70
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testIPValidator,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(PreAuthService.VALIDATION_METHOD_PARAM)).andReturn(IPValidator.IP_VALIDATION_METHOD_VALUE).anyTimes();" is 148.,70
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testMultipleValidatorsPositive,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(IPValidator.IP_ADDRESSES_PARAM)).andReturn("5.4.3.2`10.1.23.42").anyTimes();" is 122.,95
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testMultipleValidatorsPositive,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(PreAuthService.VALIDATION_METHOD_PARAM)).andReturn(DefaultValidator.DEFAULT_VALIDATION_METHOD_VALUE + "`" + IPValidator.IP_VALIDATION_METHOD_VALUE).anyTimes();" is 205.,95
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testMultipleValidatorsPositive,Magic Number,The method contains a magic number: 2,95
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testMultipleValidatorsNegative,Long Statement,The length of the statement "EasyMock.expect(filterConfig.getInitParameter(PreAuthService.VALIDATION_METHOD_PARAM)).andReturn(DefaultValidator.DEFAULT_VALIDATION_METHOD_VALUE + "` NOT_EXISTED_VALIDATOR");" is 175.,122
apache_knox,org.apache.knox.gateway.provider.federation,PreAuthServiceTest,testMultipleValidatorsNegative,Long Statement,The length of the statement "assertEquals("Unable to find validator with name 'preauth.default.validation` " + "NOT_EXISTED_VALIDATOR'"`e.getMessage());" is 123.,122
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2048,98
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,setUpBeforeClass,Magic Number,The method contains a magic number: 365,98
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,setUpBeforeClass,Magic Number,The method contains a magic number: 76,98
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,tearDown,Empty catch clause,The method has an empty catch block.,113
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testJWTWithoutKnoxUUIDClaim,Magic Number,The method contains a magic number: 5000,124
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredJWTWithoutKnoxUUIDClaim,Magic Number,The method contains a magic number: 5000,132
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestJWTWithoutKnoxUUIDClaim,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`"bar"`new Date(expiration)`new Date()`privateKey`JWSAlgorithm.RS256.getName()`null);" is 150.,141
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testValidJWT,Magic Number,The method contains a magic number: 5000,169
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testValidAudienceJWT,Magic Number,The method contains a magic number: 5000,200
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidAudienceJWT,Magic Number,The method contains a magic number: 5000,231
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testValidAudienceJWTWhitespace,Magic Number,The method contains a magic number: 5000,263
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testNoTokenAudience,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`null`new Date(new Date().getTime() + 5000)`new Date()`privateKey`"RS256");" is 140.,295
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testNoTokenAudience,Magic Number,The method contains a magic number: 5000,295
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testNoAudienceConfigured,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`null`new Date(new Date().getTime() + 5000)`new Date()`privateKey`"RS256");" is 140.,325
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testNoAudienceConfigured,Magic Number,The method contains a magic number: 5000,325
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testEmptyAudienceConfigured,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`null`new Date(new Date().getTime() + 5000)`new Date()`privateKey`"RS256");" is 140.,356
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testEmptyAudienceConfigured,Magic Number,The method contains a magic number: 5000,356
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testValidVerificationPEM,Magic Number,The method contains a magic number: 50000,388
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredJWT,Magic Number,The method contains a magic number: 1000,423
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testUnableToParseJWT,Magic Number,The method contains a magic number: 5000,482
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testFailedSignatureValidationJWT,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"bob"`new Date(new Date().getTime() + TimeUnit.MINUTES.toMillis(10))`(RSAPrivateKey)kp.getPrivate());" is 159.,511
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testFailedSignatureValidationJWT,Magic Number,The method contains a magic number: 2048,511
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testFailedSignatureValidationJWT,Magic Number,The method contains a magic number: 10,511
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidVerificationPEM,Long Statement,The length of the statement "String failingPem=new String(encoder.encodeToString(data).getBytes(StandardCharsets.US_ASCII)`StandardCharsets.US_ASCII).trim();" is 128.,549
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidVerificationPEM,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`new Date(new Date().getTime() + TimeUnit.MINUTES.toMillis(10))`privateKey);" is 141.,549
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidVerificationPEM,Magic Number,The method contains a magic number: 2048,549
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidVerificationPEM,Magic Number,The method contains a magic number: 365,549
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidVerificationPEM,Magic Number,The method contains a magic number: 76,549
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidVerificationPEM,Magic Number,The method contains a magic number: 10,549
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidIssuer,Magic Number,The method contains a magic number: 5000,591
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testValidIssuerViaConfig,Magic Number,The method contains a magic number: 5000,619
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testRS512SignatureAlgorithm,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`new Date(new Date().getTime() + TimeUnit.MINUTES.toMillis(10))`new Date()`privateKey`JWSAlgorithm.RS512.getName());" is 181.,650
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testRS512SignatureAlgorithm,Magic Number,The method contains a magic number: 10,650
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidSignatureAlgorithm,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`new Date(new Date().getTime() + TimeUnit.MINUTES.toMillis(10))`new Date()`privateKey`JWSAlgorithm.RS384.getName());" is 181.,686
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testInvalidSignatureAlgorithm,Magic Number,The method contains a magic number: 10,686
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testNotBeforeJWT,Long Statement,The length of the statement "SignedJWT jwt=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`new Date(new Date().getTime() + 5000)`new Date(new Date().getTime() + 5000)`privateKey`JWSAlgorithm.RS256.getName());" is 183.,721
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testNotBeforeJWT,Magic Number,The method contains a magic number: 5000,721
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testNotBeforeJWT,Magic Number,The method contains a magic number: 5000,721
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Long Statement,The length of the statement "final SignedJWT jwt_alice=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`principalAlice`"myAudience"`new Date(new Date().getTime() + TimeUnit.MINUTES.toMillis(10))`new Date()`privateKey`JWSAlgorithm.RS512.getName()`tokenId);" is 221.,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Long Statement,The length of the statement "final SignedJWT jwt_bob=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`principalBob`"myAudience"`new Date(new Date().getTime() + TimeUnit.MINUTES.toMillis(10))`new Date()`privateKey`JWSAlgorithm.RS512.getName()`tokenId);" is 217.,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Long Statement,The length of the statement "Assert.assertEquals("Expected no token verification calls yet."`0`((TokenVerificationCounter)handler).getVerificationCount());" is 126.,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Long Statement,The length of the statement "Assert.assertEquals("Expected token verification to have been performed."`1`((TokenVerificationCounter)handler).getVerificationCount());" is 136.,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Long Statement,The length of the statement "Assert.assertEquals("Expected token verification to have been skipped the second time."`1`((TokenVerificationCounter)handler).getVerificationCount());" is 150.,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Long Statement,The length of the statement "Assert.assertEquals("Expected token verification to have been skipped the second time."`2`((TokenVerificationCounter)handler).getVerificationCount());" is 150.,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Long Statement,The length of the statement "Assert.assertEquals("Expected verification to have been performed for the token evicted from the verified cache."`3`((TokenVerificationCounter)handler).getVerificationCount());" is 176.,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Magic Number,The method contains a magic number: 10,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Magic Number,The method contains a magic number: 10,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Magic Number,The method contains a magic number: 2,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,doTestVerificationOptimization,Magic Number,The method contains a magic number: 3,772
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredTokensEvictedFromSignatureVerificationCache,Empty catch clause,The method has an empty catch block.,853
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredTokensEvictedFromSignatureVerificationCache,Long Statement,The length of the statement "Assert.assertEquals("Expected no token verification calls yet."`0`((TokenVerificationCounter)handler).getVerificationCount());" is 126.,853
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredTokensEvictedFromSignatureVerificationCache,Long Statement,The length of the statement "final SignedJWT jwt_alice=getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`principalAlice`new Date(expiration)`new Date()`privateKey`JWSAlgorithm.RS512.getName());" is 158.,853
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredTokensEvictedFromSignatureVerificationCache,Long Statement,The length of the statement "Assert.assertEquals("The signature verification record for the token should have been added."`1`getSignatureVerificationCacheSize());" is 133.,853
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredTokensEvictedFromSignatureVerificationCache,Long Statement,The length of the statement "Assert.assertEquals("The signature verification record for the expired token should have been removed."`0`getSignatureVerificationCacheSize());" is 143.,853
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredTokensEvictedFromSignatureVerificationCache,Magic Number,The method contains a magic number: 2,853
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,testExpiredTokensEvictedFromSignatureVerificationCache,Magic Number,The method contains a magic number: 500,853
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,getJWT,Long Parameter List,The method has 6 parameters. ,988
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,getJWT,Long Parameter List,The method has 7 parameters. ,994
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,getJWT,Long Parameter List,The method has 8 parameters. ,999
apache_knox,org.apache.knox.gateway.provider.federation,AbstractJWTFilterTest,getJWT,Long Statement,The length of the statement "builder.issuer(issuer).subject(sub).audience(aud).expirationTime(expires).notBeforeTime(nbf).claim("scope"`"openid").claim(PASSCODE_CLAIM`UUID.randomUUID().toString());" is 168.,999
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,setUp,Long Statement,The length of the statement "tokenMAC=new TokenMAC(HmacAlgorithms.HMAC_SHA_256.getName()`"sPj8FCgQhCEi6G18kBfpswxYSki33plbelGLs0hMSbk".toCharArray());" is 121.,66
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,setTokenOnRequest,Magic Number,The method contains a magic number: 5,75
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,generatePasscodeField,Long Statement,The length of the statement "final String base64TokenIdPasscode=Base64.encodeBase64String(tokenId.getBytes(StandardCharsets.UTF_8)) + "::" + Base64.encodeBase64String(passcode.getBytes(StandardCharsets.UTF_8));" is 181.,88
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,setTokenOnRequest,Magic Number,The method contains a magic number: 5,93
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,getTokenId,Empty catch clause,The method has an empty catch block.,120
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,testAlternativeCaseUsername,Magic Number,The method contains a magic number: 5000,143
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,testInvalidUsername,Magic Number,The method contains a magic number: 5000,171
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,testInvalidJWTForPasscode,Magic Number,The method contains a magic number: 5000,199
apache_knox,org.apache.knox.gateway.provider.federation,TokenIDAsHTTPBasicCredsFederationFilterTest,testInvalidPasscodeForJWT,Magic Number,The method contains a magic number: 5000,231
apache_knox,org.apache.knox.gateway.provider.federation,SSOCookieProviderTest,testCustomCookieNameJWT,Magic Number,The method contains a magic number: 5000,82
apache_knox,org.apache.knox.gateway.provider.federation,SSOCookieProviderTest,testMissingCookie,Long Statement,The length of the statement "Assert.assertEquals("Not the expected principal"`newLocation`"https://localhost:8443/authserver?originalUrl=https://localhost:8888/resource");" is 142.,115
apache_knox,org.apache.knox.gateway.provider.federation,SSOCookieProviderTest,testDefaultAuthenticationProviderURL,Magic Number,The method contains a magic number: 8443,194
apache_knox,org.apache.knox.gateway.provider.federation,SSOCookieProviderTest,testProxiedDefaultAuthenticationProviderURL,Long Statement,The length of the statement "Assert.assertEquals(loginURL`"https://remotehost:8443/gateway/knoxsso/api/v1/websso?originalUrl=" + "https://remotehost:8443/resource");" is 136.,217
apache_knox,org.apache.knox.gateway.provider.federation,SSOCookieProviderTest,testProxiedDefaultAuthenticationProviderURLWithoutNonGatewayAppPath,Long Statement,The length of the statement "Assert.assertEquals(loginURL`"https://remotehost:8443/notgateway/knoxsso/api/v1/websso?originalUrl=" + "https://remotehost:8443/resource");" is 139.,244
apache_knox,org.apache.knox.gateway.provider.federation,SSOCookieProviderTest,testProxiedDefaultAuthenticationProviderURLWithoutPortInHostHeader,Long Statement,The length of the statement "Assert.assertEquals(loginURL`"https://remotehost/notgateway/knoxsso/api/v1/websso?originalUrl=" + "https://remotehost/resource");" is 129.,271
apache_knox,org.apache.knox.gateway.provider.federation,SSOCookieProviderTest,testProxiedDefaultAuthenticationProviderURLWithoutMismatchInXForwardedHeader,Long Statement,The length of the statement "Assert.assertEquals(loginURL`"https://remotehost/notgateway/knoxsso/api/v1/websso?originalUrl=" + "https://remotehost/resource");" is 129.,297
apache_knox,org.apache.knox.gateway.provider.federation,JWTAsHTTPBasicCredsFederationFilterTest,setTokenOnRequest,Long Statement,The length of the statement "final byte[] basicAuth=(authUsername + ":" + (authPassword != null ? authPassword : "")).getBytes(StandardCharsets.UTF_8);" is 122.,69
apache_knox,org.apache.knox.gateway.provider.federation,JWTAsHTTPBasicCredsFederationFilterTest,testAlternativeCaseUsername,Magic Number,The method contains a magic number: 5000,86
apache_knox,org.apache.knox.gateway.provider.federation,CommonJWTFilterTest,testIsStillValid,Long Statement,The length of the statement "assertTrue("Expected the token to be valid because it has not yet expired."`doTestIsStillValid(System.currentTimeMillis() + 300000));" is 133.,123
apache_knox,org.apache.knox.gateway.provider.federation,CommonJWTFilterTest,testIsStillValid,Magic Number,The method contains a magic number: 300000,123
apache_knox,org.apache.knox.gateway.provider.federation,CommonJWTFilterTest,testIsStillValidExpired,Long Statement,The length of the statement "assertFalse("Expected the token to be invalid because it has already expired."`doTestIsStillValid(System.currentTimeMillis() - 300000));" is 136.,129
apache_knox,org.apache.knox.gateway.provider.federation,CommonJWTFilterTest,testIsStillValidExpired,Magic Number,The method contains a magic number: 300000,129
apache_knox,org.apache.knox.gateway.provider.federation,CommonJWTFilterTest,testIsStillValidUnknownToken,Long Statement,The length of the statement "EasyMock.expect(tss.getTokenExpiration(anyObject(String.class))).andThrow(new UnknownTokenException(tokenId)).anyTimes();" is 121.,135
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTFederationFilter,init,Long Identifier,The length of the field JWT_UNAUTHENTICATED_PATHS_PARAM is 31.,75
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTFederationFilter,init,Long Statement,The length of the statement "Stream.of(allowedTypes.trim().split("`")).forEach(allowedType -> allowedJwsTypes.add(new JOSEObjectType(allowedType.trim())));" is 126.,75
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTFederationFilter,doFilter,Complex Conditional,The conditional expression wireToken != null && wireToken.getLeft() != null && wireToken.getRight() != null is complex.,130
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTFederationFilter,doFilter,Long Identifier,The length of the identifier base64DecodedTokenIdAndPasscode is 31.,130
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTFederationFilter,doFilter,Long Statement,The length of the statement "handleValidationError((HttpServletRequest)request`(HttpServletResponse)response`HttpServletResponse.SC_UNAUTHORIZED`"Error while parsing the received passcode token");" is 167.,130
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTFederationFilter,parseFromHTTPBasicCredentials,Magic Number,The method contains a magic number: 2,217
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SSOCookieFederationFilter,init,Long Identifier,The length of the field SSO_AUTHENTICATION_PROVIDER_URL is 31.,76
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SSOCookieFederationFilter,init,Long Identifier,The length of the field SSO_UNAUTHENTICATED_PATHS_PARAM is 31.,76
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SSOCookieFederationFilter,init,Long Identifier,The length of the field DEFAULT_SSO_UNAUTHENTICATED_PATHS_PARAM is 39.,76
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SSOCookieFederationFilter,setGatewayPath,Long Statement,The length of the statement "final GatewayConfig gatewayConfig=filterConfig.getServletContext() == null ? null : (GatewayConfig)filterConfig.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 185.,116
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SSOCookieFederationFilter,doFilter,Empty catch clause,The method has an empty catch block.,131
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SSOCookieFederationFilter,constructLoginURL,Long Statement,The length of the statement "return providerURL + delimiter + ORIGINAL_URL_QUERY_PARAM+ request.getRequestURL().append(getOriginalQueryString(request));" is 123.,208
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTAuthCodeAssertionFilter,init,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)filterConfig.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 132.,49
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTAuthCodeAssertionFilter,init,Long Statement,The length of the statement "this.tokenIssuer=StringUtils.isBlank(filterConfig.getInitParameter(JWTAccessTokenAssertionFilter.ISSUER)) ? JWTokenAttributes.DEFAULT_ISSUER : filterConfig.getInitParameter(JWTAccessTokenAssertionFilter.ISSUER);" is 211.,49
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTAuthCodeAssertionFilter,doFilter,Long Statement,The length of the statement "authCode=authority.issueToken(new JWTokenAttributesBuilder().setIssuer(tokenIssuer).setUserName(principalName).setAlgorithm(signatureAlgorithm).build());" is 153.,67
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCache,initializeVerifiedTokensCache,Long Identifier,The length of the field TOKENS_VERIFIED_CACHE_MAX_DEFAULT is 33.,68
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTAccessTokenAssertionFilter,init,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)filterConfig.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 132.,62
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTAccessTokenAssertionFilter,init,Long Statement,The length of the statement "this.tokenIssuer=StringUtils.isBlank(filterConfig.getInitParameter(JWTAccessTokenAssertionFilter.ISSUER)) ? JWTokenAttributes.DEFAULT_ISSUER : filterConfig.getInitParameter(JWTAccessTokenAssertionFilter.ISSUER);" is 211.,62
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTAccessTokenAssertionFilter,doFilter,Magic Number,The method contains a magic number: 1000,80
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTAccessTokenAssertionFilter,getAccessToken,Long Statement,The length of the statement "final JWTokenAttributes jwtAttributes=new JWTokenAttributesBuilder().setIssuer(tokenIssuer).setUserName(principalName).setAudiences(serviceName).setAlgorithm(signatureAlgorithm).setExpires(expires).build();" is 206.,146
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AccessTokenFederationFilter,init,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)filterConfig.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 132.,59
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AccessTokenFederationFilter,isExpired,Long Statement,The length of the statement "return (tokenStateService != null) ? tokenStateService.isExpired(token) : (Long.parseLong(token.getExpires()) <= System.currentTimeMillis());" is 141.,125
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AbstractJWTFilter,init,Long Statement,The length of the statement "tokenMAC=new TokenMAC(config.getKnoxTokenHashAlgorithm()`aliasService.getPasswordFromAliasForGateway(TokenMAC.KNOX_TOKEN_HASH_KEY_ALIAS_NAME));" is 143.,125
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AbstractJWTFilter,validateToken,Long Statement,The length of the statement "handleValidationError(request`response`HttpServletResponse.SC_UNAUTHORIZED`"Token " + displayableTokenId + " is disabled");" is 123.,321
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AbstractJWTFilter,validateToken,Long Statement,The length of the statement "handleValidationError(request`response`HttpServletResponse.SC_BAD_REQUEST`"Bad request: missing required token audience");" is 122.,321
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AbstractJWTFilter,validateToken,Long Parameter List,The method has 5 parameters. ,386
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AbstractJWTFilter,validateToken,Long Statement,The length of the statement "handleValidationError(request`response`HttpServletResponse.SC_UNAUTHORIZED`"Token " + displayableTokenId + " is disabled");" is 123.,386
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,AbstractJWTFilter,validatePasscode,Long Statement,The length of the statement "final boolean validPasscode=Arrays.equals(tokenMAC.hash(tokenId`issueTime`userName`passcode).getBytes(UTF_8)`storedPasscode);" is 125.,430
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2048,43
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,testSignatureVerificationCacheWithoutTopology,Long Statement,The length of the statement "SignatureVerificationCache defaultCache=SignatureVerificationCache.getInstance(SignatureVerificationCache.DEFAULT_CACHE_ID`new TestFilterConfig());" is 147.,51
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,testSignatureVerificationCacheLifecycle,Long Statement,The length of the statement "assertFalse("JWT signature verification should NOT have been recored yet."`cache.hasSignatureBeenVerified(serializedJWT));" is 122.,86
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,testSignatureVerificationCacheLifecycle,Long Statement,The length of the statement "assertFalse("JWT signature verification record should no longer be in the cache."`cache.hasSignatureBeenVerified(serializedJWT));" is 129.,86
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,testSignatureVerificationCacheClear,Long Statement,The length of the statement "assertFalse("JWT signature verification record should no longer be in the cache."`cache.hasSignatureBeenVerified(serializedJWTs.get(i)));" is 137.,115
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,testSignatureVerificationCacheClear,Magic Number,The method contains a magic number: 5,115
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,createTestJWT,Long Statement,The length of the statement "return JWTTestUtils.getJWT(AbstractJWTFilter.JWT_DEFAULT_ISSUER`"alice"`new Date(System.currentTimeMillis() + 5000)`privateKey);" is 128.,154
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,SignatureVerificationCacheTest,createTestJWT,Magic Number,The method contains a magic number: 5000,154
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTTestUtils,getJWT,Long Parameter List,The method has 6 parameters. ,39
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTTestUtils,getJWT,Long Parameter List,The method has 7 parameters. ,45
apache_knox,org.apache.knox.gateway.provider.federation.jwt.filter,JWTTestUtils,getJWT,Long Parameter List,The method has 8 parameters. ,50
apache_knox,org.apache.knox.gateway.provider.federation.jwt.deploy,JWTAccessTokenAssertionContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,54
apache_knox,org.apache.knox.gateway.provider.federation.jwt.deploy,JWTAuthCodeAssertionContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,47
apache_knox,org.apache.knox.gateway.provider.federation.jwt.deploy,JWTFederationContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,52
apache_knox,org.apache.knox.gateway.provider.federation.jwt.deploy,AccessTokenFederationContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,47
apache_knox,org.apache.knox.gateway.provider.federation.jwt.deploy,SSOCookieFederationContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,52
apache_knox,org.apache.knox.gateway.filter,AclsAuthorizationFilter,enforceAclAuthorizationPolicy,Complex Conditional,The conditional expression parser.users.isEmpty() && parser.groups.isEmpty() && parser.ipv.getIPAddresses().isEmpty() is complex.,117
apache_knox,org.apache.knox.gateway.filter,AclsAuthorizationFilter,enforceAclAuthorizationPolicy,Complex Method,Cyclomatic complexity of the method is 10,117
apache_knox,org.apache.knox.gateway.filter,AclsAuthorizationFilter,sendForbidden,Magic Number,The method contains a magic number: 403,242
apache_knox,org.apache.knox.gateway.filter,AclParser,parseAcls,Magic Number,The method contains a magic number: 3,43
apache_knox,org.apache.knox.gateway.filter,AclParser,parseIpAddressAcls,Magic Number,The method contains a magic number: 2,76
apache_knox,org.apache.knox.gateway.filter,AclsAuthzFilterTest,setUp,Long Statement,The length of the statement "@Override public void doFilter( ServletRequest request` ServletResponse response` FilterChain chain) throws IOException` ServletException {" is 139.,47
apache_knox,org.apache.knox.gateway.filter,AclsAuthzFilterTest,setUp,Long Statement,The length of the statement "@Override protected boolean enforceAclAuthorizationPolicy( ServletRequest request` ServletResponse response` FilterChain chain){" is 128.,47
apache_knox,org.apache.knox.gateway.filter,XForwardHeaderFilterTest,testXForwardHeaders,Magic Number,The method contains a magic number: 8888,46
apache_knox,org.apache.knox.gateway.filter,XForwardHeaderFilterTest,testProxiedXForwardHeaders,Magic Number,The method contains a magic number: 8888,135
apache_knox,org.apache.knox.gateway.filter,XForwardHeaderFilterTest,testProxiedXForwardContextHeaders,Magic Number,The method contains a magic number: 8888,168
apache_knox,org.apache.knox.gateway.filter,XForwardHeaderFilterTest,testProxiedXForwardContextHeadersServiceParam,Magic Number,The method contains a magic number: 8888,201
apache_knox,org.apache.knox.gateway.filter,XForwardHeaderFilterTest,testProxiedXForwardContextHeadersNegativeTest,Magic Number,The method contains a magic number: 8888,234
apache_knox,org.apache.knox.gateway.filter,CorrelationHandler,handle,Long Statement,The length of the statement "final String reqID=StringUtils.isBlank(request.getHeader(REQUEST_ID_HEADER_NAME)) ? UUID.randomUUID().toString() : request.getHeader(REQUEST_ID_HEADER_NAME);" is 157.,38
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,PortMappingHelperHandler,Long Identifier,The length of the field defaultTopologyRedirectContext is 30.,49
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,getDefaultTopologyRedirectContext,Long Identifier,The length of the identifier defaultTopologyRedirectContext is 30.,54
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,handle,Long Identifier,The length of the field defaultTopologyRedirectContext is 30.,88
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,handlePortMapping,Long Parameter List,The method has 5 parameters. ,110
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,handlePortMapping,Long Statement,The length of the statement "final String topologyName=config.getGatewayPortMappings().entrySet().stream().filter(e -> e.getValue().equals(port)).map(Map.Entry::getKey).findFirst().orElse(null);" is 165.,110
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,handlePortMapping,Long Statement,The length of the statement "RequestUpdateHandler.ForwardedRequest newRequest=new RequestUpdateHandler.ForwardedRequest(request`gatewayTopologyContext);" is 123.,110
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,handleDefaultTopologyMapping,Long Identifier,The length of the field defaultTopologyRedirectContext is 30.,142
apache_knox,org.apache.knox.gateway.filter,PortMappingHelperHandler,handleDefaultTopologyMapping,Long Statement,The length of the statement "RequestUpdateHandler.ForwardedRequest newRequest=new RequestUpdateHandler.ForwardedRequest(request`defaultTopologyRedirectContext);" is 131.,142
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestNoContextDefaultPort,Long Statement,The length of the statement "RequestUpdateHandler.ForwardedRequest forwardedRequest=new RequestUpdateHandler.ForwardedRequest(httpServletRequest`contextPath);" is 129.,27
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestNoContext,Long Statement,The length of the statement "RequestUpdateHandler.ForwardedRequest forwardedRequest=new RequestUpdateHandler.ForwardedRequest(httpServletRequest`contextPath);" is 129.,51
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestNoContext,Magic Number,The method contains a magic number: 8443,51
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestWithContextDefaultPort,Long Statement,The length of the statement "RequestUpdateHandler.ForwardedRequest forwardedRequest=new RequestUpdateHandler.ForwardedRequest(httpServletRequest`contextPath);" is 129.,75
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestWithContextDefaultPort,Long Statement,The length of the statement "Assert.assertEquals(String.format(Locale.ROOT`"%s://%s%s"`scheme`host`contextPath + context)`forwardedRequest.getRequestURL().toString());" is 138.,75
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestWithContext,Long Statement,The length of the statement "RequestUpdateHandler.ForwardedRequest forwardedRequest=new RequestUpdateHandler.ForwardedRequest(httpServletRequest`contextPath);" is 129.,100
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestWithContext,Long Statement,The length of the statement "Assert.assertEquals(String.format(Locale.ROOT`"%s://%s:%s%s"`scheme`host`port`contextPath + context)`forwardedRequest.getRequestURL().toString());" is 146.,100
apache_knox,org.apache.knox.gateway.filter,ForwardedRequestTest,testForwardedRequestWithContext,Magic Number,The method contains a magic number: 8443,100
apache_knox,org.apache.knox.gateway.filter,RedirectToUrlFilter,init,Long Statement,The length of the statement "final GatewayConfig gatewayConfig=(GatewayConfig)filterConfig.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 135.,38
apache_knox,org.apache.knox.gateway.filter,RedirectToUrlFilterTest,shouldReplaceGatewayPathInRedirectUrl,Long Identifier,The length of the field OUT_OF_THE_BOX_REDIRECT_TO_URL is 30.,34
apache_knox,org.apache.knox.gateway.deploy.impl,AclsAuthzDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,56
apache_knox,org.apache.knox.gateway.deploy.impl,DispatchDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,48
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,contributeResource,Complex Conditional,The conditional expression context.getGatewayConfig().getXForwardContextAppendServices() != null && !context.getGatewayConfig().getXForwardContextAppendServices().isEmpty() && context.getGatewayConfig().getXForwardContextAppendServices().contains(service.getRole()) is complex.,132
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,contributeResource,Long Statement,The length of the statement "final FilterDescriptor filter=resource.addFilter().name(XFORWARDED_FILTER_NAME).role(XFORWARDED_FILTER_ROLE).impl(XForwardedHeaderFilter.class);" is 144.,132
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,contributeResource,Long Statement,The length of the statement "else if (context.getGatewayConfig().getXForwardContextAppendServices() != null && !context.getGatewayConfig().getXForwardContextAppendServices().isEmpty() && context.getGatewayConfig().getXForwardContextAppendServices().contains(service.getRole())) {" is 250.,132
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,contributeResource,Long Statement,The length of the statement "FilterDescriptor filter=resource.addFilter().name(COOKIE_SCOPING_FILTER_NAME).role(COOKIE_SCOPING_FILTER_ROLE).impl(CookieScopeServletFilter.class);" is 148.,132
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,addPolicies,Long Parameter List,The method has 6 parameters. ,172
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,buildParams,Long Statement,The length of the statement "FilterParamDescriptor f=resource.createFilterParam().name(entry.getKey().toLowerCase(Locale.ROOT)).value(entry.getValue());" is 123.,191
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,addDefaultPolicies,Long Parameter List,The method has 5 parameters. ,215
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,addRewriteFilter,Long Parameter List,The method has 5 parameters. ,223
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,addDispatchFilter,Complex Method,Cyclomatic complexity of the method is 10,232
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,addDispatchFilterForClass,Long Parameter List,The method has 7 parameters. ,288
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributor,addDispatchFilterForClass,Long Parameter List,The method has 6 parameters. ,322
apache_knox,org.apache.knox.gateway.deploy.impl,GenericProviderDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,47
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,loadRewriteRules,Long Statement,The length of the statement "try (InputStream inputStream=Files.newInputStream(file.toPath());InputStreamReader reader=new InputStreamReader(inputStream`StandardCharsets.UTF_8)){" is 149.,104
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,contributeResource,Complex Conditional,The conditional expression context.getGatewayConfig().getXForwardContextAppendServices() != null && !context.getGatewayConfig().getXForwardContextAppendServices().isEmpty() && context.getGatewayConfig().getXForwardContextAppendServices().contains(service.getRole()) is complex.,182
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,contributeResource,Long Statement,The length of the statement "final FilterDescriptor filter=resource.addFilter().name(XFORWARDED_FILTER_NAME).role(XFORWARDED_FILTER_ROLE).impl(XForwardedHeaderFilter.class);" is 144.,182
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,contributeResource,Long Statement,The length of the statement "if (context.getGatewayConfig().getXForwardContextAppendServices() != null && !context.getGatewayConfig().getXForwardContextAppendServices().isEmpty() && context.getGatewayConfig().getXForwardContextAppendServices().contains(service.getRole())) {" is 245.,182
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,contributeResource,Long Statement,The length of the statement "FilterDescriptor filter=resource.addFilter().name(COOKIE_SCOPING_FILTER_NAME).role(COOKIE_SCOPING_FILTER_ROLE).impl(CookieScopeServletFilter.class);" is 148.,182
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,addPolicies,Long Parameter List,The method has 6 parameters. ,216
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,addDefaultPolicies,Long Parameter List,The method has 5 parameters. ,231
apache_knox,org.apache.knox.gateway.deploy.impl,ApplicationDeploymentContributor,addRewriteFilter,Long Parameter List,The method has 5 parameters. ,239
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributorTest,testServiceAttributeUseTwoWaySSLParamOverride,Long Statement,The length of the statement "assertEquals("Expected only a single filter param named " + USE_TWO_WAY_SSL_PARAM`1`useTwoWaySslFilterParamValues.size());" is 122.,68
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributorTest,testServiceAttributeUseTwoWaySSLParamOverride,Long Statement,The length of the statement "assertEquals("Expected the service param to override the service definition value for " + USE_TWO_WAY_SSL_PARAM`"true"`useTwoWaySslFilterParamValues.get(0));" is 157.,68
apache_knox,org.apache.knox.gateway.deploy.impl,ServiceDefinitionDeploymentContributorTest,testTopologyDispatch,Long Statement,The length of the statement "assertEquals("Expected the topology dispatch to override the service definition value for dispatch "`EXPECTED_HA_DISPATCH_CLASS`dispatchImpl.get(0));" is 149.,171
apache_knox,org.apache.knox.gateway.deploy.impl,ShiroDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,93
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,52
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzDeploymentContributor,contributeFilter,Long Statement,The length of the statement "DeploymentFactory.getProviderContributor("authorization"`name).contributeFilter(context`provider`service`resource`params);" is 122.,52
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzProviderTest,testParsingProviderNames,Magic Number,The method contains a magic number: 3,58
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzProviderTest,testParsingProviderNames,Magic Number,The method contains a magic number: 2,58
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzProviderTest,testingParsingProviderNames,Magic Number,The method contains a magic number: 5,69
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzProviderTest,testingParsingProviderNames,Magic Number,The method contains a magic number: 2,69
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzProviderTest,testingParsingProviderNames,Magic Number,The method contains a magic number: 3,69
apache_knox,org.apache.knox.gateway.deploy.impl,CompositeAuthzProviderTest,testingParsingProviderNames,Magic Number,The method contains a magic number: 4,69
apache_knox,org.apache.knox.gateway.service.metadata,TopologyInformationWrapperMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,50
apache_knox,org.apache.knox.gateway.service.metadata,TopologyInformationWrapperMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,55
apache_knox,org.apache.knox.gateway.service.metadata,TopologyInformationWrapperMarshaller,getMarshaller,Long Statement,The length of the statement "return MediaType.APPLICATION_JSON_TYPE.getSubtype().equals(mediaType.getSubtype()) ? getJsonMarshaller() : getXmlMarshaller();" is 126.,65
apache_knox,org.apache.knox.gateway.service.metadata,TopologyInformationWrapperMarshaller,getXmlMarshaller,Long Statement,The length of the statement "xmlMarshaller=JAXBContextFactory.createContext(new Class[]{TopologyInformationWrapper.class}`properties).createMarshaller();" is 124.,69
apache_knox,org.apache.knox.gateway.service.metadata,TopologyInformationWrapperMarshaller,getJsonMarshaller,Long Statement,The length of the statement "jsonMarshaller=JAXBContextFactory.createContext(new Class[]{TopologyInformationWrapper.class}`properties).createMarshaller();" is 125.,79
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,getShortDescription,Long Statement,The length of the statement "return getServiceName().substring(0`1).toUpperCase(Locale.ROOT) + getServiceName().substring(1).toLowerCase(Locale.ROOT);" is 121.,97
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,getDescription,Long Statement,The length of the statement "return getShortDescription() + (Type.API == getType() ? " REST API" : Type.UI == getType() ? " Web User Interface" : "");" is 121.,106
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,getServiceUrl,Long Statement,The length of the statement "return String.format(Locale.ROOT`HIVE_SERVICE_URL_TEMPLATE`request.getServerName()`request.getServerPort()`gatewayPath`topologyName);" is 133.,125
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,getServiceUrl,Long Statement,The length of the statement "return String.format(Locale.ROOT`SERVICE_URL_TEMPLATE`request.getScheme()`request.getServerName()`request.getServerPort()`gatewayPath`topologyName`resolvedContext);" is 164.,135
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,resolvePlaceholdersFromBackendUrl,Complex Conditional,The conditional expression toBeResolved.indexOf("{{SCHEME}}") > -1 || toBeResolved.indexOf("{{HOST}}") > -1 || toBeResolved.indexOf("{{PORT}}") > -1 is complex.,140
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,resolvePlaceholdersFromBackendUrl,Long Statement,The length of the statement "if (toBeResolved.indexOf("{{SCHEME}}") > -1 || toBeResolved.indexOf("{{HOST}}") > -1 || toBeResolved.indexOf("{{PORT}}") > -1) {" is 128.,140
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,equals,Long Statement,The length of the statement "return new EqualsBuilder().append(topologyName`serviceModel.topologyName).append(gatewayPath`serviceModel.gatewayPath).append(getServiceName()`serviceModel.getServiceName()).append(getVersion()`serviceModel.getVersion()).append(serviceMetadata`serviceModel.serviceMetadata).append(getServiceUrl()`serviceModel.getServiceUrl()).isEquals();" is 338.,189
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,hashCode,Long Statement,The length of the statement "return new HashCodeBuilder(17`37).append(topologyName).append(gatewayPath).append(getServiceName()).append(getVersion()).append(serviceMetadata).append(getServiceUrl()).toHashCode();" is 182.,202
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,hashCode,Magic Number,The method contains a magic number: 17,202
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,hashCode,Magic Number,The method contains a magic number: 37,202
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModel,toString,Long Statement,The length of the statement "return new ToStringBuilder(this`ToStringStyle.SHORT_PREFIX_STYLE).append(topologyName).append(gatewayPath).append(getServiceName()).append(getVersion()).append(serviceMetadata).append(getServiceUrl()).toString();" is 212.,208
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getGeneralProxyInformation,Long Statement,The length of the statement "final GatewayServices gatewayServices=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 140.,93
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getGeneralProxyInformation,Long Statement,The length of the statement "proxyInfo.setAdminApiBookUrl(String.format(Locale.ROOT`"https://knox.apache.org/books/knox-%s/user-guide.html#Admin+API"`getAdminApiBookVersion(serviceInfoService.getBuildVersion())));" is 184.,93
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getGeneralProxyInformation,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,93
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getPublicCertification,Long Statement,The length of the statement "final GatewayServices gatewayServices=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 140.,133
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getPublicCertification,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,133
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getBaseGatewayUrl,Long Statement,The length of the statement "return request.getRequestURL().substring(0`request.getRequestURL().length() - request.getRequestURI().length()) + "/" + config.getGatewayPath();" is 144.,200
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getTopologies,Complex Conditional,The conditional expression !hiddenTopologies.contains(topology.getName()) && (topologyName == null || topology.getName().equalsIgnoreCase(topologyName)) is complex.,218
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getTopologies,Long Statement,The length of the statement "final GatewayServices gatewayServices=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 140.,218
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getTopologies,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,218
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getTopologies,Long Statement,The length of the statement "final ServiceDefinitionRegistry serviceDefinitionRegistry=gatewayServices.getService(ServiceType.SERVICE_DEFINITION_REGISTRY);" is 126.,218
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getTopologies,Long Statement,The length of the statement "if (!hiddenTopologies.contains(topology.getName()) && (topologyName == null || topology.getName().equalsIgnoreCase(topologyName))) {" is 132.,218
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getTopologies,Long Statement,The length of the statement "ServiceModel serviceModel=getServiceModel(request`config.getGatewayPath()`topology.getName()`service`getServiceMetadata(serviceDefinitionRegistry`service)`serviceUrl);" is 167.,218
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getTopologies,Long Statement,The length of the statement "topologies.addTopology(topology.getName()`isPinnedTopology(topology.getName()`config)`new TreeSet<>(apiServices)`new TreeSet<>(uiServices));" is 140.,218
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getServiceMetadata,Long Statement,The length of the statement "final Optional<ServiceDefinitionPair> serviceDefinition=serviceDefinitionRegistry.getServiceDefinitions().stream().filter(serviceDefinitionPair -> serviceDefinitionPair.getService().getRole().equalsIgnoreCase(service.getRole())).filter(serviceDefinitionPair -> service.getVersion() == null || service.getVersion().toString().equalsIgnoreCase(serviceDefinitionPair.getService().getVersion())).findFirst();" is 404.,258
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getServiceModel,Long Parameter List,The method has 6 parameters. ,266
apache_knox,org.apache.knox.gateway.service.metadata,KnoxMetadataResource,getProfile,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,277
apache_knox,org.apache.knox.gateway.service.metadata,GeneralProxyInformationMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,50
apache_knox,org.apache.knox.gateway.service.metadata,GeneralProxyInformationMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,55
apache_knox,org.apache.knox.gateway.service.metadata,GeneralProxyInformationMarshaller,getMarshaller,Long Statement,The length of the statement "return MediaType.APPLICATION_JSON_TYPE.getSubtype().equals(mediaType.getSubtype()) ? getJsonMarshaller() : getXmlMarshaller();" is 126.,65
apache_knox,org.apache.knox.gateway.service.metadata,GeneralProxyInformationMarshaller,getXmlMarshaller,Long Statement,The length of the statement "xmlMarshaller=JAXBContextFactory.createContext(new Class[]{GeneralProxyInformation.class}`properties).createMarshaller();" is 121.,69
apache_knox,org.apache.knox.gateway.service.metadata,GeneralProxyInformationMarshaller,getJsonMarshaller,Long Statement,The length of the statement "jsonMarshaller=JAXBContextFactory.createContext(new Class[]{GeneralProxyInformation.class}`properties).createMarshaller();" is 122.,79
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModelTest,shouldReturnTheGivenServiceVersionWhenFetchingVersion,Magic Number,The method contains a magic number: 2,72
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModelTest,shouldReturnTheGivenServiceVersionWhenFetchingVersion,Magic Number,The method contains a magic number: 3,72
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModelTest,shouldReturnProperHiveServiceUrl,Long Statement,The length of the statement "assertEquals(String.format(Locale.ROOT`HIVE_SERVICE_URL_TEMPLATE`SERVER_NAME`SERVER_PORT`gatewayPath`topologyName)`serviceModel.getServiceUrl());" is 145.,142
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModelTest,shouldReturnSimpleServiceUrl,Long Statement,The length of the statement "assertEquals(String.format(Locale.ROOT`SERVICE_URL_TEMPLATE`SERVER_SCHEME`SERVER_NAME`SERVER_PORT`gatewayPath`topologyName`context)`serviceModel.getServiceUrl());" is 162.,166
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModelTest,shouldReturnServiceUrlWithBackendHostPlaceholder,Long Statement,The length of the statement "assertEquals(String.format(Locale.ROOT`SERVICE_URL_TEMPLATE`SERVER_SCHEME`SERVER_NAME`SERVER_PORT`gatewayPath`topologyName`context.replace("{{BACKEND_HOST}}"`backendHost))`serviceModel.getServiceUrl());" is 202.,182
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModelTest,shouldReturnServiceUrlWithBackendHostPlaceholder,Long Statement,The length of the statement "assertEquals(String.format(Locale.ROOT`SERVICE_URL_TEMPLATE`SERVER_SCHEME`SERVER_NAME`SERVER_PORT`gatewayPath`topologyName`context.replace("{{BACKEND_HOST}}"`serviceUrl))`serviceModel.getServiceUrl());" is 201.,182
apache_knox,org.apache.knox.gateway.service.metadata,ServiceModelTest,shouldReturnServiceUrlWithSchemeHostAndPortPlaceholders,Long Statement,The length of the statement "assertEquals(String.format(Locale.ROOT`SERVICE_URL_TEMPLATE`SERVER_SCHEME`SERVER_NAME`SERVER_PORT`gatewayPath`topologyName`context.replace("{{SCHEME}}"`"https").replace("{{HOST}}"`"localhost").replace("{{PORT}}"`"5555"))`serviceModel.getServiceUrl());" is 251.,211
apache_knox,org.apache.knox.gateway.util,MimeTypeMap,get,Empty catch clause,The method has an empty catch block.,49
apache_knox,org.apache.knox.gateway.util,MimeTypeMap,get,Empty catch clause,The method has an empty catch block.,49
apache_knox,org.apache.knox.gateway.util,MimeTypeMap,get,Empty catch clause,The method has an empty catch block.,49
apache_knox,org.apache.knox.gateway.util,HttpUtils,splitQuery,Long Statement,The length of the statement "final String value=idx > 0 && pair.length() > idx ? URLDecoder.decode(pair.substring(idx + 1)`StandardCharsets.UTF_8.name()) : null;" is 132.,31
apache_knox,org.apache.knox.gateway.util,HttpUtils,parseQueryString,Complex Method,Cyclomatic complexity of the method is 12,51
apache_knox,org.apache.knox.gateway.util,HttpUtils,urlDecodeUtf8,Empty catch clause,The method has an empty catch block.,97
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Identifier,The length of the identifier detectedFullyQualifiedHostname is 30.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Identifier,The length of the identifier fullyQualifiedGeneralNameObject is 31.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Identifier,The length of the identifier subjectAlternativeNameExtensionClass is 36.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Identifier,The length of the identifier subjectAlternativeNameExtensionConstr is 37.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Identifier,The length of the identifier subjectAlternativeNameExtensionObject is 37.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Method,The method has 128 lines of code.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Statement,The length of the statement "Constructor<?> subjectAlternativeNameExtensionConstr=subjectAlternativeNameExtensionClass.getConstructor(generalNamesClass);" is 124.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Long Statement,The length of the statement "methodSET.invoke(certInfoObject`certAlgoIdNameValue + "." + certAlgoIdAlgoValue`methoGET.invoke(x509CertImplObject`sig_alg));" is 125.,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Magic Number,The method contains a magic number: 86400000L,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Magic Number,The method contains a magic number: 64,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Magic Number,The method contains a magic number: 2,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,generateCertificate,Magic Number,The method contains a magic number: 2,52
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getX509CertInfoModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.X509CertInfo" : "sun.security.x509.X509CertInfo";" is 131.,271
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getX509CertifValidityModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateValidity" : "sun.security.x509.CertificateValidity";" is 145.,276
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getX509X500NameModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.X500Name" : "sun.security.x509.X500Name";" is 123.,282
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getCertificateSerialNumberModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateSerialNumber" : "sun.security.x509.CertificateSerialNumber";" is 153.,288
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getCertificateSubjectNameModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateSubjectName" : "sun.security.x509.CertificateSubjectName";" is 151.,294
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getCertificateIssuerNameModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateIssuerName" : "sun.security.x509.CertificateIssuerName";" is 149.,300
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getCertificateX509KeyModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateX509Key" : "sun.security.x509.CertificateX509Key";" is 143.,306
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getCertificateVersionModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateVersion" : "sun.security.x509.CertificateVersion";" is 143.,312
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getAlgorithmIdModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.AlgorithmId" : "sun.security.x509.AlgorithmId";" is 129.,318
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getObjectIdentifierModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.util.ObjectIdentifier" : "sun.security.util.ObjectIdentifier";" is 139.,324
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getCertificateAlgorithmIdModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateAlgorithmId" : "sun.security.x509.CertificateAlgorithmId";" is 151.,330
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getGeneralNameInterfaceModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.GeneralNameInterface" : "sun.security.x509.GeneralNameInterface";" is 147.,336
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getGeneralNameModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.GeneralName" : "sun.security.x509.GeneralName";" is 129.,342
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getGeneralNamesModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.GeneralNames" : "sun.security.x509.GeneralNames";" is 131.,348
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getDNSNameModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.DNSName" : "sun.security.x509.DNSName";" is 121.,354
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getSubjectAlternativeNameExtensionModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.SubjectAlternativeNameExtension" : "sun.security.x509.SubjectAlternativeNameExtension";" is 169.,360
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getCertificateExtensionsModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.CertificateExtensions" : "sun.security.x509.CertificateExtensions";" is 149.,366
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,getX509CertImplModuleName,Long Statement,The length of the statement "return System.getProperty("java.vendor").contains("IBM") ? "com.ibm.security.x509.X509CertImpl" : "sun.security.x509.X509CertImpl";" is 131.,372
apache_knox,org.apache.knox.gateway.util,X509CertificateUtil,writeCertificateToFile,Magic Number,The method contains a magic number: 76,385
apache_knox,org.apache.knox.gateway.util,X500PrincipalParser,parseDN,Complex Method,Cyclomatic complexity of the method is 9,124
apache_knox,org.apache.knox.gateway.util,Urls,isIp,Long Statement,The length of the statement "Pattern p=Pattern.compile("^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$");" is 122.,64
apache_knox,org.apache.knox.gateway.util,Urls,getDomainName,Magic Number,The method contains a magic number: 2,84
apache_knox,org.apache.knox.gateway.util,Tokens,getTokenDisplayText,Magic Number,The method contains a magic number: 7,25
apache_knox,org.apache.knox.gateway.util,Tokens,getTokenDisplayText,Magic Number,The method contains a magic number: 6,25
apache_knox,org.apache.knox.gateway.util,Tokens,getTokenDisplayText,Magic Number,The method contains a magic number: 6,25
apache_knox,org.apache.knox.gateway.util,Tokens,getTokenIDDisplayText,Complex Conditional,The conditional expression uuid != null && uuid.length() == 36 && uuid.contains("-") is complex.,44
apache_knox,org.apache.knox.gateway.util,Tokens,getTokenIDDisplayText,Long Statement,The length of the statement "displayText=String.format(Locale.ROOT`"%s...%s"`uuid.substring(0`uuid.indexOf('-'))`uuid.substring(uuid.lastIndexOf('-') + 1));" is 127.,44
apache_knox,org.apache.knox.gateway.util,Tokens,getTokenIDDisplayText,Magic Number,The method contains a magic number: 36,44
apache_knox,org.apache.knox.gateway.util,JsonUtils,getFileStatusesAsMap,Empty catch clause,The method has an empty catch block.,102
apache_knox,org.apache.knox.gateway.util,JsonUtils,getFileStatusesAsMap,Long Statement,The length of the statement "TypeReference<HashMap<String`HashMap<String`ArrayList<HashMap<String`String>>>>> typeRef=new TypeReference<HashMap<String`HashMap<String`ArrayList<HashMap<String`String>>>>>(){" is 176.,102
apache_knox,org.apache.knox.gateway.util,XmlUtils,writeXml,Magic Number,The method contains a magic number: 4,66
apache_knox,org.apache.knox.gateway.util,HttpUtilsTest,testParseQueryString_BugKnox599,Long Method,The method has 140 lines of code.,33
apache_knox,org.apache.knox.gateway.util,HttpUtilsTest,testParseQueryString_BugKnox599,Magic Number,The method contains a magic number: 2,33
apache_knox,org.apache.knox.gateway.util,HttpUtilsTest,testParseQueryString_BugKnox599,Magic Number,The method contains a magic number: 2,33
apache_knox,org.apache.knox.gateway.util,HttpUtilsTest,testParseQueryString_BugKnox599,Magic Number,The method contains a magic number: 2,33
apache_knox,org.apache.knox.gateway.util,UrlsTest,testDomainNameCreation,Long Statement,The length of the statement "assertEquals(".local.com"`Urls.getDomainName("https://www.local.com:8443/gateway/manager/admin-ui?limit=25&query=hive_table+where+name%3D%22table_1%22"`null));" is 159.,36
apache_knox,org.apache.knox.gateway.util,UrlsTest,testDomainNameCreation,Long Statement,The length of the statement "assertEquals(".local.com"`Urls.getDomainName("https://www.local.com:8443/gateway/manager/admin-ui/?limit=25&query=\"table_1\""`null));" is 134.,36
apache_knox,org.apache.knox.gateway.util,TokensTest,testTokenIdDisplayTextInvalidUUID,Magic Number,The method contains a magic number: 4,55
apache_knox,org.apache.knox.gateway.util,TokensTest,testDisplayableTokenIDSet,Magic Number,The method contains a magic number: 5,71
apache_knox,org.apache.knox.gateway.util,TokensTest,testDisplayableTokenIDSet,Magic Number,The method contains a magic number: 36,71
apache_knox,org.apache.knox.gateway.util,TokensTest,doTestTokenDisplay,Long Statement,The length of the statement "assertEquals("Unexpected result for displayable token UUID."`tokenId.substring(0`tokenId.indexOf('-')) + "..." + tokenId.substring(tokenId.lastIndexOf('-') + 1)`displayableTokenId);" is 181.,90
apache_knox,org.apache.knox.gateway.util,CookieUtilsTest,testCookiesByName,Magic Number,The method contains a magic number: 2,52
apache_knox,org.apache.knox.gateway.util,JsonUtilsTest,testFileStatusesAsMap,Long Statement,The length of the statement "String json="{\n" + " \"FileStatuses\":{\n" + " \"FileStatus\":[\n"+ " {\n"+ " \"accessTime\":0`\n"+ " \"blockSize\":0`\n"+ " \"childrenNum\":3`\n"+ " \"fileId\":16389`\n"+ " \"group\":\"supergroup\"`\n"+ " \"length\":0`\n"+ " \"modificationTime\":1581578495905`\n"+ " \"owner\":\"hdfs\"`\n"+ " \"pathSuffix\":\"tmp\"`\n"+ " \"permission\":\"1777\"`\n"+ " \"replication\":0`\n"+ " \"storagePolicy\":0`\n"+ " \"type\":\"DIRECTORY\"\n"+ " }`\n"+ " {\n"+ " \"accessTime\":0`\n"+ " \"blockSize\":0`\n"+ " \"childrenNum\":658`\n"+ " \"fileId\":16386`\n"+ " \"group\":\"supergroup\"`\n"+ " \"length\":0`\n"+ " \"modificationTime\":1581578527580`\n"+ " \"owner\":\"hdfs\"`\n"+ " \"pathSuffix\":\"user\"`\n"+ " \"permission\":\"755\"`\n"+ " \"replication\":0`\n"+ " \"storagePolicy\":0`\n"+ " \"type\":\"DIRECTORY\"\n"+ " } \n"+ " ]\n"+ " }\n"+ "}";" is 841.,59
apache_knox,org.apache.knox.gateway.util,PasswordUtilsTest,testGeneratePassword,Magic Number,The method contains a magic number: 20,27
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnTrueWhenCheckingIfCollectionIsSortedAndGivenCollectionIsSorted,Magic Number,The method contains a magic number: 2,50
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnTrueWhenCheckingIfCollectionIsSortedAndGivenCollectionIsSorted,Magic Number,The method contains a magic number: 5,50
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnTrueWhenCheckingIfCollectionIsSortedAndGivenCollectionIsSorted,Magic Number,The method contains a magic number: 8,50
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnTrueWhenCheckingIfCollectionIsSortedAndGivenCollectionIsSorted,Magic Number,The method contains a magic number: 9,50
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnFalseWhenCheckingIfCollectionIsSortedAndGivenCollectionIsNotSorted,Magic Number,The method contains a magic number: 5,56
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnFalseWhenCheckingIfCollectionIsSortedAndGivenCollectionIsNotSorted,Magic Number,The method contains a magic number: 2,56
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnFalseWhenCheckingIfCollectionIsSortedAndGivenCollectionIsNotSorted,Magic Number,The method contains a magic number: 8,56
apache_knox,org.apache.knox.gateway.util,CollectionUtilsTest,shouldReturnFalseWhenCheckingIfCollectionIsSortedAndGivenCollectionIsNotSorted,Magic Number,The method contains a magic number: 9,56
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileUnsupportedExpressions,Long Statement,The length of the statement "String[] paths={"$..book[-1:]"`"$..book[`1]"`"$..book[0`1]"`"$..book[:2]"`"$..book[0:7:2]"`"$..book[(@.length-1)]"`"$..book[?(@.isbn)]"`"$..book[?(@.price<10)]"};" is 162.,76
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Long Method,The method has 170 lines of code.,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 7,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 7,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileValidExpressions,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testCompileQuotedExpressions,Magic Number,The method contains a magic number: 2,290
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testEvaluateArrays,Magic Number,The method contains a magic number: 3,476
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testEvaluateArrays,Magic Number,The method contains a magic number: 3,476
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testEvaluateArrays,Magic Number,The method contains a magic number: 3,476
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testEvaluateArrays,Magic Number,The method contains a magic number: 3,476
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testGlobMatching,Long Statement,The length of the statement "json="{ \"field-1\" : { \"field-1-1\" : { \"field-1-1-1\" : \"value-1-1-1\"` \"field\" : \"value-A\" }` \"field\" : \"value-B\"}` \"field-2\" : { \"field-2-1\" : { \"field-2-1-1\" : \"value-2-1-1\"` \"field\" : \"value-C\" }` \"field\" : \"value-D\" }` \"field\" : \"value-E\" }";" is 280.,533
apache_knox,org.apache.knox.gateway.util,JsonPathTest,testGlobMatching,Magic Number,The method contains a magic number: 5,533
apache_knox,org.apache.knox.gateway.util,ServiceDefinitionsLoader,loadServiceDefinitionDeploymentContributors,Long Statement,The length of the statement "loadServiceDefinitions(servicesDir).forEach(serviceDefinitionPair -> contributors.add(new ServiceDefinitionDeploymentContributor(serviceDefinitionPair.getService()`serviceDefinitionPair.getRewriteRules())));" is 207.,75
apache_knox,org.apache.knox.gateway.util,ServiceDefinitionsLoader,loadRewriteRules,Long Statement,The length of the statement "try (InputStream stream=Files.newInputStream(rewriteFile.toPath());Reader reader=new InputStreamReader(stream`StandardCharsets.UTF_8)){" is 135.,141
apache_knox,org.apache.knox.gateway.util,TopologyToDescriptor,saveDescriptor,Complex Method,Cyclomatic complexity of the method is 9,163
apache_knox,org.apache.knox.gateway.util,TopologyToDescriptor,fileCheck,Long Statement,The length of the statement "throw new IOException(String.format(Locale.ROOT`"File %s already exist` use --force option to overwrite."`file.getAbsolutePath()));" is 131.,217
apache_knox,org.apache.knox.gateway.util,JDBCUtils,configurePostgreSQLSsl,Long Identifier,The length of the field DATABASE_TRUSTSTORE_PASSWORD_ALIAS_NAME is 39.,71
apache_knox,org.apache.knox.gateway.util,JDBCUtils,configureMysqlSsl,Long Identifier,The length of the field DATABASE_TRUSTSTORE_PASSWORD_ALIAS_NAME is 39.,118
apache_knox,org.apache.knox.gateway.util,KnoxCLI,run,Long Statement,The length of the statement "out.println("ERROR: Invalid Command" + "\n" + "Unrecognized option:" + args[0] + "\n"+ "A fatal exception has occurred. Program will exit.");" is 141.,171
apache_knox,org.apache.knox.gateway.util,KnoxCLI,run,Magic Number,The method contains a magic number: 2,171
apache_knox,org.apache.knox.gateway.util,KnoxCLI,run,Magic Number,The method contains a magic number: 3,171
apache_knox,org.apache.knox.gateway.util,KnoxCLI,init,Complex Method,Cyclomatic complexity of the method is 96,217
apache_knox,org.apache.knox.gateway.util,KnoxCLI,init,Long Method,The method has 372 lines of code.,217
apache_knox,org.apache.knox.gateway.util,KnoxCLI,init,Magic Number,The method contains a magic number: 2,217
apache_knox,org.apache.knox.gateway.util,KnoxCLI,init,Magic Number,The method contains a magic number: 2,217
apache_knox,org.apache.knox.gateway.util,KnoxCLI,init,Magic Number,The method contains a magic number: 3,217
apache_knox,org.apache.knox.gateway.util,KnoxCLI,init,Magic Number,The method contains a magic number: 5,217
apache_knox,org.apache.knox.gateway.util,KnoxCLI,printKnoxShellUsage,Magic Number,The method contains a magic number: 79,533
apache_knox,org.apache.knox.gateway.util,KnoxCLI,loadBuildProperties,Empty catch clause,The method has an empty catch block.,2420
apache_knox,org.apache.knox.gateway.util,ServiceDefinitionsLoaderTest,testServiceDefinitionLoading,Long Statement,The length of the statement "Set<ServiceDeploymentContributor> contributors=ServiceDefinitionsLoader.loadServiceDefinitionDeploymentContributors(new File(url.getFile()));" is 141.,34
apache_knox,org.apache.knox.gateway.util,ServiceDefinitionsLoaderTest,testServiceDefinitionLoading,Magic Number,The method contains a magic number: 2,34
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryClientService,Long Statement,The length of the statement "RemoteConfigurationRegistryClientService service=cli.getGatewayServices().getService(ServiceType.REMOTE_REGISTRY_CLIENT_SERVICE);" is 129.,76
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListRemoteConfigurationRegistryClients,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).isEmpty());" is 124.,98
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListRemoteConfigurationRegistryClients,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("test_client"));" is 138.,98
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListRemoteConfigurationRegistryClients,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("test_client"));" is 138.,98
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListRemoteConfigurationRegistryClients,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("another_client"));" is 141.,98
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryGetACLs,Long Statement,The length of the statement "final String[] uploadArgs={"upload-provider-config"`testProviderConfig.getAbsolutePath()`"--registry-client"`"test_client"`"--master"`"master"};" is 144.,132
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryGetACLs,Long Statement,The length of the statement "final String[] args={"get-registry-acl"`"/knox/config/shared-providers"`"--registry-client"`"test_client"`"--master"`"master"};" is 127.,132
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryGetACLs,Magic Number,The method contains a magic number: 3,132
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryUploadProviderConfig,Long Statement,The length of the statement "final String[] args={"upload-provider-config"`testProviderConfig.getAbsolutePath()`"--registry-client"`"test_client"`"--master"`"master"};" is 138.,176
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryUploadProviderConfigWithDestinationOverride,Long Statement,The length of the statement "final String[] args={"upload-provider-config"`testProviderConfig.getAbsolutePath()`"--entry-name"`entryName`"--registry-client"`"test_client"`"--master"`"master"};" is 163.,222
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryUploadDescriptor,Long Statement,The length of the statement "final String[] args={"upload-descriptor"`testDescriptor.getAbsolutePath()`"--registry-client"`"test_client"`"--master"`"master"};" is 129.,263
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryUploadDescriptorWithDestinationOverride,Long Statement,The length of the statement "final String[] args={"upload-descriptor"`testDescriptor.getAbsolutePath()`"--entry-name"`entryName`"--registry-client"`"test_client"`"--master"`"master"};" is 154.,308
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryDeleteProviderConfig,Long Statement,The length of the statement "final String[] createArgs={"upload-provider-config"`testProviderConfig.getAbsolutePath()`"--registry-client"`"test_client"`"--master"`"master"};" is 144.,348
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryDeleteProviderConfig,Long Statement,The length of the statement "final String[] deleteArgs={"delete-provider-config"`providerConfigName`"--registry-client"`"test_client"`"--master"`"master"};" is 126.,348
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryDeleteProviderConfig,Long Statement,The length of the statement "rc=cli.run(new String[]{"delete-provider-config"`"imaginary-providers.xml"`"--registry-client"`"test_client"`"--master"`"master"});" is 131.,348
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testRemoteConfigurationRegistryDeleteDescriptor,Long Statement,The length of the statement "final String[] createArgs={"upload-descriptor"`testDescriptor.getAbsolutePath()`"--registry-client"`"test_client"`"--master"`"master"};" is 135.,401
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testSuccessfulAliasLifecycle,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1 has been successfully " + "created."));" is 169.,452
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testSuccessfulAliasLifecycle,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1"));" is 133.,452
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testSuccessfulAliasLifecycle,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1 has been successfully " + "deleted."));" is 169.,452
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testSuccessfulAliasLifecycle,Long Statement,The length of the statement "assertFalse(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1"));" is 134.,452
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListAndDeleteOfAliasForInvalidClusterName,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1 has been successfully " + "created."));" is 169.,485
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListAndDeleteOfAliasForInvalidClusterName,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Invalid cluster name provided: Invalidcluster1"));" is 173.,485
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListAndDeleteOfAliasForInvalidClusterName,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Invalid cluster name provided: Invalidcluster1"));" is 173.,485
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testForInvalidArgument,Magic Number,The method contains a magic number: 2,564
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListAndDeleteOfAliasForValidClusterName,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1 has been successfully " + "created."));" is 169.,575
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListAndDeleteOfAliasForValidClusterName,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1"));" is 133.,575
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListAndDeleteOfAliasForValidClusterName,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1 has been successfully " + "deleted."));" is 169.,575
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testListAndDeleteOfAliasForValidClusterName,Long Statement,The length of the statement "assertFalse(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1"));" is 134.,575
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1 has been successfully " + "created."));" is 169.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias2 has been successfully " + "created."));" is 169.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertFalse(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias2"));" is 134.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1"));" is 133.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertFalse(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1"));" is 134.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias2"));" is 133.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias1 has been successfully " + "deleted."));" is 169.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGatewayAndClusterStores,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("alias2 has been successfully " + "deleted."));" is 169.,610
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,createTestMaster,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Master secret has been persisted to disk."));" is 123.,674
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateSelfSignedCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-identity has been successfully " + "created."));" is 179.,686
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-identity has been successfully " + "created."));" is 179.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Certificate gateway-identity has been successfully exported to"));" is 189.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-identity.pem"));" is 147.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Certificate gateway-identity has been successfully exported to"));" is 189.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-identity.pem"));" is 147.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Certificate gateway-identity has been successfully exported to"));" is 189.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-identity.pem"));" is 147.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Certificate gateway-identity has been successfully exported to"));" is 189.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-client-trust.jks"));" is 151.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Certificate gateway-identity has been successfully exported to"));" is 189.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-client-trust.pkcs12"));" is 154.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Certificate gateway-identity has been successfully exported to"));" is 189.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("gateway-client-trust.jceks"));" is 153.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testExportCert,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Invalid type for export file provided."));" is 165.,702
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMaster,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("Master secret has been persisted to disk."));" is 168.,769
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Master secret has been persisted to disk."));" is 123.,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Master secret has been persisted to disk."));" is 123.,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 36,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 8,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 9,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 13,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 14,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 18,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 19,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 23,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterGenerate,Magic Number,The method contains a magic number: 36,786
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterForce,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Master secret has been persisted to disk."));" is 123.,828
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterForce,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Master secret is already present on disk."));" is 123.,828
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMasterForce,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("Master secret has been persisted to disk."));" is 123.,828
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMultipleAliasesInOneBatch,Long Statement,The length of the statement "String[] args1={"create-aliases"`"--alias"`"alias1"`"--value"`"testvalue1"`"--alias"`"alias2"`"--value"`"testvalue2"`"--alias"`"alias3"`"--value"`"testvalue3"`"--cluster"`"cluster1"`"--master"`"master"};" is 203.,884
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateMultipleAliasesInOneBatch,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("3 alias(es) have been successfully created: [alias1` alias2` alias3]"));" is 195.,884
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateAndGenerateMultipleAliasesInOneBatch1,Long Statement,The length of the statement "String[] args1={"create-aliases"`"--alias"`"alias1"`"--value"`"testvalue1"`"--alias"`"alias2"`"--value"`"testvalue2"`"--alias"`"alias3"`"--generate"`"--cluster"`"cluster1"`"--master"`"master"};" is 193.,902
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateAndGenerateMultipleAliasesInOneBatch1,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("2 alias(es) have been successfully created: [alias1` alias2]"));" is 187.,902
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateAndGenerateMultipleAliasesInOneBatch1,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("1 alias(es) have been successfully generated: [alias3]"));" is 181.,902
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateAndGenerateMultipleAliasesInOneBatch2,Long Statement,The length of the statement "String[] args1={"create-aliases"`"--alias"`"alias1"`"--value"`"testvalue1"`"--alias"`"alias2"`"--alias"`"alias3"`"--generate"`"--cluster"`"cluster1"`"--master"`"master"};" is 170.,923
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateAndGenerateMultipleAliasesInOneBatch2,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("2 alias(es) have been successfully generated: [alias2` alias3]"));" is 189.,923
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testCreateAndGenerateMultipleAliasesInOneBatch2,Long Statement,The length of the statement "assertTrue(outContent.toString(StandardCharsets.UTF_8.name())`outContent.toString(StandardCharsets.UTF_8.name()).contains("1 alias(es) have been successfully created: [alias1]"));" is 179.,923
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,createBadTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("123").addTag("param").addTag("name").addText("").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText("ldap://localhost:8443").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("vvv").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 1135.,956
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,createGoodTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("gateway").addTag("provider").addTag("role").addText("authentication").addTag("name").addText("ShiroProvider").addTag("enabled").addText("true").addTag("param").addTag("name").addText("main.ldapRealm").addTag("value").addText("org.apache.knox.gateway.shirorealm.KnoxLdapRealm").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.userDnTemplate").addTag("value").addText("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.url").addTag("value").addText("ldap://localhost:8443").gotoParent().addTag("param").addTag("name").addText("main.ldapRealm.contextFactory.authenticationMechanism").addTag("value").addText("simple").gotoParent().addTag("param").addTag("name").addText("urls./**").addTag("value").addText("authcBasic").gotoParent().gotoParent().addTag("provider").addTag("role").addText("identity-assertion").addTag("enabled").addText("true").addTag("name").addText("Default").gotoParent().addTag("provider").gotoRoot().addTag("service").addTag("role").addText("test-service-role").gotoRoot();" is 1151.,991
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testConvertTopology,Long Statement,The length of the statement "cli.run(new String[]{"convert-topology"`"--master"`"master"`"--path"`topologyFile.getAbsolutePath()`"--provider-name"`providerConfigFileName`"--descriptor-name"`descriptorConfigFileName`"--output-dir"`outputDir.getAbsolutePath()`"--force"`"--cluster"`clusterName`"--discovery-url"`discoveryUrl`"--discovery-user"`discoveryUser`"--discovery-pwd-alias"`discoveryPwdAlias`"--discovery-type"`discoveryType});" is 404.,1118
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testConvertTopology,Magic Number,The method contains a magic number: 8,1118
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testConvertTopology,Magic Number,The method contains a magic number: 3,1118
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testConvertTopology,Magic Number,The method contains a magic number: 3,1118
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testConvertTopology,Magic Number,The method contains a magic number: 5,1118
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testConvertTopology,Magic Number,The method contains a magic number: 7,1118
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testConvertTopology,Magic Number,The method contains a magic number: 5,1118
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGeneratingJwkInvalidAlgorithm,Long Statement,The length of the statement "assertThat(outContent.toString(StandardCharsets.UTF_8.name())`containsString("generate-jwk [--jwkAlg HS256|HS384|HS512]"));" is 123.,1190
apache_knox,org.apache.knox.gateway.util,KnoxCLITest,testGeneratingJWK,Long Statement,The length of the statement "final String[] args=alias == null ? new String[]{"generate-jwk"`"--jwkAlg"`jwkAlgorithm.getName()`"--master"`"master"} : new String[]{"generate-jwk"`"--jwkAlg"`jwkAlgorithm.getName()`"--master"`"master"`"--saveAlias"`alias};" is 224.,1224
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,postgresDataSourceShouldHaveProperConnectionProperties,Magic Number,The method contains a magic number: 5432,48
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,setBasicPostgresExpectations,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_USER_ALIAS_NAME)).andReturn("user".toCharArray()).anyTimes();" is 140.,63
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,setBasicPostgresExpectations,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_PASSWORD_ALIAS_NAME)).andReturn("password".toCharArray()).anyTimes();" is 148.,63
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,setBasicPostgresExpectations,Magic Number,The method contains a magic number: 5432,63
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testPostgreSqlSslEnabledVerificationEnabled,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_TRUSTSTORE_PASSWORD_ALIAS_NAME)).andReturn("password".toCharArray()).anyTimes();" is 159.,90
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testGetPostgreSqlDatasourceFromJdbcConnectionUrl,Long Statement,The length of the statement "final String connectionUrl="jdbc:postgresql://postgresql_host:1234/testDb?user=smolnar&password=secret&ssl=true&sslmode=verify-ca&sslrootcert=/var/lib/knox/gateway/conf/postgresql/root.crt";" is 190.,109
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testGetPostgreSqlDatasourceFromJdbcConnectionUrl,Magic Number,The method contains a magic number: 1234,109
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,derbyDataSourceShouldHaveProperConnectionProperties,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_USER_ALIAS_NAME)).andReturn("user".toCharArray()).anyTimes();" is 140.,137
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,derbyDataSourceShouldHaveProperConnectionProperties,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_PASSWORD_ALIAS_NAME)).andReturn("password".toCharArray()).anyTimes();" is 148.,137
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,derbyDataSourceShouldHaveProperConnectionProperties,Magic Number,The method contains a magic number: 1527,137
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,derbyDataSourceShouldHaveProperConnectionProperties,Magic Number,The method contains a magic number: 1527,137
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testMysqlDataSourceShouldHaveProperConnectionProperties,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_USER_ALIAS_NAME)).andReturn("user".toCharArray()).anyTimes();" is 140.,166
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testMysqlDataSourceShouldHaveProperConnectionProperties,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_PASSWORD_ALIAS_NAME)).andReturn("password".toCharArray()).anyTimes();" is 148.,166
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testMysqlDataSourceShouldHaveProperConnectionProperties,Magic Number,The method contains a magic number: 5432,166
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testMysqlDataSourceShouldHaveProperConnectionProperties,Magic Number,The method contains a magic number: 5432,166
apache_knox,org.apache.knox.gateway.util,JDBCUtilsTest,testGetMySqlDatasourceFromJdbcConnectionUrl,Long Statement,The length of the statement "String connectionUrl="jdbc:mysql://mysql_host:1234/testDb?user=user&password=secret&ssl=true&sslmode=verify-ca&sslrootcert=/var/lib/knox/gateway/conf/postgresql/root.crt";" is 171.,187
apache_knox,org.apache.knox.gateway.util,WhitelistUtils,getDispatchWhitelist,Long Identifier,The length of the field DEFAULT_DISPATCH_WHITELIST_TEMPLATE is 35.,45
apache_knox,org.apache.knox.gateway.util,WhitelistUtils,getDispatchWhitelist,Long Identifier,The length of the field HTTPS_ONLY_DISPATCH_WHITELIST_TEMPLATE is 38.,45
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testDefault,Long Statement,The length of the statement "assertNull("The test service role is not configured to honor the whitelist` so there should be none returned."`whitelist);" is 122.,39
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testDefaultDomainWhitelist,Long Statement,The length of the statement "String whitelist=doTestGetDispatchWhitelist(createMockGatewayConfig(Collections.singletonList(serviceRole)`null)`"host0.test.org"`serviceRole);" is 143.,72
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testDefaultDomainWhitelistWithXForwardedHost,Long Statement,The length of the statement "String whitelist=doTestGetDispatchWhitelist(createMockGatewayConfig(Collections.singletonList(serviceRole)`null)`"host0.test.org"`"lb.external.test.org"`serviceRole);" is 166.,94
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testDefaultDomainWhitelistWithXForwardedHostAndPort,Long Statement,The length of the statement "String whitelist=doTestGetDispatchWhitelist(createMockGatewayConfig(Collections.singletonList(serviceRole)`null)`"host0.test.org"`"lb.external.test.org:9090"`serviceRole);" is 171.,107
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testConfiguredWhitelist,Long Statement,The length of the statement "String whitelist=doTestGetDispatchWhitelist(createMockGatewayConfig(Collections.singletonList(serviceRole)`WHITELIST)`serviceRole);" is 131.,121
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testLocalhostAddressAsHostName,Long Statement,The length of the statement "String whitelist=doTestGetDispatchWhitelist(createMockGatewayConfig(Collections.singletonList(serviceRole)`null)`"192.168.1.100"`serviceRole);" is 142.,133
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testExplicitlyConfiguredDefaultWhitelist,Long Statement,The length of the statement "String whitelist=doTestGetDispatchWhitelist(createMockGatewayConfig(Collections.singletonList(serviceRole)`WHITELIST)`serviceRole);" is 131.,144
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testExplicitlyConfiguredDefaultWhitelist,Long Statement,The length of the statement "assertTrue("Expected to match whitelist given the explicitly configured DEFAULT whitelist."`RegExUtils.checkWhitelist(whitelist`"http://localhost:9099/"));" is 155.,144
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testExplicitlyConfiguredHttpsOnlyWhitelist,Long Statement,The length of the statement "String whitelist=doTestGetDispatchWhitelist(createMockGatewayConfig(Collections.singletonList(serviceRole)`WHITELIST)`serviceRole);" is 131.,157
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testExplicitlyConfiguredHttpsOnlyWhitelist,Long Statement,The length of the statement "assertFalse("Expected to not match whitelist given the explicitly configured HTTPS_ONLY whitelist."`RegExUtils.checkWhitelist(whitelist`"http://localhost:9099/"));" is 163.,157
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,testExplicitlyConfiguredHttpsOnlyWhitelist,Long Statement,The length of the statement "assertTrue("Expected to match whitelist given the explicitly configured HTTPS_ONLY whitelist."`RegExUtils.checkWhitelist(whitelist`"https://localhost:9099/"));" is 159.,157
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,doTestGetDispatchWhitelist,Long Statement,The length of the statement "Method method=WhitelistUtils.class.getDeclaredMethod("deriveDefaultDispatchWhitelist"`HttpServletRequest.class`String.class);" is 125.,182
apache_knox,org.apache.knox.gateway.util,WhitelistUtilsTest,doTestDeriveDomainBasedWhitelist,Long Statement,The length of the statement "Method defineWhitelistMethod=WhitelistUtils.class.getDeclaredMethod("defineWhitelistForDomain"`String.class`String.class);" is 122.,216
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditService,getContext,Long Statement,The length of the statement "return new Log4jAuditContext(ThreadContext.get(MDC_AUDIT_CONTEXT_KEY + "_username")`ThreadContext.get(MDC_AUDIT_CONTEXT_KEY + "_proxyUsername")`ThreadContext.get(MDC_AUDIT_CONTEXT_KEY + "_systemUsername")`ThreadContext.get(MDC_AUDIT_CONTEXT_KEY + "_targetServiceName")`ThreadContext.get(MDC_AUDIT_CONTEXT_KEY + "_remoteIp")`ThreadContext.get(MDC_AUDIT_CONTEXT_KEY + "_remoteHostname"));" is 386.,41
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditor,audit,Long Parameter List,The method has 7 parameters. ,72
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditor,audit,Long Parameter List,The method has 5 parameters. ,92
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditor,auditLog,Long Parameter List,The method has 5 parameters. ,102
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditor,maskTokenFromURL,Empty catch clause,The method has an empty catch block.,137
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditor,maskTokenFromURL,Long Statement,The length of the statement "final URI newURI=new URI(original.getScheme()`original.getAuthority()`original.getPath()`newQuery.toString()`original.getFragment());" is 133.,137
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditContext,of,Long Statement,The length of the statement "return new Log4jAuditContext(data.get(MDC_AUDIT_CONTEXT_KEY + "_username")`data.get(MDC_AUDIT_CONTEXT_KEY + "_proxyUsername")`data.get(MDC_AUDIT_CONTEXT_KEY + "_systemUsername")`data.get(MDC_AUDIT_CONTEXT_KEY + "_targetServiceName")`data.get(MDC_AUDIT_CONTEXT_KEY + "_remoteIp")`data.get(MDC_AUDIT_CONTEXT_KEY + "_remoteHostname"));" is 332.,35
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditContext,Log4jAuditContext,Long Parameter List,The method has 6 parameters. ,52
apache_knox,org.apache.knox.gateway.audit.log4j.audit,Log4jAuditContext,toString,Long Statement,The length of the statement "return "[" + "username=" + username + "` proxy_username="+ proxyUsername+ "` system_username="+ systemUsername+ "` targetServiceName="+ targetServiceName+ "` remoteIp="+ remoteIp+ "` remoteHostname="+ remoteHostname+ "]";" is 221.,122
apache_knox,org.apache.knox.gateway.audit.log4j.correlation,Log4jCorrelationService,getContext,Long Statement,The length of the statement "return new Log4jCorrelationContext(ThreadContext.get(KEY_REQUEST_ID)`ThreadContext.get(KEY_PARENT_REQUEST_ID)`ThreadContext.get(KEY_ROOT_REQUEST_ID));" is 150.,38
apache_knox,org.apache.knox.gateway.audit.log4j.correlation,Log4jCorrelationService,readExternalizedContext,Long Statement,The length of the statement "try (ByteArrayInputStream bais=new ByteArrayInputStream(externalizedContext);ObjectInput oi=new ObjectInputStream(bais)){" is 121.,89
apache_knox,org.apache.knox.gateway.audit.log4j.correlation,Log4jCorrelationContext,of,Long Statement,The length of the statement "return data.containsKey(KEY_REQUEST_ID) ? new Log4jCorrelationContext(data.get(KEY_REQUEST_ID)`data.get(KEY_PARENT_REQUEST_ID)`data.get(KEY_ROOT_REQUEST_ID)) : null;" is 165.,35
apache_knox,org.apache.knox.gateway.audit.log4j.correlation,Log4jCorrelationContext,random,Long Statement,The length of the statement "return new Log4jCorrelationContext(UUID.randomUUID().toString()`UUID.randomUUID().toString()`UUID.randomUUID().toString());" is 123.,45
apache_knox,org.apache.knox.gateway.audit.log4j.correlation,Log4jCorrelationContext,toString,Long Statement,The length of the statement "return "[" + "request_id=" + requestId + "` parent_request_id="+ parentRequestId+ "` root_request_id="+ rootRequestId+ "]";" is 123.,72
apache_knox,org.apache.knox.gateway.audit.api,Auditor,audit,Long Parameter List,The method has 7 parameters. ,25
apache_knox,org.apache.knox.gateway.audit.api,Auditor,audit,Long Parameter List,The method has 5 parameters. ,39
apache_knox,org.apache.knox.gateway.plang,Interpreter,Interpreter,Long Statement,The length of the statement "addFunction("match"`Arity.BINARY`args -> args.get(0) instanceof String ? Pattern.matches((String)args.get(1)`(String)args.get(0)) : ((List<String>)(args.get(0))).stream().anyMatch(each -> Pattern.matches((String)args.get(1)`each)));" is 232.,46
apache_knox,org.apache.knox.gateway.plang,Arity,min,Long Statement,The length of the statement "throw new ArityException("wrong number of arguments in call to '" + methodName + "'. Expected at least "+ count+ " got "+ params.size()+ ".");" is 142.,34
apache_knox,org.apache.knox.gateway.plang,AbstractSyntaxTree,isNumber,Empty catch clause,The method has an empty catch block.,57
apache_knox,org.apache.knox.gateway.plang,ParserTest,parse,Long Statement,The length of the statement "assertTrue("Expected syntax error: " + message + " but got: "+ e.getMessage()`e.getMessage().toLowerCase(Locale.getDefault()).contains(message.toLowerCase(Locale.getDefault())));" is 178.,146
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testSimple,Long Statement,The length of the statement "System.out.println("Running " + Thread.currentThread().getStackTrace()[1].getClassName() + "#"+ Thread.currentThread().getStackTrace()[1].getMethodName());" is 155.,65
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentConsumer,Long Statement,The length of the statement "System.out.println("Running " + Thread.currentThread().getStackTrace()[1].getClassName() + "#"+ Thread.currentThread().getStackTrace()[1].getMethodName());" is 155.,91
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentConsumer,Magic Number,The method contains a magic number: 120000,91
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentConsumer,Magic Number,The method contains a magic number: 100,91
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentConsumer,Magic Number,The method contains a magic number: 2,91
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentConsumer,Magic Number,The method contains a magic number: 5,91
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentConsumer,Magic Number,The method contains a magic number: 2,91
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentProcessor,Long Statement,The length of the statement "System.out.println("Running " + Thread.currentThread().getStackTrace()[1].getClassName() + "#"+ Thread.currentThread().getStackTrace()[1].getMethodName());" is 155.,113
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentProcessor,Magic Number,The method contains a magic number: 120000,113
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentProcessor,Magic Number,The method contains a magic number: 100,113
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentProcessor,Magic Number,The method contains a magic number: 2,113
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentProcessor,Magic Number,The method contains a magic number: 5,113
apache_knox,org.apache.knox.gateway.audit,JdbmQueueTest,testConcurrentProcessor,Magic Number,The method contains a magic number: 2,113
apache_knox,org.apache.knox.gateway.audit,StoreAndForwardAppenderTest,testAppender,Long Statement,The length of the statement "System.out.println("Running " + Thread.currentThread().getStackTrace()[1].getClassName() + "#"+ Thread.currentThread().getStackTrace()[1].getMethodName());" is 155.,52
apache_knox,org.apache.knox.gateway.audit,StoreAndForwardAppenderTest,testAppender,Magic Number,The method contains a magic number: 500000,52
apache_knox,org.apache.knox.gateway.audit,StoreAndForwardAppenderTest,testAppender,Magic Number,The method contains a magic number: 1000,52
apache_knox,org.apache.knox.gateway.audit,StoreAndForwardAppenderTest,testAppender,Magic Number,The method contains a magic number: 20,52
apache_knox,org.apache.knox.gateway.audit,AuditServiceTest,testMultipleRequestEvents,Magic Number,The method contains a magic number: 1000,74
apache_knox,org.apache.knox.gateway.audit,AuditLayoutTest,testFullyFilledAuditEvent,Long Statement,The length of the statement "String expectedOutput=String.format(Locale.ROOT`RECORD_PATTERN`formatedDate`ROOT_REQUEST_ID`PARENT_REQUEST_ID`REQUEST_ID`"audit.forward"`HOST_ADDRESS`TARGET_SERVICE`USERNAME`PROXYUSERNAME`SYSTEMUSERNAME`ACTION`RESOURCE_TYPE`RESOURCE_NAME`OUTCOME`MESSAGE`System.lineSeparator());" is 278.,89
apache_knox,org.apache.knox.gateway.audit,AuditLayoutTest,testAuditEventWithoutContexts,Long Statement,The length of the statement "String expectedOutput=String.format(Locale.ROOT`RECORD_PATTERN`formatedDate`EMPTY`EMPTY`EMPTY`"audit.forward"`EMPTY`EMPTY`EMPTY`EMPTY`EMPTY`ACTION`RESOURCE_TYPE`RESOURCE_NAME`OUTCOME`MESSAGE`System.lineSeparator());" is 215.,120
apache_knox,org.apache.knox.gateway.audit,AuditLayoutTest,testAuditEventWithoutMessage,Long Statement,The length of the statement "String expectedOutput=String.format(Locale.ROOT`RECORD_PATTERN`formatedDate`EMPTY`EMPTY`EMPTY`"audit.forward"`EMPTY`EMPTY`EMPTY`EMPTY`EMPTY`ACTION`RESOURCE_TYPE`RESOURCE_NAME`OUTCOME`EMPTY`System.lineSeparator());" is 213.,136
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreator,init,Long Identifier,The length of the field MAPPING_CONFIG_OVERRIDE_PROPERTY is 32.,66
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreator,create,Complex Method,Cyclomatic complexity of the method is 13,111
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreator,create,Long Statement,The length of the statement "log.lookingUpServiceConfigProperty(configProperty.getService()`configProperty.getServiceConfig()`configProperty.getValue());" is 124.,111
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreator,create,Long Statement,The length of the statement "AmbariCluster.ServiceConfiguration svcConfig=cluster.getServiceConfiguration(configProperty.getService()`configProperty.getServiceConfig());" is 140.,111
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariClientCommon,getActiveServiceConfigurations,Long Statement,The length of the statement "activeConfigs=getActiveServiceConfigurations(config.getAddress()`clusterName`config.getUser()`config.getPasswordAlias());" is 121.,55
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariClientCommon,getActiveServiceConfigurations,Long Statement,The length of the statement "serviceConfigurations.get(serviceName).put(configType`new AmbariCluster.ServiceConfiguration(configType`configVersion`configProps));" is 132.,70
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,ResourceManagerURLCreatorBase,create,Complex Method,Cyclomatic complexity of the method is 8,46
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,ServiceURLPropertyConfig,ServiceURLPropertyConfig,Empty catch clause,The method has an empty catch block.,93
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,ServiceURLPropertyConfig,setAll,Complex Method,Cyclomatic complexity of the method is 9,142
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,initializeComponentConfigMappings,Long Identifier,The length of the field COMPONENT_CONFIG_OVERRIDES_FILENAME is 35.,94
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,initializeComponentConfigMappings,Long Identifier,The length of the field COMPONENT_CONFIG_MAPPING_SYSTEM_PROPERTY is 40.,94
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,getConfigurationChangeMonitor,Long Identifier,The length of the field GATEWAY_SERVICES_ACCESSOR_CLASS is 31.,164
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,getConfigurationChangeMonitor,Long Identifier,The length of the field GATEWAY_SERVICES_ACCESSOR_METHOD is 32.,164
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,getConfigurationChangeMonitor,Long Statement,The length of the statement "ClusterConfigurationMonitorService clusterMonitorService=((GatewayServices)obj).getService(ServiceType.CLUSTER_CONFIGURATION_MONITOR_SERVICE);" is 142.,164
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,discover,Complex Method,Cyclomatic complexity of the method is 21,198
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,discover,Long Statement,The length of the statement "Map<String`Map<String`AmbariCluster.ServiceConfiguration>> serviceConfigurations=ambariClient.getActiveServiceConfigurations(discoveryAddress`encodedClusterName`discoveryUser`discoveryPwdAlias);" is 194.,198
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,discover,Long Statement,The length of the statement "for ( Entry<String`Map<String`AmbariCluster.ServiceConfiguration>> serviceConfiguration : serviceConfigurations.entrySet()) {" is 125.,198
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscovery,discover,Long Statement,The length of the statement "AmbariComponent c=new AmbariComponent(componentName`svcConfig.getVersion()`encodedClusterName`serviceName`hostNames`svcConfig.getProperties());" is 143.,198
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariCluster,getZooKeeperConfiguration,Complex Method,Cyclomatic complexity of the method is 10,154
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariCluster,getZooKeeperConfiguration,Long Statement,The length of the statement "result=new ZooKeeperConfiguration(enabledProp != null ? scProps.get(enabledProp) : null`ensembleProp != null ? scProps.get(ensembleProp) : null`portProp != null ? scProps.get(portProp) : null`namespaceProp != null ? scProps.get(namespaceProp) : null);" is 251.,154
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariCluster,getZooKeeperConfiguration,Magic Number,The method contains a magic number: 2,154
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkHistoryUIServiceURLCreator,isSSL,Long Statement,The length of the statement "return Boolean.valueOf(comp.getConfigProperty(SSL_FLAG_PRIMARY)) || Boolean.valueOf(comp.getConfigProperty(SSL_FLAG_SECONDARY));" is 128.,62
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariComponent,AmbariComponent,Long Parameter List,The method has 6 parameters. ,35
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RESTInvoker,getHttpClient,Long Statement,The length of the statement "return HttpClientBuilder.create().setSSLContext(TruststoreSSLContextUtils.getTruststoreSSLContext(keystoreService)).setDefaultRequestConfig(getRequestConfig(config)).build();" is 174.,70
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RESTInvoker,getRequestConfig,Long Statement,The length of the statement "builder.setConnectTimeout(config.getHttpClientConnectionTimeout()).setConnectionRequestTimeout(config.getHttpClientConnectionTimeout()).setSocketTimeout(config.getHttpClientSocketTimeout());" is 190.,77
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RESTInvoker,getRequestConfig,Long Statement,The length of the statement "builder.setConnectTimeout(DEFAULT_TIMEOUT).setConnectionRequestTimeout(DEFAULT_TIMEOUT).setSocketTimeout(DEFAULT_TIMEOUT);" is 122.,77
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RESTInvoker,invoke,Complex Method,Cyclomatic complexity of the method is 11,91
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,PropertyEqualsHandler,PropertyEqualsHandler,Long Parameter List,The method has 5 parameters. ,28
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,PropertyEqualsHandler,evaluate,Complex Method,Cyclomatic complexity of the method is 11,40
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,PropertyEqualsHandler,getActualPropertyValue,Long Statement,The length of the statement "value=cluster.getServiceConfiguration(property.getService()`property.getServiceConfig()).getProperties().get(property.getValue());" is 130.,85
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,HDFSURLCreatorBase,create,Complex Method,Cyclomatic complexity of the method is 14,55
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitor,getClusterNames,Long Statement,The length of the statement "for ( Entry<String`Map<String`Map<String`String>>> ambariClusterConfigVersion : ambariClusterConfigVersions.entrySet()) {" is 121.,400
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitor,getUpdatedConfigVersions,Long Statement,The length of the statement "Map<String`Map<String`AmbariCluster.ServiceConfiguration>> serviceConfigs=ambariClient.getActiveServiceConfigurations(clusterName`sdc);" is 135.,433
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariClusterTest,testAtlasZooKeeperEnsemblePropsConfigurationSecondary,Long Statement,The length of the statement "AmbariCluster.ZooKeeperConfig config=getZooKeeperConfiguration("ATLAS"`"ATLAS"`"application-properties"`serviceConfigProps);" is 124.,138
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariClusterTest,testAtlasZooKeeperEnsemblePropsConfigurationPrimary,Long Statement,The length of the statement "AmbariCluster.ZooKeeperConfig config=getZooKeeperConfiguration("ATLAS"`"ATLAS"`"application-properties"`serviceConfigProps);" is 124.,165
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Empty catch clause,The method has an empty catch block.,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Long Statement,The length of the statement "updateConfigurations.get(addr1).put(cluster1Name`Arrays.asList(Arrays.asList(createTestServiceConfig("zoo.cfg"`"3")`createTestServiceConfig("hive-site"`"2"))`Arrays.asList(createTestServiceConfig("zoo.cfg"`"3")`createTestServiceConfig("hive-site"`"3"))`Arrays.asList(createTestServiceConfig("zoo.cfg"`"2")`createTestServiceConfig("hive-site"`"1"))));" is 350.,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Long Statement,The length of the statement "updateConfigurations.get(addr2).put(cluster2Name`Arrays.asList(Arrays.asList(createTestServiceConfig("zoo.cfg"`"1")`createTestServiceConfig("hive-site"`"1"))`Collections.singletonList(createTestServiceConfig("zoo.cfg"`"1"))`Arrays.asList(createTestServiceConfig("zoo.cfg"`"1")`createTestServiceConfig("hive-site"`"2"))));" is 321.,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Long Statement,The length of the statement "updateConfigurations.get(addr2).put(cluster1Name`Arrays.asList(Arrays.asList(createTestServiceConfig("zoo.cfg"`"2")`createTestServiceConfig("hive-site"`"4"))`Arrays.asList(createTestServiceConfig("zoo.cfg"`"3")`createTestServiceConfig("hive-site"`"4")`createTestServiceConfig("yarn-site"`"1"))`Arrays.asList(createTestServiceConfig("zoo.cfg"`"1")`createTestServiceConfig("hive-site"`"2"))));" is 391.,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Long Statement,The length of the statement "monitor.addClusterConfigVersions(createTestCluster(cluster2Name`initialAmbariClusterConfigs)`createTestDiscoveryConfig(addr2));" is 127.,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Long Statement,The length of the statement "monitor.addClusterConfigVersions(createTestCluster(cluster1Name`initialAmbariClusterConfigs)`createTestDiscoveryConfig(addr2));" is 127.,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Long Statement,The length of the statement "while (!areChangeUpdatesExhausted(updateConfigurations`configChangeIndex) && (System.currentTimeMillis() < expiration)) {" is 121.,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Magic Number,The method contains a magic number: 10,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Magic Number,The method contains a magic number: 1000,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Magic Number,The method contains a magic number: 30,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Magic Number,The method contains a magic number: 5,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Magic Number,The method contains a magic number: 3,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariConfigurationMonitorTest,testPollingMonitor,Magic Number,The method contains a magic number: 3,57
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RMURLCreatorTestBase,doTestCreateSingleURL,Long Statement,The length of the statement "EasyMock.expect(cluster.getServiceConfiguration(ResourceManagerURLCreatorBase.CONFIG_SERVICE`ResourceManagerURLCreatorBase.CONFIG_TYPE)).andReturn(rmSvcConfig).anyTimes();" is 171.,37
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RMURLCreatorTestBase,doTestCreateHAURLs,Long Parameter List,The method has 5 parameters. ,61
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RMURLCreatorTestBase,doTestCreateHAURLs,Long Statement,The length of the statement "EasyMock.expect(cluster.getServiceConfiguration(ResourceManagerURLCreatorBase.CONFIG_SERVICE`ResourceManagerURLCreatorBase.CONFIG_TYPE)).andReturn(rmSvcConfig).anyTimes();" is 171.,61
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,RMURLCreatorTestBase,doTestCreateHAURLs,Magic Number,The method contains a magic number: 2,61
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,doTestSparkHistoryUI,Magic Number,The method contains a magic number: 2,42
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,doTestSparkHistoryUI_SSL,Magic Number,The method contains a magic number: 2,106
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,doTestSparkHistoryUI_SSL,Magic Number,The method contains a magic number: 400,106
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,testSparkAndSpark2HistoryUI,Magic Number,The method contains a magic number: 2,150
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,doTestLivyServer,Magic Number,The method contains a magic number: 2,191
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,doTestLivyServerSSL,Magic Number,The method contains a magic number: 2,224
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,testLivyAndLivy2Server,Magic Number,The method contains a magic number: 2,248
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,SparkServiceURLCreatorTest,doTestSparkThriftUI,Magic Number,The method contains a magic number: 2,316
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testOozieURLFromInternalMappingWithExternalOverrides,Long Identifier,The length of the field OOZIE_OVERRIDE_MAPPING_FILE_CONTENTS is 36.,273
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHBaseURL,Long Statement,The length of the statement "EasyMock.expect(hbaseMaster.getConfigProperty(HBASE_MASTER_PORT_PROPERTY)).andReturn(hbaseMasterConfig.get(HBASE_MASTER_PORT_PROPERTY)).anyTimes();" is 147.,325
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHBaseURL,Long Statement,The length of the statement "EasyMock.expect(hbaseMaster.getConfigProperty(HBASE_REST_PORT_PROPERTY)).andReturn(hbaseMasterConfig.get(HBASE_REST_PORT_PROPERTY)).anyTimes();" is 143.,325
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHdfsURLHASingleNameService,Magic Number,The method contains a magic number: 2,397
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testHdfsUIURLHASingleNameService,Magic Number,The method contains a magic number: 2,425
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHdfsURLHAMultipleNameServicesNoDefaultFS,Magic Number,The method contains a magic number: 2,458
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testHdfsUIURLHAMultipleNameServicesNoDefaultFS,Magic Number,The method contains a magic number: 2,497
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHdfsURLFederatedNNWithDefaultFS,Magic Number,The method contains a magic number: 2,534
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testHdfsUIURLFederatedNNWithDefaultFS,Magic Number,The method contains a magic number: 2,578
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHdfsURLFederatedNNWithDefaultFSAndHaNodes,Magic Number,The method contains a magic number: 2,624
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testHdfsUIURLFederatedNNWithDefaultFSAndHaNodes,Magic Number,The method contains a magic number: 2,672
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHdfsURLFederatedNNDeclaredNS,Magic Number,The method contains a magic number: 2,719
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testWebHdfsURLFederatedNNDeclaredNSWithoutHaNodes,Magic Number,The method contains a magic number: 2,774
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testExtensionServiceURLFromOverride,Long Identifier,The length of the field CUSTOM_AUGMENT_MAPPING_FILE_CONTENTS is 36.,1188
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,testExtensionServiceURLFromOverride,Long Statement,The length of the statement "EasyMock.expect(hbaseMaster.getConfigProperty(HBASE_MASTER_PORT_PROPERTY)).andReturn(hbaseMasterConfig.get(HBASE_MASTER_PORT_PROPERTY)).anyTimes();" is 147.,1188
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariDynamicServiceURLCreatorTest,validateServiceURLs,Long Parameter List,The method has 5 parameters. ,1250
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,WebHdfsUrlCreatorTest,testFederatedHttpEndpointAddress,Magic Number,The method contains a magic number: 2,96
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,WebHdfsUrlCreatorTest,testFederatedHttpsEndpointAddress,Magic Number,The method contains a magic number: 2,140
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,WebHdfsUrlCreatorTest,testFederatedHttpsWebHdfsEndpointAddressWithValidNS,Magic Number,The method contains a magic number: 2,184
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,YarnUIURLCreatorTest,testCreateHAHttpURLs,Long Statement,The length of the statement "List<String> urls=doTestCreateHAURLs("HTTP_ONLY"`activeHttpAddress`stdbyHttpAddress`"test.host.secure.active:8088"`"test.host.secure.stdby:8088");" is 146.,50
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,YarnUIURLCreatorTest,testCreateHAHttpsURLs,Long Statement,The length of the statement "List<String> urls=doTestCreateHAURLs("HTTPS_ONLY"`"test.host.unsecure.active:8088"`"test.host.unsecure.stdby:8088"`stdbyHttpsAddress`activeHttpsAddress);" is 153.,72
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,ResourceManagerURLCreatorTest,testCreateHAHttpURLs,Long Statement,The length of the statement "List<String> urls=doTestCreateHAURLs("HTTP_ONLY"`activeHttpAddress`stdbyHttpAddress`"test.host.secure.active:8088"`"test.host.secure.stdby:8088");" is 146.,48
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,ResourceManagerURLCreatorTest,testCreateHAHttpsURLs,Long Statement,The length of the statement "List<String> urls=doTestCreateHAURLs("HTTPS_ONLY"`"test.host.unsecure.active:8088"`"test.host.unsecure.stdby:8088"`stdbyHttpsAddress`activeHttpsAddress);" is 153.,70
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscoveryTest,testSingleClusterDiscovery,Magic Number,The method contains a magic number: 6,52
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscoveryTest,testSingleClusterDiscoveryWithDefaultAddress,Magic Number,The method contains a magic number: 6,73
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscoveryTest,testSingleClusterDiscoveryWithDefaultClusterName,Magic Number,The method contains a magic number: 6,96
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscoveryTest,testSingleClusterDiscoveryWithDefaultAddressAndClusterName,Magic Number,The method contains a magic number: 6,120
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscoveryTest,testClusterDiscoveryWithExternalComponentConfigAugmentation,Long Statement,The length of the statement "final String URL_MAPPING_OVERRIDES="<?xml version=\"1.0\" encoding=\"utf-8\"?>\n" + "<service-discovery-url-mappings>\n" + " <service name=\"DISCOVERYTEST\">\n"+ " <url-pattern>{TEST_ADDRESS}/discoveryTest</url-pattern>\n"+ " <properties>\n"+ " <property name=\"TEST_ADDRESS\">\n"+ " <component>DISCOVERY_TEST</component>\n"+ " <config-property>discovery.test.base.url</config-property>\n"+ " </property>\n"+ " </properties>\n"+ " </service>\n"+ "</service-discovery-url-mappings>\n";" is 484.,199
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscoveryTest,testClusterDiscoveryWithExternalComponentConfigAugmentation,Long Statement,The length of the statement "System.setProperty(AmbariDynamicServiceURLCreator.MAPPING_CONFIG_OVERRIDE_PROPERTY`urlMappingOverrides.getAbsolutePath());" is 122.,199
apache_knox,org.apache.knox.gateway.topology.discovery.ambari,AmbariServiceDiscoveryTest,testClusterDiscoveryWithExternalComponentConfigAugmentation,Magic Number,The method contains a magic number: 7,199
apache_knox,org.apache.hadoop.http,HttpServer2,HttpServer2,Long Statement,The length of the statement "this.webAppContext.getServletContext().setAttribute(AuthenticationFilter.SIGNER_SECRET_PROVIDER_ATTRIBUTE`secretProvider);" is 122.,534
apache_knox,org.apache.hadoop.http,HttpServer2,initializeWebServer,Magic Number,The method contains a magic number: 4,560
apache_knox,org.apache.hadoop.http,HttpServer2,createWebAppContext,Long Statement,The length of the statement "Map<String`String> params=ImmutableMap.<String`String>builder().put("acceptRanges"`"true").put("dirAllowed"`"false").put("gzip"`"true").put("useFileMappedBuffer"`"true").build();" is 178.,621
apache_knox,org.apache.hadoop.http,HttpServer2,constructSecretProvider,Long Identifier,The length of the field disallowFallbackToRandomSignerSecretProvider is 44.,649
apache_knox,org.apache.hadoop.http,HttpServer2,addNoCacheFilter,Long Statement,The length of the statement "defineFilter(ctxt`NO_CACHE_FILTER`NoCacheFilter.class.getName()`Collections.<String`String>emptyMap()`new String[]{"/*"});" is 122.,668
apache_knox,org.apache.hadoop.http,HttpServer2,addDefaultApps,Long Statement,The length of the statement "boolean logsEnabled=conf.getBoolean(CommonConfigurationKeys.HADOOP_HTTP_LOGS_ENABLED`CommonConfigurationKeys.HADOOP_HTTP_LOGS_ENABLED_DEFAULT);" is 143.,696
apache_knox,org.apache.hadoop.http,HttpServer2,addDefaultApps,Long Statement,The length of the statement "if (conf.getBoolean(CommonConfigurationKeys.HADOOP_JETTY_LOGS_SERVE_ALIASES`CommonConfigurationKeys.DEFAULT_HADOOP_JETTY_LOGS_SERVE_ALIASES)) {" is 143.,696
apache_knox,org.apache.hadoop.http,HttpServer2,addJerseyResourcePackage,Long Statement,The length of the statement "sh.setInitParameter("com.sun.jersey.config.property.resourceConfigClass"`"com.sun.jersey.api.core.PackagesResourceConfig");" is 123.,786
apache_knox,org.apache.hadoop.http,HttpServer2,addInternalServlet,Long Statement,The length of the statement "LOG.debug("Found existing " + servletMapping.getServletName() + " servlet at path "+ pathSpec+ "; will replace mapping"+ " with "+ holder.getName()+ " servlet");" is 161.,833
apache_knox,org.apache.hadoop.http,HttpServer2,addInternalServlet,Long Statement,The length of the statement "LOG.debug("Found existing " + servletMapping.getServletName() + " servlet at path "+ pathSpec+ "; will replace mapping"+ " with "+ sh.getName()+ " servlet");" is 157.,884
apache_knox,org.apache.hadoop.http,HttpServer2,defineFilter,Long Parameter List,The method has 5 parameters. ,984
apache_knox,org.apache.hadoop.http,HttpServer2,getConnectorAddress,Magic Number,The method contains a magic number: 2,1090
apache_knox,org.apache.hadoop.http,HttpServer2,bindForSinglePort,Magic Number,The method contains a magic number: 100,1215
apache_knox,org.apache.hadoop.http,HttpServer2,bindForPortRange,Magic Number,The method contains a magic number: 100,1239
apache_knox,org.apache.hadoop.http,HttpServer2,openListeners,Magic Number,The method contains a magic number: 2,1273
apache_knox,org.apache.hadoop.http,HttpServer2,toString,Long Statement,The length of the statement "StringBuilder sb=new StringBuilder("HttpServer (").append(isAlive() ? STATE_DESCRIPTION_ALIVE : STATE_DESCRIPTION_NOT_LIVE).append(")` listening at:");" is 151.,1356
apache_knox,org.apache.hadoop.http,HttpServer2,hasAdministratorAccess,Long Statement,The length of the statement "response.sendError(HttpServletResponse.SC_FORBIDDEN`"Unauthenticated users are not " + "authorized to access this page.");" is 122.,1401
apache_knox,org.apache.hadoop.http,HttpServer2,hasAdministratorAccess,Long Statement,The length of the statement "response.sendError(HttpServletResponse.SC_FORBIDDEN`"Unauthenticated users are not " + "authorized to access this page.");" is 122.,1401
apache_knox,org.apache.hadoop.http,HttpServer2,HttpServer2,Long Statement,The length of the statement "this.webAppContext.getServletContext().setAttribute(AuthenticationFilter.SIGNER_SECRET_PROVIDER_ATTRIBUTE`secretProvider);" is 122.,535
apache_knox,org.apache.hadoop.http,HttpServer2,initializeWebServer,Magic Number,The method contains a magic number: 4,561
apache_knox,org.apache.hadoop.http,HttpServer2,createWebAppContext,Long Statement,The length of the statement "Map<String`String> params=ImmutableMap.<String`String>builder().put("acceptRanges"`"true").put("dirAllowed"`"false").put("gzip"`"true").put("useFileMappedBuffer"`"true").build();" is 178.,622
apache_knox,org.apache.hadoop.http,HttpServer2,constructSecretProvider,Long Identifier,The length of the field disallowFallbackToRandomSignerSecretProvider is 44.,650
apache_knox,org.apache.hadoop.http,HttpServer2,addNoCacheFilter,Long Statement,The length of the statement "defineFilter(ctxt`NO_CACHE_FILTER`NoCacheFilter.class.getName()`Collections.<String`String>emptyMap()`new String[]{"/*"});" is 122.,669
apache_knox,org.apache.hadoop.http,HttpServer2,addDefaultApps,Long Statement,The length of the statement "boolean logsEnabled=conf.getBoolean(CommonConfigurationKeys.HADOOP_HTTP_LOGS_ENABLED`CommonConfigurationKeys.HADOOP_HTTP_LOGS_ENABLED_DEFAULT);" is 143.,697
apache_knox,org.apache.hadoop.http,HttpServer2,addDefaultApps,Long Statement,The length of the statement "if (conf.getBoolean(CommonConfigurationKeys.HADOOP_JETTY_LOGS_SERVE_ALIASES`CommonConfigurationKeys.DEFAULT_HADOOP_JETTY_LOGS_SERVE_ALIASES)) {" is 143.,697
apache_knox,org.apache.hadoop.http,HttpServer2,addJerseyResourcePackage,Long Statement,The length of the statement "sh.setInitParameter("com.sun.jersey.config.property.resourceConfigClass"`"com.sun.jersey.api.core.PackagesResourceConfig");" is 123.,787
apache_knox,org.apache.hadoop.http,HttpServer2,addInternalServlet,Long Statement,The length of the statement "LOG.debug("Found existing " + servletMapping.getServletName() + " servlet at path "+ pathSpec+ "; will replace mapping"+ " with "+ holder.getName()+ " servlet");" is 161.,834
apache_knox,org.apache.hadoop.http,HttpServer2,addInternalServlet,Long Statement,The length of the statement "LOG.debug("Found existing " + servletMapping.getServletName() + " servlet at path "+ pathSpec+ "; will replace mapping"+ " with "+ sh.getName()+ " servlet");" is 157.,885
apache_knox,org.apache.hadoop.http,HttpServer2,defineFilter,Long Parameter List,The method has 5 parameters. ,985
apache_knox,org.apache.hadoop.http,HttpServer2,getConnectorAddress,Magic Number,The method contains a magic number: 2,1091
apache_knox,org.apache.hadoop.http,HttpServer2,bindForSinglePort,Magic Number,The method contains a magic number: 100,1216
apache_knox,org.apache.hadoop.http,HttpServer2,bindForPortRange,Magic Number,The method contains a magic number: 100,1240
apache_knox,org.apache.hadoop.http,HttpServer2,openListeners,Magic Number,The method contains a magic number: 2,1274
apache_knox,org.apache.hadoop.http,HttpServer2,toString,Long Statement,The length of the statement "StringBuilder sb=new StringBuilder("HttpServer (").append(isAlive() ? STATE_DESCRIPTION_ALIVE : STATE_DESCRIPTION_NOT_LIVE).append(")` listening at:");" is 151.,1357
apache_knox,org.apache.hadoop.http,HttpServer2,hasAdministratorAccess,Long Statement,The length of the statement "response.sendError(HttpServletResponse.SC_FORBIDDEN`"Unauthenticated users are not " + "authorized to access this page.");" is 122.,1402
apache_knox,org.apache.hadoop.http,HttpServer2,hasAdministratorAccess,Long Statement,The length of the statement "response.sendError(HttpServletResponse.SC_FORBIDDEN`"Unauthenticated users are not " + "authorized to access this page.");" is 122.,1402
apache_knox,org.apache.knox.gateway.service.admin,TopologyCollectionMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,53
apache_knox,org.apache.knox.gateway.service.admin,TopologyCollectionMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,58
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionCollectionMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,52
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionCollectionMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,57
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionCollectionMarshaller,getMarshaller,Long Statement,The length of the statement "return MediaType.APPLICATION_JSON_TYPE.getSubtype().equals(mediaType.getSubtype()) ? getJsonMarshaller() : getXmlMarshaller();" is 126.,67
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionCollectionMarshaller,getXmlMarshaller,Long Statement,The length of the statement "xmlMarshaller=JAXBContextFactory.createContext(new Class[]{ServiceDefinitionsWrapper.class}`properties).createMarshaller();" is 123.,71
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionCollectionMarshaller,getJsonMarshaller,Long Statement,The length of the statement "jsonMarshaller=JAXBContextFactory.createContext(new Class[]{ServiceDefinitionsWrapper.class}`properties).createMarshaller();" is 124.,81
apache_knox,org.apache.knox.gateway.service.admin,TopologyMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,60
apache_knox,org.apache.knox.gateway.service.admin,TopologyMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,65
apache_knox,org.apache.knox.gateway.service.admin,TopologyMarshaller,readFrom,Long Parameter List,The method has 6 parameters. ,93
apache_knox,org.apache.knox.gateway.service.admin,HrefListingMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,46
apache_knox,org.apache.knox.gateway.service.admin,HrefListingMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,55
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionsResource,getServiceDefinition,Long Statement,The length of the statement "return getServiceDefinitions(serviceDefinitionPair -> serviceDefinitionPair.getService().getName().equalsIgnoreCase(name)`serviceOnly);" is 135.,82
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionsResource,getServiceDefinition,Long Statement,The length of the statement "return getServiceDefinitions(serviceDefinitionPair -> serviceDefinitionPair.getService().getName().equalsIgnoreCase(name) && serviceDefinitionPair.getService().getRole().equalsIgnoreCase(role)`serviceOnly);" is 206.,89
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionsResource,getServiceDefinition,Long Statement,The length of the statement "return getServiceDefinitions(serviceDefinitionPair -> serviceDefinitionPair.getService().getName().equalsIgnoreCase(name) && serviceDefinitionPair.getService().getRole().equalsIgnoreCase(role) && serviceDefinitionPair.getService().getVersion().equalsIgnoreCase(version)`serviceOnly);" is 283.,99
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionsResource,toUri,Long Statement,The length of the statement "return toUri(serviceDefinition.getService().getName()`serviceDefinition.getService().getRole()`serviceDefinition.getService().getVersion());" is 140.,146
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionsResource,getServiceDefinitions,Long Statement,The length of the statement "serviceDefinitions.stream().forEach(serviceDefinition -> serviceDefinitionsWrapper.getServiceDefinitions().add(new ServiceDefinitionPair(serviceDefinition.getService()`null)));" is 176.,154
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionsResource,getServiceDefinitions,Long Statement,The length of the statement "return predicate == null ? serviceDefinitions : serviceDefinitions.stream().filter(predicate).collect(Collectors.toSet());" is 122.,167
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionsResource,getServiceDefinitionRegistry,Long Statement,The length of the statement "final GatewayServices gatewayServices=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 140.,172
apache_knox,org.apache.knox.gateway.service.admin,VersionMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,53
apache_knox,org.apache.knox.gateway.service.admin,VersionMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,58
apache_knox,org.apache.knox.gateway.service.admin,AliasResource,postAlias,Long Statement,The length of the statement "return status(Response.Status.CREATED).entity("{ \"created\" : { \"topology\": \"" + topology + "\"` \"alias\": \""+ alias+ "\" } }").type(MediaType.APPLICATION_JSON_TYPE).build();" is 180.,84
apache_knox,org.apache.knox.gateway.service.admin,AliasResource,postAlias,Long Statement,The length of the statement "return status(INTERNAL_SERVER_ERROR).entity("Error adding alias " + alias + " for cluster "+ topology+ "` reason: "+ e.toString()).type(MediaType.APPLICATION_JSON_TYPE).build();" is 177.,84
apache_knox,org.apache.knox.gateway.service.admin,AliasResource,deleteAlias,Long Statement,The length of the statement "return status(Response.Status.OK).entity("{ \"deleted\" : { \"topology\": \"" + topology + "\"` \"alias\": \""+ alias+ "\" } }").type(MediaType.APPLICATION_JSON_TYPE).build();" is 175.,122
apache_knox,org.apache.knox.gateway.service.admin,AliasResource,deleteAlias,Long Statement,The length of the statement "return status(INTERNAL_SERVER_ERROR).entity("Error deleting alias " + alias + " for cluster "+ topology+ "` reason: "+ e.toString()).type(MediaType.APPLICATION_JSON_TYPE).build();" is 179.,122
apache_knox,org.apache.knox.gateway.service.admin,AliasResource,getAliases,Long Statement,The length of the statement "return status(Response.Status.OK).entity(mapper.writeValueAsString(new TopologyAliases(topology`aliases))).type(MediaType.APPLICATION_JSON_TYPE).build();" is 153.,152
apache_knox,org.apache.knox.gateway.service.admin,AliasResource,getAliases,Long Statement,The length of the statement "return status(INTERNAL_SERVER_ERROR).entity("Error getting aliases for cluster " + topology + "` reason: "+ e.toString()).type(MediaType.APPLICATION_JSON_TYPE).build();" is 168.,152
apache_knox,org.apache.knox.gateway.service.admin,AliasResource,getAliasService,Long Statement,The length of the statement "final GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 133.,185
apache_knox,org.apache.knox.gateway.service.admin,ServiceDiscoveryCollectionMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,50
apache_knox,org.apache.knox.gateway.service.admin,ServiceDiscoveryCollectionMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,55
apache_knox,org.apache.knox.gateway.service.admin,ServiceDiscoveryCollectionMarshaller,writeTo,Long Statement,The length of the statement "final JAXBContext context=JAXBContext.newInstance(new Class[]{ServiceDiscoveryResource.ServiceDiscoveryWrapper.class}`properties);" is 130.,55
apache_knox,org.apache.knox.gateway.service.admin,VersionResource,getServerVersion,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,54
apache_knox,org.apache.knox.gateway.service.admin,ServiceDefinitionUnmarshaller,readFrom,Long Parameter List,The method has 6 parameters. ,48
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,getTopology,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,107
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,getTopologies,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,143
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadTopology,Empty catch clause,The method has an empty catch block.,168
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadTopology,Long Statement,The length of the statement "GatewayServices gs=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 121.,168
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,deleteTopology,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,212
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,getProviderConfigurations,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,235
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,getProviderConfiguration,Long Identifier,The length of the field SINGLE_PROVIDERCONFIG_API_PATH is 30.,257
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,getProviderConfiguration,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,257
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,deleteProviderConfiguration,Long Identifier,The length of the field SINGLE_PROVIDERCONFIG_API_PATH is 30.,294
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,deleteProviderConfiguration,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,294
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,deleteSimpleDescriptor,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,312
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadProviderConfiguration,Empty catch clause,The method has an empty catch block.,335
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadProviderConfiguration,Long Identifier,The length of the field SINGLE_PROVIDERCONFIG_API_PATH is 30.,335
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadProviderConfiguration,Long Statement,The length of the statement "GatewayServices gs=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 121.,335
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadProviderConfiguration,Long Statement,The length of the statement "response=status(Response.Status.BAD_REQUEST).entity("{ \"error\" : \"Failed to deploy provider configuration " + name + "\" }").build();" is 136.,335
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadSimpleDescriptor,Empty catch clause,The method has an empty catch block.,380
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadSimpleDescriptor,Long Statement,The length of the statement "GatewayServices gs=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 121.,380
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,uploadSimpleDescriptor,Long Statement,The length of the statement "response=status(Response.Status.BAD_REQUEST).entity("{ \"error\" : \"Failed to deploy descriptor " + name + "\" }").build();" is 124.,380
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,getSimpleDescriptors,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,428
apache_knox,org.apache.knox.gateway.service.admin,TopologiesResource,getSimpleDescriptor,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,450
apache_knox,org.apache.knox.gateway.service.admin,TopologyMarshallerTest,testTopologyMarshalling,Long Statement,The length of the statement "JAXBContext jaxbContext=JAXBContext.newInstance(Topology.class.getPackage().getName()`Topology.class.getClassLoader()`properties);" is 130.,38
apache_knox,org.apache.knox.gateway.service.admin,TopologyMarshallerTest,testTopologyMarshalling,Magic Number,The method contains a magic number: 2,38
apache_knox,org.apache.knox.gateway.ha.provider,HaServiceConfig,setDisableStickySessionForUserAgents,Long Identifier,The length of the parameter disableStickySessionForUserAgents is 33.,62
apache_knox,org.apache.knox.gateway.ha.provider,HaServletContextListener,locateDescriptor,Long Identifier,The length of the field DESCRIPTOR_LOCATION_INIT_PARAM_NAME is 35.,75
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManager,retrieveHosts,Empty catch clause,The method has an empty catch block.,92
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManager,retrieveHosts,Long Identifier,The length of the field DEFAULT_ZOOKEEPER_NAMESPACE_SECURE is 34.,92
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManager,retrieveHosts,Long Identifier,The length of the field DEFAULT_ZOOKEEPER_NAMESPACE_UNSECURE is 36.,92
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManager,retrieveHosts,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(getZookeeperEnsemble()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 168.,92
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 1000,92
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 3,92
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 10,92
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Identifier,The length of the identifier disableLoadBalancingForUserAgentsConfig is 39.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final boolean enabled=Boolean.parseBoolean(configMap.getOrDefault(CONFIG_PARAM_ENABLED`Boolean.toString(DEFAULT_ENABLED)));" is 123.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final int maxFailoverAttempts=Integer.parseInt(configMap.getOrDefault(CONFIG_PARAM_MAX_FAILOVER_ATTEMPTS`Integer.toString(DEFAULT_MAX_FAILOVER_ATTEMPTS)));" is 155.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final int failoverSleep=Integer.parseInt(configMap.getOrDefault(CONFIG_PARAM_FAILOVER_SLEEP`Integer.toString(DEFAULT_FAILOVER_SLEEP)));" is 135.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final boolean stickySessionsEnabled=Boolean.parseBoolean(configMap.getOrDefault(CONFIG_STICKY_SESSIONS_ENABLED`Boolean.toString(DEFAULT_STICKY_SESSIONS_ENABLED)));" is 163.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final boolean loadBalancingEnabled=Boolean.parseBoolean(configMap.getOrDefault(CONFIG_LOAD_BALANCING_ENABLED`Boolean.toString(DEFAULT_LOAD_BALANCING_ENABLED)));" is 160.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final boolean noFallbackEnabled=Boolean.parseBoolean(configMap.getOrDefault(CONFIG_NO_FALLBACK_ENABLED`Boolean.toString(DEFAULT_NO_FALLBACK_ENABLED)));" is 151.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final String stickySessionCookieName=configMap.getOrDefault(STICKY_SESSION_COOKIE_NAME`DEFAULT_STICKY_SESSION_COOKIE_NAME);" is 123.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "final String disableLoadBalancingForUserAgentsConfig=configMap.getOrDefault(DISABLE_LB_USER_AGENTS`DEFAULT_DISABLE_LB_USER_AGENTS);" is 131.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "return createServiceConfig(serviceName`enabled`maxFailoverAttempts`failoverSleep`zookeeperEnsemble`zookeeperNamespace`stickySessionsEnabled`loadBalancingEnabled`stickySessionCookieName`noFallbackEnabled`disableLoadBalancingForUserAgentsConfig);" is 244.,32
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Complex Method,Cyclomatic complexity of the method is 9,51
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Identifier,The length of the parameter disableLoadBalancingForUserAgentsValue is 38.,51
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Identifier,The length of the identifier disableLoadBalancingForUserAgentsConfig is 39.,51
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Parameter List,The method has 11 parameters. ,51
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Statement,The length of the statement "return createServiceConfig(serviceName`enabled`maxFailoverAttempts`failoverSleep`zookeeperEnsemble`zookeeperNamespace`stickySessionsEnabled`loadBalancingEnabled`stickySessionCookieName`noFallbackEnabled`disableLoadBalancingForUserAgentsConfig);" is 244.,51
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Identifier,The length of the parameter disableStickySessionForUserAgents is 33.,110
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,createServiceConfig,Long Parameter List,The method has 11 parameters. ,110
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactory,parseHaConfiguration,Magic Number,The method contains a magic number: 2,130
apache_knox,org.apache.knox.gateway.ha.provider.impl,StringResponseHandler,handleResponse,Magic Number,The method contains a magic number: 200,33
apache_knox,org.apache.knox.gateway.ha.provider.impl,StringResponseHandler,handleResponse,Magic Number,The method contains a magic number: 300,33
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManager,lookupURLs,Long Identifier,The length of the field APACHE_ATLAS_ACTIVE_SERVER_INFO is 31.,65
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManager,lookupURLs,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(zooKeeperEnsemble).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 163.,65
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManager,lookupURLs,Magic Number,The method contains a magic number: 1000,65
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManager,lookupURLs,Magic Number,The method contains a magic number: 3,65
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManager,lookupURLs,Magic Number,The method contains a magic number: 10,65
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManager,retrieveHosts,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(getZookeeperEnsemble()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 168.,71
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 1000,71
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 3,71
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 10,71
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManager,retrieveHosts,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(getZookeeperEnsemble()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 168.,91
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 1000,91
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 3,91
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManager,retrieveHosts,Magic Number,The method contains a magic number: 10,91
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManager,store,Magic Number,The method contains a magic number: 2,42
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManager,load,Long Statement,The length of the statement "HaServiceConfig config=HaDescriptorFactory.createServiceConfig(element.getAttribute(SERVICE_NAME_ATTRIBUTE)`element.getAttribute(ENABLED_ATTRIBUTE)`element.getAttribute(MAX_FAILOVER_ATTEMPTS)`element.getAttribute(FAILOVER_SLEEP)`element.getAttribute(ZOOKEEPER_ENSEMBLE)`element.getAttribute(ZOOKEEPER_NAMESPACE)`element.getAttribute(ENABLE_LOAD_BALANCING)`element.getAttribute(ENABLE_STICKY_SESSIONS)`element.getAttribute(STICKY_SESSION_COOKIE_NAME)`element.getAttribute(ENABLE_NO_FALLBACK)`element.getAttribute(DISABLE_LB_USER_AGENTS));" is 537.,84
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,supportsConfig,Complex Conditional,The conditional expression zookeeperEnsemble != null && zookeeperNamespace != null && !zookeeperEnsemble.trim().isEmpty() && !zookeeperNamespace.trim().isEmpty() is complex.,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,supportsConfig,Long Statement,The length of the statement "if (zookeeperEnsemble != null && zookeeperNamespace != null && !zookeeperEnsemble.trim().isEmpty() && !zookeeperNamespace.trim().isEmpty()) {" is 141.,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,lookupURLs,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(zooKeeperEnsemble).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 163.,72
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,lookupURLs,Long Statement,The length of the statement "String serverInfo=new String(zooKeeperClient.getData().forPath("/" + zooKeeperNamespace + "/"+ serverNode)`StandardCharsets.UTF_8);" is 131.,72
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,lookupURLs,Magic Number,The method contains a magic number: 1000,72
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,lookupURLs,Magic Number,The method contains a magic number: 3,72
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,lookupURLs,Magic Number,The method contains a magic number: 10,72
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,constructURL,Complex Method,Cyclomatic complexity of the method is 8,94
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,constructURL,Magic Number,The method contains a magic number: 2,94
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,constructURL,Magic Number,The method contains a magic number: 2,94
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,constructURL,Magic Number,The method contains a magic number: 2,94
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,constructURL,Magic Number,The method contains a magic number: 2,94
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManager,constructURL,Magic Number,The method contains a magic number: 2,94
apache_knox,org.apache.knox.gateway.ha.provider.impl,BaseZookeeperURLManager,validateHosts,Empty catch clause,The method has an empty catch block.,160
apache_knox,org.apache.knox.gateway.ha.provider.impl,BaseZookeeperURLManager,validateHosts,Empty catch clause,The method has an empty catch block.,160
apache_knox,org.apache.knox.gateway.ha.provider.impl,BaseZookeeperURLManager,buildHttpClient,Long Statement,The length of the statement "RequestConfig.Builder requestBuilder=RequestConfig.custom().setConnectTimeout(TIMEOUT).setSocketTimeout(TIMEOUT).setConnectionRequestTimeout(TIMEOUT);" is 150.,197
apache_knox,org.apache.knox.gateway.ha.provider.impl,BaseZookeeperURLManager,buildHttpClient,Long Statement,The length of the statement "Registry<AuthSchemeProvider> authSchemeRegistry=RegistryBuilder.<AuthSchemeProvider>create().register(AuthSchemes.SPNEGO`new KnoxSpnegoAuthSchemeFactory(true)).build();" is 168.,197
apache_knox,org.apache.knox.gateway.ha.provider.impl,BaseZookeeperURLManager,buildHttpClient,Long Statement,The length of the statement "client=HttpClientBuilder.create().setDefaultRequestConfig(requestBuilder.build()).setDefaultAuthSchemeRegistry(authSchemeRegistry).setDefaultCredentialsProvider(credentialsProvider).build();" is 190.,197
apache_knox,org.apache.knox.gateway.ha.provider.impl,DefaultHaServiceConfig,setDisableStickySessionForUserAgents,Long Identifier,The length of the parameter disableStickySessionForUserAgents is 33.,150
apache_knox,org.apache.knox.gateway.ha.provider.impl,DefaultHaServiceConfig,setDisableStickySessionForUserAgents,Long Identifier,The length of the field disableStickySessionForUserAgents is 33.,150
apache_knox,org.apache.knox.gateway.ha.provider.impl,DefaultHaServiceConfig,getStickySessionDisabledUserAgents,Long Identifier,The length of the field disableStickySessionForUserAgents is 33.,155
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(cluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 172.,49
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 1000,49
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 3,49
apache_knox,org.apache.knox.gateway.ha.provider.impl,SOLRZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 10,49
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManagerTest,createZNodes,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(cluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 172.,116
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManagerTest,createZNodes,Magic Number,The method contains a magic number: 1000,116
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManagerTest,createZNodes,Magic Number,The method contains a magic number: 3,116
apache_knox,org.apache.knox.gateway.ha.provider.impl,HBaseZookeeperURLManagerTest,createZNodes,Magic Number,The method contains a magic number: 10,116
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorLoad,Long Statement,The length of the statement "String xml="<ha><service name='foo' maxFailoverAttempts='42' failoverSleep='4000' enabled='false'/>" + "<service name='bar' failoverLimit='3' enabled='true'/></ha>";" is 165.,38
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorLoad,Magic Number,The method contains a magic number: 42,38
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorLoad,Magic Number,The method contains a magic number: 4000,38
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoring,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("foo"`"false"`"42"`"1000"`"foo:2181`bar:2181"`"hiveserver2"`null`null`null`null`null));" is 155.,76
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoring,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("bar"`"true"`"3"`"5000"`null`null`null`null`null`null`null));" is 129.,76
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoring,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='false' and @failoverSleep='1000' and @maxFailoverAttempts='42' and @name='foo' and @zookeeperEnsemble='foo:2181`bar:2181' and @zookeeperNamespace='hiveserver2']"));" is 217.,76
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoring,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='true' and @failoverSleep='5000' and @maxFailoverAttempts='3' and @name='bar']"));" is 134.,76
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("foo"`"false"`"42"`"1000"`"foo:2181`bar:2181"`"hiveserver2"`null`"true"`null`null`null));" is 157.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("bar"`"true"`"3"`"5000"`null`null`null`"true"`null`null`null));" is 131.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("abc"`"true"`"3"`"5000"`null`null`null`"true"`"abc"`null`null));" is 132.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("xyz"`"true"`"3"`"5000"`null`null`null`"true"`"xyz"`"true"`null));" is 134.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='false' and @failoverSleep='1000' and @maxFailoverAttempts='42' and @name='foo' and @zookeeperEnsemble='foo:2181`bar:2181' and @zookeeperNamespace='hiveserver2' and @enableStickySession='true']"));" is 249.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='true' and @failoverSleep='5000' and @maxFailoverAttempts='3' and @name='bar' and @enableStickySession='true']"));" is 166.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='true' and @failoverSleep='5000' and @maxFailoverAttempts='3' and @name='abc' and @enableStickySession='true' and @stickySessionCookieName='abc']"));" is 201.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringStickySessionCookie,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='true' and @failoverSleep='5000' and @maxFailoverAttempts='3' and @name='xyz' and @enableStickySession='true' and @stickySessionCookieName='xyz' and @noFallback='true']"));" is 224.,88
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringLoadBalancerConfig,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("foo"`"false"`"42"`"1000"`"foo:2181`bar:2181"`"hiveserver2"`"true"`"false"`null`null`null));" is 160.,105
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringLoadBalancerConfig,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("bar"`"true"`"3"`"5000"`null`null`"true"`null`null`null`null));" is 131.,105
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringLoadBalancerConfig,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig("abc"`"true"`"3"`"5000"`null`null`null`"true"`"abc"`null`null));" is 132.,105
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringLoadBalancerConfig,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='false' and @failoverSleep='1000' and @maxFailoverAttempts='42' and @name='foo' and @zookeeperEnsemble='foo:2181`bar:2181' and @zookeeperNamespace='hiveserver2' and @enableLoadBalancing='true' and @enableStickySession='false']"));" is 282.,105
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringLoadBalancerConfig,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='true' and @failoverSleep='5000' and @maxFailoverAttempts='3' and @name='bar' and @enableLoadBalancing='true' and @enableStickySession='false']"));" is 199.,105
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorManagerTest,testDescriptorStoringLoadBalancerConfig,Long Statement,The length of the statement "assertThat(the(xml)`hasXPath("/ha//service[@enabled='true' and @failoverSleep='5000' and @maxFailoverAttempts='3' and @name='abc' and @enableLoadBalancing='false' and @enableStickySession='true' and @stickySessionCookieName='abc']"));" is 234.,105
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfig,Long Statement,The length of the statement "HaServiceConfig serviceConfig=HaDescriptorFactory.createServiceConfig("foo"`"enabled=true;maxFailoverAttempts=42;failoverSleep=50");" is 132.,35
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfig,Magic Number,The method contains a magic number: 42,35
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfig,Magic Number,The method contains a magic number: 50,35
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfig,Magic Number,The method contains a magic number: 3,35
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfig,Magic Number,The method contains a magic number: 1000,35
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Long Statement,The length of the statement "HaServiceConfig serviceConfig=HaDescriptorFactory.createServiceConfig("foo"`"enableStickySession=true;enabled=true;maxFailoverAttempts=42;failoverSleep=50");" is 157.,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Long Statement,The length of the statement "serviceConfig=HaDescriptorFactory.createServiceConfig("foo"`"enableStickySession=true;enabled=true;maxFailoverAttempts=42;failoverSleep=50;stickySessionCookieName=abc");" is 169.,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 42,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 50,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 42,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 50,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 3,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 1000,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 4,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 3000,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 3,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 1000,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 3,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,HaDescriptorFactoryTest,testCreateServiceConfigActive,Magic Number,The method contains a magic number: 1000,52
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(cluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 172.,45
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 1000,45
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 3,45
apache_knox,org.apache.knox.gateway.ha.provider.impl,KafkaZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 10,45
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(cluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 172.,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "String host1="hive.server2.authentication=NONE;hive.server2.transport.mode=http;hive.server2.thrift.http.path=cliservice;" + "hive.server2.thrift.http.port=10001;hive.server2.thrift.bind.host=host1;hive.server2.use.SSL=true";" is 225.,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "String host2="hive.server2.authentication=NONE;hive.server2.transport.mode=http;hive.server2.thrift.http.path=foobar;" + "hive.server2.thrift.http.port=10002;hive.server2.thrift.bind.host=host2;hive.server2.use.SSL=false";" is 222.,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "String host3="hive.server2.authentication=NONE;hive.server2.transport.mode=http;hive.server2.thrift.http.path=cliservice;" + "hive.server2.thrift.http.port=10003;hive.server2.thrift.bind.host=host3;hive.server2.use.SSL=false";" is 226.,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "String host4="hive.server2.authentication=NONE;hive.server2.transport.mode=http;hive.server2.thrift.http.path=cliservice;" + "hive.server2.thrift.http.port=10004;hive.server2.thrift.bind.host=host4;hive.server2.use.SSL=true";" is 225.,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 1000,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 3,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 10,44
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,testActiveURLManagement,Magic Number,The method contains a magic number: 2,86
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,testMarkingFailedURL,Magic Number,The method contains a magic number: 2,101
apache_knox,org.apache.knox.gateway.ha.provider.impl,HS2ZookeeperURLManagerTest,testMarkingFailedURL,Magic Number,The method contains a magic number: 3,101
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setUp,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(cluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 172.,48
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 1000,48
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 3,48
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setUp,Magic Number,The method contains a magic number: 10,48
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setAtlasActiveHostURLInZookeeper,Long Statement,The length of the statement "try (CuratorFramework zooKeeperClient=CuratorFrameworkFactory.builder().connectString(cluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(1000`3)).build()){" is 172.,149
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setAtlasActiveHostURLInZookeeper,Magic Number,The method contains a magic number: 1000,149
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setAtlasActiveHostURLInZookeeper,Magic Number,The method contains a magic number: 3,149
apache_knox,org.apache.knox.gateway.ha.provider.impl,AtlasZookeeperURLManagerTest,setAtlasActiveHostURLInZookeeper,Magic Number,The method contains a magic number: 10,149
apache_knox,org.apache.knox.gateway.ha.dispatch,AtlasApiTrustedProxyHaDispatch,executeRequest,Complex Conditional,The conditional expression (statusCode == HttpServletResponse.SC_MOVED_TEMPORARILY || statusCode == HttpServletResponse.SC_TEMPORARY_REDIRECT) && originalLocationHeader != null is complex.,33
apache_knox,org.apache.knox.gateway.ha.dispatch,AtlasApiTrustedProxyHaDispatch,executeRequest,Long Statement,The length of the statement "if ((statusCode == HttpServletResponse.SC_MOVED_TEMPORARILY || statusCode == HttpServletResponse.SC_TEMPORARY_REDIRECT) && originalLocationHeader != null) {" is 156.,33
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,init,Long Identifier,The length of the field disableLoadBalancingForUserAgents is 33.,91
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,init,Long Statement,The length of the statement "disableLoadBalancingForUserAgents=Arrays.asList(serviceConfig.getStickySessionDisabledUserAgents().trim().split("\\s*`\\s*"));" is 126.,91
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,executeRequestWrapper,Complex Method,Cyclomatic complexity of the method is 8,141
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,executeRequestWrapper,Long Identifier,The length of the field disableLoadBalancingForUserAgents is 33.,141
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,executeRequestWrapper,Long Statement,The length of the statement "final String userAgentFromBrowser=StringUtils.isBlank(inboundRequest.getHeader("User-Agent")) ? "" : inboundRequest.getHeader("User-Agent");" is 140.,141
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,setBackendfromHaCookie,Complex Conditional,The conditional expression loadBalancingEnabled && stickySessionsEnabled && inboundRequest.getCookies() != null is complex.,221
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,setBackendfromHaCookie,Empty catch clause,The method has an empty catch block.,221
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,setKnoxHaCookie,Complex Conditional,The conditional expression serviceHaCookies != null && !serviceHaCookies.isEmpty() && hashToUrlLookup.containsKey(serviceHaCookies.get(0).getValue()) is complex.,241
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,setKnoxHaCookie,Long Statement,The length of the statement "serviceHaCookies=Arrays.stream(inboundRequest.getCookies()).filter(cookie -> stickySessionCookieName.equals(cookie.getName())).collect(Collectors.toList());" is 156.,241
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,setKnoxHaCookie,Long Statement,The length of the statement "if (serviceHaCookies != null && !serviceHaCookies.isEmpty() && hashToUrlLookup.containsKey(serviceHaCookies.get(0).getValue())) {" is 129.,241
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,setKnoxHaCookie,Long Statement,The length of the statement "final List<String> urls=haProvider.getURLs(getServiceRole()).stream().filter(u -> u.contains(outboundRequest.getURI().getHost())).collect(Collectors.toList());" is 159.,241
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,setKnoxHaCookie,Long Statement,The length of the statement "GatewayConfig config=(GatewayConfig)inboundRequest.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 124.,241
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,failoverRequest,Complex Conditional,The conditional expression stickySessionsEnabled && noFallbackEnabled && sessionCookie.isPresent() is complex.,286
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,failoverRequest,Long Parameter List,The method has 5 parameters. ,286
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatch,failoverRequest,Long Statement,The length of the statement "sessionCookie=Arrays.stream(inboundRequest.getCookies()).findFirst().filter(cookie -> stickySessionCookieName.equals(cookie.getName()));" is 136.,286
apache_knox,org.apache.knox.gateway.ha.dispatch,AtlasApiHaDispatch,executeRequest,Complex Conditional,The conditional expression (statusCode == HttpServletResponse.SC_MOVED_TEMPORARILY || statusCode == HttpServletResponse.SC_TEMPORARY_REDIRECT) && originalLocationHeader != null is complex.,60
apache_knox,org.apache.knox.gateway.ha.dispatch,AtlasApiHaDispatch,executeRequest,Long Statement,The length of the statement "if ((statusCode == HttpServletResponse.SC_MOVED_TEMPORARILY || statusCode == HttpServletResponse.SC_TEMPORARY_REDIRECT) && originalLocationHeader != null) {" is 156.,60
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testConnectivityFailover,Empty catch clause,The method has an empty catch block.,65
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testConnectivityFailover,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`null`null`null`null));" is 135.,65
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testConnectivityFailover,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,65
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testConnectivityFailover,Magic Number,The method contains a magic number: 1000,65
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testNoLoadbalancingStickyFailoverNoFallback,Empty catch clause,The method has an empty catch block.,128
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testNoLoadbalancingStickyFailoverNoFallback,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`"true"`null`"true"`null));" is 139.,128
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testNoLoadbalancingStickyFailoverNoFallback,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,128
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testNoFallbackWhenStickyDisabled,Empty catch clause,The method has an empty catch block.,193
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testNoFallbackWhenStickyDisabled,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`null`null`"true"`null));" is 137.,193
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testNoFallbackWhenStickyDisabled,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,193
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testNoFallbackWhenStickyDisabled,Magic Number,The method contains a magic number: 1000,193
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOffStickyOn,Empty catch clause,The method has an empty catch block.,262
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOffStickyOn,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`"true"`null`null`null));" is 137.,262
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOffStickyOn,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,262
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOffStickyOn,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,262
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOffStickyOn,Magic Number,The method contains a magic number: 4L,262
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOn,Empty catch clause,The method has an empty catch block.,358
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOn,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`"true"`null`null`null`null));" is 137.,358
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOn,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,358
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOn,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,358
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOn,Magic Number,The method contains a magic number: 4L,358
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOnStickyOn,Empty catch clause,The method has an empty catch block.,453
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOnStickyOn,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`"true"`"true"`null`null`null));" is 139.,453
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOnStickyOn,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,453
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOnStickyOn,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,453
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testLoadbalancingOnStickyOn,Magic Number,The method contains a magic number: 4L,453
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Empty catch clause,The method has an empty catch block.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`enableLoadBalancing`enableStickySession`null`noFallback`null));" is 171.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "EasyMock.expectLastCall().andReturn(new Cookie[]{new Cookie(HaServiceConfigConstants.DEFAULT_STICKY_SESSION_COOKIE_NAME + "-" + serviceName`"59973e253ae20de796c6ef413608ec1c80fca24310a4cbdecc0ff97aeea55745")}).anyTimes();" is 221.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "EasyMock.expect(outboundResponse.getOutputStream()).andAnswer((IAnswer<SynchronousServletOutputStreamAdapter>)() -> new SynchronousServletOutputStreamAdapter(){" is 160.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "Assert.assertEquals("Expected no fail-over because the initial request contained a session cookie."`HttpStatus.SC_BAD_GATEWAY`statusCodeCapture.getValue().intValue());" is 167.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "Assert.assertEquals("Expected the request to have failed-over to the alternate host."`uri2`requestURICapture.getValue());" is 121.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Long Statement,The length of the statement "Assert.assertEquals("Expected the failed-over request to succeed."`HttpStatus.SC_OK`statusCodeCapture.getValue().intValue());" is 125.,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,doTestFailoverStickyOnFallbackOff,Magic Number,The method contains a magic number: 4L,577
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testStickyOn,Empty catch clause,The method has an empty catch block.,712
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testStickyOn,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`"true"`"true"`null`null`null));" is 139.,712
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testStickyOn,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,712
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testStickyOn,Long Statement,The length of the statement "Cookie[] cookie=new Cookie[]{new Cookie("KNOX_BACKEND-OOZIE"`"59973e253ae20de796c6ef413608ec1c80fca24310a4cbdecc0ff97aeea55745")};" is 130.,712
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testStickyOn,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,712
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testStickyOn,Magic Number,The method contains a magic number: 4L,712
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgent,Empty catch clause,The method has an empty catch block.,810
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgent,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`"true"`"true"`null`null`null));" is 139.,810
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgent,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,810
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgent,Long Statement,The length of the statement "Cookie[] cookie=new Cookie[]{new Cookie("KNOX_BACKEND-OOZIE"`"59973e253ae20de796c6ef413608ec1c80fca24310a4cbdecc0ff97aeea55745")};" is 130.,810
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgent,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,810
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgent,Magic Number,The method contains a magic number: 4L,810
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDActiveURL,Long Statement,The length of the statement "descriptor1.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName1`"enableStickySession=true;enableLoadBalancing=true;enabled=true;maxFailoverAttempts=42;failoverSleep=50;maxRetryAttempts=1;disableLoadBalancingForUserAgents=Test User Agent` Test User Agent2`Test User Agent3 `Test User Agent4 ;retrySleep=1000"));" is 328.,909
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDActiveURL,Long Statement,The length of the statement "descriptor2.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName2`"enableStickySession=true;enableLoadBalancing=true;enabled=true;maxFailoverAttempts=42;failoverSleep=50;maxRetryAttempts=1;disableLoadBalancingForUserAgents=Test User Agent` Test User Agent2`Test User Agent3 `Test User Agent4 ;retrySleep=1000"));" is 328.,909
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDActiveURL,Long Statement,The length of the statement "Assert.assertEquals(provider1.getActiveURL(serviceName1)`((AtomicReference<String>)activeURLField.get(dispatch1)).get());" is 121.,909
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDActiveURL,Long Statement,The length of the statement "Assert.assertEquals(provider2.getActiveURL(serviceName2)`((AtomicReference<String>)activeURLField.get(dispatch2)).get());" is 121.,909
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentNegativeCase,Empty catch clause,The method has an empty catch block.,963
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentNegativeCase,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`"true"`"true"`null`null`null));" is 139.,963
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentNegativeCase,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,963
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentNegativeCase,Long Statement,The length of the statement "Cookie[] cookie=new Cookie[]{new Cookie("KNOX_BACKEND-OOZIE"`"59973e253ae20de796c6ef413608ec1c80fca24310a4cbdecc0ff97aeea55745")};" is 130.,963
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentNegativeCase,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,963
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentNegativeCase,Magic Number,The method contains a magic number: 4L,963
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentConfiguration,Empty catch clause,The method has an empty catch block.,1063
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentConfiguration,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"enableStickySession=true;enableLoadBalancing=true;enabled=true;maxFailoverAttempts=42;failoverSleep=50;maxRetryAttempts=1;disableLoadBalancingForUserAgents=Test User Agent` Test User Agent2`Test User Agent3 `Test User Agent4 ;retrySleep=1000"));" is 326.,1063
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentConfiguration,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,1063
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentConfiguration,Long Statement,The length of the statement "Cookie[] cookie=new Cookie[]{new Cookie("KNOX_BACKEND-OOZIE"`"59973e253ae20de796c6ef413608ec1c80fca24310a4cbdecc0ff97aeea55745")};" is 130.,1063
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentConfiguration,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,1063
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testDisableLBDefaultUserAgentConfiguration,Magic Number,The method contains a magic number: 4L,1063
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testConnectivityActive,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`"true"`null`null`null));" is 137.,1162
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testConnectivityActive,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,1162
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testMarkedFailedWithoutRetry,Empty catch clause,The method has an empty catch block.,1213
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testMarkedFailedWithoutRetry,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"0"`"1000"`null`null`null`null`null`null`null));" is 135.,1213
apache_knox,org.apache.knox.gateway.ha.dispatch,DefaultHaDispatchTest,testMarkedFailedWithoutRetry,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,1213
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatchTest,testHADispatchURL,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`"true"`"true"`null`null`null));" is 139.,61
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatchTest,testHADispatchURL,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getRequestURL()).andReturn(new StringBuffer(provider.getActiveURL(serviceName))).anyTimes();" is 123.,61
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatchTest,testSetCookieHeader,Empty catch clause,The method has an empty catch block.,97
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatchTest,testSetCookieHeader,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`"true"`"true"`null`null`null));" is 139.,97
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatchTest,testSetCookieHeader,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,97
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatchTest,testSetCookieHeader,Long Statement,The length of the statement "EasyMock.replay(filterConfig`servletContext`outboundRequest`inboundRequest`outboundResponse`mockHttpClient`inboundResponse`statusLine`entity`header`context`config);" is 164.,97
apache_knox,org.apache.knox.gateway.ha.dispatch,ConfigurableHADispatchTest,testSetCookieHeader,Magic Number,The method contains a magic number: 4L,97
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributor,contributeProvider,Long Statement,The length of the statement "context.getWebArchive().addAsWebInfResource(new StringAsset(asset)`HaServletContextListener.DESCRIPTOR_DEFAULT_FILE_NAME);" is 122.,63
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributor,finalizeContribution,Long Statement,The length of the statement "context.getWebAppDescriptor().createContextParam().paramName(HaServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME).paramValue(HaServletContextListener.DESCRIPTOR_DEFAULT_LOCATION);" is 188.,138
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,150
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testProviderLevelParams,Long Statement,The length of the statement "providerParams.put("TestRoleOne"`getHaProviderParamValue(false`40`4`"testRoleOne"`"http://host1:2181`http://host2:2181"));" is 122.,72
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testProviderLevelParams,Long Statement,The length of the statement "validateServiceHaConfig(descriptor.getServiceConfig("TestRoleOne")`false`40`4`"testRoleOne"`"http://host1:2181`http://host2:2181");" is 131.,72
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testProviderLevelParams,Magic Number,The method contains a magic number: 40,72
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testProviderLevelParams,Magic Number,The method contains a magic number: 4,72
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testProviderLevelParams,Magic Number,The method contains a magic number: 40,72
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testProviderLevelParams,Magic Number,The method contains a magic number: 4,72
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_NoProviderParams,Long Statement,The length of the statement "validateServiceHaConfig(descriptor.getServiceConfig("TestRoleOne")`true`80`8`"testRoleOneOverride"`"http://host3:2181`http://host4:2181");" is 138.,117
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_NoProviderParams,Magic Number,The method contains a magic number: 80,117
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_NoProviderParams,Magic Number,The method contains a magic number: 8,117
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_SubsetProviderParams,Long Statement,The length of the statement "validateServiceHaConfig(descriptor.getServiceConfig("TestRoleOne")`true`40`4`"testRoleOneOverride"`"http://host3:2181`http://host4:2181");" is 138.,170
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_SubsetProviderParams,Magic Number,The method contains a magic number: 40,170
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_SubsetProviderParams,Magic Number,The method contains a magic number: 4,170
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_SubsetProviderParams,Magic Number,The method contains a magic number: 40,170
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_SubsetProviderParams,Magic Number,The method contains a magic number: 4,170
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Long Statement,The length of the statement "providerParams.put("TestRoleTwo"`getHaProviderParamValue(false`40`4`"testRoleTwo"`"http://host1:2181`http://host2:2181"));" is 122.,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Long Statement,The length of the statement "validateServiceHaConfig(descriptor.getServiceConfig("TestRoleTwo")`true`80`8`"testRoleTwoOverride"`"http://host3:2181`http://host4:2181");" is 138.,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 20,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 2,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 40,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 4,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 2,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 20,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 2,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 80,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,testServiceLevelParamOverrides_MultipleMixed,Magic Number,The method contains a magic number: 8,218
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,getHaProviderParamValue,Long Parameter List,The method has 5 parameters. ,290
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,getHaProviderParamValue,Long Statement,The length of the statement "builder.append(HaServiceConfigConstants.CONFIG_PARAM_ENABLED).append(HaServiceConfigConstants.CONFIG_PAIR_DELIMITER).append(enabled);" is 133.,290
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,getHaProviderParamValue,Long Statement,The length of the statement "builder.append(HaServiceConfigConstants.CONFIG_PAIRS_DELIMITER).append(HaServiceConfigConstants.CONFIG_PARAM_MAX_FAILOVER_ATTEMPTS).append(HaServiceConfigConstants.CONFIG_PAIR_DELIMITER).append(maxFailoverAttempts);" is 215.,290
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,getHaProviderParamValue,Long Statement,The length of the statement "builder.append(HaServiceConfigConstants.CONFIG_PAIRS_DELIMITER).append(HaServiceConfigConstants.CONFIG_PARAM_FAILOVER_SLEEP).append(HaServiceConfigConstants.CONFIG_PAIR_DELIMITER).append(failoverSleep);" is 202.,290
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,getHaProviderParamValue,Long Statement,The length of the statement "builder.append(HaServiceConfigConstants.CONFIG_PAIRS_DELIMITER).append(HaServiceConfigConstants.CONFIG_PARAM_ZOOKEEPER_NAMESPACE).append(HaServiceConfigConstants.CONFIG_PAIR_DELIMITER).append(zooKeeperNamespace);" is 212.,290
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,getHaProviderParamValue,Long Statement,The length of the statement "builder.append(HaServiceConfigConstants.CONFIG_PAIRS_DELIMITER).append(HaServiceConfigConstants.CONFIG_PARAM_ZOOKEEPER_ENSEMBLE).append(HaServiceConfigConstants.CONFIG_PAIR_DELIMITER).append(zooKeeperEnsemble);" is 210.,290
apache_knox,org.apache.knox.gateway.ha.deploy,HaProviderDeploymentContributorTest,validateServiceHaConfig,Long Parameter List,The method has 6 parameters. ,332
apache_knox,org.apache.knox.gateway.service.vault,CredentialResource,getCredentialsList,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,77
apache_knox,org.apache.knox.gateway.service.vault,CredentialResource,getCredentialValueForAlias,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,91
apache_knox,org.apache.knox.gateway.service.config.remote,RemoteConfigurationRegistryClientServiceFactory,newInstance,Long Statement,The length of the statement "ServiceLoader<RemoteConfigurationRegistryClientServiceProvider> providers=ServiceLoader.load(RemoteConfigurationRegistryClientServiceProvider.class);" is 149.,26
apache_knox,org.apache.knox.gateway.service.config.remote,LocalFileSystemRemoteConfigurationRegistryClientService,init,Long Statement,The length of the statement "List<RemoteConfigurationRegistryConfig> registryConfigurations=RemoteConfigurationRegistriesAccessor.getRemoteRegistryConfigurations(config);" is 141.,63
apache_knox,org.apache.knox.gateway.service.config.remote,LocalFileSystemRemoteConfigurationRegistryClientService,createClient,Complex Method,Cyclomatic complexity of the method is 10,90
apache_knox,org.apache.knox.gateway.service.config.remote,LocalFileSystemRemoteConfigurationRegistryClientService,createClient,Long Method,The method has 137 lines of code.,90
apache_knox,org.apache.knox.gateway.service.config.remote,LocalFileSystemRemoteConfigurationRegistryClientService,createClient,Long Statement,The length of the statement "collected.computeIfAbsent(parsed[0].toLowerCase(Locale.ROOT)`s -> new ArrayList<>()).add(parsed[1].toLowerCase(Locale.ROOT));" is 125.,90
apache_knox,org.apache.knox.gateway.service.config.remote,LocalFileSystemRemoteConfigurationRegistryClientService,getACL,Long Statement,The length of the statement "collected.computeIfAbsent(parsed[0].toLowerCase(Locale.ROOT)`s -> new ArrayList<>()).add(parsed[1].toLowerCase(Locale.ROOT));" is 125.,111
apache_knox,org.apache.knox.gateway.service.config.remote.zk,CuratorClientService,init,Long Statement,The length of the statement "List<RemoteConfigurationRegistryConfig> registryConfigs=new ArrayList<>(RemoteConfigurationRegistriesAccessor.getRemoteRegistryConfigurations(config));" is 151.,71
apache_knox,org.apache.knox.gateway.service.config.remote.zk,CuratorClientService,createClient,Long Statement,The length of the statement "CuratorFramework client=CuratorFrameworkFactory.builder().connectString(config.getConnectionString()).retryPolicy(new ExponentialBackoffRetry(1000`3)).aclProvider(aclProvider).build();" is 184.,123
apache_knox,org.apache.knox.gateway.service.config.remote.zk,CuratorClientService,createClient,Magic Number,The method contains a magic number: 1000,123
apache_knox,org.apache.knox.gateway.service.config.remote.zk,CuratorClientService,createClient,Magic Number,The method contains a magic number: 3,123
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfig,RemoteConfigurationRegistryJAASConfig,Long Statement,The length of the statement "final String message=String.format(Locale.ROOT`"%s: %s"`JAAS_CONFIG_ERRROR_PREFIX`System.getProperty(GatewayConfig.KRB5_LOGIN_CONFIG`"Undefined"));" is 147.,70
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfig,validateKeytabFile,Long Statement,The length of the statement "throw new ConfigurationException("The specified keytab file " + keytabFile.getAbsolutePath() + " is either non-existing or cannot be read!");" is 141.,98
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfig,createEntry,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@6fb51ad8,141
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfig,getLoginModuleName,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@360498c4,184
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "final String registryConfigValue=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString();" is 197.,38
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "EasyMock.expect(config.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(REGISTRY_CLIENT_NAME)).anyTimes();" is 132.,38
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testMultipleUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "final String registryConfigValue1=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString();" is 198.,69
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testMultipleUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "EasyMock.expect(config.getRemoteRegistryConfiguration(REGISTRY_CLIENT_NAME_1)).andReturn(registryConfigValue1).anyTimes();" is 122.,69
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testMultipleUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "final String registryConfigValue2=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString();" is 198.,69
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testMultipleUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "EasyMock.expect(config.getRemoteRegistryConfiguration(REGISTRY_CLIENT_NAME_2)).andReturn(registryConfigValue2).anyTimes();" is 122.,69
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testMultipleUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "EasyMock.expect(config.getRemoteRegistryConfigurationNames()).andReturn(Arrays.asList(REGISTRY_CLIENT_NAME_1`REGISTRY_CLIENT_NAME_2)).anyTimes();" is 145.,69
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceUnsecureTest,testMultipleUnsecuredZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "RemoteConfigurationRegistryClientService clientService=RemoteConfigurationRegistryClientServiceFactory.newInstance(config);" is 123.,69
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,setupAndStartSecureTestZooKeeper,Long Statement,The length of the statement "final AppConfigurationEntry[] serverEntries={new AppConfigurationEntry("org.apache.zookeeper.server.auth.DigestLoginModule"`AppConfigurationEntry.LoginModuleControlFlag.REQUIRED`digestOptions)};" is 194.,54
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,initializeTestClientAndZNodes,Long Statement,The length of the statement "CuratorFramework setupClient=CuratorFrameworkFactory.builder().connectString(zkCluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(100`3)).build();" is 163.,95
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,initializeTestClientAndZNodes,Magic Number,The method contains a magic number: 100,95
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,initializeTestClientAndZNodes,Magic Number,The method contains a magic number: 3,95
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,initializeTestClientAndZNodes,Magic Number,The method contains a magic number: 10,95
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Long Parameter List,The method has 5 parameters. ,132
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(credentialAlias)).andReturn(isSecureTest ? digestPassword.toCharArray() : null).anyTimes();" is 151.,132
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Long Statement,The length of the statement "RemoteConfigurationRegistryClientService clientService=RemoteConfigurationRegistryClientServiceFactory.newInstance(config);" is 123.,132
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Empty catch clause,The method has an empty catch block.,157
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Empty catch clause,The method has an empty catch block.,157
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Empty catch clause,The method has an empty catch block.,157
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Long Statement,The length of the statement "c.addEntryListener(path`(cc`p`d) -> listenerLog.add("EXTERNAL: " + p + ":"+ (d != null ? new String(d`StandardCharsets.UTF_8) : "null")));" is 138.,157
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Magic Number,The method contains a magic number: 1000,157
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Magic Number,The method contains a magic number: 1000,157
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceTestBase,doTestZooKeeperClient,Magic Number,The method contains a magic number: 1000,157
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,testZooKeeperDigestContextEntry,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(DIGEST_PWD_ALIAS)).andReturn(DIGEST_PWD.toCharArray()).anyTimes();" is 126.,55
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,testZooKeeperDigestContextEntry,Long Statement,The length of the statement "RemoteConfigurationRegistryJAASConfig jaasConfig=RemoteConfigurationRegistryJAASConfig.configure(registryConfigs`aliasService);" is 127.,55
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,testZooKeeperDigestContextEntry,Long Statement,The length of the statement "validateDigestContext(jaasConfig`ENTRY_NAME`RemoteConfigurationRegistryJAASConfig.digestLoginModules.get("ZOOKEEPER")`DIGEST_PRINCIPAL`DIGEST_PWD);" is 147.,55
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,testZooKeeperMultipleContextEntries,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(DIGEST_PWD_ALIAS)).andReturn(DIGEST_PWD.toCharArray()).anyTimes();" is 126.,116
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,testZooKeeperMultipleContextEntries,Long Statement,The length of the statement "RemoteConfigurationRegistryJAASConfig jaasConfig=RemoteConfigurationRegistryJAASConfig.configure(registryConfigs`aliasService);" is 127.,116
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,testZooKeeperMultipleContextEntries,Long Statement,The length of the statement "validateDigestContext(jaasConfig`DIGEST_ENTRY_NAME`RemoteConfigurationRegistryJAASConfig.digestLoginModules.get("ZOOKEEPER")`DIGEST_PRINCIPAL`DIGEST_PWD);" is 154.,116
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,shouldRaiseAnErrorWithMeaningfulErrorMessageIfAuthLoginConfigCannotBeParsed,Long Statement,The length of the statement "final String jaasConfigFilePath=writeInvalidJaasConf(false`"jaasConfWithInvalidKeytab"`createTempKeytabFile("invalidKeytab"));" is 126.,207
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,writeInvalidJaasConf,Long Statement,The length of the statement "final String jaasConfig="com.sun.security.jgss.initiate {\n" + "com.sun.security.auth.module.Krb5LoginModule required\n" + "renewTGT=false\n"+ "doNotPrompt=true\n"+ "useKeyTab=true\n"+ "keyTab=" + (valid ? "\"" : "") + keytabFileName+ (valid ? "\"" : "")+ "\n"+ "principal=\"knox/myHost@myRealm\"\n"+ "storeKey=true\n"+ "useTicketCache=false;\n"+ "};";" is 352.,245
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,createKerberosConfig,Long Parameter List,The method has 6 parameters. ,297
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,validateDigestContext,Long Parameter List,The method has 5 parameters. ,316
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryJAASConfigTest,validateKerberosContext,Long Parameter List,The method has 6 parameters. ,331
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceSecureTest,testZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "final String registryConfigValue=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString()+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_AUTH_TYPE+ "="+ AUTH_TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_PRINCIPAL+ "="+ PRINCIPAL+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_CREDENTIAL_ALIAS+ "="+ CRED_ALIAS;" is 412.,38
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceSecureTest,testZooKeeperWithSimpleRegistryConfig,Long Statement,The length of the statement "EasyMock.expect(config.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(REGISTRY_CLIENT_NAME)).anyTimes();" is 132.,38
apache_knox,org.apache.knox.gateway.service.config.remote.zk,RemoteConfigurationRegistryClientServiceSecureTest,testZooKeeperWithSingleExternalRegistryConfig,Long Statement,The length of the statement "String registryConfigXML=RemoteRegistryConfigTestUtils.createRemoteConfigRegistriesXML(Collections.singleton(registryConfigProps));" is 131.,74
apache_knox,org.apache.knox.gateway.service.config.remote.config,RemoteConfigurationRegistriesAccessor,getRemoteRegistryConfigurations,Long Identifier,The length of the identifier remoteConfigRegistryConfigFilename is 34.,33
apache_knox,org.apache.knox.gateway.service.config.remote.config,RemoteConfigurationRegistriesAccessor,getRemoteRegistryConfigurations,Long Identifier,The length of the identifier remoteConfigRegistryConfigFile is 30.,33
apache_knox,org.apache.knox.gateway.service.config.remote.config,RemoteConfigurationRegistriesAccessor,getRemoteRegistryConfigurations,Long Identifier,The length of the field XML_CONFIG_REFERENCE_SYSTEM_PROPERTY_NAME is 41.,33
apache_knox,org.apache.knox.gateway.service.config.remote.config,DefaultRemoteConfigurationRegistries,extractConfigForRegistry,Long Statement,The length of the statement "result.setBackwardsCompatible(Boolean.valueOf(properties.getOrDefault(GatewayConfig.ZOOKEEPER_REMOTE_CONFIG_REGISTRY_BACKWARDS_COMPATIBLE`"false")));" is 149.,48
apache_knox,org.apache.knox.gateway.service.config.remote.config,RemoteConfigurationRegistryConfigParserTest,testExternalXMLParsing,Long Statement,The length of the statement "List<RemoteConfigurationRegistryConfig> configs=RemoteConfigurationRegistriesParser.getConfig(registryConfigFile.getAbsolutePath());" is 132.,35
apache_knox,org.apache.knox.gateway.service.config.remote.config,RemoteConfigurationRegistryConfigParserTest,validateParsedRegistryConfiguration,Long Statement,The length of the statement "assertEquals(Boolean.valueOf(expected.get(RemoteRegistryConfigTestUtils.PROPERTY_USE_TICKET_CACHE))`config.isUseTicketCache());" is 127.,92
apache_knox,org.apache.knox.gateway.service.config.remote.config,DefaultRemoteConfigurationRegistriesTest,validateRemoteRegistryConfig,Long Statement,The length of the statement "assertEquals(Boolean.valueOf((String)expected.get(GatewayConfig.REMOTE_CONFIG_REGISTRY_USE_KEYTAB))`registryConfig.isUseKeyTab());" is 130.,161
apache_knox,org.apache.knox.gateway.service.config.remote.config,DefaultRemoteConfigurationRegistriesTest,validateRemoteRegistryConfig,Long Statement,The length of the statement "assertEquals(Boolean.valueOf((String)expected.get(GatewayConfig.REMOTE_CONFIG_REGISTRY_USE_TICKET_CACHE))`registryConfig.isUseTicketCache());" is 141.,161
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistriesXML,Long Statement,The length of the statement "result.append(createRemoteConfigRegistryXMLWithKerberosAuth(props.get(PROPERTY_TYPE)`props.get(PROPERTY_NAME)`props.get(PROPERTY_ADDRESS)`props.get(PROPERTY_PRINCIPAL)`props.get(PROPERTY_KEYTAB)`Boolean.valueOf(props.get(PROPERTY_USE_KEYTAB))`Boolean.valueOf(props.get(PROPERTY_USE_TICKET_CACHE))));" is 299.,36
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistriesXML,Long Statement,The length of the statement "result.append(createRemoteConfigRegistryXMLWithDigestAuth(props.get(PROPERTY_TYPE)`props.get(PROPERTY_NAME)`props.get(PROPERTY_ADDRESS)`props.get(PROPERTY_PRINCIPAL)`props.get(PROPERTY_CRED_ALIAS)));" is 199.,36
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistriesXML,Long Statement,The length of the statement "result.append(createRemoteConfigRegistryXMLNoAuth(props.get(PROPERTY_TYPE)`props.get(PROPERTY_NAME)`props.get(PROPERTY_ADDRESS)));" is 130.,36
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistriesXML,Magic Number,The method contains a magic number: 128,36
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistryXMLWithKerberosAuth,Long Parameter List,The method has 7 parameters. ,68
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistryXMLWithKerberosAuth,Long Statement,The length of the statement "return " <remote-configuration-registry>\n" + " <name>" + name + "</name>\n"+ " <type>"+ type+ "</type>\n"+ " <address>"+ address+ "</address>\n"+ " <secure>true</secure>\n"+ " <auth-type>"+ "Kerberos"+ "</auth-type>\n"+ " <principal>"+ principal+ "</principal>\n"+ " <keytab>"+ keyTab+ "</keytab>\n"+ " <use-keytab>"+ userKeyTab+ "</use-keytab>\n"+ " <use-ticket-cache>"+ useTicketCache+ "</use-ticket-cache>\n"+ " </remote-configuration-registry>\n";" is 452.,68
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistryXMLWithDigestAuth,Long Parameter List,The method has 5 parameters. ,88
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistryXMLWithDigestAuth,Long Statement,The length of the statement "return " <remote-configuration-registry>\n" + " <name>" + name + "</name>\n"+ " <type>"+ type+ "</type>\n"+ " <address>"+ address+ "</address>\n"+ " <secure>true</secure>\n"+ " <auth-type>"+ "Digest"+ "</auth-type>\n"+ " <principal>"+ principal+ "</principal>\n"+ " <credential-alias>"+ credentialAlias+ "</credential-alias>\n"+ " </remote-configuration-registry>\n";" is 367.,88
apache_knox,org.apache.knox.gateway.service.config.remote.util,RemoteRegistryConfigTestUtils,createRemoteConfigRegistryXMLNoAuth,Long Statement,The length of the statement "return " <remote-configuration-registry>\n" + " <name>" + name + "</name>\n"+ " <type>"+ type+ "</type>\n"+ " <address>"+ address+ "</address>\n"+ " </remote-configuration-registry>\n";" is 185.,105
apache_knox,org.apache.knox.gateway.util.urltemplate,Parser,fixNakedAuthority,Complex Conditional,The conditional expression builder.getHasScheme() && !builder.getHasAuthority() && !builder.getIsAbsolute()&& !builder.getIsDirectory()&& (builder.getPath().size() == 1)&& !builder.getHasQuery()&& !builder.getHasFragment() is complex.,122
apache_knox,org.apache.knox.gateway.util.urltemplate,Parser,fixNakedAuthority,Long Statement,The length of the statement "if (builder.getHasScheme() && !builder.getHasAuthority() && !builder.getIsAbsolute()&& !builder.getIsDirectory()&& (builder.getPath().size() == 1)&& !builder.getHasQuery()&& !builder.getHasFragment()) {" is 202.,122
apache_knox,org.apache.knox.gateway.util.urltemplate,Parser,consumeAuthorityToken,Complex Method,Cyclomatic complexity of the method is 8,175
apache_knox,org.apache.knox.gateway.util.urltemplate,Parser,parseTemplateToken,Complex Conditional,The conditional expression (b > 0) && (e > 0) && (e > b) is complex.,296
apache_knox,org.apache.knox.gateway.util.urltemplate,Segment,createRegex,Complex Method,Cyclomatic complexity of the method is 8,276
apache_knox,org.apache.knox.gateway.util.urltemplate,Segment,createRegex,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@1c565a8a,276
apache_knox,org.apache.knox.gateway.util.urltemplate,Matcher,pickBestMatch,Complex Conditional,The conditional expression (bestPath == null) || (pathNode.depth > bestPath.depth) || ((pathNode.depth == bestPath.depth) && (pathNode.getType() < bestPath.getType())) is complex.,208
apache_knox,org.apache.knox.gateway.util.urltemplate,Matcher,pickBestMatch,Long Statement,The length of the statement "if ((bestPath == null) || (pathNode.depth > bestPath.depth) || ((pathNode.depth == bestPath.depth) && (pathNode.getType() < bestPath.getType()))) {" is 147.,208
apache_knox,org.apache.knox.gateway.util.urltemplate,Matcher,pickBestQueryMatch,Complex Conditional,The conditional expression (bestNode == null || queryMatchCount > bestMatchCount) && (matchesNamedQueries && matchesExtraQuery) is complex.,242
apache_knox,org.apache.knox.gateway.util.urltemplate,Matcher,pickBestQueryMatch,Long Statement,The length of the statement "boolean matchesExtraQuery=((extra == null) || (Segment.GLOB_PATTERN.equals(extra.getQueryName())) || (input.getQuery().size() > nodeQuerySize));" is 144.,242
apache_knox,org.apache.knox.gateway.util.urltemplate,Matcher,createMatch,Complex Method,Cyclomatic complexity of the method is 13,278
apache_knox,org.apache.knox.gateway.util.urltemplate,Rewriter,rewrite,Long Parameter List,The method has 5 parameters. ,40
apache_knox,org.apache.knox.gateway.util.urltemplate,Function,Function,Complex Conditional,The conditional expression "$".equals(token) || ")".equals(token) || "]".equals(token) is complex.,37
apache_knox,org.apache.knox.gateway.util.urltemplate,Function,Function,Complex Conditional,The conditional expression "$".equals(token) || "(".equals(token) || ")".equals(token)|| "[".equals(token)|| "]".equals(token) is complex.,37
apache_knox,org.apache.knox.gateway.util.urltemplate,Function,Function,Complex Conditional,The conditional expression "$".equals(token) || "(".equals(token) || ")".equals(token)|| "[".equals(token)|| "]".equals(token) is complex.,37
apache_knox,org.apache.knox.gateway.util.urltemplate,Function,Function,Complex Method,Cyclomatic complexity of the method is 16,37
apache_knox,org.apache.knox.gateway.util.urltemplate,Builder,build,Long Statement,The length of the statement "return new Template(original`scheme`hasScheme`username`password`host`port`hasAuthority`isAuthorityOnly`path`isAbsolute`isDirectory`query`extra`hasQuery`fragment`hasFragment);" is 174.,166
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandScheme,Long Parameter List,The method has 5 parameters. ,69
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandAuthority,Long Parameter List,The method has 5 parameters. ,77
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandPath,Complex Method,Cyclomatic complexity of the method is 10,104
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandPath,Long Parameter List,The method has 5 parameters. ,104
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandQuery,Long Parameter List,The method has 5 parameters. ,156
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandExplicitQuery,Complex Method,Cyclomatic complexity of the method is 11,166
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandExplicitQuery,Long Parameter List,The method has 6 parameters. ,166
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandExplicitQuery,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@10f138c2,166
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandExtraQuery,Long Parameter List,The method has 5 parameters. ,204
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandFragment,Long Parameter List,The method has 5 parameters. ,269
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandSingleValue,Complex Method,Cyclomatic complexity of the method is 8,276
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandSingleValue,Long Parameter List,The method has 5 parameters. ,276
apache_knox,org.apache.knox.gateway.util.urltemplate,Expander,expandSingleValue,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@57d593de,276
apache_knox,org.apache.knox.gateway.util.urltemplate,Query,hashCode,Magic Number,The method contains a magic number: 31,62
apache_knox,org.apache.knox.gateway.util.urltemplate,Template,Template,Long Parameter List,The method has 17 parameters. ,45
apache_knox,org.apache.knox.gateway.util.urltemplate,Template,buildAuthority,Complex Method,Cyclomatic complexity of the method is 8,160
apache_knox,org.apache.knox.gateway.util.urltemplate,Template,buildPath,Complex Conditional,The conditional expression isDirectory && (!isAbsolute || !path.isEmpty()) is complex.,201
apache_knox,org.apache.knox.gateway.util.urltemplate,Template,buildQuery,Complex Method,Cyclomatic complexity of the method is 8,232
apache_knox,org.apache.knox.gateway.util.urltemplate,TemplateTest,testParseNonUrlKnox310,Long Statement,The length of the statement "input="/var/lib/oozie/*.jar`/usr/lib/hadoop/client/*.jar`/usr/lib/oozie/libserver/*.jar`${catalina.home}/lib`${catalina.home}/lib/*.jar";" is 137.,36
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testWildcardCharacterInInputTemplate,Long Statement,The length of the statement "inputTemplate=Parser.parseLiteral("https://localhost:8443/gateway/sandbox/hbase/test_table/test_row/family1:row2_col1`family2/0`9223372036854775807?v=1");" is 154.,177
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testWildcardCharacterInInputTemplate,Long Statement,The length of the statement "inputTemplate=Parser.parseLiteral("https://localhost:8443/gateway/sandbox/hbase/test_table/*/family1:row2_col1`family2/0`9223372036854775807?v=1");" is 147.,177
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testWildcardCharacterInInputTemplate,Long Statement,The length of the statement "inputTemplate=Parser.parseLiteral("https://localhost:8443/gateway/sandbox/hbase/test_table/*/family1:row2_col1`family2/0`9223372036854775807?v=1");" is 147.,177
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testQueryHandling,Long Method,The method has 111 lines of code.,360
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testQueryHandling,Long Statement,The length of the statement "assertThat("Should not have extracts any parameters since pattern template didn't contain {}"`match.getParams().resolve("query")`nullValue());" is 142.,360
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testQueryHandling,Magic Number,The method contains a magic number: 2,360
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testQueryHandling,Magic Number,The method contains a magic number: 2,360
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testFullUrlExtraction,Long Statement,The length of the statement "template=Parser.parseTemplate("{scheme}://{username}:{password}@{host}:{port}/{root}/{path}/{file}?queryA={paramA}&queryB={paramB}#{fragment}");" is 144.,754
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testFullUrlExtraction,Magic Number,The method contains a magic number: 11,754
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testMultipleDoubleStarPathMatching,Long Statement,The length of the statement "input=Parser.parseLiteral("http://localhost:53221/gateway/cluster/webhdfs/v1/tmp/GatewayWebHdfsFuncTest/testBasicHdfsUseCase/dir?user.name=hdfs&op=MKDIRS");" is 156.,793
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testPathExtraction,Magic Number,The method contains a magic number: 2,835
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testPathExtraction,Magic Number,The method contains a magic number: 2,835
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testPathExtraction,Magic Number,The method contains a magic number: 2,835
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testPathExtraction,Magic Number,The method contains a magic number: 2,835
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testPathExtraction,Magic Number,The method contains a magic number: 2,835
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testBugKnox599,Long Statement,The length of the statement "input=Parser.parseLiteral("http://kminder-os-u14-23-knoxha-150922-1352-2.novalocal:1022/gateway/sandbox/webhdfs/v1/user/hrt_qa/knox-ha/knox_webhdfs_client_dir/test_file?op=CREATE&delegation=XXX&namenoderpcaddress=nameservice&createflag=&createparent=true&overwrite=true");" is 272.,976
apache_knox,org.apache.knox.gateway.util.urltemplate,MatcherTest,testBugKnox599,Long Statement,The length of the statement "assertThat(expandedStr`containsString("http://host:42/root/webhdfs/v1/user/hrt_qa/knox-ha/knox_webhdfs_client_dir/test_file?"));" is 128.,976
apache_knox,org.apache.knox.gateway.util.urltemplate,SegmentTest,testCreateRegex,Long Statement,The length of the statement "String input="/var/lib/oozie/*.jar`/usr/lib/hadoop/client/*.jar`/usr/lib/oozie/libserver/*.jar`${catalina.home}/lib`${catalina.home}/lib/*.jar";" is 144.,107
apache_knox,org.apache.knox.gateway.util.urltemplate,SegmentTest,testCreateRegex,Long Statement,The length of the statement "String expect="/var/lib/oozie/.*\\.jar`/usr/lib/hadoop/client/.*\\.jar`/usr/lib/oozie/libserver/.*\\.jar`\\$\\{catalina\\.home\\}/lib`\\$\\{catalina\\.home\\}/lib/.*\\.jar";" is 173.,107
apache_knox,org.apache.knox.gateway.util.urltemplate,ExpanderTest,testCompleteUrl,Long Statement,The length of the statement "assertThat(expanded.toString()`equalTo("http://horton:hadoop@hortonworks.com:8888/top/mid/bot/file?query=new-value#fragment"));" is 127.,53
apache_knox,org.apache.knox.gateway.util.urltemplate,ExpanderTest,testExtraParamHandling,Long Statement,The length of the statement "assertThat(expandedUri.toString()`equalTo("schemeA://host/pathA/pathB?host=hostA&query=queryA&query=queryB&extra=extraA"));" is 123.,287
apache_knox,org.apache.knox.gateway.util.urltemplate,ExpanderTest,testExtraParamHandling,Long Statement,The length of the statement "assertThat(expandedUri.toString()`equalTo("schemeA://host/pathA/pathB?server=hostA&query=queryA&query=queryB&extra=extraA"));" is 125.,287
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testServiceRegistryHostmapUserCase,Long Statement,The length of the statement "EasyMock.expect(evaluator.evaluate("hostmap"`Collections.singletonList("internal-host"))).andReturn(Collections.singletonList("external-host")).anyTimes();" is 155.,103
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteUrlWithHttpServletRequestAndFilterConfig,Long Statement,The length of the statement "EasyMock.expect(request.getParameterValues("expect-queryParam-name")).andReturn(new String[]{"expect-queryParam-value"}).anyTimes();" is 132.,167
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteUrlWithHttpServletRequestAndFilterConfig,Long Statement,The length of the statement "expectOutput=new URI("http://filter-queryParam-value/gatewaycluster/webhdfs/v1/test/file?op=CREATE&user.name=hdfs&overwrite=false");" is 132.,167
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteUrlWithHttpServletRequestAndFilterConfig,Long Statement,The length of the statement "sourcePattern=Parser.parseTemplate("*://*:*/webhdfs/v1/{path=**}?op={op=*}&user.name={username=*}&overwrite={overwrite=*}");" is 124.,167
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteUrlWithHttpServletRequestAndFilterConfig,Long Statement,The length of the statement "targetPattern=Parser.parseTemplate("http://{filter-queryParam-name}/gatewaycluster/webhdfs/v1/{path=**}?op={op}&user.name={username}&overwrite={overwrite}");" is 157.,167
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteNameNodeLocationResponseHeader,Long Statement,The length of the statement "actualInput=new URI("http://vm.local:50075/webhdfs/v1/tmp/GatewayWebHdfsFuncTest/dirA700/fileA700?op=CREATE&user.name=hdfs&overwrite=false&permission=700");" is 156.,279
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteNameNodeLocationResponseHeader,Long Statement,The length of the statement "assertThat(actualString`containsString("http://gw:8888/gateway/cluster/webhdfs/data/v1/tmp/GatewayWebHdfsFuncTest/dirA700/fileA700?"));" is 135.,279
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteDataNodeLocationResponseHeader,Long Statement,The length of the statement "actualInput=new URI("/webhdfs/data/v1/tmp/GatewayWebHdfsFuncTest/dirA700/fileA700?host=vm.local&port=50075&op=CREATE&user.name=hdfs&overwrite=false&permission=700");" is 165.,308
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,testRewriteDataNodeLocationResponseHeader,Long Statement,The length of the statement "assertThat(actualString`containsString("http://vm.local:50075/webhdfs/v1/tmp/GatewayWebHdfsFuncTest/dirA700/fileA700?"));" is 121.,308
apache_knox,org.apache.knox.gateway.util.urltemplate,RewriterTest,getParameters,Long Statement,The length of the statement "final String value=idx > 0 && pair.length() > idx + 1 ? URLDecoder.decode(pair.substring(idx + 1)`StandardCharsets.UTF_8.name()) : "";" is 134.,368
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,assertBasics,Long Parameter List,The method has 6 parameters. ,36
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,assertPath,Long Statement,The length of the statement "assertThat("Incorrect template value pattern."`segment.getFirstValue().getToken().getEffectivePattern()`is(valuePattern));" is 122.,50
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,assertPath,Long Parameter List,The method has 7 parameters. ,60
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,assertQuery,Long Parameter List,The method has 7 parameters. ,87
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testCompleteUrl,Magic Number,The method contains a magic number: 3,104
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testCompleteUrl,Magic Number,The method contains a magic number: 2,104
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testTemplates,Magic Number,The method contains a magic number: 2,126
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testTemplates,Magic Number,The method contains a magic number: 2,126
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testTemplates,Magic Number,The method contains a magic number: 2,126
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Long Method,The method has 127 lines of code.,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testStaticPatterns,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testEncodedChar,Magic Number,The method contains a magic number: 2,348
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testGlobPattern,Magic Number,The method contains a magic number: 2,432
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testEdgeCases,Long Method,The method has 188 lines of code.,680
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testQueryNameWithoutValue,Long Statement,The length of the statement "text="http://localhost:62142/gateway/cluster/webhdfs/data/v1/tmp/GatewayWebHdfsFuncTest/testBasicHdfsUseCase/dir/file?aG9zdD1sb2NhbGhvc3QmcG9ydD02MjEzOSZvcD1DUkVBVEUmdXNlci5uYW1lPWhkZnM";" is 187.,1042
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testQueryNameWithoutValue,Long Statement,The length of the statement "assertThat(template.getQuery().get("aG9zdD1sb2NhbGhvc3QmcG9ydD02MjEzOSZvcD1DUkVBVEUmdXNlci5uYW1lPWhkZnM")`notNullValue());" is 122.,1042
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testQueryNameWithoutValue,Long Statement,The length of the statement "assertThat(string`is("http://localhost:62142/gateway/cluster/webhdfs/data/v1/tmp/GatewayWebHdfsFuncTest/testBasicHdfsUseCase/dir/file?aG9zdD1sb2NhbGhvc3QmcG9ydD02MjEzOSZvcD1DUkVBVEUmdXNlci5uYW1lPWhkZnM"));" is 205.,1042
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testQueryNameWithoutValue,Long Statement,The length of the statement "text="http://localhost:62142/gateway/cluster/webhdfs/data/v1/tmp/GatewayWebHdfsFuncTest/testBasicHdfsUseCase/dir/file?aG9zdD1sb2NhbGhvc3QmcG9ydD02MjEzOSZvcD1DUkVBVEUmdXNlci5uYW1lPWhkZnM=";" is 188.,1042
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testQueryNameWithoutValue,Long Statement,The length of the statement "assertThat(template.getQuery().get("aG9zdD1sb2NhbGhvc3QmcG9ydD02MjEzOSZvcD1DUkVBVEUmdXNlci5uYW1lPWhkZnM")`notNullValue());" is 122.,1042
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testQueryNameWithoutValue,Long Statement,The length of the statement "assertThat(string`is("http://localhost:62142/gateway/cluster/webhdfs/data/v1/tmp/GatewayWebHdfsFuncTest/testBasicHdfsUseCase/dir/file?aG9zdD1sb2NhbGhvc3QmcG9ydD02MjEzOSZvcD1DUkVBVEUmdXNlci5uYW1lPWhkZnM"));" is 205.,1042
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testBugKnox599,Long Statement,The length of the statement "input=Parser.parseTemplate("http://kminder-os-u14-23-knoxha-150922-1352-2.novalocal:1022/gateway/sandbox/webhdfs/v1/user/hrt_qa/knox-ha/knox_webhdfs_client_dir/test_file?op=CREATE&delegation=XXX&namenoderpcaddress=nameservice&createflag=&createparent=true&overwrite=true");" is 273.,1276
apache_knox,org.apache.knox.gateway.util.urltemplate,ParserTest,testBugKnox599,Long Statement,The length of the statement "input=Parser.parseTemplate("http://kminder-os-u14-23-knoxha-150922-1352-2.novalocal:1022/gateway/sandbox/webhdfs/v1/user/hrt_qa/knox-ha/knox_webhdfs_client_dir/test_file?op=CREATE&delegation=XXX&namenoderpcaddress=nameservice&createflag&createparent=true&overwrite=true");" is 272.,1276
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,88
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapFunctionProcessorTest,testBasicUseCase,Long Statement,The length of the statement "EasyMock.expect(environment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 124.,65
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapFunctionProcessorTest,testBasicUseCase,Long Statement,The length of the statement "EasyMock.expect(environment.resolve("cluster.name")).andReturn(Collections.singletonList("test-cluster-name")).anyTimes();" is 122.,65
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapFunctionProcessorTest,testHdfsUseCase,Long Statement,The length of the statement "Template input=Parser.parseLiteral("test-scheme://test-external-host:42/test-path/test-file?test-name-1=test-value-1&test-name-2=test-value-2");" is 144.,100
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapFunctionProcessorTest,testHdfsUseCase,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapFunctionProcessorTest,testQueryToPathRewriteWithFunction,Long Statement,The length of the statement "Template input=Parser.parseLiteral("test-scheme://test-external-host:42/test-path/test-file?qp1=qp1-val&qp2=qp2-val&test-name-1=test-value-1&test-name-2=test-value-2");" is 168.,133
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapFunctionProcessorTest,testQueryToPathRewriteWithFunction,Magic Number,The method contains a magic number: 3,133
apache_knox,org.apache.knox.gateway.hostmap.impl,HostmapFunctionProcessorTest,testUnmappedUseCase,Long Statement,The length of the statement "Template input=Parser.parseLiteral("test-scheme://test-inbound-unmapped-host:42/test-path/test-file?test-name-1=test-value-1&test-name-2=test-value-2");" is 152.,166
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationAsserterDeploymentContributor,contributeProvider,Long Identifier,The length of the field GROUP_PRINCIPAL_MAPPING_PARAM_NAME is 34.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationAsserterDeploymentContributor,contributeProvider,Long Statement,The length of the statement "context.getWebAppDescriptor().createContextParam().paramName(GROUP_PRINCIPAL_MAPPING_PARAM_NAME).paramValue(groupMappings);" is 123.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilter,wrapHttpServletRequest,Long Statement,The length of the statement "return new NoImpersonationAsserterRequestWrapper((HttpServletRequest)request`mappedPrincipalName`impersonationParamsList);" is 122.,47
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testInitParameters,Long Statement,The length of the statement "String username=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 123.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 121.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 130.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testInitParameters,Long Statement,The length of the statement "String[] mappedGroups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 139.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 121.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 130.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testInitParameters,Long Statement,The length of the statement "mappedGroups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 130.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testContextParameters,Long Statement,The length of the statement "String username=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 123.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testContextParameters,Long Statement,The length of the statement "String[] groups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 133.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 122.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 131.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testContextParameters,Long Statement,The length of the statement "groups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 124.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 122.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 131.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationHttpServletRequestWrapperTest,testNoUserNameInPostMethod,Long Statement,The length of the statement "String inputBody="jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 314.,43
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationHttpServletRequestWrapperTest,testNoUserNameInPostMethod,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,43
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationHttpServletRequestWrapperTest,testNoUserNameInPostMethodWithoutEncoding,Long Statement,The length of the statement "String inputBody="jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 314.,60
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationHttpServletRequestWrapperTest,testNoUserNameInPostMethodWithoutEncoding,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,60
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationHttpServletRequestWrapperTest,testOverwriteUserNameInPostMethod,Long Statement,The length of the statement "String inputBody="user.name=input-user&jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 335.,77
apache_knox,org.apache.knox.gateway.identityasserter.filter,NoImpersonationHttpServletRequestWrapperTest,testOverwriteUserNameInPostMethod,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,77
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testInsertUserNameInPostMethod,Long Statement,The length of the statement "String inputBody="jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 314.,52
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testInsertUserNameInPostMethod,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,52
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testInsertUserNameInPostMethodWithoutEncoding,Long Statement,The length of the statement "String inputBody="jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 314.,69
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testInsertUserNameInPostMethodWithoutEncoding,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,69
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testInsertUserNameInPostMethodWithIso88591Encoding,Long Statement,The length of the statement "String inputBody="jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 314.,85
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testInsertUserNameInPostMethodWithIso88591Encoding,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,85
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testOverwriteUserNameInPostMethod,Long Statement,The length of the statement "String inputBody="user.name=input-user&jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 335.,102
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testOverwriteUserNameInPostMethod,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,102
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testRemoveImpersonationParam,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,120
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testRemoveImpersonationParam,Long Statement,The length of the statement "IdentityAsserterHttpServletRequestWrapper wrapper=new IdentityAsserterHttpServletRequestWrapper(request`"output-user"`Arrays.asList("DelegationUID"));" is 150.,120
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testIngoreNonFormBody,Long Statement,The length of the statement "String inputBody="user.name=input-user&jar=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaWebHCat%2Fhadoop-examples.jar&class=org.apache.org.apache.hadoop.examples.WordCount&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Finput&arg=%2Ftmp%2FGatewayWebHdfsFuncTest%2FtestJavaMapReduceViaTempleton%2Foutput";" is 335.,140
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAssertionHttpServletRequestWrapperTest,testIngoreNonFormBody,Long Statement,The length of the statement "request.setInputStream(new MockServletInputStream(new ByteArrayInputStream(inputBody.getBytes(StandardCharsets.UTF_8))));" is 121.,140
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,setUp,Long Statement,The length of the statement "@Override protected void continueChainAsPrincipal( HttpServletRequestWrapper request` ServletResponse response` FilterChain chain` String mappedPrincipalName` String[] groups) throws IOException` ServletException {" is 214.,56
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,setUp,Long Statement,The length of the statement "assertEquals("Groups should not have duplicates: " + Arrays.toString(groups)`new HashSet<>(Arrays.asList(groups)).size()`groups.length);" is 136.,56
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,setUp,Magic Number,The method contains a magic number: 4,56
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,mapGroupPrincipals,Magic Number,The method contains a magic number: 4,65
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,continueChainAsPrincipal,Long Parameter List,The method has 5 parameters. ,82
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,continueChainAsPrincipal,Long Statement,The length of the statement "assertEquals("Groups should not have duplicates: " + Arrays.toString(groups)`new HashSet<>(Arrays.asList(groups)).size()`groups.length);" is 136.,82
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,testSimpleFilter,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter(CommonIdentityAssertionFilter.GROUP_PRINCIPAL_MAPPING)).andReturn("*=everyone;lmccay=test-virtual-group").once();" is 153.,93
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,testSimpleFilter,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter(CommonIdentityAssertionFilter.PRINCIPAL_MAPPING)).andReturn("ljm=lmccay;").once();" is 122.,93
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,testSimpleFilter,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameterNames()).andReturn(Collections.enumeration(Arrays.asList(CommonIdentityAssertionFilter.GROUP_PRINCIPAL_MAPPING`CommonIdentityAssertionFilter.PRINCIPAL_MAPPING`CommonIdentityAssertionFilter.VIRTUAL_GROUP_MAPPING_PREFIX + "test-virtual-group"))).anyTimes();" is 294.,93
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,testSimpleFilter,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter(CommonIdentityAssertionFilter.VIRTUAL_GROUP_MAPPING_PREFIX + "test-virtual-group")).andReturn("(and (username 'lmccay') (and (member 'users') (member 'admin')))").anyTimes();" is 214.,93
apache_knox,org.apache.knox.gateway.identityasserter.filter,CommonIdentityAssertionFilterTest,testSimpleFilter,Magic Number,The method contains a magic number: 2,93
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAsserterDeploymentContributor,contributeProvider,Long Identifier,The length of the field GROUP_PRINCIPAL_MAPPING_PARAM_NAME is 34.,37
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAsserterDeploymentContributor,contributeProvider,Long Statement,The length of the statement "context.getWebAppDescriptor().createContextParam().paramName(GROUP_PRINCIPAL_MAPPING_PARAM_NAME).paramValue(groupMappings);" is 123.,37
apache_knox,org.apache.knox.gateway.identityasserter.filter,IdentityAsserterDeploymentContributor,contributeProvider,Long Statement,The length of the statement "provider.getParamsList().stream().filter(each -> each.getName().startsWith(VIRTUAL_GROUP_MAPPING_PREFIX)).forEach(each -> context.getWebAppDescriptor().createContextParam().paramName(each.getName()).paramValue(each.getValue()));" is 228.,37
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testInitParameters,Long Statement,The length of the statement "String username=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 123.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 121.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 130.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testInitParameters,Long Statement,The length of the statement "String[] mappedGroups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 139.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 121.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testInitParameters,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 130.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testInitParameters,Long Statement,The length of the statement "mappedGroups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 130.,39
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testContextParameters,Long Statement,The length of the statement "String username=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 123.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testContextParameters,Long Statement,The length of the statement "String[] groups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 133.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 122.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 131.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testContextParameters,Long Statement,The length of the statement "groups=filter.mapGroupPrincipals(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName()`subject);" is 124.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("principal.mapping")).andReturn("lmccay`kminder=hdfs;newuser=mapred").anyTimes();" is 122.,109
apache_knox,org.apache.knox.gateway.identityasserter.filter,DefaultIdentityAssertionFilterTest,testContextParameters,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("group.principal.mapping")).andReturn("kminder=group1;lmccay=mrgroup`mrducks").anyTimes();" is 131.,109
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaBaseDispatcher,writeOutboundResponse,Magic Number,The method contains a magic number: 403,97
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaBaseDispatcher,writeOutboundResponse,Magic Number,The method contains a magic number: 307,97
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaBaseDispatcher,failoverRequest,Long Parameter List,The method has 5 parameters. ,116
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailure,Empty catch clause,The method has an empty catch block.,57
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailure,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`null`null`null`null));" is 135.,57
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailure,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,57
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailure,Magic Number,The method contains a magic number: 1000,57
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailover,Empty catch clause,The method has an empty catch block.,128
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailover,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`null`null`null`null));" is 135.,128
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailover,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,128
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,testConnectivityFailover,Magic Number,The method contains a magic number: 1000,128
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,getStatusLine,Magic Number,The method contains a magic number: 307,215
apache_knox,org.apache.knox.gateway.rm.dispatch,RMHaDispatchTest,getStatusLine,Magic Number,The method contains a magic number: 307,215
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.log4j,Log4jMessageLogger,log,Long Parameter List,The method has 5 parameters. ,39
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.log4j,Log4jMessageLogger,toLevel,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@4505f358,44
apache_knox,org.apache.knox.gateway.service.test,ServiceTestWrapperMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,53
apache_knox,org.apache.knox.gateway.service.test,ServiceTestWrapperMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,58
apache_knox,org.apache.knox.gateway.service.test,ServiceTestResource,serviceTest,Complex Method,Cyclomatic complexity of the method is 9,62
apache_knox,org.apache.knox.gateway.service.test,ServiceTestResource,serviceTest,Long Statement,The length of the statement "String base64EncodedUserPass=Base64.getEncoder().encodeToString((username + ":" + password).getBytes(StandardCharsets.UTF_8));" is 126.,62
apache_knox,org.apache.knox.gateway.service.test,ServiceTestResource,serviceTest,Long Statement,The length of the statement "String contentType=(res.getEntity().getContentType() != null) ? res.getEntity().getContentType().toString() : "No-contenttype";" is 127.,62
apache_knox,org.apache.knox.gateway.service.test,ServiceTestResource,getTopology,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,160
apache_knox,org.apache.knox.gateway.service.test,ServiceTestResource,getServiceTestURLs,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,180
apache_knox,org.apache.knox.gateway.identityasserter.concat.filter,ConcatIdentityAssertionFilterTest,testPrefixAndSuffix,Long Statement,The length of the statement "String username=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 123.,36
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifier,init,Long Identifier,The length of the field privilegedUserConcurrentSessionLimit is 36.,45
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifier,init,Long Identifier,The length of the field nonPrivilegedUserConcurrentSessionLimit is 39.,45
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifier,privilegedUserCheckLimitReached,Long Identifier,The length of the field privilegedUserConcurrentSessionLimit is 36.,71
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifier,privilegedUserCheckLimitReached,Long Statement,The length of the statement "return privilegedUsers.contains(username) && (concurrentSessionCounter.get(username) >= privilegedUserConcurrentSessionLimit);" is 126.,71
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifier,nonPrivilegedUserCheckLimitReached,Long Identifier,The length of the field nonPrivilegedUserConcurrentSessionLimit is 39.,78
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifier,nonPrivilegedUserCheckLimitReached,Long Statement,The length of the statement "return nonPrivilegedUsers.contains(username) && (concurrentSessionCounter.get(username) >= nonPrivilegedUserConcurrentSessionLimit);" is 132.,78
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInNeitherOfTheGroups,Magic Number,The method contains a magic number: 3,50
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInNeitherOfTheGroups,Magic Number,The method contains a magic number: 2,50
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInNeitherOfTheGroups,Magic Number,The method contains a magic number: 4,50
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInBothOfTheGroups,Long Statement,The length of the statement "GatewayConfig config=mockConfig(new HashSet<>(Arrays.asList("admin"`"tom"))`new HashSet<>(Arrays.asList("tom"`"guest"))`3`2);" is 125.,59
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInBothOfTheGroups,Magic Number,The method contains a magic number: 3,59
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInBothOfTheGroups,Magic Number,The method contains a magic number: 2,59
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInBothOfTheGroups,Magic Number,The method contains a magic number: 3,59
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsInBothOfTheGroups,Magic Number,The method contains a magic number: 4,59
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsPrivileged,Magic Number,The method contains a magic number: 3,77
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsPrivileged,Magic Number,The method contains a magic number: 2,77
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsNotPrivileged,Magic Number,The method contains a magic number: 3,93
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,userIsNotPrivileged,Magic Number,The method contains a magic number: 2,93
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,privilegedLimitIsZero,Magic Number,The method contains a magic number: 2,108
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,nonPrivilegedLimitIsZero,Magic Number,The method contains a magic number: 3,116
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,sessionsDoNotGoToNegative,Magic Number,The method contains a magic number: 2,124
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,sessionsDoNotGoToNegative,Magic Number,The method contains a magic number: 2,124
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,negativeLimitMeansUnlimited,Long Statement,The length of the statement "GatewayConfig config=mockConfig(new HashSet<>(Arrays.asList("admin"))`new HashSet<>(Arrays.asList("tom"`"guest"))`-2`-2);" is 121.,150
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,negativeLimitMeansUnlimited,Magic Number,The method contains a magic number: 2,150
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,negativeLimitMeansUnlimited,Magic Number,The method contains a magic number: 2,150
apache_knox,org.apache.knox.gateway.session.control,ConcurrentSessionVerifierTest,negativeLimitMeansUnlimited,Magic Number,The method contains a magic number: 10,150
apache_knox,org.apache.knox.gateway.hive,HiveDispatchUtils,addCredentialsToRequest,Empty catch clause,The method has an empty catch block.,30
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilter,init,Empty catch clause,The method has an empty catch block.,40
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilter,init,Empty catch clause,The method has an empty catch block.,40
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testDefaultConfig,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,37
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testUpperPrincipalAndGroups,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,62
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testLowerPrincipalAndGroups,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,89
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testNonePrincipalAndGroups,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,115
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testDefaultGroupsConfFromUsers,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,139
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testDefaultGroupsConfOverride,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,165
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testNone,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,191
apache_knox,org.apache.knox.gateway.identityasserter.switchcase,SwitchCaseIdentityAssertionFilterTest,testNoGroups,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,217
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionTest,testUnmarshalling,Magic Number,The method contains a magic number: 5,32
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionTest,testUnmarshalling,Magic Number,The method contains a magic number: 5,32
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionTest,testUnmarshalling,Magic Number,The method contains a magic number: 2,32
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionTest,testUnmarshallingCommonServices,Magic Number,The method contains a magic number: 12,66
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionComparatorTest,shouldCompareByName,Long Statement,The length of the statement "assertEquals(-1`serviceDefinitionComparator.compare(buildServiceDefinition("service1"`"role1"`"1.0")`buildServiceDefinition("service2"`"role1"`"1.0")));" is 152.,28
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionComparatorTest,shouldCompareByRole,Long Statement,The length of the statement "assertEquals(-1`serviceDefinitionComparator.compare(buildServiceDefinition("service1"`"role1"`"1.0")`buildServiceDefinition("service1"`"role2"`"1.0")));" is 152.,33
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionComparatorTest,shouldCompareByVersion,Long Statement,The length of the statement "assertEquals(-1`serviceDefinitionComparator.compare(buildServiceDefinition("service1"`"role1"`"1.0")`buildServiceDefinition("service1"`"role1"`"2.0")));" is 152.,38
apache_knox,org.apache.knox.gateway.service.definition,ServiceDefinitionComparatorTest,shouldReturnZeroIfAllEquals,Long Statement,The length of the statement "assertEquals(0`serviceDefinitionComparator.compare(buildServiceDefinition("service1"`"role1"`"1.0")`buildServiceDefinition("service1"`"role1"`"1.0")));" is 151.,43
apache_knox,org.apache.knox.gateway.service.definition,UrlRewriteRulesDescriptorAdapter,unmarshal,Long Statement,The length of the statement "try (InputStream is=nodeToInputStream((Node)value);InputStreamReader isr=new InputStreamReader(is`StandardCharsets.UTF_8)){" is 123.,48
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceUrlFunctionProcessor,resolve,Long Statement,The length of the statement "outputUri=new URI(inputUri.getScheme()`inputUri.getUserInfo()`host`inputUri.getPort()`inputUri.getPath()`inputUri.getQuery()`inputUri.getFragment());" is 149.,50
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceMappedHostFunctionProcessor,resolve,Complex Method,Cyclomatic complexity of the method is 8,54
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceMappedAddressFunctionProcessor,resolve,Complex Method,Cyclomatic complexity of the method is 10,70
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceMappedUrlFunctionProcessor,resolve,Long Statement,The length of the statement "outputUri=new URI(inputUri.getScheme()`inputUri.getUserInfo()`host`inputUri.getPort()`inputUri.getPath()`inputUri.getQuery()`inputUri.getFragment());" is 149.,67
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceMappedUrlFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,58
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceMappedUrlFunctionProcessorTest,testResolve,Long Statement,The length of the statement "assertThat(func.resolve(ctx`Collections.singletonList("test-service"))`contains("test-scheme://test-internal-host:777/test-path"));" is 131.,146
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceUrlFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,58
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceUrlFunctionProcessorTest,testResolve,Long Statement,The length of the statement "assertThat(func.resolve(ctx`Collections.singletonList("test-service"))`contains("test-scheme://test-host:777/test-path"));" is 122.,145
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceMappedAddressFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,58
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceHostFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,53
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceMappedHostFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,58
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServicePortFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,53
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testSetup,Long Statement,The length of the statement "EasyMock.expect(mockServiceRegistry.lookupServiceURL("test-cluster"`"NAMENODE")).andReturn("test-nn-scheme://test-nn-host:411").anyTimes();" is 139.,76
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testSetup,Long Statement,The length of the statement "EasyMock.expect(mockServiceRegistry.lookupServiceURL("test-cluster"`"JOBTRACKER")).andReturn("test-jt-scheme://test-jt-host:511").anyTimes();" is 141.,76
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testSetup,Long Statement,The length of the statement "EasyMock.expect(mockGatewayServices.getService(ServiceType.SERVICE_REGISTRY_SERVICE)).andReturn(mockServiceRegistry).anyTimes();" is 128.,76
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testSetup,Long Statement,The length of the statement "server.getContext().setInitParameter(UrlRewriteServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME`descriptorUrl);" is 121.,76
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnXmlRequestBody,Long Statement,The length of the statement "String input=TestUtils.getResourceString(ServiceRegistryFunctionsTest.class`"test-input-body.xml"`StandardCharsets.UTF_8);" is 122.,120
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnXmlRequestBody,Long Statement,The length of the statement "String expect=TestUtils.getResourceString(ServiceRegistryFunctionsTest.class`"test-expect-body.xml"`StandardCharsets.UTF_8);" is 124.,120
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnXmlRequestBody,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://test-host:42/test-path").contentType("text/xml").characterEncoding(StandardCharsets.UTF_8.name()).content(expect`StandardCharsets.UTF_8);" is 191.,120
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnXmlRequestBody,Magic Number,The method contains a magic number: 200,120
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnXmlRequestBody,Magic Number,The method contains a magic number: 200,120
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnJsonRequestBody,Long Statement,The length of the statement "String input=TestUtils.getResourceString(ServiceRegistryFunctionsTest.class`"test-input-body.json"`StandardCharsets.UTF_8);" is 123.,152
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnJsonRequestBody,Long Statement,The length of the statement "String expect=TestUtils.getResourceString(ServiceRegistryFunctionsTest.class`"test-expect-body.json"`StandardCharsets.UTF_8);" is 125.,152
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnJsonRequestBody,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("http://test-host:42/test-path").contentType("application/json").characterEncoding(StandardCharsets.UTF_8.name()).content(expect`StandardCharsets.UTF_8);" is 199.,152
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnJsonRequestBody,Magic Number,The method contains a magic number: 200,152
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceRegistryFunctionsTest,testServiceRegistryFunctionsOnJsonRequestBody,Magic Number,The method contains a magic number: 200,152
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceSchemeFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,53
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServiceAddressFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,53
apache_knox,org.apache.knox.gateway.svcregfunc.impl,ServicePathFunctionProcessorTest,setUp,Long Statement,The length of the statement "EasyMock.expect(reg.lookupServiceURL("test-cluster"`"test-service")).andReturn("test-scheme://test-host:777/test-path").anyTimes();" is 131.,53
apache_knox,org.apache.knox.gateway.clientcert.filter,ClientCertFilter,init,Long Identifier,The length of the field CLIENT_CERT_PRINCIPAL_ATTRIBUTE_NAME is 36.,57
apache_knox,org.apache.knox.gateway.clientcert.deploy,ClientCertDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,50
apache_knox,org.apache.knox.gateway.impala,ImpalaDispatchUtils,addCredentialsToRequest,Empty catch clause,The method has an empty catch block.,30
apache_knox,org.apache.knox.gateway.hdfs.dispatch,AbstractHdfsHaDispatch,writeOutboundResponse,Magic Number,The method contains a magic number: 403,92
apache_knox,org.apache.knox.gateway.hdfs.dispatch,AbstractHdfsHaDispatch,failoverRequest,Long Parameter List,The method has 5 parameters. ,113
apache_knox,org.apache.knox.gateway.hdfs.dispatch,WebHdfsHaDispatchTest,testConnectivityFailover,Empty catch clause,The method has an empty catch block.,47
apache_knox,org.apache.knox.gateway.hdfs.dispatch,WebHdfsHaDispatchTest,testConnectivityFailover,Long Statement,The length of the statement "descriptor.addServiceConfig(HaDescriptorFactory.createServiceConfig(serviceName`"true"`"1"`"1000"`null`null`null`null`null`null`null));" is 135.,47
apache_knox,org.apache.knox.gateway.hdfs.dispatch,WebHdfsHaDispatchTest,testConnectivityFailover,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(HaServletContextListener.PROVIDER_ATTRIBUTE_NAME)).andReturn(provider).anyTimes();" is 126.,47
apache_knox,org.apache.knox.gateway.hdfs.dispatch,WebHdfsHaDispatchTest,testConnectivityFailover,Magic Number,The method contains a magic number: 1000,47
apache_knox,org.apache.knox.gateway.inboundurl.impl,InboundUrlFunctionProcessor,resolve,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@6ba96378,45
apache_knox,org.apache.knox.gateway.inboundurl.impl,InboundUrlFunctionProcessorTest,getRewriteResponse,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(UrlRewriteServletContextListener.PROCESSOR_ATTRIBUTE_NAME)).andReturn(rewriter).anyTimes();" is 128.,99
apache_knox,org.apache.knox.gateway.inboundurl.impl,InboundUrlFunctionProcessorTest,getRewriteResponse,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter(UrlRewriteServletFilter.RESPONSE_BODY_FILTER_PARAM)).andReturn("test-filter").anyTimes();" is 129.,99
apache_knox,org.apache.knox.gateway.inboundurl.impl,InboundUrlFunctionProcessorTest,testQueryParam,Long Statement,The length of the statement "EasyMock.expect(environment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 124.,120
apache_knox,org.apache.knox.gateway.inboundurl.impl,InboundUrlFunctionProcessorTest,testQueryParam,Long Statement,The length of the statement "EasyMock.expect(environment.resolve("cluster.name")).andReturn(Collections.singletonList("test-cluster-name")).anyTimes();" is 122.,120
apache_knox,org.apache.knox.gateway.inboundurl.impl,InboundUrlFunctionProcessorTest,testQueryParam,Long Statement,The length of the statement "EasyMock.expect(resolver.resolve("query.param.host")).andReturn(Collections.singletonList("http://foo:50075")).anyTimes();" is 122.,120
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,init,Long Statement,The length of the statement "this.tokenIssuer=StringUtils.isBlank(context.getInitParameter(SSO_TOKEN_ISSUER)) ? JWTokenAttributes.DEFAULT_ISSUER : context.getInitParameter(SSO_TOKEN_ISSUER);" is 161.,119
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,setSignatureAlogrithm,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,140
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,setSignatureAlogrithm,Long Statement,The length of the statement "final GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 133.,140
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,setSignatureAlogrithm,Long Statement,The length of the statement "signatureAlgorithm=TokenUtils.getSignatureAlgorithm(configuredSigAlg`(AliasService)services.getService(ServiceType.ALIAS_SERVICE)`config.getSigningKeystoreName());" is 163.,140
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,handleCookieSetup,Complex Method,Cyclomatic complexity of the method is 10,147
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,handleCookieSetup,Long Identifier,The length of the field SSO_COOKIE_SECURE_ONLY_INIT_PARAM is 33.,147
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,handleCookieSetup,Long Identifier,The length of the field SSO_COOKIE_DOMAIN_SUFFIX_PARAM is 30.,147
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,handleCookieSetup,Long Identifier,The length of the field SSO_COOKIE_TOKEN_WHITELIST_PARAM is 32.,147
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,handleCookieSetup,Long Identifier,The length of the field SSO_COOKIE_TOKEN_AUDIENCES_PARAM is 32.,147
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,handleCookieSetup,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,147
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Complex Method,Cyclomatic complexity of the method is 10,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Empty catch clause,The method has an empty catch block.,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Empty catch clause,The method has an empty catch block.,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Long Identifier,The length of the identifier signingKeystorePassphraseAlias is 30.,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Long Identifier,The length of the field SSO_SIGNINGKEY_KEYSTORE_PASSPHRASE_ALIAS is 40.,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Long Statement,The length of the statement "throw new WebApplicationException("Original URL not valid according to the configured whitelist."`Response.Status.BAD_REQUEST);" is 127.,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getAuthenticationToken,Long Statement,The length of the statement "final JWTokenAttributes jwtAttributes=new JWTokenAttributesBuilder().setIssuer(tokenIssuer).setUserName(p.getName()).setAudiences(targetAudiences).setAlgorithm(signatureAlgorithm).setExpires(getExpiry()).setSigningKeystoreName(signingKeystoreName).setSigningKeystoreAlias(signingKeystoreAlias).setSigningKeystorePassphrase(signingKeystorePassphrase).build();" is 358.,217
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getOriginalUrlFromQueryParams,Complex Conditional,The conditional expression !ORIGINAL_URL_REQUEST_PARAM.equals(entry.getKey()) && !original.contains(entry.getKey() + "=") && !ssoExpectedparams.contains(entry.getKey()) is complex.,323
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getOriginalUrlFromQueryParams,Complex Method,Cyclomatic complexity of the method is 8,323
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,getOriginalUrlFromQueryParams,Long Statement,The length of the statement "if (!ORIGINAL_URL_REQUEST_PARAM.equals(entry.getKey()) && !original.contains(entry.getKey() + "=") && !ssoExpectedparams.contains(entry.getKey())) {" is 148.,323
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResource,addJWTHadoopCookie,Magic Number,The method contains a magic number: 50,373
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2048,91
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testWhitelistMatching,Long Statement,The length of the statement "String whitelist="^https?://.*example.com:8080/.*$;" + "^https?://.*example.com/.*$;" + "^https?://.*example2.com:\\d{0`9}/.*$;"+ "^https://.*example3.com:\\d{0`9}/.*$;"+ "^https?://localhost:\\d{0`9}/.*$;^/.*$";" is 212.,101
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(expectGatewayConfig(sslEnabled)).anyTimes();" is 132.,152
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(TokenUtils.SIGNING_HMAC_SECRET_ALIAS)).andReturn(null).anyTimes();" is 126.,152
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testAudiences,Magic Number,The method contains a magic number: 2,206
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testAudiencesWhitespace,Magic Number,The method contains a magic number: 2,234
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testDefaultTTL,Magic Number,The method contains a magic number: 30000L,295
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomTTL,Magic Number,The method contains a magic number: 60000L,321
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomTTL,Magic Number,The method contains a magic number: 30000L,321
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testNegativeTTL,Magic Number,The method contains a magic number: 30000L,349
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testSecureOnly,Long Statement,The length of the statement "configureCommonExpectations(Collections.singletonMap("knoxsso.cookie.secure.only"`knoxSsoCookieSecureOnly == null ? null : knoxSsoCookieSecureOnly.toString())`sslEnabled);" is 171.,388
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testOverflowTTL,Magic Number,The method contains a magic number: 30000L,406
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testWhitelistValidationWithEncodedOriginalURL,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(expectGatewayConfig()).anyTimes();" is 122.,433
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testWhitelistValidationWithEncodedOriginalURL,Long Statement,The length of the statement "EasyMock.expect(request.getParameter("originalUrl")).andReturn(URLEncoder.encode("http://disallowedhost:9080/service"`StandardCharsets.UTF_8.name()));" is 150.,433
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testWhitelistValidationWithEncodedOriginalURL,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(TokenUtils.SIGNING_HMAC_SECRET_ALIAS)).andReturn(null).anyTimes();" is 126.,433
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testExpectedKnoxSSOParams,Long Statement,The length of the statement "paramMap.put("knoxtoken"`new String[]{"eyJhbGciOiJSUzI1NiJ9.eyJzdWIiO" + "iJhZG1pbjEiLCJpc3MiOiJLTk9YU1NPIiwiZXhwIjoxNTMwODk1NjUw" + "fQ.Sodks_BTwaijMM5eg9rY77ro1H4um12TCqmwL5eWn4IMWBBXZQOV"+ "D4JRWNKG_OtITKvkn9EhowOZO6Qtb6tvZLUPyW8Bf9gfgKAHJNLSYyc"+ "yWSPzBOc2kcPmwdYXkOXtPu6KWZaQcD-WRw-89aORbgqZVRKX2Zyk2MLb0Rnig_0"});" is 320.,511
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testExpectedKnoxSSOParams,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(expectGatewayConfig()).anyTimes();" is 122.,511
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testExpectedKnoxSSOParams,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(TokenUtils.SIGNING_HMAC_SECRET_ALIAS)).andReturn(null).anyTimes();" is 126.,511
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testExpectedKnoxSSOParams,Long Statement,The length of the statement "assertEquals(originalUrl + "?&" + "knoxtoken="+ "eyJhbGciOiJSUzI1NiJ9.eyJzdWIiO"+ "iJhZG1pbjEiLCJpc3MiOiJLTk9YU1NPIiwiZXhwIjoxNTMwODk1NjUw"+ "fQ.Sodks_BTwaijMM5eg9rY77ro1H4um12TCqmwL5eWn4IMWBBXZQOV"+ "D4JRWNKG_OtITKvkn9EhowOZO6Qtb6tvZLUPyW8Bf9gfgKAHJNLSYyc"+ "yWSPzBOc2kcPmwdYXkOXtPu6KWZaQcD-WRw-89aORbgqZVRKX2Zyk2MLb0Rnig_0"`resp.getLocation().toString());" is 357.,511
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testRedactToken,Long Statement,The length of the statement "final String token="eyJhbGciOiJSUzI1NiJ9." + "eyJzdWIiOiJhZG1pbjEiLCJpc3MiOiJLTk9YU1NPIiwiZXhwIjoxNTMwNzkwMjkxfQ." + "BdWDAzGvXVvBH_TiEhAqowH-K24GfH8rgb8HJLromVpGwBTkbijIfOZWcvT3a5uZx6r"+ "VEGAXqAKPEqrODBGTSV6l0uEJGeAfQj_7ulQD0YkXaPPJ_FYYntelSA814HzTU0X8UmY"+ "Wo6awEaBwRC_xgNoZ_bMqnkjgFAfTtdHiiEQ";" is 299.,582
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testRedactToken,Long Statement,The length of the statement "final String fragment2="/gateway/knoxsso/api/v1/websso?knoxtoken=" + token + "&originalUrl=http%3A%2F%2Fwww.local.com%3A8443%2F%3Fgateway%3Done%26knoxtoken";" is 157.,582
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testRedactToken,Long Statement,The length of the statement "final String fragment3="/gateway/knoxsso/api/v1/websso?test=value" + "&originalUrl=http%3A%2F%2Fwww.local.com%3A8443%2F%3Fgateway%3Done%26knoxtoken";" is 149.,582
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testRedactToken,Long Statement,The length of the statement "assertEquals("http://loclahost:8080/?&test=value&knoxtoken=***************"`Log4jAuditor.maskTokenFromURL(originalUrl2));" is 121.,582
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testRedactToken,Long Statement,The length of the statement "assertEquals("http://loclahost:8080/?&knoxtoken=***************&test=value"`Log4jAuditor.maskTokenFromURL(originalUrl3));" is 121.,582
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testRedactToken,Long Statement,The length of the statement "assertEquals("/gateway/knoxsso/api/v1/websso?knoxtoken=***************" + "&originalUrl=http://www.local.com:8443/?gateway=one&knoxtoken"`Log4jAuditor.maskTokenFromURL(fragment2));" is 180.,582
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testRedactToken,Long Statement,The length of the statement "assertEquals("/gateway/knoxsso/api/v1/websso?test=value" + "&originalUrl=http://www.local.com:8443/?gateway=one&knoxtoken"`Log4jAuditor.maskTokenFromURL(fragment3));" is 165.,582
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomSigningKey,Long Identifier,The length of the identifier customSigningKeyPassphraseAlias is 31.,613
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomSigningKey,Long Statement,The length of the statement "EasyMock.expect(context.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(expectGatewayConfig()).anyTimes();" is 122.,613
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomSigningKey,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameter("knoxsso.signingkey.keystore.passphrase.alias")).andReturn(customSigningKeyPassphraseAlias);" is 133.,613
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomSigningKey,Long Statement,The length of the statement "authority.addCustomSigningKey(customSigningKeyName`customSigningKeyAlias`customSigningKeyPassphrase.toCharArray()`customPrivateKey);" is 132.,613
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomSigningKey,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(topologyName`customSigningKeyPassphraseAlias)).andReturn(customSigningKeyPassphrase.toCharArray());" is 159.,613
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomSigningKey,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(TokenUtils.SIGNING_HMAC_SECRET_ALIAS)).andReturn(null).anyTimes();" is 126.,613
apache_knox,org.apache.knox.gateway.service.knoxsso,WebSSOResourceTest,testCustomSigningKey,Magic Number,The method contains a magic number: 2048,613
apache_knox,org.apache.knox.gateway.identityasserter.regex.filter,RegexIdentityAssertionFilter,init,Long Statement,The length of the statement "boolean useOriginalOnLookupFailure=Boolean.parseBoolean(filterConfig.getInitParameter("use.original.on.lookup.failure"));" is 121.,39
apache_knox,org.apache.knox.gateway.identityasserter.regex.filter,RegexIdentityAssertionFilter,loadDictionary,Long Statement,The length of the statement "throw new PrincipalMappingException("Unable to load lookup dictionary from provided configuration: " + config + ". No principal mapping will be provided."`e);" is 158.,70
apache_knox,org.apache.knox.gateway.identityasserter.regex.filter,RegexIdentityAssertionFilterTest,testExtractUsernameFromEmail,Long Statement,The length of the statement "String actual=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 121.,38
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerCluster,getServiceURLs,Complex Method,Cyclomatic complexity of the method is 8,55
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerCluster,getServiceURLs,Long Statement,The length of the statement "log.qualifyingServiceParamMismatch(serviceName`serviceParamKey`serviceParam.getValue()`model.getQualifyingServiceParam(serviceParamKey));" is 137.,55
apache_knox,org.apache.knox.gateway.topology.discovery.cm,DiscoveryApiClient,configure,Complex Method,Cyclomatic complexity of the method is 11,68
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryRepository,registerCluster,Long Statement,The length of the statement "repository.putIfAbsent(RepositoryKey.of(serviceDiscoveryConfig)`Caffeine.newBuilder().expireAfterWrite(Duration.ofSeconds(cacheEntryTTL)).build());" is 147.,62
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryRepository,getServices,Long Statement,The length of the statement "return clusterServices == null ? null : clusterServices.asMap().entrySet().stream().filter(entry -> entry.getValue() != null).map(entry -> entry.getKey()).collect(Collectors.toList());" is 184.,70
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ServiceModel,ServiceModel,Long Parameter List,The method has 5 parameters. ,53
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ServiceModel,addQualifyingServiceParam,Long Identifier,The length of the field QUALIFYING_SERVICE_PARAM_PREFIX is 31.,72
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ServiceModel,getQualifyingServiceParam,Long Identifier,The length of the field QUALIFYING_SERVICE_PARAM_PREFIX is 31.,93
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ServiceModel,equals,Long Statement,The length of the statement "return getType().equals(other.getType()) && getService().equals(other.getService()) && getServiceType().equals(other.getServiceType())&& getRoleType().equals(other.getRoleType())&& getServiceUrl().equals(other.getServiceUrl());" is 227.,160
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,configureRetryParams,Long Identifier,The length of the identifier configuredRetryDurationSeconds is 30.,118
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,configureRetryParams,Long Statement,The length of the statement "final int pollingInterval=gatewayConfig.getClusterMonitorPollingInterval(ClouderaManagerClusterConfigurationMonitor.getType());" is 127.,118
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,configureRetryParams,Magic Number,The method contains a magic number: 2,118
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,getConfigurationChangeMonitor,Long Statement,The length of the statement "ClusterConfigurationMonitorService clusterMonitorService=GatewayServer.getGatewayServices().getService(ServiceType.CLUSTER_CONFIGURATION_MONITOR_SERVICE);" is 154.,150
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,getConfigurationChangeMonitor,Long Statement,The length of the statement "ClusterConfigurationMonitor monitor=clusterMonitorService.getMonitor(ClouderaManagerClusterConfigurationMonitor.getType());" is 123.,150
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,discover,Long Parameter List,The method has 5 parameters. ,189
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,discover,Long Statement,The length of the statement "throw new IllegalArgumentException("The cluster configuration is missing from` or invalid in` the discovery configuration.");" is 125.,189
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,discover,Magic Number,The method contains a magic number: 1000L,189
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,discoverCluster,Complex Method,Cyclomatic complexity of the method is 12,243
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscovery,getRoleConfig,Long Statement,The length of the statement "configList=rolesResourceApi.readRoleConfig(serviceDiscoveryConfig.getCluster()`role.getName()`service.getName()`VIEW_FULL);" is 123.,405
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryRepositoryTest,containsServiceConfig,Long Statement,The length of the statement "return serviceConfigs.getItems().stream().anyMatch(serviceConfig -> serviceConfig.getName().equals(serviceConfigName) && serviceConfig.getValue().equals(serviceConfigValue));" is 174.,166
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryRepositoryTest,containsRoleConfig,Long Statement,The length of the statement "return roleConfigs.getItems().stream().anyMatch(roleConfig -> roleConfig.getName().equals(roleConfigName) && roleConfig.getValue().equals(roleConfigValue));" is 156.,183
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerClusterTest,testGetUnqualifiedMultipleSOLRServiceURLs_NoDiscoveryServiceParams,Long Statement,The length of the statement "doTestGetSOLRServiceURLs(Arrays.asList("SOLR-3"`"SOLR-7")`Collections.singletonMap("test-param"`"test-value")`Arrays.asList("SOLR-3"`"SOLR-7"));" is 144.,51
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerClusterTest,testGetIncorrectlyQualifiedSOLRServiceURLs,Long Statement,The length of the statement "doTestGetSOLRServiceURLs(Arrays.asList("SOLR-3"`"SOLR-7")`Collections.singletonMap(QUALIFYING_SERVICE_PARAM_PREFIX + DISCOVERY_SERVICE_DISPLAY_NAME`"SOLR-5Display")`Collections.emptyList());" is 190.,62
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerClusterTest,testGetDisplayNameQualifiedSOLRServiceURLs,Long Statement,The length of the statement "doTestGetSOLRServiceURLs(Arrays.asList("SOLR-3"`"SOLR-7")`Collections.singletonMap(QUALIFYING_SERVICE_PARAM_PREFIX + DISCOVERY_SERVICE_DISPLAY_NAME`"SOLR-7Display")`Collections.singletonList("SOLR-7"));" is 202.,73
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerClusterTest,testGetServiceNameQualifiedSOLRServiceURLs,Long Statement,The length of the statement "doTestGetSOLRServiceURLs(Arrays.asList("SOLR-5"`"SOLR-6")`Collections.singletonMap(QUALIFYING_SERVICE_PARAM_PREFIX + DISCOVERY_SERVICE_NAME`"SOLR-5")`Collections.singletonList("SOLR-5"));" is 187.,83
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerClusterTest,createSOLRServiceModel,Long Statement,The length of the statement "return new ServiceModel(ServiceModel.Type.API`SolrServiceModelGenerator.SERVICE`SolrServiceModelGenerator.SERVICE_TYPE`SolrServiceModelGenerator.ROLE_TYPE`url);" is 160.,167
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestJobTrackerResourceManagerServiceDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery(hostName`"YARN-1"`"YARN"`"YARN-1-RESOURCEMANAGER-12345"`"RESOURCEMANAGER"`serviceProperties`roleProperties);" is 157.,97
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,testWebHCatDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery(hostName`"HIVE-1"`WebHCatServiceModelGenerator.SERVICE_TYPE`"HIVE-1-WEBHCAT-1"`WebHCatServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 206.,405
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestKuduUIDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery(hostName`"KUDU-1"`KuduUIServiceModelGenerator.SERVICE_TYPE`"KUDU-KUDU_MASTER-12345"`KuduUIServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 210.,566
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestNiFiDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery(hostName`"NIFI-1"`NifiServiceModelGenerator.SERVICE_TYPE`"nifi-NIFI_NODE-1"`NifiServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 200.,599
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestCMDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery("somehost"`serviceName + "-1"`ClouderaManagerUIServiceModelGenerator.SERVICE_TYPE`serviceName + "-1"`ClouderaManagerUIServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`Collections.emptyMap());" is 246.,644
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestNiFiRegistryDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery(hostName`"NIFI_REGISTRY-1"`NifiRegistryServiceModelGenerator.SERVICE_TYPE`"NIFI_REGISTRY_SERVER-1"`NifiRegistryServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 231.,661
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestImpalaDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery(hostName`"IMPALA-1"`ImpalaServiceModelGenerator.SERVICE_TYPE`"IMAPALA-1-IMPALAD-1"`ImpalaServiceModelGenerator.ROLE_TYPE`serviceProperties`roleProperties);" is 204.,686
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestImpalaUIDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster cluster=doTestDiscovery(hostName`"IMPALA-1"`ImpalaUIServiceModelGenerator.SERVICE_TYPE`"IMAPALA-1-IMPALAD-1"`ImpalaUIServiceModelGenerator.ROLE_TYPE`serviceProperties`roleProperties);" is 208.,715
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestOozieDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"OOZIE-1"`OozieServiceModelGenerator.SERVICE_TYPE`"OOZIE-1-OOZIE_SERVER-12345"`OozieServiceModelGenerator.ROLE_TYPE`serviceProperties`roleProperties);" is 182.,764
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestZeppelinDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"ZEPPELIN-1"`ZeppelinServiceModelGenerator.SERVICE_TYPE`"ZEPPELIN-ZEPPELIN_SERVER-1"`ZeppelinServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 196.,815
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestRangerDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"RANGER-1"`RangerServiceModelGenerator.SERVICE_TYPE`"RANGER-RANGER_ADMIN-1"`RangerServiceModelGenerator.ROLE_TYPE`serviceProperties`roleProperties);" is 180.,865
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestSolrDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"SOLR-1"`SolrServiceModelGenerator.SERVICE_TYPE`"SOLR-SOLR_SERVER-1"`SolrServiceModelGenerator.ROLE_TYPE`serviceProperties`roleProperties);" is 171.,887
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestSparkHistoryUIDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"SPARK_ON_YARN-1"`SparkHistoryUIServiceModelGenerator.SERVICE_TYPE`"SPAR4fcf419a-SPARK_YARN_HISTORY_SERVER-12345"`SparkHistoryUIServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 231.,909
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestSpark3HistoryUIDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"SPARK3_ON_YARN-1"`Spark3HistoryUIServiceModelGenerator.SERVICE_TYPE`"SPAR4fcf419a-SPARK3_YARN_HISTORY_SERVER-12345"`Spark3HistoryUIServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 235.,924
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestAtlasDiscovery,Long Parameter List,The method has 5 parameters. ,957
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestAtlasDiscovery,Long Statement,The length of the statement "return doTestDiscovery(atlasHost`ATLAS_SERVICE_NAME`AtlasServiceModelGenerator.SERVICE_TYPE`"ATLAS-ATLAS_SERVER-1"`AtlasServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties`testRetry);" is 201.,957
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHiveServiceDiscovery,Long Statement,The length of the statement "final String safetyValveThriftPathFormat="<property><name>hive.server2.thrift.http.path</name><value>%s</value></property>";" is 124.,979
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHiveServiceDiscovery,Long Statement,The length of the statement "final String safetyValveThriftPathConfig=thriftPath != null ? String.format(Locale.ROOT`safetyValveThriftPathFormat`thriftPath) : "";" is 133.,979
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHiveServiceDiscovery,Long Statement,The length of the statement "final String hs2SafetyValveValue="<property><name>hive.server2.transport.mode</name><value>http</value></property>\n" + "<property><name>hive.server2.thrift.http.port</name><value>" + thriftPort + "</value></property>\n"+ safetyValveThriftPathConfig;" is 250.,979
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHiveServiceDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"HIVE-1"`HiveServiceModelGenerator.SERVICE_TYPE`"HIVE-1-HIVESERVER2-12345"`HiveServiceModelGenerator.ROLE_TYPE`serviceProperties`roleProperties);" is 177.,979
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHiveOnTezServiceDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"HIVE_ON_TEZ-1"`HiveOnTezServiceModelGenerator.SERVICE_TYPE`"HIVE_ON_TEZ-1-HIVESERVER2-12345"`HiveServiceModelGenerator.ROLE_TYPE`serviceProperties`roleProperties);" is 196.,1010
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHDFSDiscovery,Long Parameter List,The method has 5 parameters. ,1046
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHDFSDiscovery,Long Parameter List,The method has 6 parameters. ,1055
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHDFSDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"NAMENODE-1"`NameNodeServiceModelGenerator.SERVICE_TYPE`"HDFS-1-NAMENODE-12345"`NameNodeServiceModelGenerator.ROLE_TYPE`serviceProps`roleProperties);" is 181.,1055
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestHBaseUIDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"HBASE-1"`HBaseUIServiceModelGenerator.SERVICE_TYPE`"HBASE-1-MASTER-12345"`HBaseUIServiceModelGenerator.ROLE_TYPE`serviceProps`roleProperties);" is 175.,1087
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestWebHBaseDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"HBASE-1"`WebHBaseServiceModelGenerator.SERVICE_TYPE`"HBASE-1-RESTSERVER"`WebHBaseServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 185.,1108
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestLivyDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"LIVY-1"`LivyServiceModelGenerator.SERVICE_TYPE`"LIVY-LIVY_SERVER-1"`LivyServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 176.,1126
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestPhoenixDiscovery,Long Statement,The length of the statement "return doTestDiscovery(hostName`"PHOENIX-1"`PhoenixServiceModelGenerator.SERVICE_TYPE`"PHOENIX-PHOENIX_QUERY_SERVER-1"`PhoenixServiceModelGenerator.ROLE_TYPE`Collections.emptyMap()`roleProperties);" is 197.,1144
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Long Parameter List,The method has 7 parameters. ,1162
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Long Parameter List,The method has 8 parameters. ,1172
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Long Statement,The length of the statement "EasyMock.expect(gwConf.getClouderaManagerServiceDiscoveryMaximumRetryAttempts()).andReturn(GatewayConfig.DEFAULT_CM_SERVICE_DISCOVERY_MAX_RETRY_ATTEMPTS).anyTimes();" is 165.,1172
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Long Statement,The length of the statement "EasyMock.expect(gwConf.getClusterMonitorPollingInterval(ClouderaManagerClusterConfigurationMonitor.getType())).andReturn(10).anyTimes();" is 136.,1172
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Long Statement,The length of the statement "TestDiscoveryApiClient mockClient=testRetry ? new TestFaultyDiscoveryApiClient(sdConfig`null`null) : new TestDiscoveryApiClient(sdConfig`null`null);" is 148.,1172
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Magic Number,The method contains a magic number: 10,1172
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Magic Number,The method contains a magic number: 9,1172
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,doTestDiscovery,Magic Number,The method contains a magic number: 4,1172
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,createMockApiServiceConfig,Magic Number,The method contains a magic number: 2,1271
apache_knox,org.apache.knox.gateway.topology.discovery.cm,ClouderaManagerServiceDiscoveryTest,createMockApiConfigList,Magic Number,The method contains a magic number: 2,1293
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,AbstractConfigurationStore,remove,Long Statement,The length of the statement "log.failedToRemovPersistedClusterMonitorData(ClouderaManagerClusterConfigurationMonitor.getType()`persisted.getAbsolutePath());" is 127.,46
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,PollingConfigurationAnalyzer,Long Parameter List,The method has 5 parameters. ,146
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,PollingConfigurationAnalyzer,Magic Number,The method contains a magic number: 3,146
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,PollingConfigurationAnalyzer,Magic Number,The method contains a magic number: 1000,146
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,waitFor,Magic Number,The method contains a magic number: 1000L,167
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,run,Complex Method,Cyclomatic complexity of the method is 8,175
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,hasConfigChanged,Complex Method,Cyclomatic complexity of the method is 9,226
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,hasConfigChanged,Long Statement,The length of the statement "final Map<String`ServiceConfigurationModel> serviceConfigurations=configCache.getClusterServiceConfigurations(address`clusterName);" is 131.,226
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,clusterReferencesExist,Empty catch clause,The method has an empty catch block.,311
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,getApiClient,Long Statement,The length of the statement "return clients.computeIfAbsent(discoveryConfig.getAddress()`c -> new DiscoveryApiClient(discoveryConfig`aliasService`keystoreService));" is 135.,378
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,getRelevantEvents,Long Identifier,The length of the field eventQueryDefaultTimestampOffset is 32.,388
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,getRelevantEvents,Long Statement,The length of the statement "final List<ApiEvent> events=queryEvents(getApiClient(configCache.getDiscoveryConfig(address`clusterName))`clusterName`lastTimestamp.toString());" is 144.,388
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,getRelevantEvents,Magic Number,The method contains a magic number: 2,388
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,isRelevantEvent,Long Statement,The length of the statement "final String status=attributeMap.containsKey(COMMAND_STATUS) ? ((List<String>)attributeMap.get(COMMAND_STATUS)).get(0) : "";" is 124.,431
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,getAttributeMap,Long Statement,The length of the statement "return attributes == null ? Collections.emptyMap() : attributes.stream().collect(Collectors.toMap(ApiEventAttribute::getName`ApiEventAttribute::getValues));" is 156.,441
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzer,hasConfigurationChanged,Complex Method,Cyclomatic complexity of the method is 10,510
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,ClusterConfigurationCache,addDiscoveryConfig,Long Identifier,The length of the field clusterMonitorConfigurationsLock is 32.,63
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,ClusterConfigurationCache,getDiscoveryConfig,Long Identifier,The length of the field clusterMonitorConfigurationsLock is 32.,95
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,ClusterConfigurationCache,getClusterNames,Long Statement,The length of the statement "for ( Map.Entry<String`Map<String`Map<String`ServiceConfigurationModel>>> configs : clusterServiceConfigurations.entrySet()) {" is 126.,141
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,DiscoveryConfigurationFileStoreTest,testMultiple,Magic Number,The method contains a magic number: 2,64
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,DiscoveryConfigurationFileStoreTest,testMultiple,Magic Number,The method contains a magic number: 2,64
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRestartEventWithoutConfigChange,Long Statement,The length of the statement "ApiEvent restartEvent=createApiEvent(clusterName`NameNodeServiceModelGenerator.SERVICE_TYPE`NameNodeServiceModelGenerator.SERVICE`PollingConfigurationAnalyzer.RESTART_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS);" is 222.,89
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRestartEventWithConfigChange,Long Statement,The length of the statement "ApiEvent restartEvent=createApiEvent(clusterName`NameNodeServiceModelGenerator.SERVICE_TYPE`NameNodeServiceModelGenerator.SERVICE`PollingConfigurationAnalyzer.RESTART_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS);" is 222.,106
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testNewServiceStartEvent,Long Statement,The length of the statement "ApiEvent startEvent=createApiEvent(clusterName`NameNodeServiceModelGenerator.SERVICE_TYPE`NameNodeServiceModelGenerator.SERVICE`PollingConfigurationAnalyzer.START_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS);" is 218.,123
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testExistingServiceStartWithoutConfigChange,Long Statement,The length of the statement "ApiEvent startEvent=createApiEvent(clusterName`NameNodeServiceModelGenerator.SERVICE_TYPE`NameNodeServiceModelGenerator.SERVICE`PollingConfigurationAnalyzer.START_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS);" is 218.,143
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testExistingServiceStartWithConfigChange,Long Statement,The length of the statement "ApiEvent startEvent=createApiEvent(clusterName`NameNodeServiceModelGenerator.SERVICE_TYPE`NameNodeServiceModelGenerator.SERVICE`PollingConfigurationAnalyzer.START_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS);" is 218.,160
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRollingServiceRestartWithoutConfigChange,Long Statement,The length of the statement "ApiEvent rollingRestartEvent=createApiEvent(clusterName`NameNodeServiceModelGenerator.SERVICE_TYPE`NameNodeServiceModelGenerator.SERVICE`PollingConfigurationAnalyzer.ROLLING_RESTART_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS`"EV_SERVICE_ROLLING_RESTARTED");" is 268.,177
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRollingServiceRestartWithConfigChange,Long Statement,The length of the statement "ApiEvent rollingRestartEvent=createApiEvent(clusterName`NameNodeServiceModelGenerator.SERVICE_TYPE`NameNodeServiceModelGenerator.SERVICE`PollingConfigurationAnalyzer.ROLLING_RESTART_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS`"EV_SERVICE_ROLLING_RESTARTED");" is 268.,195
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRollingClusterRestartEvent,Long Statement,The length of the statement "ApiEvent rollingRestartEvent=createApiEvent(clusterName`PollingConfigurationAnalyzer.CM_SERVICE_TYPE`PollingConfigurationAnalyzer.CM_SERVICE`PollingConfigurationAnalyzer.ROLLING_RESTART_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS`"EV_CLUSTER_ROLLING_RESTARTED");" is 272.,213
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRollingClusterRestartEvent,Long Statement,The length of the statement "ChangeListener listener=doTestEvent(rollingRestartEvent`address`clusterName`Collections.emptyMap()`Collections.emptyMap());" is 123.,213
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRestartWaitingForStalenessSuccessEvent,Long Statement,The length of the statement "final ApiEvent rollingRestartEvent=createApiEvent(clusterName`PollingConfigurationAnalyzer.CM_SERVICE_TYPE`PollingConfigurationAnalyzer.CM_SERVICE`PollingConfigurationAnalyzer.RESTART_WAITING_FOR_STALENESS_SUCCESS_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS`"EV_CLUSTER_RESTARTED");" is 292.,234
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRestartWaitingForStalenessSuccessEvent,Long Statement,The length of the statement "final ChangeListener listener=doTestEvent(rollingRestartEvent`address`clusterName`Collections.emptyMap()`Collections.emptyMap());" is 129.,234
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testRestartWaitingForStalenessSuccessEventProcessedOnlyOnce,Long Statement,The length of the statement "final ApiEvent rollingRestartEvent=createApiEvent(clusterName`PollingConfigurationAnalyzer.CM_SERVICE_TYPE`PollingConfigurationAnalyzer.CM_SERVICE`PollingConfigurationAnalyzer.RESTART_WAITING_FOR_STALENESS_SUCCESS_COMMAND`PollingConfigurationAnalyzer.SUCCEEDED_STATUS`"EV_CLUSTER_RESTARTED"`"123");" is 298.,250
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testClusterConfigMonitorTerminationForNoLongerReferencedClusters,Empty catch clause,The method has an empty catch block.,273
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testClusterConfigMonitorTerminationForNoLongerReferencedClusters,Long Statement,The length of the statement "final String descContent="{\n" + " \"discovery-type\": \"ClouderaManager\"`\n" + " \"discovery-address\": \"" + updatedAddress + "\"`\n"+ " \"cluster\": \""+ clusterName+ "\"`\n"+ " \"provider-config-ref\": \"ldap\"`\n"+ " \"services\": [\n"+ " {\n"+ " \"name\": \"WEBHDFS\"\n"+ " }\n"+ " ]\n"+ "}";" is 299.,273
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testClusterConfigMonitorTerminationForNoLongerReferencedClusters,Long Statement,The length of the statement "assertEquals("Expected the config cache entry for " + clusterName + " to have been removed."`0`configCache.getClusterNames().get(address).size());" is 146.,273
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testClusterConfigMonitorTerminationForNoLongerReferencedClusters,Magic Number,The method contains a magic number: 5,273
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,testClusterConfigMonitorTerminationForNoLongerReferencedClusters,Magic Number,The method contains a magic number: 10,273
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Long Identifier,The length of the parameter updatedServiceConfigurationModels is 33.,397
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Long Parameter List,The method has 5 parameters. ,397
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Empty catch clause,The method has an empty catch block.,402
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Long Identifier,The length of the parameter updatedServiceConfigurationModels is 33.,402
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Long Parameter List,The method has 6 parameters. ,402
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Long Statement,The length of the statement "final TestablePollingConfigAnalyzer pca=pollingConfigAnalyzer == null ? buildPollingConfigAnalyzer(address`clusterName`serviceConfigurationModels`listener) : pollingConfigAnalyzer;" is 180.,402
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Magic Number,The method contains a magic number: 5,402
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,doTestEvent,Magic Number,The method contains a magic number: 10,402
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,buildPollingConfigAnalyzer,Long Statement,The length of the statement "EasyMock.expect(configCache.getClusterServiceConfigurations(address`clusterName)).andReturn(serviceConfigurationModels).anyTimes();" is 131.,435
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,createApiEvent,Long Parameter List,The method has 5 parameters. ,538
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,createApiEvent,Long Parameter List,The method has 6 parameters. ,546
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,createApiEvent,Long Parameter List,The method has 7 parameters. ,554
apache_knox,org.apache.knox.gateway.topology.discovery.cm.monitor,PollingConfigurationAnalyzerTest,createApiEvent,Magic Number,The method contains a magic number: 8,571
apache_knox,org.apache.knox.gateway.topology.discovery.cm.auth,SpnegoAuthInterceptor,isNegotiate,Magic Number,The method contains a magic number: 2,99
apache_knox,org.apache.knox.gateway.topology.discovery.cm.auth,SpnegoAuthInterceptor,authenticate,Long Statement,The length of the statement "if (response.request().headers(AUTHORIZATION).stream().anyMatch(SpnegoAuthInterceptor::isNegotiate) || response.headers(WWW_AUTHENTICATE).stream().noneMatch(SpnegoAuthInterceptor::isNegotiate)) {" is 195.,104
apache_knox,org.apache.knox.gateway.topology.discovery.cm.auth,SpnegoAuthInterceptor,generateToken,Empty catch clause,The method has an empty catch block.,130
apache_knox,org.apache.knox.gateway.topology.discovery.cm.auth,SpnegoAuthInterceptor,generateToken,Long Statement,The length of the statement "GSSContext result=GSS_MANAGER.createContext(GSS_MANAGER.createName(servicePrincipal`NT_HOSTBASED_SERVICE)`SPNEGO_OID`GSSCredentialSession.getClientCredential()`INDEFINITE_LIFETIME);" is 181.,130
apache_knox,org.apache.knox.gateway.topology.discovery.cm.auth,SpnegoAuthInterceptor,createCredentialSession,Long Statement,The length of the statement "GSSCredential clientCredential=doAs(subject`() -> GSS_MANAGER.createCredential(GSS_MANAGER.createName(clientPrincipal.getName()`NT_USER_NAME)`DEFAULT_LIFETIME`KERBEROS_OID`INITIATE_ONLY));" is 188.,170
apache_knox,org.apache.knox.gateway.topology.discovery.cm.auth,AuthUtilsTest,createTestKrb5LoginConfigFile,Empty catch clause,The method has an empty catch block.,60
apache_knox,org.apache.knox.gateway.topology.discovery.cm.auth,AuthUtilsTest,getTestKrb5LoginConf,Long Statement,The length of the statement "return AuthUtils.JGSS_LOGIN_MODULE + " {\n" + "com.sun.security.auth.module.Krb5LoginModule required\n"+ "renewTGT=false\n"+ "doNotPrompt=true\n"+ "useKeyTab=false\n"+ "principal=\"knox/myhost.example.com@EXAMPLE.COM\"\n"+ "storeKey=false\n"+ "useTicketCache=false;\n"+ "};";" is 275.,77
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.atlas,AtlasServiceModelGenerator,generateService,Long Statement,The length of the statement "ServiceModel model=new ServiceModel(getModelType()`getService()`getServiceType()`getRoleType()`String.format(Locale.getDefault()`"%s://%s:%s"`scheme`hostname`port));" is 165.,58
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveServiceModelGenerator,checkHiveServer2HTTPMode,Long Statement,The length of the statement "final String hiveServer2TransportMode=hiveServer2SafetyValve == null ? null : getSafetyValveValue(hiveServer2SafetyValve`TRANSPORT_MODE);" is 137.,116
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveServiceModelGenerator,validateTransportMode,Long Statement,The length of the statement "response.addConfigurationIssue("Invalid configuration: " + configPropName + ". Expected="+ TRANSPORT_MODE_HTTP+ " or "+ TRANSPORT_MODE_ALL+ "; Found="+ transportMode);" is 167.,123
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveServiceModelGeneratorTest,testHandles,Long Statement,The length of the statement "roleConfig.put(HiveServiceModelGenerator.SAFETY_VALVE`getSafetyValveConfig(HiveServiceModelGenerator.TRANSPORT_MODE_HTTP));" is 123.,32
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveServiceModelGeneratorTest,testHandlesTransportModeAll,Long Statement,The length of the statement "roleConfig.put(HiveServiceModelGenerator.SAFETY_VALVE`getSafetyValveConfig(HiveServiceModelGenerator.TRANSPORT_MODE_ALL));" is 122.,41
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveServiceModelGeneratorTest,testServiceModelMetadata,Long Statement,The length of the statement "roleConfig.put(HiveServiceModelGenerator.SAFETY_VALVE`getSafetyValveConfig(HiveServiceModelGenerator.TRANSPORT_MODE_HTTP));" is 123.,56
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveServiceModelGeneratorTest,testServiceModelMetadataTransportModeAll,Long Statement,The length of the statement "roleConfig.put(HiveServiceModelGenerator.SAFETY_VALVE`getSafetyValveConfig(HiveServiceModelGenerator.TRANSPORT_MODE_ALL));" is 122.,68
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveServiceModelGeneratorTest,getSafetyValveConfig,Long Statement,The length of the statement "return "<property><name>" + HiveServiceModelGenerator.HTTP_PORT + "</name><value>12345</value></property>"+ "<property><name>"+ HiveServiceModelGenerator.HTTP_PATH+ "</name><value>cliService</value></property>"+ "<property><name>"+ HiveServiceModelGenerator.TRANSPORT_MODE+ "</name><value>"+ transportMode+ "</value></property>";" is 329.,95
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveOnTezServiceModelGeneratorTest,testHandles,Long Statement,The length of the statement "roleConfig.put(HiveOnTezServiceModelGenerator.HIVEONTEZ_TRANSPORT_MODE`HiveOnTezServiceModelGenerator.TRANSPORT_MODE_HTTP);" is 123.,32
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveOnTezServiceModelGeneratorTest,testHandlesTransportModeAll,Long Statement,The length of the statement "roleConfig.put(HiveOnTezServiceModelGenerator.HIVEONTEZ_TRANSPORT_MODE`HiveOnTezServiceModelGenerator.TRANSPORT_MODE_ALL);" is 122.,41
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveOnTezServiceModelGeneratorTest,testServiceModelMetadata,Long Statement,The length of the statement "roleConfig.put(HiveOnTezServiceModelGenerator.HIVEONTEZ_TRANSPORT_MODE`HiveOnTezServiceModelGenerator.TRANSPORT_MODE_HTTP);" is 123.,56
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hive,HiveOnTezServiceModelGeneratorTest,testServiceModelMetadataTransportModeAll,Long Statement,The length of the statement "roleConfig.put(HiveOnTezServiceModelGenerator.HIVEONTEZ_TRANSPORT_MODE`HiveOnTezServiceModelGenerator.TRANSPORT_MODE_ALL);" is 122.,70
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.cm,ClouderaManagerAPIServiceModelGenerator,generateService,Long Statement,The length of the statement "final String serviceURL=getModelType() == ServiceModel.Type.API ? String.format(Locale.getDefault()`"%s://%s:%s/api"`uri.getScheme()`uri.getHost()`uri.getPort()) : String.format(Locale.getDefault()`"%s://%s:%s"`uri.getScheme()`uri.getHost()`uri.getPort());" is 256.,60
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hdfs,WebHdfsServiceModelGeneratorTest,testServiceModelMetadataWithNameService,Long Statement,The length of the statement "final String qualifyingProperty=ServiceModel.QUALIFYING_SERVICE_PARAM_PREFIX + WebHdfsServiceModelGenerator.DISCOVERY_NAMESERVICE;" is 130.,62
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hdfs,WebHdfsServiceModelGeneratorTest,testServiceModelMetadataWithNameService,Long Statement,The length of the statement "assertEquals("Expected " + qualifyingProperty + " model property."`roleConfig.get(WebHdfsServiceModelGenerator.NN_NAMESERVICE)`modelProps.get(qualifyingProperty));" is 163.,62
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hdfs,NameNodeServiceModelGeneratorTest,testServiceModelMetadataWithNameService,Long Statement,The length of the statement "final String qualifyingProperty=ServiceModel.QUALIFYING_SERVICE_PARAM_PREFIX + NameNodeServiceModelGenerator.DISCOVERY_NAMESERVICE;" is 131.,32
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.hdfs,NameNodeServiceModelGeneratorTest,testServiceModelMetadataWithNameService,Long Statement,The length of the statement "assertEquals("Expected " + qualifyingProperty + " model property."`roleConfig.get(NameNodeServiceModelGenerator.NN_NAMESERVICE)`modelProps.get(qualifyingProperty));" is 164.,32
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.solr,SolrServiceModelGenerator,generateService,Long Identifier,The length of the field DISCOVERY_SERVICE_DISPLAY_NAME is 30.,60
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.solr,SolrServiceModelGeneratorTest,testServiceModelMetadata,Long Statement,The length of the statement "assertEquals("Expected " + serviceNameQualifier + " model property."`getServiceType() + "-1"`modelProps.get(serviceNameQualifier));" is 131.,34
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.solr,SolrServiceModelGeneratorTest,testServiceModelMetadata,Magic Number,The method contains a magic number: 2,34
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model,AbstractServiceModelGenerator,handles,Long Statement,The length of the statement "return new ServiceModelGeneratorHandleResponse(getServiceType().equals(service.getType()) && getRoleType().equals(role.getType()));" is 131.,84
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model,AbstractServiceModelGeneratorTest,doTestHandles,Long Parameter List,The method has 5 parameters. ,69
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model,AbstractServiceModelGeneratorTest,doTestHandles,Long Statement,The length of the statement "return generator.handles(createApiServiceMock(serviceType)`createApiServiceConfigMock(serviceConfig)`createApiRoleMock(roleType)`createApiConfigListMock(roleProps)).handled();" is 175.,69
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model,AbstractServiceModelGeneratorTest,createServiceModel,Long Statement,The length of the statement "model=newGenerator().generateService(createApiServiceMock(getServiceType())`createApiServiceConfigMock(serviceConfig)`createApiRoleMock(getRoleType())`createApiConfigListMock(roleConfig));" is 188.,81
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.nifi,NifiServiceModelGenerator,generateService,Long Statement,The length of the statement "ServiceModel model=new ServiceModel(getModelType()`getService()`getServiceType()`getRoleType()`String.format(Locale.getDefault()`"%s://%s:%s"`scheme`hostname`port));" is 165.,70
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.nifi,NifiRegistryServiceModelGenerator,generateService,Long Statement,The length of the statement "ServiceModel model=new ServiceModel(getModelType()`getService()`getServiceType()`getRoleType()`String.format(Locale.getDefault()`"%s://%s:%s"`scheme`hostname`port));" is 165.,70
apache_knox,org.apache.knox.gateway.topology.discovery.cm.model.impala,ImpalaUIServiceModelGenerator,handles,Long Statement,The length of the statement "response.addConfigurationIssue("Invalid configuration: " + ENABLE_WEBSERVER + ". Expected=true; Found="+ impalaWebserverEnabled);" is 129.,60
apache_knox,org.apache.knox.gateway.topology.discovery.cm.collector,HueURLCollectorTest,testSingleServiceModel,Long Statement,The length of the statement "testRoleModels.put(HueServiceModelGenerator.ROLE_TYPE`Collections.singletonList(createMockServiceModel(HueServiceModelGenerator.SERVICE`HueServiceModelGenerator.SERVICE_TYPE`HueServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/test1")));" is 238.,44
apache_knox,org.apache.knox.gateway.topology.discovery.cm.collector,HueURLCollectorTest,testMultipleServiceModels,Long Statement,The length of the statement "testRoleModels.put(HueServiceModelGenerator.ROLE_TYPE`Arrays.asList(createMockServiceModel(HueServiceModelGenerator.SERVICE`HueServiceModelGenerator.SERVICE_TYPE`HueServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/test1")`createMockServiceModel(HueServiceModelGenerator.SERVICE`HueServiceModelGenerator.SERVICE_TYPE`HueServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/test2")`createMockServiceModel(HueServiceModelGenerator.SERVICE`HueServiceModelGenerator.SERVICE_TYPE`HueServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/test3")));" is 538.,60
apache_knox,org.apache.knox.gateway.topology.discovery.cm.collector,HueURLCollectorTest,testMultipleServiceModels,Magic Number,The method contains a magic number: 3,60
apache_knox,org.apache.knox.gateway.topology.discovery.cm.collector,HueURLCollectorTest,testMultipleServiceModelsWithHueLB,Long Statement,The length of the statement "testRoleModels.put(HueServiceModelGenerator.ROLE_TYPE`Arrays.asList(createMockServiceModel(HueServiceModelGenerator.SERVICE`HueServiceModelGenerator.SERVICE_TYPE`HueServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/test1")`createMockServiceModel(HueServiceModelGenerator.SERVICE`HueServiceModelGenerator.SERVICE_TYPE`HueServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/test2")));" is 382.,86
apache_knox,org.apache.knox.gateway.topology.discovery.cm.collector,HueURLCollectorTest,testMultipleServiceModelsWithHueLB,Long Statement,The length of the statement "testRoleModels.put(HueLBServiceModelGenerator.ROLE_TYPE`Collections.singletonList(createMockServiceModel(HueLBServiceModelGenerator.SERVICE`HueLBServiceModelGenerator.SERVICE_TYPE`HueLBServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/lb")));" is 243.,86
apache_knox,org.apache.knox.gateway.topology.discovery.cm.collector,HueURLCollectorTest,testLBSSL,Long Statement,The length of the statement "testRoleModels.put(HueServiceModelGenerator.ROLE_TYPE`Collections.singletonList(createMockServiceModel(HueServiceModelGenerator.SERVICE`HueServiceModelGenerator.SERVICE_TYPE`HueServiceModelGenerator.ROLE_TYPE`"https://hostx:1234/test1")));" is 239.,114
apache_knox,org.apache.knox.gateway.topology.discovery.cm.collector,HueURLCollectorTest,testLBSSL,Long Statement,The length of the statement "testRoleModels.put(HueLBServiceModelGenerator.ROLE_TYPE`Collections.singletonList(createMockServiceModel(HueLBServiceModelGenerator.SERVICE`HueLBServiceModelGenerator.SERVICE_TYPE`HueLBServiceModelGenerator.ROLE_TYPE`"http://hostx:1234/lb")));" is 243.,114
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,VirtualGroupMapper,evalPredicate,Long Parameter List,The method has 5 parameters. ,59
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,VirtualGroupMapper,addRequestFunctions,Long Statement,The length of the statement "interpreter.addFunction("request-attribute"`Arity.UNARY`params -> ensureNotNull(req.getAttribute((String)params.get(0))));" is 122.,76
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,VirtualGroupMapper,addRequestFunctions,Long Statement,The length of the statement "interpreter.addFunction("request-header"`Arity.UNARY`params -> ensureNotNull(((HttpServletRequest)req).getHeader((String)params.get(0))));" is 138.,76
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,VirtualGroupMapper,addRequestFunctions,Long Statement,The length of the statement "interpreter.addFunction("session"`Arity.UNARY`params -> ensureNotNull(sessionAttribute((HttpServletRequest)req`(String)params.get(0))));" is 136.,76
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,CommonIdentityAssertionFilter,init,Complex Conditional,The conditional expression principalMapping != null && !principalMapping.isEmpty() || groupPrincipalMapping != null && !groupPrincipalMapping.isEmpty() is complex.,70
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,CommonIdentityAssertionFilter,init,Long Statement,The length of the statement "if (principalMapping != null && !principalMapping.isEmpty() || groupPrincipalMapping != null && !groupPrincipalMapping.isEmpty()) {" is 131.,70
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,CommonIdentityAssertionFilter,doFilter,Long Statement,The length of the statement "String[] virtualGroups=virtualGroupMapper.mapGroups(mappedPrincipalName`combine(subject`groups)`request).toArray(new String[0]);" is 128.,173
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,CommonIdentityAssertionFilter,wrapHttpServletRequest,Long Statement,The length of the statement "return new IdentityAsserterHttpServletRequestWrapper((HttpServletRequest)request`mappedPrincipalName`impersonationParamsList);" is 126.,225
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,AbstractIdentityAssertionFilter,continueChainAsPrincipal,Complex Method,Cyclomatic complexity of the method is 8,89
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,AbstractIdentityAssertionFilter,continueChainAsPrincipal,Long Parameter List,The method has 5 parameters. ,89
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,AbstractIdentityAssertionFilter,continueChainAsPrincipal,Long Statement,The length of the statement "auditor.audit(Action.IDENTITY_MAPPING`primaryPrincipal.getName()`ResourceType.PRINCIPAL`ActionOutcome.SUCCESS`RES.effectiveUser(mappedPrincipalName));" is 150.,89
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,AbstractIdentityAssertionFilter,addMappedGroupsToSubject,Long Statement,The length of the statement "auditor.audit(Action.IDENTITY_MAPPING`mappedPrincipalName`ResourceType.PRINCIPAL`ActionOutcome.SUCCESS`RES.groupsList(Arrays.toString(groups)));" is 144.,183
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,AbstractIdentityAsserterDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,44
apache_knox,org.apache.knox.gateway.identityasserter.common.filter,AbstractIdentityAsserterDeploymentContributor,buildServiceParams,Long Statement,The length of the statement "FilterParamDescriptor f=resource.createFilterParam().name(entry.getKey().toLowerCase(Locale.ROOT)).value(entry.getValue());" is 123.,53
apache_knox,org.apache.knox.gateway.identityasserter.function,UsernameFunctionProcessorTest,testSetup,Long Statement,The length of the statement "server.getContext().setInitParameter(UrlRewriteServletContextListener.DESCRIPTOR_LOCATION_INIT_PARAM_NAME`descriptorUrl);" is 121.,81
apache_knox,org.apache.knox.gateway.identityasserter.function,UsernameFunctionProcessorTest,testRequestUrlRewriteOfUsernameViaRewriteRule,Long Statement,The length of the statement "interaction.expect().method("PUT").requestUrl("test-output-scheme://test-input-host:777/test-output-path/test-input-path").queryParam("user.name"`"test-user").queryParam("test-query-input-name"`"test-query-input-value").queryParam("test-query-output-name"`"test-query-output-value").contentType("text/xml").content(expect`StandardCharsets.UTF_8);" is 346.,164
apache_knox,org.apache.knox.gateway.identityasserter.function,UsernameFunctionProcessorTest,testRequestUrlRewriteOfUsernameViaRewriteRule,Magic Number,The method contains a magic number: 200,164
apache_knox,org.apache.knox.gateway.identityasserter.function,UsernameFunctionProcessorTest,testRequestUrlRewriteOfUsernameViaRewriteRule,Magic Number,The method contains a magic number: 200,164
apache_knox,org.apache.knox.gateway.service.health,MetricsResource,init,Long Statement,The length of the statement "throw new IllegalStateException(String.format(Locale.ROOT`"Couldn't find a MetricRegistry instance with key %s"`METRICS_REGISTRY));" is 131.,70
apache_knox,org.apache.knox.gateway.topology.discovery,PropertiesFileServiceDiscoveryTest,testPropertiesFileServiceDiscovery,Long Statement,The length of the statement "ServiceDiscovery.Cluster c=sd.discover(gc`new DefaultServiceDiscoveryConfig(discoverySource.getAbsolutePath())`"mycluster");" is 124.,59
apache_knox,org.apache.knox.gateway.topology.discovery,PropertiesFileServiceDiscoveryTest,testPropertiesFileServiceDiscovery,Magic Number,The method contains a magic number: 2,59
apache_knox,org.apache.knox.gateway.topology.discovery,ServiceDiscoveryFactoryTest,testGetAllServiceDiscoveries,Magic Number,The method contains a magic number: 3,84
apache_knox,org.apache.knox.gateway.topology.discovery,ServiceDiscoveryFactory,get,Long Statement,The length of the statement "final ServiceDiscovery sd=getAllServiceDiscoveries(gatewayConfig).stream().filter(serviceDiscovery -> serviceDiscovery.getType().equalsIgnoreCase(type)).findFirst().orElse(null);" is 178.,63
apache_knox,org.apache.knox.gateway.topology.simple,JSONProviderConfiguration,saveOrUpdateProviders,Long Statement,The length of the statement "final Optional<Provider> toBeRemoved=this.providers.stream().filter(provider -> provider.getRole().equals(providerToAdd.getRole())).findFirst();" is 144.,50
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,handle,Long Statement,The length of the statement "return handle(config`SimpleDescriptorFactory.parse(desc.getAbsolutePath())`desc.getParentFile()`destDirectory`gatewayServices);" is 127.,94
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,handle,Complex Method,Cyclomatic complexity of the method is 18,102
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,handle,Long Identifier,The length of the field ALLOWED_SERVICES_WITHOUT_URLS_AND_PARAMS is 40.,102
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,handle,Long Parameter List,The method has 5 parameters. ,102
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,handle,Long Statement,The length of the statement "return generateTopology(desc`srcDirectory`destDirectory`cluster`declaredServiceNames`validServiceNames`serviceVersions`serviceURLs`serviceParams`gws);" is 150.,102
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,performDiscovery,Long Statement,The length of the statement "final Collection<String> includedServices=desc.getServices().stream().map(service -> service.getName()).collect(Collectors.toSet());" is 132.,229
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,resolveProviderConfigurationReference,Complex Method,Cyclomatic complexity of the method is 9,335
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,resolveProviderConfigurationReference,Long Identifier,The length of the field PROVIDER_CONFIG_FILE_EXTENSIONS is 31.,335
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,generateTopology,Complex Conditional,The conditional expression zkConf != null && zkConf.getEnsemble() != null && isServiceHaEnabled is complex.,376
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,generateTopology,Complex Method,Cyclomatic complexity of the method is 38,376
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,generateTopology,Long Method,The method has 175 lines of code.,376
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,generateTopology,Long Parameter List,The method has 10 parameters. ,376
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,generateTopology,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(topologyDescriptor.toPath());OutputStreamWriter outputStreamWriter=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8);BufferedWriter fw=new BufferedWriter(outputStreamWriter)){" is 238.,376
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandler,parseHaProviderParam,Magic Number,The method contains a magic number: 2,682
apache_knox,org.apache.knox.gateway.topology.simple,XMLProviderConfiguration,saveOrUpdateProviders,Long Statement,The length of the statement "final Optional<Provider> toBeRemoved=providers.stream().filter(provider -> provider.getRole().equals(providerToAdd.getRole())).findFirst();" is 139.,51
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorImpl,getApplication,Long Statement,The length of the statement "return getApplications().stream().filter(application -> application.getName().equals(applicationName)).findFirst().orElse(null);" is 128.,172
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,doTestDiscoveryConfig,Long Parameter List,The method has 5 parameters. ,140
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandler,Complex Method,Cyclomatic complexity of the method is 11,203
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandler,Long Method,The method has 129 lines of code.,203
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandler,Long Statement,The length of the statement "assertThat("Expected the \"generated\" marker element in the topology XML` with value of \"true\"."`topologyXml`hasXPath("/topology/generated"`is("true")));" is 156.,203
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandler,Long Statement,The length of the statement "ProviderConfiguration testProviderConfiguration=ProviderConfigurationParser.parseXML(new ByteArrayInputStream(TEST_PROVIDER_CONFIG.getBytes(StandardCharsets.UTF_8)));" is 166.,203
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testInvalidServiceURLFromDiscovery,Long Method,The method has 102 lines of code.,390
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testInvalidServiceURLFromDiscovery,Long Statement,The length of the statement "serviceDiscoverySourceProps.setProperty(CLUSTER_NAME + ".NAMENODE.url"`DEFAULT_VALID_SERVICE_URL.replace("http"`"hdfs"));" is 121.,390
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testInvalidServiceURLFromDiscovery,Long Statement,The length of the statement "serviceDiscoverySourceProps.setProperty(CLUSTER_NAME + ".JOBTRACKER.url"`DEFAULT_VALID_SERVICE_URL.replace("http"`"rpc"));" is 122.,390
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testInvalidServiceURLFromDiscovery,Long Statement,The length of the statement "ProviderConfiguration testProviderConfiguration=ProviderConfigurationParser.parseXML(new ByteArrayInputStream(TEST_PROVIDER_CONFIG.getBytes(StandardCharsets.UTF_8)));" is 166.,390
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandlerHaProviderConfigOverrides,Complex Method,Cyclomatic complexity of the method is 15,578
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandlerHaProviderConfigOverrides,Long Method,The method has 181 lines of code.,578
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandlerHaProviderConfigOverrides,Long Statement,The length of the statement "assertThat("Expected the \"generated\" marker element in the topology XML` with value of \"true\"."`topologyXml`hasXPath("/topology/generated"`is("true")));" is 156.,578
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandlerHaProviderConfigOverrides,Long Statement,The length of the statement "ProviderConfiguration testProviderConfiguration=ProviderConfigurationParser.parseXML(new ByteArrayInputStream(TEST_HA_PROVIDER_CONFIG.getBytes(StandardCharsets.UTF_8)));" is 169.,578
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandlerHaProviderConfigOverrides,Long Statement,The length of the statement "assertEquals("Expected true because enabled=auto and service config indicates HA is enabled"`HIVE_HA_ENABLED`hiveServiceParams.get("haEnabled"));" is 145.,578
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandlerHaProviderConfigOverrides,Long Statement,The length of the statement "assertEquals("Expected true because enabled=auto and service config indicates HA is enabled"`ATLAS_HA_ENABLED`atlasServiceParams.get("haEnabled"));" is 147.,578
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,testSimpleDescriptorHandlerHaProviderConfigOverrides,Magic Number,The method contains a magic number: 2,578
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,validateGeneratedProviderConfiguration,Long Identifier,The length of the identifier generatedProviderConfiguration is 30.,866
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,validateGeneratedProviderConfiguration,Long Statement,The length of the statement "ProviderConfiguration generatedProviderConfiguration=ProviderConfigurationParser.parseXML(new ByteArrayInputStream(writer.toString().getBytes(StandardCharsets.UTF_8)));" is 168.,866
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,validateGeneratedProviderConfiguration,Long Statement,The length of the statement "assertTrue("Failed to validate provider with role " + expectedProvider.getRole()`validateProvider(expectedProvider`actualProviders));" is 133.,866
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,validateProvider,Complex Method,Cyclomatic complexity of the method is 9,894
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorHandlerTest,validateProvider,Long Statement,The length of the statement "if (actualParams.containsKey(expectedParamKey) && expectedParams.get(expectedParamKey).equals(actualParams.get(expectedParamKey))) {" is 132.,894
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptor,Empty catch clause,The method has an empty catch block.,105
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptor,Long Statement,The length of the statement "services.put("HIVE"`Arrays.asList("http://c6401.ambari.apache.org"`"http://c6402.ambari.apache.org"`"http://c6403.ambari.apache.org"));" is 135.,105
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptor,Long Statement,The length of the statement "testFile=writeDescriptorFile(type`fileName`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services);" is 125.,105
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServiceVersions,Empty catch clause,The method has an empty catch block.,147
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServiceVersions,Long Statement,The length of the statement "services.put("HIVE"`Arrays.asList("http://c6401.ambari.apache.org"`"http://c6402.ambari.apache.org"`"http://c6403.ambari.apache.org"));" is 135.,147
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServiceVersions,Long Statement,The length of the statement "testFile=writeDescriptorFile(type`fileName`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`serviceVersions);" is 141.,147
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServiceParams,Empty catch clause,The method has an empty catch block.,196
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServiceParams,Long Statement,The length of the statement "services.put("HIVE"`Arrays.asList("http://c6401.ambari.apache.org"`"http://c6402.ambari.apache.org"`"http://c6403.ambari.apache.org"));" is 135.,196
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServiceParams,Long Statement,The length of the statement "testFile=writeDescriptorFile(type`fileName`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`null`serviceParams);" is 144.,196
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithApplications,Empty catch clause,The method has an empty catch block.,257
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithApplications,Long Statement,The length of the statement "testFile=writeDescriptorFile(type`fileName`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`null`null`null`apps`appParams);" is 146.,257
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServicesAndApplications,Empty catch clause,The method has an empty catch block.,319
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServicesAndApplications,Long Statement,The length of the statement "services.put("HIVE"`Arrays.asList("http://c6401.ambari.apache.org"`"http://c6402.ambari.apache.org"`"http://c6403.ambari.apache.org"));" is 135.,319
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServicesAndApplications,Long Statement,The length of the statement "testFile=writeDescriptorFile(type`fileName`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`null`serviceParams`apps`appParams);" is 159.,319
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,testParseSimpleDescriptorWithServicesAndApplications,Long Statement,The length of the statement "validateSimpleDescriptor(sd`discoveryType`discoveryAddress`providerConfig`clusterName`services`null`serviceParams`apps`appParams);" is 130.,319
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Parameter List,The method has 8 parameters. ,424
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Statement,The length of the statement "return writeDescriptorFile(type`path`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`null);" is 124.,424
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Parameter List,The method has 9 parameters. ,443
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Statement,The length of the statement "return writeDescriptorFile(type`path`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`serviceVersions`null);" is 140.,443
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Parameter List,The method has 10 parameters. ,464
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Statement,The length of the statement "return writeDescriptorFile(type`path`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`serviceVersions`serviceParams`null`null);" is 159.,464
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Parameter List,The method has 12 parameters. ,489
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Statement,The length of the statement "result=writeJSON(path`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`serviceVersions`serviceParams`apps`appParams);" is 149.,489
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeDescriptorFile,Long Statement,The length of the statement "result=writeYAML(path`discoveryType`discoveryAddress`discoveryUser`providerConfig`clusterName`services`serviceVersions`serviceParams`apps`appParams);" is 149.,489
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeJSON,Long Parameter List,The method has 11 parameters. ,535
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeJSON,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(pathObject);Writer fw=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8)){" is 136.,535
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeServiceOrApplicationJSON,Complex Method,Cyclomatic complexity of the method is 12,574
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeYAML,Long Parameter List,The method has 11 parameters. ,629
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeYAML,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(pathObject);Writer fw=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8)){" is 136.,629
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,writeServiceOrApplicationYAML,Complex Method,Cyclomatic complexity of the method is 9,666
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,validateSimpleDescriptor,Long Parameter List,The method has 6 parameters. ,703
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,validateSimpleDescriptor,Long Parameter List,The method has 7 parameters. ,713
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,validateSimpleDescriptor,Long Statement,The length of the statement "validateSimpleDescriptor(sd`discoveryType`discoveryAddress`providerConfig`clusterName`expectedServices`expectedServiceVersions`null);" is 133.,713
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,validateSimpleDescriptor,Long Parameter List,The method has 8 parameters. ,724
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,validateSimpleDescriptor,Long Statement,The length of the statement "validateSimpleDescriptor(sd`discoveryType`discoveryAddress`providerConfig`clusterName`expectedServices`expectedServiceVersions`expectedServiceParameters`null`null);" is 164.,724
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,validateSimpleDescriptor,Complex Method,Cyclomatic complexity of the method is 13,744
apache_knox,org.apache.knox.gateway.topology.simple,SimpleDescriptorFactoryTest,validateSimpleDescriptor,Long Parameter List,The method has 10 parameters. ,744
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,testParseProviderConfigurationXML,Long Statement,The length of the statement "final String XML="<gateway>\n" + " <provider>\n" + " <role>TestNotEnabled</role>\n"+ " <name>TestProviderNotEnabled</name>\n"+ " <enabled>false</enabled>\n"+ " </provider>\n"+ " <provider>\n"+ " <role>TestEnabledNoParams</role>\n"+ " <name>TestProviderEnabledNoParams</name>\n"+ " <enabled>true</enabled>\n"+ " </provider>\n"+ " <provider>\n"+ " <role>TestEnabledWithParams</role>\n"+ " <name>TestProviderEnabledWithParams</name>\n"+ " <enabled>true</enabled>\n"+ " <param><name>param1</name><value>param1-value</value></param>\n"+ " <param><name>param2</name><value>param2-value</value></param>\n"+ " <param><name>param3</name><value>param3-value</value></param>\n"+ " </provider>\n"+ "</gateway>\n";" is 701.,60
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,testParseProviderConfigurationXML,Magic Number,The method contains a magic number: 3,60
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,testParseProviderConfigurationXML,Magic Number,The method contains a magic number: 3,60
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,testParseProviderConfigurationJSON,Long Statement,The length of the statement "final String JSON="{\n" + " \"providers\": [\n" + " {\n"+ " \"role\":\"authentication\"`\n"+ " \"name\":\"ShiroProvider\"`\n"+ " \"enabled\":\"true\"`\n"+ " \"params\":{\n"+ " \"main.ldapContextFactory\":\"org.apache.hadoop.gateway.shirorealm.KnoxLdapContextFactory\"`\n"+ " \"main.ldapRealm\":\"org.apache.hadoop.gateway.shirorealm.KnoxLdapRealm\"`\n"+ " \"main.ldapRealm.contextFactory\":\"$ldapContextFactory\"`\n"+ " \"main.ldapRealm.userDnTemplate\":\"uid={0}`ou=people`dc=hadoop`dc=apache`dc=org\"`\n"+ " \"main.ldapRealm.contextFactory.url\":\"ldap://localhost:33389\"`\n"+ " \"main.ldapRealm.contextFactory.authenticationMechanism\":\"simple\"`\n"+ " \"sessionTimeout\":\"30\"`\n"+ " \"urls./**\":\"authcBasic\"\n"+ " }\n"+ " }`\n"+ " {\n"+ " \"role\":\"hostmap\"`\n"+ " \"name\":\"static\"`\n"+ " \"enabled\":\"true\"`\n"+ " \"params\":{\n"+ " \"localhost\":\"sandbox`sandbox.hortonworks.com\"\n"+ " }\n"+ " }`\n"+ " {\n"+ " \"role\":\"dummy\"`\n"+ " \"name\":\"NoParamsDummyProvider\"`\n"+ " \"enabled\":\"true\"\n"+ " }`\n"+ " {\n"+ " \"role\":\"ha\"`\n"+ " \"name\":\"HaProvider\"`\n"+ " \"enabled\":\"false\"`\n"+ " \"params\":{\n"+ " \"HIVE\":\"maxFailoverAttempts=3;failoverSleep=1000;enabled=true\"`\n"+ " \"WEBHDFS\":\"maxFailoverAttempts=3;failoverSleep=1000;enabled=true\"\n"+ " }\n"+ " }\n"+ " ]\n"+ "}";" is 1324.,123
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,testParseProviderConfigurationJSON,Magic Number,The method contains a magic number: 4,123
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,doTestParseProviderConfigurationYAML,Long Statement,The length of the statement "final String YAML="---\n" + "providers: \n" + " - role: authentication\n"+ " name: ShiroProvider\n"+ " enabled: true\n"+ " params:\n"+ " sessionTimeout: 30\n"+ " main.ldapRealm: org.apache.hadoop.gateway.shirorealm.KnoxLdapRealm\n"+ " main.ldapContextFactory: org.apache.hadoop.gateway.shirorealm.KnoxLdapContextFactory\n"+ " main.ldapRealm.contextFactory: $ldapContextFactory\n"+ " main.ldapRealm.userDnTemplate: uid={0}`ou=people`dc=hadoop`dc=apache`dc=org\n"+ " main.ldapRealm.contextFactory.url: ldap://localhost:33389\n"+ " main.ldapRealm.contextFactory.authenticationMechanism: simple\n"+ " urls./**: authcBasic\n"+ " - role: hostmap\n"+ " name: static\n"+ " enabled: true\n"+ " params:\n"+ " localhost: sandbox`sandbox.hortonworks.com\n"+ " - role: dummy\n"+ " name: NoParamsDummyProvider\n"+ " enabled: true\n"+ " - role: ha\n"+ " name: HaProvider\n"+ " enabled: false\n"+ " params:\n"+ " WEBHDFS: maxFailoverAttempts=3;failoverSleep=1000;enabled=true\n"+ " HIVE: maxFailoverAttempts=3;failoverSleep=1000;enabled=true";" is 1027.,194
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,doTestParseProviderConfigurationYAML,Magic Number,The method contains a magic number: 4,194
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,validateParsedProviders,Long Statement,The length of the statement "String[] expectedParameterOrder=new String[]{"main.ldapContextFactory"`"main.ldapRealm"`"main.ldapRealm.contextFactory"`"main.ldapRealm.contextFactory.authenticationMechanism"`"main.ldapRealm.contextFactory.url"`"main.ldapRealm.userDnTemplate"`"sessionTimeout"`"urls./**"};" is 273.,238
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,validateParsedProviders,Magic Number,The method contains a magic number: 8,238
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,validateParsedProviders,Magic Number,The method contains a magic number: 2,238
apache_knox,org.apache.knox.gateway.topology.simple,ProviderConfigurationParserTest,doTestParseProviderConfiguration,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(testConfig.toPath());Writer fw=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8)){" is 145.,295
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Long Statement,The length of the statement "String connectionString=String.format("jdbc:hive2://%s:%d/;ssl=true;sslTrustStore=%s;trustStorePassword=%s?hive.server2.transport.mode=http;hive.server2.thrift.http.path=/%s"`gatewayHost`gatewayPort`trustStore`trustStorePassword`contextPath);" is 242.,32
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Long Statement,The length of the statement "statement.execute("CREATE TABLE logs(column1 string` column2 string` column3 string` column4 string` column5 string` column6 string` column7 string) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' '");" is 197.,32
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Magic Number,The method contains a magic number: 8443,32
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Magic Number,The method contains a magic number: 2,32
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Long Statement,The length of the statement "String connectionString=String.format("jdbc:hive2://%s:%d/;ssl=true;sslTrustStore=%s;trustStorePassword=%s?hive.server2.transport.mode=http;hive.server2.thrift.http.path=/%s"`gatewayHost`gatewayPort`trustStore`trustStorePassword`contextPath);" is 242.,32
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Long Statement,The length of the statement "statement.execute("CREATE TABLE logs(column1 string` column2 string` column3 string` column4 string` column5 string` column6 string` column7 string) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' '");" is 197.,32
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Magic Number,The method contains a magic number: 8443,32
apache_knox,org.apache.knox.gateway.shell.hive,HiveJDBCSample,main,Magic Number,The method contains a magic number: 2,32
apache_knox,(default package),HiveJDBCSample,main,Long Statement,The length of the statement "String connectionString=String.format("jdbc:hive2://%s:%d/;ssl=true;sslTrustStore=%s;trustStorePassword=%s?hive.server2.transport.mode=http;hive.server2.thrift.http.path=/%s"`gatewayHost`gatewayPort`trustStore`trustStorePassword`contextPath);" is 242.,32
apache_knox,(default package),HiveJDBCSample,main,Long Statement,The length of the statement "statement.execute("CREATE TABLE logs(column1 string` column2 string` column3 string` column4 string` column5 string` column6 string` column7 string) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' '");" is 197.,32
apache_knox,(default package),HiveJDBCSample,main,Magic Number,The method contains a magic number: 8443,32
apache_knox,(default package),HiveJDBCSample,main,Magic Number,The method contains a magic number: 2,32
apache_knox,(default package),HiveJDBCSample,main,Long Statement,The length of the statement "String connectionString=String.format("jdbc:hive2://%s:%d/;ssl=true;sslTrustStore=%s;trustStorePassword=%s?hive.server2.transport.mode=http;hive.server2.thrift.http.path=/%s"`gatewayHost`gatewayPort`trustStore`trustStorePassword`contextPath);" is 242.,32
apache_knox,(default package),HiveJDBCSample,main,Long Statement,The length of the statement "statement.execute("CREATE TABLE logs(column1 string` column2 string` column3 string` column4 string` column5 string` column6 string` column7 string) ROW FORMAT DELIMITED FIELDS TERMINATED BY ' '");" is 197.,32
apache_knox,(default package),HiveJDBCSample,main,Magic Number,The method contains a magic number: 8443,32
apache_knox,(default package),HiveJDBCSample,main,Magic Number,The method contains a magic number: 2,32
apache_knox,org.apache.knox.gateway.deploy,AnonymousAuthDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,53
apache_knox,org.apache.knox.gateway.deploy,DeploymentContextImpl,DeploymentContextImpl,Long Parameter List,The method has 6 parameters. ,44
apache_knox,org.apache.knox.gateway.deploy,DeploymentContextImpl,contributeFilter,Long Parameter List,The method has 5 parameters. ,109
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,getJAXBContext,Magic Number,The method contains a magic number: 2,87
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,validateNoAppsWithDuplicateUrlsInTopology,Complex Method,Cyclomatic complexity of the method is 8,128
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,validateNoAppsWithDuplicateUrlsInTopology,Long Statement,The length of the statement "throw new DeploymentException("Topology " + topology.getName() + " contains applications "+ app.getName()+ " and "+ dup.getName()+ " with the same url: "+ url);" is 160.,128
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,validateNoAppsWithRootUrlsInServicesTopology,Long Statement,The length of the statement "throw new DeploymentException("Topology " + topology.getName() + " contains both services and an application "+ dups.get(0).getName()+ " with a root url.");" is 156.,152
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,collectTopologyProviders,Complex Method,Cyclomatic complexity of the method is 9,275
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,selectContextApplications,Complex Conditional,The conditional expression url == null || url.isEmpty() || "/".equals(url) is complex.,334
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,selectContextApplications,Complex Method,Cyclomatic complexity of the method is 8,334
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,selectContextApplications,Long Statement,The length of the statement "throw new DeploymentException(String.format(Locale.ROOT`"Topologies with services cannot contain an application (%s) with a root url."`name));" is 142.,334
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,injectServices,Empty catch clause,The method has an empty catch block.,441
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,injectServices,Long Statement,The length of the statement "stmt=new Statement(contributor`"set" + serviceType.getServiceTypeName()`new Object[]{gatewayServices.getService(serviceType)});" is 127.,441
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,contributeServices,Long Statement,The length of the statement "ServiceDeploymentContributor contributor=getServiceContributor(service.getRole()`service.getName()`service.getVersion());" is 121.,490
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,finish,Long Statement,The length of the statement "context.getWebArchive().addAsWebInfResource(new StringAsset(writer.toString())`GatewayServlet.GATEWAY_DESCRIPTOR_LOCATION_DEFAULT);" is 131.,565
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,finish,Long Statement,The length of the statement "servlet.createInitParam().paramName(GatewayServlet.GATEWAY_DESCRIPTOR_LOCATION_PARAM).paramValue("/WEB-INF/" + GatewayServlet.GATEWAY_DESCRIPTOR_LOCATION_DEFAULT);" is 163.,565
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,finish,Long Statement,The length of the statement "filter.createInitParam().paramName(GatewayServlet.GATEWAY_DESCRIPTOR_LOCATION_PARAM).paramValue("/WEB-INF/" + GatewayServlet.GATEWAY_DESCRIPTOR_LOCATION_DEFAULT);" is 162.,565
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,loadStacksServiceContributors,Long Statement,The length of the statement "Set<ServiceDeploymentContributor> deploymentContributors=ServiceDefinitionsLoader.loadServiceDefinitionDeploymentContributors(stacksDir);" is 137.,693
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,getProviderContributor,Complex Conditional,The conditional expression contributor == null || !contributor.getRole().equals(role) || !contributor.getName().equals(name) is complex.,764
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactory,getProviderContributor,Long Statement,The length of the statement "throw new DeploymentException("Failed to contribute provider. Role: " + role + " Name: "+ name+ ". Please check the topology for"+ " errors in name and role and that the provider is "+ "on the classpath.");" is 206.,764
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithRootUrlsInServicesTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains both services and " + "an application test-application with a root url."`e.getMessage());" is 135.,57
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithRootUrlsInServicesTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains both services and an " + "application test-application with a root url."`e.getMessage());" is 135.,57
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithRootUrlsInServicesTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains both services and an " + "application test-application with a root url."`e.getMessage());" is 135.,57
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithRootUrlsInServicesTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains both services and an " + "application test-application with a root url."`e.getMessage());" is 135.,57
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithDuplicateUrlsInTopology,Long Method,The method has 164 lines of code.,160
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithDuplicateUrlsInTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains applications " + "test-application-1 and test-application-2 with the " + "same url: /test-application-dup"`e.getMessage());" is 169.,160
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithDuplicateUrlsInTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains applications " + "test-application-1 and test-application-2 with the same url: /"`e.getMessage());" is 144.,160
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithDuplicateUrlsInTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains applications " + "test-application-1 and test-application-2 with the same url: "`e.getMessage());" is 143.,160
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithDuplicateUrlsInTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains applications " + "test-application-1 and test-application-2 with the " + "same url: test-application-1"`e.getMessage());" is 166.,160
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithDuplicateUrlsInTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains applications " + "test-application-1 and test-application-1 with the " + "same url: test-application-1"`e.getMessage());" is 166.,160
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryTest,test_validateNoAppsWithDuplicateUrlsInTopology,Long Statement,The length of the statement "assertEquals("Topology test-topology contains applications " + "test-application-1 and test-application-2 with the " + "same url: /test-application-3"`e.getMessage());" is 167.,160
apache_knox,org.apache.knox.gateway.deploy,DeploymentContext,contributeFilter,Long Parameter List,The method has 5 parameters. ,43
apache_knox,org.apache.knox.gateway.deploy,ServiceDeploymentContributorBase,addXForwardedFilter,Long Statement,The length of the statement "resource.addFilter().name(XFORWARDED_FILTER_NAME).role(XFORWARDED_FILTER_ROLE).impl("org.apache.knox.gateway.filter.XForwardedHeaderFilter");" is 141.,96
apache_knox,org.apache.knox.gateway.deploy,ServiceDeploymentContributorBase,addDispatchFilter,Long Parameter List,The method has 5 parameters. ,112
apache_knox,org.apache.knox.gateway.deploy,ServiceDeploymentContributorBase,addDispatchFilter,Long Parameter List,The method has 6 parameters. ,116
apache_knox,org.apache.knox.gateway.deploy,ProviderDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,46
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testGenericProviderDeploymentContributor,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[1]/class"`equalTo("org.apache.knox.gateway.filter.XForwardedHeaderFilter")));" is 134.,70
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testGenericProviderDeploymentContributor,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[2]/class"`equalTo("org.apache.knox.gateway.preauth.filter.HeaderPreAuthFederationFilter")));" is 149.,70
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testInvalidGenericProviderDeploymentContributor,Long Statement,The length of the statement "assertEquals("Failed to contribute provider. Role: authentication Name: generic. " + "Please check the topology for errors in name and role and that " + "the provider is on the classpath."`e.getMessage());" is 205.,141
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[1]/class"`equalTo("org.apache.knox.gateway.filter.ResponseCookieFilter")));" is 132.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[2]/class"`equalTo("org.apache.shiro.web.servlet.ShiroFilter")));" is 121.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[3]/class"`equalTo("org.apache.knox.gateway.filter.ShiroSubjectIdentityAdapter")));" is 139.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[4]/class"`equalTo("org.apache.knox.gateway.filter.rewrite.api.UrlRewriteServletFilter")));" is 147.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[5]/class"`equalTo("org.apache.knox.gateway.identityasserter.filter.IdentityAsserterFilter")));" is 151.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[6]/class"`equalTo("org.apache.knox.gateway.filter.AclsAuthorizationFilter")));" is 135.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[7]/class"`equalTo("org.apache.knox.gateway.dispatch.GatewayDispatchFilter")));" is 135.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[2]/filter[1]/class"`equalTo("org.apache.knox.gateway.filter.ResponseCookieFilter")));" is 132.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[2]/filter[2]/class"`equalTo("org.apache.shiro.web.servlet.ShiroFilter")));" is 121.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[2]/filter[3]/class"`equalTo("org.apache.knox.gateway.filter.ShiroSubjectIdentityAdapter")));" is 139.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[2]/filter[4]/class"`equalTo("org.apache.knox.gateway.filter.rewrite.api.UrlRewriteServletFilter")));" is 147.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[2]/filter[5]/class"`equalTo("org.apache.knox.gateway.identityasserter.filter.IdentityAsserterFilter")));" is 151.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[6]/class"`equalTo("org.apache.knox.gateway.filter.AclsAuthorizationFilter")));" is 135.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testSimpleTopology,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[2]/filter[7]/class"`equalTo("org.apache.knox.gateway.dispatch.GatewayDispatchFilter")));" is 135.,193
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testWebXmlGeneration,Magic Number,The method contains a magic number: 10,316
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,createAndTestDeployment,Long Statement,The length of the statement "assertThat(web`hasXPath("/web-app/listener[2]/listener-class"`equalTo("org.apache.knox.gateway.services.GatewayServicesContextListener")));" is 139.,375
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,createAndTestDeployment,Long Statement,The length of the statement "assertThat(web`hasXPath("/web-app/listener[3]/listener-class"`equalTo("org.apache.knox.gateway.services.GatewayMetricsServletContextListener")));" is 145.,375
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,createAndTestDeployment,Long Statement,The length of the statement "assertThat(web`hasXPath("/web-app/listener[4]/listener-class"`equalTo("org.apache.knox.gateway.ha.provider" + ".HaServletContextListener")));" is 141.,375
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,createAndTestDeployment,Long Statement,The length of the statement "assertThat(web`hasXPath("/web-app/listener[5]/listener-class"`equalTo("org.apache.knox.gateway.filter" + ".rewrite.api.UrlRewriteServletContextListener")));" is 156.,375
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[1]/class"`equalTo("org.apache.knox.gateway.filter.AnonymousAuthFilter")));" is 131.,628
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[2]/class"`equalTo("org.apache.knox.gateway.filter.rewrite.api.UrlRewriteServletFilter")));" is 147.,628
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[3]/class"`equalTo("org.apache.knox.gateway.filter.AclsAuthorizationFilter")));" is 135.,628
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway`hasXPath("/gateway/resource[1]/filter[4]/class"`equalTo("org.apache.knox.gateway.dispatch.GatewayDispatchFilter")));" is 135.,628
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway2`hasXPath("/gateway/resource[1]/filter[1]/class"`equalTo("org.apache.knox.gateway.filter.AnonymousAuthFilter")));" is 132.,628
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway2`hasXPath("/gateway/resource[1]/filter[2]/class"`equalTo("org.apache.knox.gateway.filter.rewrite.api.UrlRewriteServletFilter")));" is 148.,628
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway2`hasXPath("/gateway/resource[1]/filter[3]/class"`equalTo("org.apache.knox.gateway.filter.AclsAuthorizationFilter")));" is 136.,628
apache_knox,org.apache.knox.gateway.deploy,DeploymentFactoryFuncTest,testServiceAnonAuth,Long Statement,The length of the statement "assertThat(gateway2`hasXPath("/gateway/resource[1]/filter[4]/class"`equalTo("org.apache.knox.gateway.dispatch.GatewayDispatchFilter")));" is 136.,628
apache_knox,org.apache.knox.gateway.config,ConfigurationInjectorBuilder,createInjector,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to load an implementation of %s"`ConfigurationInjector.class.getName()));" is 140.,41
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfStrings,Magic Number,The method contains a magic number: 2,79
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfStrings,Magic Number,The method contains a magic number: 2,79
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfStrings,Magic Number,The method contains a magic number: 42,79
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfStrings,Magic Number,The method contains a magic number: 42,79
apache_knox,org.apache.knox.gateway.config,FuncTest,testProperties,Magic Number,The method contains a magic number: 2,108
apache_knox,org.apache.knox.gateway.config,FuncTest,testProperties,Magic Number,The method contains a magic number: 2,108
apache_knox,org.apache.knox.gateway.config,FuncTest,testProperties,Magic Number,The method contains a magic number: 42,108
apache_knox,org.apache.knox.gateway.config,FuncTest,testProperties,Magic Number,The method contains a magic number: 42,108
apache_knox,org.apache.knox.gateway.config,FuncTest,testExplicitProvider,Magic Number,The method contains a magic number: 2,152
apache_knox,org.apache.knox.gateway.config,FuncTest,testExplicitProvider,Magic Number,The method contains a magic number: 2,152
apache_knox,org.apache.knox.gateway.config,FuncTest,testExplicitProvider,Magic Number,The method contains a magic number: 42,152
apache_knox,org.apache.knox.gateway.config,FuncTest,testExplicitProvider,Magic Number,The method contains a magic number: 42,152
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfObjects,Magic Number,The method contains a magic number: 42,181
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfObjects,Magic Number,The method contains a magic number: 42,181
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfObjects,Magic Number,The method contains a magic number: 42,181
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfObjects,Magic Number,The method contains a magic number: 42,181
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfObjects,Magic Number,The method contains a magic number: 42,181
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfObjects,Magic Number,The method contains a magic number: 42,181
apache_knox,org.apache.knox.gateway.config,FuncTest,testMapOfObjects,Magic Number,The method contains a magic number: 42,181
apache_knox,org.apache.knox.gateway.config,MapFieldSampleTest,sample,Magic Number,The method contains a magic number: 5,38
apache_knox,org.apache.knox.gateway.config,MapMethodSampleTest,sample,Magic Number,The method contains a magic number: 5,42
apache_knox,org.apache.knox.gateway.config,UsageTest,usage,Long Statement,The length of the statement "ConfigurationInjectorBuilder.configuration().target(target).source(System.getProperties()).bind("user"`"user.name").inject();" is 125.,32
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,injectFieldValue,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to find configuration for %s bound to %s of %s via %s"`bind`name`target.getClass().getName()`adapter.getClass().getName()));" is 191.,75
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,injectFieldValue,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to inject field configuration property %s of %s"`name`target.getClass().getName())`e);" is 153.,75
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,injectMethodValue,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to find configuration for %s as %s of %s via %s"`bndName`argName`target.getClass().getName()`adapter.getClass().getName()));" is 191.,105
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,injectMethodValue,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to inject method configuration via %s of %s"`methodName`target.getClass().getName())`e);" is 155.,105
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,convertValue,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to convert configuration for %s of %s to %s"`name`target.getClass().getName()`type.getName())`e);" is 164.,144
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,retrieveValue,Long Parameter List,The method has 5 parameters. ,156
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,retrieveValue,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to retrieve configuration for %s bound to %s of %s via %s"`bind`name`target.getClass().getName()`adapter.getClass().getName())`e);" is 197.,156
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,getBindName,Long Statement,The length of the statement "throw new ConfigurationException(String.format(Locale.ROOT`"Failed to bind configuration for %s of %s via %s"`name`target.getClass().getName()`binding.getClass().getName())`e);" is 176.,194
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,getConfigName,Complex Conditional,The conditional expression methodName.length() > 3 && methodName.startsWith("set") && Character.isUpperCase(methodName.charAt(3)) is complex.,233
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,getConfigName,Magic Number,The method contains a magic number: 3,233
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,getConfigName,Magic Number,The method contains a magic number: 3,233
apache_knox,org.apache.knox.gateway.config.impl,DefaultConfigurationInjector,getConfigName,Magic Number,The method contains a magic number: 3,233
apache_knox,org.apache.knox.gateway.config.impl,ConfigurationAdapterFactory,findConstructorForConfigType,Long Statement,The length of the statement "throw new NoSuchMethodException("No constructor for " + adapterType.getName() + " that will accept "+ configType.getName());" is 124.,86
apache_knox,org.apache.knox.gateway.config.impl,BeanConfigurationAdapterDescriptorTest,testDescriptor,Long Statement,The length of the statement "assertThat("Descriptor didn't return " + BeanConfigurationAdapter.class.getName()`type == BeanConfigurationAdapter.class);" is 122.,44
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGatewayConfDir,Long Statement,The length of the statement "@SuppressWarnings("deprecation") String configDir=System.getProperty(GATEWAY_CONF_HOME_VAR`System.getenv(GATEWAY_CONF_HOME_VAR));" is 129.,329
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGatewayDataDir,Long Statement,The length of the statement "@SuppressWarnings("deprecation") String dataDir=System.getProperty(GATEWAY_DATA_HOME_VAR`System.getenv(GATEWAY_DATA_HOME_VAR));" is 127.,342
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,loadConfig,Long Statement,The length of the statement "configFileUrl=loadConfigFile(System.getProperty(GATEWAY_HOME_VAR)`GATEWAY_CONFIG_DIR_PREFIX + File.separator + fileName);" is 121.,431
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getDefaultTopologyName,Long Identifier,The length of the field GATEWAY_DEFAULT_TOPOLOGY_NAME_PARAM is 35.,555
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getIncludedSSLCiphers,Complex Conditional,The conditional expression value != null && !value.isEmpty() && !"none".equalsIgnoreCase(value.trim()) is complex.,586
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getExcludedSSLCiphers,Complex Conditional,The conditional expression value != null && !value.isEmpty() && !"none".equalsIgnoreCase(value.trim()) is complex.,596
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpClientMaxConnections,Magic Number,The method contains a magic number: 32,656
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpClientConnectionTimeout,Empty catch clause,The method has an empty catch block.,661
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpClientConnectionTimeout,Long Identifier,The length of the field HTTP_CLIENT_CONNECTION_TIMEOUT is 30.,661
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpClientConnectionTimeout,Magic Number,The method contains a magic number: 20,661
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpClientSocketTimeout,Empty catch clause,The method has an empty catch block.,675
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpClientSocketTimeout,Magic Number,The method contains a magic number: 20,675
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getThreadPoolMax,Magic Number,The method contains a magic number: 254,714
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getThreadPoolMax,Magic Number,The method contains a magic number: 5,714
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getThreadPoolMax,Magic Number,The method contains a magic number: 5,714
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerRequestBuffer,Magic Number,The method contains a magic number: 16,724
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerRequestBuffer,Magic Number,The method contains a magic number: 1024,724
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerRequestHeaderBuffer,Long Identifier,The length of the field HTTP_SERVER_REQUEST_HEADER_BUFFER is 33.,729
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerRequestHeaderBuffer,Magic Number,The method contains a magic number: 8,729
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerRequestHeaderBuffer,Magic Number,The method contains a magic number: 1024,729
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerResponseBuffer,Magic Number,The method contains a magic number: 32,734
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerResponseBuffer,Magic Number,The method contains a magic number: 1024,734
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerResponseHeaderBuffer,Long Identifier,The length of the field HTTP_SERVER_RESPONSE_HEADER_BUFFER is 34.,739
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerResponseHeaderBuffer,Magic Number,The method contains a magic number: 8,739
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHttpServerResponseHeaderBuffer,Magic Number,The method contains a magic number: 1024,739
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGatewayDeploymentsBackupVersionLimit,Long Identifier,The length of the field DEPLOYMENTS_BACKUP_VERSION_LIMIT is 32.,744
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGatewayDeploymentsBackupVersionLimit,Magic Number,The method contains a magic number: 5,744
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGatewayIdleTimeout,Magic Number,The method contains a magic number: 300000L,753
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGlobalRulesServices,Complex Conditional,The conditional expression value != null && !value.isEmpty() && !"none".equalsIgnoreCase(value.trim()) is complex.,854
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isGraphiteMetricsReportingEnabled,Long Identifier,The length of the field GRAPHITE_METRICS_REPORTING_ENABLED is 34.,873
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGraphiteHost,Long Identifier,The length of the field GRAPHITE_METRICS_REPORTING_HOST is 31.,878
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGraphitePort,Long Identifier,The length of the field GRAPHITE_METRICS_REPORTING_PORT is 31.,883
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGraphitePort,Magic Number,The method contains a magic number: 32772,883
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getGraphiteReportingFrequency,Long Identifier,The length of the field GRAPHITE_METRICS_REPORTING_FREQUENCY is 36.,888
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isWebsocketEnabled,Long Identifier,The length of the field DEFAULT_WEBSOCKET_FEATURE_ENABLED is 33.,893
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxTextMessageSize,Long Identifier,The length of the field WEBSOCKET_MAX_TEXT_MESSAGE_SIZE is 31.,899
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxTextMessageSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_SIZE is 39.,899
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxBinaryMessageSize,Long Identifier,The length of the field WEBSOCKET_MAX_BINARY_MESSAGE_SIZE is 33.,904
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxBinaryMessageSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_SIZE is 41.,904
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxTextMessageBufferSize,Long Identifier,The length of the field WEBSOCKET_MAX_TEXT_MESSAGE_BUFFER_SIZE is 38.,909
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxTextMessageBufferSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_BUFFER_SIZE is 46.,909
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxBinaryMessageBufferSize,Long Identifier,The length of the field WEBSOCKET_MAX_BINARY_MESSAGE_BUFFER_SIZE is 40.,914
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxBinaryMessageBufferSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_BUFFER_SIZE is 48.,914
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketInputBufferSize,Long Identifier,The length of the field DEFAULT_WEBSOCKET_INPUT_BUFFER_SIZE is 35.,919
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketAsyncWriteTimeout,Long Identifier,The length of the field DEFAULT_WEBSOCKET_ASYNC_WRITE_TIMEOUT is 37.,924
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketIdleTimeout,Long Identifier,The length of the field DEFAULT_WEBSOCKET_IDLE_TIMEOUT is 30.,929
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxWaitBufferCount,Long Identifier,The length of the field WEBSOCKET_MAX_WAIT_BUFFER_COUNT is 31.,934
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getWebsocketMaxWaitBufferCount,Long Identifier,The length of the field DEFAULT_WEBSOCKET_MAX_WAIT_BUFFER_COUNT is 39.,934
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isGatewayPortMappingEnabled,Long Identifier,The length of the field DEFAULT_GATEWAY_PORT_MAPPING_ENABLED is 36.,957
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,parseNetworkTimeout,Long Statement,The length of the statement "PeriodFormatter f=new PeriodFormatterBuilder().appendMinutes().appendSuffix("m"`" min").appendSeconds().appendSuffix("s"`" sec").appendMillis().toFormatter();" is 158.,963
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isCookieScopingToPathEnabled,Long Identifier,The length of the field DEFAULT_COOKIE_SCOPING_FEATURE_ENABLED is 38.,972
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getClusterMonitorPollingInterval,Long Identifier,The length of the field CLUSTER_CONFIG_MONITOR_INTERVAL_SUFFIX is 38.,1028
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getClusterMonitorPollingInterval,Long Statement,The length of the statement "return getInt(CLUSTER_CONFIG_MONITOR_PREFIX + type.toLowerCase(Locale.ROOT) + CLUSTER_CONFIG_MONITOR_INTERVAL_SUFFIX`-1);" is 121.,1028
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isClusterMonitorEnabled,Long Identifier,The length of the field CLUSTER_CONFIG_MONITOR_ENABLED_SUFFIX is 37.,1033
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isClusterMonitorEnabled,Long Statement,The length of the statement "return getBoolean(CLUSTER_CONFIG_MONITOR_PREFIX + type.toLowerCase(Locale.ROOT) + CLUSTER_CONFIG_MONITOR_ENABLED_SUFFIX`false);" is 127.,1033
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getRemoteConfigurationMonitorClientName,Long Identifier,The length of the field REMOTE_CONFIG_MONITOR_CLIENT_NAME is 33.,1061
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,allowUnauthenticatedRemoteRegistryReadAccess,Long Identifier,The length of the field REMOTE_CONFIG_MONITOR_CLIENT_ALLOW_READ_ACCESS is 46.,1066
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isRemoteAliasServiceEnabled,Long Identifier,The length of the field DEFAULT_REMOTE_ALIAS_SERVICE_ENABLED is 36.,1071
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getRemoteAliasServiceConfigurationPrefix,Long Identifier,The length of the field REMOTE_ALIAS_SERVICE_CONFIG_PREFIX is 34.,1076
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getRemoteAliasServiceConfigurationPrefix,Long Identifier,The length of the field REMOTE_ALIAS_SERVICE_CONFIG_PREFIX_DEFAULT is 42.,1076
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getRemoteAliasServiceConfiguration,Long Identifier,The length of the identifier remoteAliasServiceConfiguration is 31.,1081
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getFederationHeaderName,Long Identifier,The length of the field DEFAULT_FEDERATION_HEADER_NAME is 30.,1114
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getAutoDeployTopologyNames,Long Identifier,The length of the field DEFAULT_AUTO_DEPLOY_TOPOLOGIES is 30.,1119
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getDispatchWhitelistServices,Long Identifier,The length of the field DISPATCH_HOST_WHITELIST_SERVICES is 32.,1135
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isTopologyValidationEnabled,Long Identifier,The length of the field DEFAULT_STRICT_TOPOLOGY_VALIDATION is 34.,1149
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,topologyRedeploymentRequiresChanges,Long Identifier,The length of the field TOPOLOGY_REDEPLOYMENT_REQUIRES_CHANGES is 38.,1155
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getXForwardContextAppendServices,Complex Conditional,The conditional expression value != null && !value.isEmpty() && !"none".equalsIgnoreCase(value.trim()) is complex.,1160
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getXForwardContextAppendServices,Long Identifier,The length of the field X_FORWARD_CONTEXT_HEADER_APPEND_SERVICES is 40.,1160
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getClouderaManagerDescriptorsMonitoringInterval,Long Identifier,The length of the field CLOUDERA_MANAGER_DESCRIPTORS_MONITOR_INTERVAL is 45.,1182
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getClouderaManagerAdvancedServiceDiscoveryConfigurationMonitoringInterval,Long Identifier,The length of the field CLOUDERA_MANAGER_ADVANCED_SERVICE_DISCOVERY_CONF_MONITOR_INTERVAL is 65.,1187
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getClouderaManagerServiceDiscoveryRepositoryEntryTTL,Long Identifier,The length of the field CLOUDERA_MANAGER_SERVICE_DISCOVERY_REPOSITORY_CACHE_ENTRY_TTL is 61.,1192
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getClouderaManagerServiceDiscoveryRepositoryEntryTTL,Long Statement,The length of the statement "return getLong(CLOUDERA_MANAGER_SERVICE_DISCOVERY_REPOSITORY_CACHE_ENTRY_TTL`DEFAULT_CM_SERVICE_DISCOVERY_CACHE_ENTRY_TTL);" is 123.,1192
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getClouderaManagerServiceDiscoveryMaximumRetryAttempts,Long Identifier,The length of the field CLOUDERA_MANAGER_SERVICE_DISCOVERY_MAX_RETRY_ATTEMPS is 52.,1197
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getKnoxTokenEvictionInterval,Long Identifier,The length of the field KNOX_TOKEN_EVICTION_INTERVAL_DEFAULT is 36.,1208
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getKnoxTokenEvictionGracePeriod,Long Identifier,The length of the field KNOX_TOKEN_EVICTION_GRACE_PERIOD is 32.,1213
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getKnoxTokenEvictionGracePeriod,Long Identifier,The length of the field KNOX_TOKEN_EVICTION_GRACE_PERIOD_DEFAULT is 40.,1213
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getKnoxTokenStateAliasPersistenceInterval,Long Identifier,The length of the field KNOX_TOKEN_ALIAS_PERSISTENCE_INTERVAL is 37.,1218
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getKnoxTokenStateAliasPersistenceInterval,Long Identifier,The length of the field KNOX_TOKEN_ALIAS_PERSISTENCE_INTERVAL_DEFAULT is 45.,1218
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHiddenTopologiesOnHomepage,Long Identifier,The length of the field KNOX_HOMEPAGE_HIDDEN_TOPOLOGIES is 31.,1233
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHiddenTopologiesOnHomepage,Long Identifier,The length of the field KNOX_HOMEPAGE_HIDDEN_TOPOLOGIES_DEFAULT is 39.,1233
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHiddenTopologiesOnHomepage,Long Statement,The length of the statement "return hiddenTopologies == null || hiddenTopologies.isEmpty() ? KNOX_HOMEPAGE_HIDDEN_TOPOLOGIES_DEFAULT : hiddenTopologies;" is 123.,1233
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getPinnedTopologiesOnHomepage,Long Identifier,The length of the field KNOX_HOMEPAGE_PINNED_TOPOLOGIES is 31.,1239
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isKnoxTokenPermissiveValidationEnabled,Long Identifier,The length of the field KNOX_TOKEN_PERMISSIVE_VALIDATION_ENABLED is 40.,1245
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isKnoxTokenPermissiveValidationEnabled,Long Identifier,The length of the field KNOX_TOKEN_PERMISSIVE_VALIDATION_ENABLED_DEFAULT is 48.,1245
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getKeystoreCacheEntryTimeToLiveInMinutes,Long Identifier,The length of the field DEFAULT_KEYSTORE_CACHE_ENTRY_TTL is 32.,1275
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,isGatewayServerIncomingXForwardedSupportEnabled,Long Identifier,The length of the field KNOX_INCOMING_XFORWARDED_ENABLED is 32.,1280
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getHomePageProfiles,Long Statement,The length of the statement "profiles.put(config.getKey().substring(KNOX_HOMEPAGE_PROFILE_PREFIX.length()).toLowerCase(Locale.getDefault())`getTrimmedStringCollection(config.getKey()));" is 156.,1285
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,verifyDatabaseSslServerCertificate,Long Identifier,The length of the field GATEWAY_DATABASE_VERIFY_SERVER_CERT is 35.,1334
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getDatabaseSslTruststoreFileName,Long Identifier,The length of the field GATEWAY_DATABASE_TRUSTSTORE_FILE is 32.,1339
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getPrivilegedUsersConcurrentSessionLimit,Long Identifier,The length of the field GATEWAY_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT is 49.,1354
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getPrivilegedUsersConcurrentSessionLimit,Long Identifier,The length of the field GATEWAY_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT_DEFAULT is 57.,1354
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getPrivilegedUsersConcurrentSessionLimit,Long Statement,The length of the statement "return getInt(GATEWAY_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT`GATEWAY_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT_DEFAULT);" is 123.,1354
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getNonPrivilegedUsersConcurrentSessionLimit,Long Identifier,The length of the field GATEWAY_NON_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT is 53.,1359
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getNonPrivilegedUsersConcurrentSessionLimit,Long Identifier,The length of the field GATEWAY_NON_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT_DEFAULT is 61.,1359
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImpl,getNonPrivilegedUsersConcurrentSessionLimit,Long Statement,The length of the statement "return getInt(GATEWAY_NON_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT`GATEWAY_NON_PRIVILEGED_USERS_CONCURRENT_SESSION_LIMIT_DEFAULT);" is 131.,1359
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 16,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 8,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 32,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 8,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 32,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 32,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 4,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 4,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 16,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 16,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 6,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 6,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 16,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 8,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 32,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 8,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHttpServerSettings,Magic Number,The method contains a magic number: 1024,48
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetGatewayDeploymentsBackupVersionLimit,Magic Number,The method contains a magic number: 5,82
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetGatewayDeploymentsBackupVersionLimit,Magic Number,The method contains a magic number: 3,82
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetGatewayDeploymentsBackupVersionLimit,Magic Number,The method contains a magic number: 3,82
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetGatewayDeploymentsBackupVersionLimit,Magic Number,The method contains a magic number: 3,82
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetGatewayDeploymentsBackupAgeLimit,Magic Number,The method contains a magic number: 86400000L,97
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetGatewayDeploymentsBackupAgeLimit,Magic Number,The method contains a magic number: 86400000L,97
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetGatewayDeploymentsBackupAgeLimit,Magic Number,The method contains a magic number: 2L,97
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGlobalRulesServices,Long Statement,The length of the statement "assertThat(list`is(CoreMatchers.hasItems("NAMENODE"`"JOBTRACKER"`"WEBHDFS"`"WEBHCAT"`"OOZIE"`"WEBHBASE"`"HIVE"`"RESOURCEMANAGER"`"RESOURCEMANAGERAPI")));" is 153.,182
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGlobalRulesServices,Long Statement,The length of the statement "assertThat(config.getGlobalRulesServices()`is(CoreMatchers.hasItems("NAMENODE"`"JOBTRACKER"`"WEBHDFS"`"WEBHCAT"`"OOZIE"`"WEBHBASE"`"HIVE"`"RESOURCEMANAGER"`"RESOURCEMANAGERAPI")));" is 180.,182
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGlobalRulesServices,Long Statement,The length of the statement "assertThat(config.getGlobalRulesServices()`is(CoreMatchers.hasItems("NAMENODE"`"JOBTRACKER"`"WEBHDFS"`"WEBHCAT"`"OOZIE"`"WEBHBASE"`"HIVE"`"RESOURCEMANAGER"`"RESOURCEMANAGERAPI")));" is 180.,182
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testMetricsSettings,Magic Number,The method contains a magic number: 32772,209
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGatewayIdleTimeout,Magic Number,The method contains a magic number: 300000L,220
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGatewayIdleTimeout,Magic Number,The method contains a magic number: 15000L,220
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetRemoteConfigurationRegistryNames,Long Statement,The length of the statement "config.set(GatewayConfigImpl.CONFIG_REGISTRY_PREFIX + ".test1"`"type=ZooKeeper;address=host1:2181;authType=digest;principal=itsme;credentialAlias=testAlias");" is 158.,247
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetRemoteConfigurationRegistryNames,Long Statement,The length of the statement "config.set(GatewayConfigImpl.CONFIG_REGISTRY_PREFIX + ".test2"`"type=ZooKeeper;address=host2:2181`host3:2181`host4:2181");" is 122.,247
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetRemoteConfigurationRegistryNames,Magic Number,The method contains a magic number: 2,247
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHTTPDefaultTimeouts,Magic Number,The method contains a magic number: 20,271
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testHTTPDefaultTimeouts,Magic Number,The method contains a magic number: 20,271
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testGetReadOnlyOverrideTopologyNames,Magic Number,The method contains a magic number: 4,284
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testCustomIdentityKeystoreOptions,Long Statement,The length of the statement "assertEquals(Paths.get(config.getGatewayKeystoreDir()`"gateway.jks").toAbsolutePath().toString()`config.getIdentityKeystorePath());" is 131.,316
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,shouldReturnUserConfiguredRemoteAliasConfigType,Long Identifier,The length of the identifier remoteAliasServiceConfiguration is 31.,406
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,shouldReturnZookeeperAsRemoteAliasConfigTypeIfItIsUnset,Long Identifier,The length of the identifier remoteAliasServiceConfiguration is 31.,416
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testDefaultConcurrentSessionLimitParameters,Magic Number,The method contains a magic number: 3,441
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testDefaultConcurrentSessionLimitParameters,Magic Number,The method contains a magic number: 2,441
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testNormalConcurrentSessionLimitParameters,Magic Number,The method contains a magic number: 5,451
apache_knox,org.apache.knox.gateway.config.impl,GatewayConfigImplTest,testNormalConcurrentSessionLimitParameters,Magic Number,The method contains a magic number: 6,451
apache_knox,org.apache.knox.gateway.jersey,JerseyDispatchDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,46
apache_knox,org.apache.knox.gateway.jersey,JerseyDeploymentContributorTest,testDeploymentContributors,Long Statement,The length of the statement "context.contributeFilter(EasyMock.isA(Service.class)`EasyMock.isA(ResourceDescriptor.class)`EasyMock.isA(String.class)`EasyMock.isA(String.class)`EasyMock.isA(List.class));" is 172.,61
apache_knox,org.apache.knox.gateway.jersey,JerseyDeploymentContributorTest,testDeploymentContributors,Magic Number,The method contains a magic number: 2,61
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,HadoopXmlResourceParser,Long Identifier,The length of the field advancedServiceDiscoveryConfigMap is 33.,77
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,logParserResult,Long Statement,The length of the statement "log.foundKnoxDescriptors(String.join("` "`parserResult.getDescriptors().stream().map(descriptor -> descriptor.getName()).collect(Collectors.toSet()))`path);" is 156.,117
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,logParserResult,Long Statement,The length of the statement "log.foundKnoxProviderConfigurations(String.join("` "`parserResult.getProviders().keySet().stream().collect(Collectors.toSet()))`path);" is 134.,117
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlConfig,Long Identifier,The length of the field CONFIG_NAME_PROVIDER_CONFIGS_PREFIX is 35.,126
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlConfig,Long Statement,The length of the statement "Arrays.asList(providerConfigurations).stream().map(providerConfigurationName -> providerConfigurationName.trim()).forEach(providerConfigurationName -> {" is 152.,126
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlConfig,Long Statement,The length of the statement "final ProviderConfiguration providerConfiguration=getProviderConfiguration(providers`providerConfigFile`providerConfigurationName);" is 131.,126
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlConfig,Long Statement,The length of the statement "providerConfiguration.saveOrUpdateProviders(parseProviderConfigurations(xmlDescriptor.getValue()`providerConfiguration));" is 121.,126
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,getProviderConfiguration,Long Statement,The length of the statement "return providerConfigFile == null ? new JSONProviderConfiguration() : ProviderConfigurationParser.parse(providerConfigFile);" is 124.,156
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProviderConfigurations,Long Identifier,The length of the field CONFIG_NAME_PROVIDER_CONFIGS_ROLE_PREFIX is 40.,175
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProviderConfigurations,Long Statement,The length of the statement "final Set<String> roles=configurationPairs.stream().filter(configurationPair -> configurationPair.trim().startsWith(CONFIG_NAME_PROVIDER_CONFIGS_ROLE_PREFIX)).map(configurationPair -> configurationPair.replace(CONFIG_NAME_PROVIDER_CONFIGS_ROLE_PREFIX`"").trim()).collect(Collectors.toSet());" is 291.,175
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProvider,Long Identifier,The length of the field CONFIG_NAME_PROVIDER_CONFIGS_PARAM_PREFIX is 41.,186
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProvider,Long Identifier,The length of the field CONFIG_NAME_PROVIDER_CONFIGS_PARAM_REMOVE is 41.,186
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProvider,Long Identifier,The length of the field CONFIG_NAME_PROVIDER_CONFIGS_NAME_PREFIX is 40.,186
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProvider,Long Identifier,The length of the field CONFIG_NAME_PROVIDER_CONFIGS_ENABLED_PREFIX is 43.,186
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProvider,Long Statement,The length of the statement "final Set<String> roleConfigurations=configurationPairs.stream().filter(configurationPair -> configurationPair.trim().startsWith(role)).map(configurationPair -> configurationPair.replace(role + "."`"").trim()).collect(Collectors.toSet());" is 238.,186
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseProvider,Magic Number,The method contains a magic number: 2,186
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,getParamsForRole,Long Statement,The length of the statement "final Optional<ProviderConfiguration.Provider> provider=providerConfiguration.getProviders().stream().filter(p -> p.getRole().equals(role)).findFirst();" is 152.,210
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Complex Method,Cyclomatic complexity of the method is 10,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Long Identifier,The length of the identifier advancedServiceDiscoveryConfig is 30.,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Long Identifier,The length of the field CONFIG_NAME_DISCOVERY_PASSWORD_ALIAS is 36.,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Long Identifier,The length of the field CONFIG_NAME_PROVIDER_CONFIG_REFERENCE is 37.,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Long Identifier,The length of the field CONFIG_NAME_APPLICATION_PREFIX is 30.,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Long Identifier,The length of the field advancedServiceDiscoveryConfigMap is 33.,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Magic Number,The method contains a magic number: 2,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseXmlDescriptor,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@728761e7,215
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,setDiscoveryDetails,Long Identifier,The length of the parameter advancedServiceDiscoveryConfig is 30.,265
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,addEnabledServices,Long Identifier,The length of the parameter advancedServiceDiscoveryConfig is 30.,282
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseApplication,Magic Number,The method contains a magic number: 2,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseApplication,Magic Number,The method contains a magic number: 5,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseApplication,Magic Number,The method contains a magic number: 2,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseService,Magic Number,The method contains a magic number: 2,319
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,parseService,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@9b7570a,319
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,isServiceEnabled,Long Identifier,The length of the field advancedServiceDiscoveryConfigMap is 33.,368
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,isServiceEnabled,Long Statement,The length of the statement "return advancedServiceDiscoveryConfigMap.containsKey(descriptorName) ? advancedServiceDiscoveryConfigMap.get(descriptorName).isServiceEnabled(serviceName) : true;" is 162.,368
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,onAdvancedServiceDiscoveryConfigurationChange,Long Identifier,The length of the identifier advancedServiceDiscoveryConfig is 30.,372
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,onAdvancedServiceDiscoveryConfigurationChange,Long Identifier,The length of the field advancedServiceDiscoveryConfigMap is 33.,372
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParser,onAdvancedServiceDiscoveryConfigurationChange,Long Statement,The length of the statement "final AdvancedServiceDiscoveryConfig advancedServiceDiscoveryConfig=new AdvancedServiceDiscoveryConfig(newConfiguration);" is 121.,372
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceMonitor,setupMonitor,Long Statement,The length of the statement "final ScheduledExecutorService executorService=Executors.newSingleThreadScheduledExecutor(new BasicThreadFactory.Builder().namingPattern("ClouderaManagerDescriptorMonitor-%d").build());" is 185.,63
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceMonitor,setupMonitor,Long Statement,The length of the statement "executorService.scheduleAtFixedRate(() -> monitorClouderaManagerDescriptors(null)`0`monitoringInterval`TimeUnit.MILLISECONDS);" is 126.,63
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceMonitor,monitorClouderaManagerDescriptors,Long Identifier,The length of the identifier clouderaManagerDescriptorFiles is 30.,73
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceMonitor,monitorClouderaManagerDescriptors,Long Identifier,The length of the field HADOOP_XML_RESOURCE_FILE_EXTENSION is 34.,73
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceMonitor,monitorClouderaManagerDescriptors,Long Statement,The length of the statement "final File[] clouderaManagerDescriptorFiles=new File(descriptorsDir).listFiles((FileFilter)new SuffixFileFilter(HADOOP_XML_RESOURCE_FILE_EXTENSION));" is 149.,73
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceMonitor,monitorClouderaManagerDescriptor,Complex Conditional,The conditional expression topologyName != null || lastReloadTime == null || lastReloadTime.compareTo(lastModifiedTime) < 0 is complex.,80
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParser,Magic Number,The method contains a magic number: 2,69
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParserWrongDescriptorContent,Long Statement,The length of the statement "final String testConfigPath=this.getClass().getClassLoader().getResource("testDescriptorConfigurationWithWrongDescriptor.xml").getPath();" is 137.,89
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParserWrongXMLContent,Long Statement,The length of the statement "final String testConfigPath=this.getClass().getClassLoader().getResource("testDescriptorConfigurationWithNonHadoopStyleConfiguration.xml").getPath();" is 149.,98
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParserWithNotEnabledServices,Long Identifier,The length of the identifier advancedConfigurationTopology1 is 30.,105
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParserWithNotEnabledServices,Long Identifier,The length of the identifier advancedConfigurationTopology2 is 30.,105
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParserWithNotEnabledServices,Magic Number,The method contains a magic number: 2,105
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParserModifyingProviderParams,Long Statement,The length of the statement "testConfigPath=this.getClass().getClassLoader().getResource("testDescriptorWithAdminProviderConfigUpdatedLdapUrl.xml").getPath();" is 129.,152
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testCMDescriptorParserRemovingProviderParams,Long Statement,The length of the statement "testConfigPath=this.getClass().getClassLoader().getResource("testDescriptorWithAdminProviderConfigRemovedUserDnTemplate.xml").getPath();" is 136.,175
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,buildEnabledParameter,Long Statement,The length of the statement "return AdvancedServiceDiscoveryConfig.PARAMETER_NAME_PREFIX_ENABLED_SERVICE + topologyName + AdvancedServiceDiscoveryConfig.PARAMETER_NAME_POSTFIX_ENABLED_SERVICE+ serviceName;" is 176.,196
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,testSettingDiscoveryDetails,Long Statement,The length of the statement "final String testConfigPath=this.getClass().getClassLoader().getResource("testDescriptorWithoutDiscoveryDetails.xml").getPath();" is 128.,200
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTopology1Descriptors,Long Statement,The length of the statement "final Map<String`String> expectedServiceParameters=Stream.of(new String[][]{{"httpclient.connectionTimeout"`"5m"}`{"httpclient.socketTimeout"`"100m"}}).collect(Collectors.toMap(data -> data[0]`data -> data[1]));" is 211.,218
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTopology1Descriptors,Magic Number,The method contains a magic number: 2,218
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTopology2Descriptors,Long Statement,The length of the statement "final Map<String`String> expectedServiceParameters=Stream.of(new String[][]{{"httpclient.connectionTimeout"`"5m"}`{"httpclient.socketTimeout"`"100m"}}).collect(Collectors.toMap(data -> data[0]`data -> data[1]));" is 211.,237
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,assertService,Long Parameter List,The method has 5 parameters. ,266
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Long Statement,The length of the statement "assertEquals("org.apache.knox.gateway.shirorealm.KnoxLdapContextFactory"`authenticationProvider.getParams().get("main.ldapContextFactory"));" is 140.,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Long Statement,The length of the statement "assertEquals("org.apache.hadoop.gateway.shirorealm.KnoxLdapRealm"`authenticationProvider.getParams().get("main.ldapRealm"));" is 124.,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Long Statement,The length of the statement "assertEquals("uid=guest`ou=people`dc=hadoop`dc=apache`dc=org"`authenticationProvider.getParams().get("main.ldapRealm.contextFactory.systemUsername"));" is 150.,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Long Statement,The length of the statement "assertEquals("${ALIAS=knoxLdapSystemPassword}"`authenticationProvider.getParams().get("main.ldapRealm.contextFactory.systemPassword"));" is 135.,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Long Statement,The length of the statement "assertEquals("uid={0}`ou=people`dc=hadoop`dc=apache`dc=org"`authenticationProvider.getParams().get("main.ldapRealm.userDnTemplate"));" is 133.,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Magic Number,The method contains a magic number: 2,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Magic Number,The method contains a magic number: 10,292
apache_knox,org.apache.knox.gateway.topology.hadoop.xml,HadoopXmlResourceParserTest,validateTestDescriptorProviderConfigs,Magic Number,The method contains a magic number: 9,292
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfig,isServiceEnabled,Long Identifier,The length of the field PARAMETER_NAME_PREFIX_ENABLED_SERVICE is 37.,48
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfig,isServiceEnabled,Long Identifier,The length of the field PARAMETER_NAME_POSTFIX_ENABLED_SERVICE is 38.,48
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfig,isServiceEnabled,Long Statement,The length of the statement "final String propertyName=PARAMETER_NAME_PREFIX_ENABLED_SERVICE + getTopologyName() + PARAMETER_NAME_POSTFIX_ENABLED_SERVICE+ serviceName;" is 138.,48
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfig,getEnabledServiceNames,Long Statement,The length of the statement "return properties.entrySet().stream().filter(keyValuePair -> Boolean.valueOf((String)keyValuePair.getValue())).map(keyValuePair -> ((String)keyValuePair.getKey()).substring(((String)keyValuePair.getKey()).lastIndexOf('.') + 1).toUpperCase(Locale.getDefault())).collect(toSet());" is 278.,53
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfig,getDiscoveryAddress,Long Identifier,The length of the field PARAMETER_NAME_DISCOVERY_ADDRESS is 32.,62
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfig,getDiscoveryCluster,Long Identifier,The length of the field PARAMETER_NAME_DISCOVERY_CLUSTER is 32.,66
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfigurationMonitor,setupMonitor,Long Identifier,The length of the field ADVANCED_CONFIGURATION_FILE_NAME_PREFIX is 39.,69
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfigurationMonitor,setupMonitor,Long Statement,The length of the statement "final ScheduledExecutorService executorService=newSingleThreadScheduledExecutor(new BasicThreadFactory.Builder().namingPattern("AdvancedServiceDiscoveryConfigurationMonitor-%d").build());" is 187.,69
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfigurationMonitor,setupMonitor,Long Statement,The length of the statement "executorService.scheduleAtFixedRate(() -> monitorAdvancedServiceConfigurations()`0`monitoringInterval`TimeUnit.MILLISECONDS);" is 125.,69
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfigurationMonitor,monitorAdvancedServiceConfigurations,Long Identifier,The length of the field ADVANCED_CONFIGURATION_FILE_NAME_PREFIX is 39.,83
apache_knox,org.apache.knox.gateway.topology.discovery.advanced,AdvancedServiceDiscoveryConfigurationMonitor,monitorAdvancedServiceConfigurations,Long Statement,The length of the statement "final File[] advancedConfigurationFiles=new File(gatewayConfigurationDir).listFiles((FileFilter)new PrefixFileFilter(ADVANCED_CONFIGURATION_FILE_NAME_PREFIX));" is 159.,83
apache_knox,org.apache.knox.gateway.launcher,Config,load,Complex Method,Cyclomatic complexity of the method is 10,45
apache_knox,org.apache.knox.gateway.launcher,Config,load,Magic Number,The method contains a magic number: 2,45
apache_knox,org.apache.knox.gateway.launcher,Command,loadClassPath,Complex Conditional,The conditional expression libFile.canRead() && (libFile.isFile() || libFile.isDirectory()) is complex.,113
apache_knox,org.apache.knox.gateway.launcher,Invoker,resolveValue,Magic Number,The method contains a magic number: 2,71
apache_knox,org.apache.knox.gateway.launcher,Invoker,resolveValue,Magic Number,The method contains a magic number: 3,71
apache_knox,org.apache.knox.gateway.launcher,Launcher,createExternalConfig,Empty catch clause,The method has an empty catch block.,112
apache_knox,org.apache.knox.gateway.launcher,Launcher,findOrCreateExternalConfig,Long Parameter List,The method has 5 parameters. ,124
apache_knox,org.apache.knox.gateway.hbase,HBaseRequestUtil,fixTrailingSlash,Long Statement,The length of the statement "outboundRequest=RequestBuilder.copy(outboundRequest).setUri(split[0] + "/" + (split.length == 2 ? "?" + split[1] : "")).build();" is 128.,32
apache_knox,org.apache.knox.gateway.hbase,HBaseRequestUtil,fixTrailingSlash,Magic Number,The method contains a magic number: 2,32
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Complex Method,Cyclomatic complexity of the method is 16,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Identifier,The length of the identifier includeGroupsInTokenAllowedParam is 32.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Identifier,The length of the field TOKEN_INCLUDE_GROUPS_IN_JWT_ALLOWED is 35.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Identifier,The length of the field TARGET_ENDPOINT_PULIC_CERT_PEM is 30.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Identifier,The length of the field KNOX_TOKEN_USER_LIMIT_EXCEEDED_ACTION is 37.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Identifier,The length of the field TOKEN_EXP_RENEWAL_MAX_LIFETIME is 30.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Statement,The length of the statement "includeGroupsInTokenAllowed=includeGroupsInTokenAllowedParam == null ? true : Boolean.parseBoolean(includeGroupsInTokenAllowedParam);" is 133.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Statement,The length of the statement "this.tokenIssuer=StringUtils.isBlank(context.getInitParameter(KNOX_TOKEN_ISSUER)) ? JWTokenAttributes.DEFAULT_ISSUER : context.getInitParameter(KNOX_TOKEN_ISSUER);" is 163.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,init,Long Statement,The length of the statement "tokenMAC=new TokenMAC(gatewayConfig.getKnoxTokenHashAlgorithm()`aliasService.getPasswordFromAliasForGateway(TokenMAC.KNOX_TOKEN_HASH_KEY_ALIAS_NAME));" is 150.,210
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getTokenTTLAsText,Long Statement,The length of the statement "long minutesPart=tokenTTLDuration.toHours() > 0 ? tokenTTLDuration.minusHours(tokenTTLDuration.toHours()).toMinutes() : tokenTTLDuration.toMinutes();" is 149.,335
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getTokenTTLAsText,Long Statement,The length of the statement "long secondsPart=tokenTTLDuration.toMinutes() > 0 ? tokenTTLDuration.minusMinutes(tokenTTLDuration.toMinutes()).getSeconds() : tokenTTLDuration.getSeconds();" is 157.,335
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getTokenTTLAsText,Magic Number,The method contains a magic number: 32,335
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Identifier,The length of the identifier configuredTokenStateServiceImpl is 31.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Identifier,The length of the field TSS_STATUS_IS_MANAGEMENT_ENABLED is 32.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Statement,The length of the statement "final String configuredTokenStateServiceImpl=config.getServiceParameter(ServiceType.TOKEN_STATE_SERVICE.getShortName()`"impl");" is 127.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Statement,The length of the statement "final String configuredTokenServiceName=StringUtils.isBlank(configuredTokenStateServiceImpl) ? "" : configuredTokenStateServiceImpl.substring(configuredTokenStateServiceImpl.lastIndexOf('.') + 1);" is 196.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Statement,The length of the statement "final String actualTokenServiceName=actualTokenStateServiceImpl.substring(actualTokenStateServiceImpl.lastIndexOf('.') + 1);" is 124.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Statement,The length of the statement "tokenStateServiceStatusMap.put(TSS_MAXIMUM_LIFETIME_SECONDS`String.valueOf(tokenTTL == -1 ? tokenTTL : (tokenTTL / 1000)));" is 123.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Long Statement,The length of the statement "final Boolean lifespanInputEnabled=lifespanInputEnabledValue == null ? Boolean.TRUE : Boolean.parseBoolean(lifespanInputEnabledValue);" is 134.,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenStateServiceStatusMap,Magic Number,The method contains a magic number: 1000,361
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,populateAllowedTokenStateBackendForTokenGenApp,Long Identifier,The length of the field TSS_ALLOWED_BACKEND_FOR_TOKENGEN is 32.,385
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,populateAllowedTokenStateBackendForTokenGenApp,Long Identifier,The length of the field TOKEN_EXP_TOKENGEN_ALLOWED_TSS_BACKENDS is 39.,385
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,populateAllowedTokenStateBackendForTokenGenApp,Long Statement,The length of the statement "if ("AliasBasedTokenStateService".equals(actualTokenServiceName) || "JDBCTokenStateService".equals(actualTokenServiceName)) {" is 125.,385
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setSignatureAlogrithm,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)request.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 123.,403
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setSignatureAlogrithm,Long Statement,The length of the statement "final GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 133.,403
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getUserTokens,Complex Method,Cyclomatic complexity of the method is 9,451
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getUserTokens,Long Statement,The length of the statement "return Response.status(Response.Status.SERVICE_UNAVAILABLE).entity("{\n \"error\": \"Token management is not configured\"\n}\n").build();" is 137.,451
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getUserTokens,Long Statement,The length of the statement "final Collection<KnoxToken> userTokens=createdBy == null ? tokenStateService.getTokens(userName) : tokenStateService.getDoAsTokens(createdBy);" is 142.,451
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getUserTokens,Long Statement,The length of the statement "return Response.status(Response.Status.OK).entity(JsonUtils.renderAsJsonString(Collections.singletonMap("tokens"`tokens))).build();" is 131.,451
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,renew,Long Statement,The length of the statement "log.renewalDisabled(getTopologyName()`Tokens.getTokenDisplayText(token)`Tokens.getTokenIDDisplayText(TokenUtils.getTokenId(jwt)));" is 130.,503
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,renew,Long Statement,The length of the statement "log.renewedToken(getTopologyName()`Tokens.getTokenDisplayText(token)`Tokens.getTokenIDDisplayText(TokenUtils.getTokenId(jwt))`renewer);" is 135.,503
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,renew,Long Statement,The length of the statement "resp=Response.status(Response.Status.OK).entity("{\n \"renewed\": \"true\"`\n \"expires\": \"" + expiration + "\"\n}\n").build();" is 129.,503
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,renew,Long Statement,The length of the statement "resp=Response.status(errorStatus).entity("{\n \"renewed\": \"false\"`\n \"error\": \"" + error + "\"`\n \"code\": "+ errorCode.toInt()+ "\n}\n").build();" is 153.,503
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,revoke,Long Statement,The length of the statement "resp=Response.status(errorStatus).entity("{\n \"revoked\": \"false\"`\n \"error\": \"" + error + "\"`\n \"code\": "+ errorCode.toInt()+ "\n}\n").build();" is 153.,572
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getTokenId,Empty catch clause,The method has an empty catch block.,635
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenEnabledFlag,Long Statement,The length of the statement "return Response.status(Response.Status.OK).entity("{\n \"setEnabledFlag\": \"true\"`\n \"isEnabled\": \"" + enabled + "\"\n}\n").build();" is 137.,660
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,setTokenEnabledFlag,Long Statement,The length of the statement "return Response.status(Response.Status.BAD_REQUEST).entity("{\n \"setEnabledFlag\": \"false\"`\n \"error\": \"" + error + "\"`\n \"code\": "+ errorCode.toInt()+ "\n}\n").build();" is 178.,660
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Complex Method,Cyclomatic complexity of the method is 23,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Long Method,The method has 131 lines of code.,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Long Statement,The length of the statement "return Response.status(Response.Status.FORBIDDEN).entity("{ \"Unable to get token - untrusted client cert.\" }").build();" is 121.,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)request.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 127.,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Long Statement,The length of the statement "log.generalInfoMessage(String.format(Locale.getDefault()`"Revoking %s's oldest token %s ..."`userName`Tokens.getTokenIDDisplayText(oldestTokenId)));" is 148.,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Long Statement,The length of the statement "jwtAttributesBuilder.setIssuer(tokenIssuer).setUserName(userName).setAlgorithm(signatureAlgorithm).setExpires(expires).setManaged(managedToken).setJku(jku).setType(tokenType);" is 175.,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Long Statement,The length of the statement "return Response.status(Response.Status.BAD_REQUEST).entity("{\n \"error\": \"Including group information in tokens is disabled\"\n}\n").build();" is 144.,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,getAuthenticationToken,Long Statement,The length of the statement "tokenStateService.addToken(tokenId`issueTime`expires`maxTokenLifetime.orElse(tokenStateService.getDefaultMaxLifetimeDuration()));" is 129.,700
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,groups,Long Statement,The length of the statement "Set<String> groups=subject.getPrincipals(GroupPrincipal.class).stream().map(GroupPrincipal::getName).collect(Collectors.toSet());" is 129.,869
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,generatePasscodeField,Long Statement,The length of the statement "final String base64TokenIdPasscode=Base64.encodeBase64String(tokenId.getBytes(StandardCharsets.UTF_8)) + "::" + Base64.encodeBase64String(passcode.getBytes(StandardCharsets.UTF_8));" is 181.,889
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,addClientDataToMap,Magic Number,The method contains a magic number: 2,894
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenResource,addClientDataToMap,Magic Number,The method contains a magic number: 2,894
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResource,init,Long Statement,The length of the statement "this.signatureAlgorithm=TokenUtils.getSignatureAlgorithm(configuredSigAlg`(AliasService)services.getService(ServiceType.ALIAS_SERVICE)`config.getSigningKeystoreName());" is 168.,64
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResource,getJwks,Long Statement,The length of the statement "final RSAKey.Builder builder=new RSAKey.Builder(rsa).keyUse(KeyUse.SIGNATURE).algorithm(new JWSAlgorithm(this.signatureAlgorithm)).keyID(kid);" is 142.,81
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResource,getJwks,Long Statement,The length of the statement "return Response.status(500).entity("{\n \"error\": \"" + "keystore " + keystore + " could not be found."+ "\"\n}\n").build();" is 125.,81
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResource,getJwks,Magic Number,The method contains a magic number: 500,81
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResource,getJwks,Magic Number,The method contains a magic number: 500,81
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2048,67
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,init,Long Statement,The length of the statement "EasyMock.expect(services.getService(ServiceType.ALIAS_SERVICE)).andReturn(EasyMock.createNiceMock(AliasService.class)).anyTimes();" is 130.,77
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,getTestToken,Long Statement,The length of the statement "final JWT token=new JWTToken(new JWTokenAttributesBuilder().setAlgorithm(algorithm).setAudiences(Collections.singletonList("aud")).setManaged(false).build());" is 158.,136
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,getTestToken,Magic Number,The method contains a magic number: 6,136
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,getTestToken,Magic Number,The method contains a magic number: 2,136
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,getTestToken,Magic Number,The method contains a magic number: 3,136
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,getTestToken,Magic Number,The method contains a magic number: 4,136
apache_knox,org.apache.knox.gateway.service.knoxtoken,JWKSResourceTest,getTestToken,Magic Number,The method contains a magic number: 5,136
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2048,132
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Complex Method,Cyclomatic complexity of the method is 9,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(context.getInitParameterNames()).andReturn(Collections.enumeration(contextExpectations.keySet())).anyTimes();" is 125.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(request.getParameter(TokenResource.LIFESPAN)).andReturn(contextExpectations.get(TokenResource.LIFESPAN)).anyTimes();" is 132.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(request.getParameter(TokenResource.KNOX_TOKEN_INCLUDE_GROUPS)).andReturn(contextExpectations.get(TokenResource.KNOX_TOKEN_INCLUDE_GROUPS)).anyTimes();" is 166.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(request.getParameter(TokenResource.QUERY_PARAMETER_DOAS)).andReturn(contextExpectations.get(TokenResource.QUERY_PARAMETER_DOAS)).anyTimes();" is 156.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(request.getParameter(TokenResource.IMPERSONATION_ENABLED_PARAM)).andReturn(contextExpectations.get(TokenResource.IMPERSONATION_ENABLED_PARAM)).anyTimes();" is 170.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(config.getServiceParameter(tokenStateServiceType`"impl")).andReturn(contextExpectations.get(tokenStateServiceType)).anyTimes();" is 143.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(config.getMaximumNumberOfTokensPerUser()).andReturn(contextExpectations.containsKey(KNOX_TOKEN_USER_LIMIT) ? Integer.parseInt(contextExpectations.get(KNOX_TOKEN_USER_LIMIT)) : -1).anyTimes();" is 207.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(TokenUtils.SIGNING_HMAC_SECRET_ALIAS)).andReturn(hmacSecret).anyTimes();" is 132.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(TokenMAC.KNOX_TOKEN_HASH_KEY_ALIAS_NAME)).andReturn("sPj8FCgQhCEi6G18kBfpswxYSki33plbelGLs0hMSbk".toCharArray()).anyTimes();" is 184.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,configureCommonExpectations,Long Statement,The length of the statement "EasyMock.expect(request.getAttribute("javax.servlet.request.X509Certificate")).andReturn(certArrayList.toArray(certs)).anyTimes();" is 130.,154
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testClientData,Magic Number,The method contains a magic number: 2,246
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGetToken,Magic Number,The method contains a magic number: 200,263
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testConcurrentGetToken,Magic Number,The method contains a magic number: 2,300
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testConcurrentGetToken,Magic Number,The method contains a magic number: 2,300
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testAudiences,Magic Number,The method contains a magic number: 200,335
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testAudiences,Magic Number,The method contains a magic number: 2,335
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testAudiencesWhitespace,Magic Number,The method contains a magic number: 200,370
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testAudiencesWhitespace,Magic Number,The method contains a magic number: 2,370
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testValidClientCert,Magic Number,The method contains a magic number: 200,405
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testValidClientCertWrongUser,Magic Number,The method contains a magic number: 403,435
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testMissingClientCert,Magic Number,The method contains a magic number: 403,453
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testSignatureAlgorithm,Magic Number,The method contains a magic number: 200,471
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testDefaultTTL,Magic Number,The method contains a magic number: 200,501
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testDefaultTTL,Magic Number,The method contains a magic number: 30000L,501
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testCustomTTL,Magic Number,The method contains a magic number: 200,535
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testCustomTTL,Magic Number,The method contains a magic number: 60000L,535
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testCustomTTL,Magic Number,The method contains a magic number: 30000L,535
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testNegativeTTL,Magic Number,The method contains a magic number: 200,570
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testNegativeTTL,Magic Number,The method contains a magic number: 30000L,570
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testOverflowTTL,Magic Number,The method contains a magic number: 200,604
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testOverflowTTL,Magic Number,The method contains a magic number: 30000L,604
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_NoRenewersNoSubject,Long Statement,The length of the statement "validateRenewalResponse(renewalResponse`403`false`"Caller (null) not authorized to renew tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 136.,706
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_NoRenewersNoSubject,Magic Number,The method contains a magic number: 403,706
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_NoRenewersWithSubject,Long Statement,The length of the statement "validateRenewalResponse(renewalResponse`403`false`"Caller (" + caller + ") not authorized to renew tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 146.,712
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_NoRenewersWithSubject,Magic Number,The method contains a magic number: 403,712
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_WithRenewersNoSubject,Long Statement,The length of the statement "validateRenewalResponse(renewalResponse`403`false`"Caller (null) not authorized to renew tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 136.,722
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_WithRenewersNoSubject,Magic Number,The method contains a magic number: 403,722
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_WithRenewersWithInvalidSubject,Long Statement,The length of the statement "validateRenewalResponse(renewalResponse`403`false`"Caller (" + caller + ") not authorized to renew tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 146.,731
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_WithRenewersWithInvalidSubject,Magic Number,The method contains a magic number: 403,731
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_WithConfigurableMaxTokenLifetime,Magic Number,The method contains a magic number: 10L,766
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRenewal_Enabled_WithConfigurableMaxTokenLifetime,Magic Number,The method contains a magic number: 10L,766
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_ServerManagedStateNotConfigured,Long Statement,The length of the statement "validateRevocationResponse(renewalResponse`400`false`"Token revocation support is not configured"`TokenResource.ErrorCode.CONFIGURATION_ERROR);" is 143.,783
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_ServerManagedStateNotConfigured,Magic Number,The method contains a magic number: 400,783
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Disabled,Long Statement,The length of the statement "validateRevocationResponse(renewalResponse`400`false`"Token revocation support is not configured"`TokenResource.ErrorCode.CONFIGURATION_ERROR);" is 143.,792
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Disabled,Magic Number,The method contains a magic number: 400,792
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_NoRenewersNoSubject,Long Statement,The length of the statement "validateRevocationResponse(renewalResponse`403`false`"Caller (null) not authorized to revoke tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 140.,801
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_NoRenewersNoSubject,Magic Number,The method contains a magic number: 403,801
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_NoRenewersWithSubject,Long Statement,The length of the statement "validateRevocationResponse(renewalResponse`403`false`"Caller (" + caller + ") not authorized to revoke tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 150.,810
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_NoRenewersWithSubject,Magic Number,The method contains a magic number: 403,810
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_WithRenewersNoSubject,Long Statement,The length of the statement "validateRevocationResponse(renewalResponse`403`false`"Caller (null) not authorized to revoke tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 140.,820
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_WithRenewersNoSubject,Magic Number,The method contains a magic number: 403,820
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_WithRenewersWithInvalidSubject,Long Statement,The length of the statement "validateRevocationResponse(renewalResponse`403`false`"Caller (" + caller + ") not authorized to revoke tokens."`TokenResource.ErrorCode.UNAUTHORIZED);" is 150.,829
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenRevocation_Enabled_WithRenewersWithInvalidSubject,Magic Number,The method contains a magic number: 403,829
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testKidJkuClaims,Magic Number,The method contains a magic number: 200,853
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGetTokenStateStatusTokenStateServiceNotEnabled,Long Statement,The length of the statement "testGetTokenStateStatus(Collections.singletonMap(TokenStateService.CONFIG_SERVER_MANAGED`"false")`"false"`null`null`null);" is 122.,883
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGetTokenStateStatus,Long Parameter List,The method has 5 parameters. ,904
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGetTokenStateStatus,Magic Number,The method contains a magic number: 200,904
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGettingTokenWithLifespanLessThanConfiguredTTL,Magic Number,The method contains a magic number: 23,932
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGettingTokenWithLifespanLessThanConfiguredTTL,Magic Number,The method contains a magic number: 47,932
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGettingTokenWithLifespanLessThanConfiguredTTL,Magic Number,The method contains a magic number: 3600000L,932
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGettingTokenWithConfiguredTTL,Magic Number,The method contains a magic number: 60000L,978
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testUnlimitedTokensPerUser,Magic Number,The method contains a magic number: 100,1012
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenLimitChangeAfterAlreadyHavingTokens,Long Statement,The length of the statement "Collection<String> tokens=((Map<String`Collection<String>>)JsonUtils.getObjectFromJsonString(getKnoxTokensResponse.getEntity().toString())).get("tokens");" is 154.,1017
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenLimitChangeAfterAlreadyHavingTokens,Magic Number,The method contains a magic number: 5,1017
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenLimitPerUserExceeded,Magic Number,The method contains a magic number: 10,1058
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenLimitPerUserExceeded,Magic Number,The method contains a magic number: 11,1058
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenLimitPerUserExceededShouldRevokeOldestToken,Magic Number,The method contains a magic number: 10,1068
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testTokenLimitPerUserExceededShouldRevokeOldestToken,Magic Number,The method contains a magic number: 11,1068
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testLimitingTokensPerUser,Long Statement,The length of the statement "contextExpectations.put(KNOX_TOKEN_USER_LIMIT_EXCEEDED_ACTION`TokenResource.UserLimitExceededAction.REMOVE_OLDEST.name());" is 122.,1081
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testLimitingTokensPerUser,Long Statement,The length of the statement "final Collection<String> tokens=((Map<String`Collection<String>>)JsonUtils.getObjectFromJsonString(getKnoxTokensResponse.getEntity().toString())).get("tokens");" is 160.,1081
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testCreateImpersonatedToken,Long Statement,The length of the statement "final Collection<LinkedHashMap<String`Object>> tokens=((Map<String`Collection<LinkedHashMap<String`Object>>>)JsonUtils.getObjectFromJsonString(getKnoxTokensResponse.getEntity().toString())).get("tokens");" is 204.,1116
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testDefaultIssuer,Magic Number,The method contains a magic number: 200,1146
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testConfiguredIssuer,Magic Number,The method contains a magic number: 200,1164
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testGroupsAddedToToken,Magic Number,The method contains a magic number: 200,1183
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testNoGroupsAddedToTokenByDefault,Magic Number,The method contains a magic number: 200,1209
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testBadRequestWhenGroupsAreRequestedToBeIncludedInTokenButItIsDisabledByServer,Magic Number,The method contains a magic number: 400,1233
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,testPasscodeToken,Magic Number,The method contains a magic number: 200,1270
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,doTestTokenRenewal,Long Parameter List,The method has 5 parameters. ,1335
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,doTestTokenRenewal,Long Statement,The length of the statement "return doTestTokenLifecyle(TokenLifecycleOperation.Renew`serviceLevelConfig`gatewayLevelConfig`renewers`maxTokenLifetime`caller);" is 129.,1335
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,doTestTokenLifecyle,Long Parameter List,The method has 5 parameters. ,1394
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,doTestTokenLifecyle,Long Parameter List,The method has 6 parameters. ,1414
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,doTestTokenLifecyle,Magic Number,The method contains a magic number: 2,1414
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,doTestTokenLifecyle,Magic Number,The method contains a magic number: 200,1414
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,doTestTokenLifecyle,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@63c2ea57,1414
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,validateSuccessfulRenewalResponse,Magic Number,The method contains a magic number: 200,1498
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,validateRenewalResponse,Long Parameter List,The method has 5 parameters. ,1502
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,validateSuccessfulRevocationResponse,Magic Number,The method contains a magic number: 200,1521
apache_knox,org.apache.knox.gateway.service.knoxtoken,TokenServiceResourceTest,validateRevocationResponse,Long Parameter List,The method has 5 parameters. ,1525
apache_knox,org.apache.knox.gateway.service.session,SessionResource,getBaseGatewayUrl,Long Statement,The length of the statement "return request.getRequestURL().substring(0`request.getRequestURL().length() - request.getRequestURI().length()) + "/" + config.getGatewayPath();" is 144.,64
apache_knox,org.apache.knox.gateway.service.session,SessionResource,getLogoutPageUrl,Long Statement,The length of the statement "return getBaseGatewayUrl(config) + "/knoxsso/knoxauth/logout.jsp?originalUrl=" + getBaseGatewayUrl(config)+ "/homepage/home";" is 125.,70
apache_knox,org.apache.knox.gateway.service.session,SessionInformationMarshaller,getSize,Long Parameter List,The method has 5 parameters. ,50
apache_knox,org.apache.knox.gateway.service.session,SessionInformationMarshaller,writeTo,Long Parameter List,The method has 7 parameters. ,55
apache_knox,org.apache.knox.gateway.service.session,SessionInformationMarshaller,getMarshaller,Long Statement,The length of the statement "return MediaType.APPLICATION_JSON_TYPE.getSubtype().equals(mediaType.getSubtype()) ? getJsonMarshaller() : getXmlMarshaller();" is 126.,65
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributor,contributeFilter,Long Identifier,The length of the field CENTRAL_GROUP_CONFIG_PREFIX_PARAM_NAME is 38.,70
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,70
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributor,contributeFilter,Long Statement,The length of the statement "final List<FilterParamDescriptor> groupMappingParamsList=getParamsFromGatewaySiteWithCentralGroupConfigPrefix(provider`context`resource);" is 137.,70
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributor,contributeFilter,Long Statement,The length of the statement "provider.getParams().entrySet().stream().filter(entry -> !entry.getKey().startsWith(CENTRAL_GROUP_CONFIG_PREFIX_PARAM_NAME)).forEach(entry -> {" is 143.,70
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributor,getParamsFromGatewaySiteWithCentralGroupConfigPrefix,Long Identifier,The length of the field CENTRAL_GROUP_CONFIG_PREFIX_PARAM_NAME is 38.,94
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributor,getParamsFromGatewaySiteWithCentralGroupConfigPrefix,Long Statement,The length of the statement "final Map<String`String> groupMappingParams=gatewayConfig == null ? null : ((Configuration)gatewayConfig).getPropsWithPrefix(prefix);" is 133.,94
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributorTest,testilterParametersGeneration,Long Identifier,The length of the parameter addCentralGroupPrefixParamIntoGatewaySite is 41.,81
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributorTest,testilterParametersGeneration,Long Statement,The length of the statement "providerParams.put(HadoopGroupProviderDeploymentContributor.CENTRAL_GROUP_CONFIG_PREFIX_PARAM_NAME`centralGroupPrefixParam);" is 124.,81
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributorTest,testilterParametersGeneration,Long Statement,The length of the statement "final String expectedPropertyValue=haveCustomProviderParameter ? "custom.gateway.site.property.value" : "gateway.site.property.value";" is 134.,81
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributorTest,testilterParametersGeneration,Magic Number,The method contains a magic number: 2,81
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderDeploymentContributorTest,getFilterParam,Long Statement,The length of the statement "final Collection<FilterParamDescriptor> relevantFilterParams=params.stream().filter(param -> param.name().equals(name)).collect(Collectors.toList());" is 149.,126
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,testGroups,Long Statement,The length of the statement "final String principal=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 130.,74
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,testGroups,Long Statement,The length of the statement "assertThat("No groups assosciated with the user` most likely this is a failure` it is only OK when 'bash -c groups' command returns 0 groups. "`groups.length > 0);" is 163.,74
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,testUnknownUser,Long Statement,The length of the statement "final String principal=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 130.,106
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,testUnknownUser,Long Statement,The length of the statement "assertThat("Somehow groups were found for this user` how is it possible ! check 'bash -c groups' command "`groups.length == 0);" is 127.,106
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "final List<String> keysList=Arrays.asList("hadoop.security.group.mapping"`"hadoop.security.group.mapping.ldap.bind.user"`"hadoop.security.group.mapping.ldap.bind.password"`"hadoop.security.group.mapping.ldap.url"`"hadoop.security.group.mapping.ldap.search.filter.group"`"hadoop.security.group.mapping.ldap.search.attr.member"`"hadoop.security.group.mapping.ldap.search.filter.user");" is 383.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("hadoop.security.group.mapping")).andReturn("org.apache.hadoop.security.LdapGroupsMapping").anyTimes();" is 143.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("hadoop.security.group.mapping.ldap.bind.user")).andReturn("uid=dummy`ou=people`dc=hadoop`dc=apache`dc=org").anyTimes();" is 160.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("hadoop.security.group.mapping.ldap.bind.password")).andReturn("unbind-me-please").anyTimes();" is 134.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("hadoop.security.group.mapping.ldap.url")).andReturn("ldap://nomansland:33389").anyTimes();" is 131.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("hadoop.security.group.mapping.ldap.search.filter.group")).andReturn("(objectclass=groupOfNames)").anyTimes();" is 150.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("hadoop.security.group.mapping.ldap.search.attr.member")).andReturn("member").anyTimes();" is 129.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter("hadoop.security.group.mapping.ldap.search.filter.user")).andReturn("(&amp;(|(objectclass=person)(objectclass=applicationProcess))(cn={0}))").anyTimes();" is 193.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,badConfigTest,Long Statement,The length of the statement "final String principal=filter.mapUserPrincipal(((Principal)subject.getPrincipals(PrimaryPrincipal.class).toArray()[0]).getName());" is 130.,141
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,testGroupsWithVirtualGroup,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameterNames()).andReturn(Collections.enumeration(Arrays.asList(CommonIdentityAssertionFilter.VIRTUAL_GROUP_MAPPING_PREFIX + "test-virtual-group"))).anyTimes();" is 192.,214
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,testGroupsWithVirtualGroup,Long Statement,The length of the statement "EasyMock.expect(config.getInitParameter(CommonIdentityAssertionFilter.VIRTUAL_GROUP_MAPPING_PREFIX + "test-virtual-group")).andReturn("(and (username 'knox') (member 'hadoop-group'))").anyTimes();" is 196.,214
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,testGroupsWithVirtualGroup,Long Statement,The length of the statement "@Override protected void continueChainAsPrincipal( HttpServletRequestWrapper request` ServletResponse response` FilterChain chain` String mappedPrincipalName` String[] groups){" is 176.,214
apache_knox,org.apache.knox.gateway.identityasserter.hadoop.groups.filter,HadoopGroupProviderFilterTest,continueChainAsPrincipal,Long Parameter List,The method has 5 parameters. ,239
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Long Statement,The length of the statement "System.out.println("Invalid number of arguments for :ds add. Useage: :ds add {ds-name} {connectStr} {driver} {authnType: none|basic}");" is 135.,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 2,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 6,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 2,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 3,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 4,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 5,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 3,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,processDataSourceCommand,Magic Number,The method contains a magic number: 2,111
apache_knox,org.apache.knox.gateway.shell.jdbc,KnoxLine,closeConnection,Empty catch clause,The method has an empty catch block.,196
apache_knox,org.apache.knox.gateway.shell.jdbc.derby,DerbyDatabase,shutdown,Magic Number,The method contains a magic number: 45000,68
apache_knox,org.apache.knox.gateway.shell.jdbc.derby,DerbyDatabase,hasTable,Long Statement,The length of the statement "try (Connection connection=getConnection();ResultSet tables=connection.getMetaData().getTables(connection.getCatalog()`schemaName`tableName`null)){" is 147.,99
apache_knox,org.apache.knox.gateway.shell,KnoxClientRetryHandler,KnoxClientRetryHandler,Long Statement,The length of the statement "super(retryCount`requestSentRetryEnabled`Arrays.asList(InterruptedIOException.class`UnknownHostException.class`SSLException.class));" is 132.,39
apache_knox,org.apache.knox.gateway.shell,Shell,main,Magic Number,The method contains a magic number: 3,65
apache_knox,org.apache.knox.gateway.shell,Shell,main,Magic Number,The method contains a magic number: 2,65
apache_knox,org.apache.knox.gateway.shell,KnoxSession,login,Long Statement,The length of the statement "KnoxSession instance=new KnoxSession(ClientContext.with(url).connection().withTruststore(truststoreLocation`truststorePass).end());" is 131.,174
apache_knox,org.apache.knox.gateway.shell,KnoxSession,login,Long Parameter List,The method has 5 parameters. ,190
apache_knox,org.apache.knox.gateway.shell,KnoxSession,login,Long Statement,The length of the statement "return new KnoxSession(ClientContext.with(username`password`url).connection().withTruststore(truststoreLocation`truststorePass).end());" is 135.,190
apache_knox,org.apache.knox.gateway.shell,KnoxSession,kerberosLogin,Long Statement,The length of the statement "return new KnoxSession(ClientContext.with(url).kerberos().enable(true).jaasConf(jaasConf).krb5Conf(krb5Conf).debug(debug).end());" is 129.,201
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Complex Method,Cyclomatic complexity of the method is 11,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "System.out.println("**************** WARNING ******************\n" + "This is an insecure client instance and may\n" + "leave the interactions subject to a man in\n"+ "the middle attack. Please use the login()\n"+ "method instead of loginInsecure() for any\n"+ "sensitive or production usecases.\n"+ "*******************************************");" is 347.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "Registry<ConnectionSocketFactory> registry=RegistryBuilder.<ConnectionSocketFactory>create().register("http"`PlainConnectionSocketFactory.getSocketFactory()).register("https"`new SSLConnectionSocketFactory(sslContext`hostnameVerifier)).build();" is 244.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "ConnectionConfig connectionConfig=ConnectionConfig.custom().setBufferSize(clientContext.connection().bufferSize()).build();" is 123.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "SocketConfig socketConfig=SocketConfig.custom().setSoKeepAlive(clientContext.socket().keepalive()).setSoLinger(clientContext.socket().linger()).setSoReuseAddress(clientContext.socket().reuseAddress()).setSoTimeout(clientContext.socket().timeout()).setTcpNoDelay(clientContext.socket().tcpNoDelay()).build();" is 307.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "final Registry<AuthSchemeProvider> authSchemeRegistry=RegistryBuilder.<AuthSchemeProvider>create().register(AuthSchemes.SPNEGO`new SPNegoSchemeFactory(true)).build();" is 166.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "return HttpClients.custom().setConnectionManager(connectionManager).setDefaultAuthSchemeRegistry(authSchemeRegistry).setDefaultCredentialsProvider(EMPTY_CREDENTIALS_PROVIDER).build();" is 183.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "credentialsProvider.setCredentials(new AuthScope(host.getHostName()`host.getPort())`new UsernamePasswordCredentials(clientContext.username()`clientContext.password()));" is 168.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "HttpClientBuilder httpClientBuilder=HttpClients.custom().setConnectionManager(connectionManager).setDefaultCredentialsProvider(credentialsProvider);" is 148.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,createClient,Long Statement,The length of the statement "httpClientBuilder.setRetryHandler(new KnoxClientRetryHandler(clientContext.connection().retryCount()`clientContext.connection().requestSentRetryEnabled())).setServiceUnavailableRetryStrategy(new DefaultServiceUnavailableRetryStrategy(clientContext.connection().retryCount()`clientContext.connection().retryIntervalMillis()));" is 325.,261
apache_knox,org.apache.knox.gateway.shell,KnoxSession,getTrustStore,Long Statement,The length of the statement "pem=pem.substring(BEGIN_CERTIFICATE.length() - 1`pem.indexOf(END_CERTIFICATE.substring(0`END_CERTIFICATE.length() - 1)));" is 121.,393
apache_knox,org.apache.knox.gateway.shell,KnoxSession,getTrustStore,Long Statement,The length of the statement "throw new KnoxShellException("Unable to read truststore." + " Please import the gateway-identity certificate into the JVM" + " truststore or set the truststore location ENV variables."`e);" is 188.,393
apache_knox,org.apache.knox.gateway.shell,KnoxSession,getTrustStore,Long Statement,The length of the statement "throw new KnoxShellException("Unable to load the truststore." + " Please import the gateway-identity certificate into the JVM" + " truststore or set the truststore location ENV variables."`e);" is 192.,393
apache_knox,org.apache.knox.gateway.shell,KnoxSession,getTrustStore,Long Statement,The length of the statement "throw new KnoxShellException("Certificate cannot be found in the truststore." + " Please import the gateway-identity certificate into the JVM" + " truststore or set the truststore location ENV variables."`e);" is 208.,393
apache_knox,org.apache.knox.gateway.shell,KnoxSession,getTrustStore,Long Statement,The length of the statement "throw new KnoxShellException("Unable to load truststore." + " May be related to password setting or truststore format."`e);" is 123.,393
apache_knox,org.apache.knox.gateway.shell,KnoxSession,getTrustStore,Long Statement,The length of the statement "throw new KnoxShellException("Unable to find a truststore for secure login." + "Please import the gateway-identity certificate into the JVM" + " truststore or set the truststore location ENV variables.");" is 204.,393
apache_knox,org.apache.knox.gateway.shell,KnoxSession,executeNow,Magic Number,The method contains a magic number: 400,480
apache_knox,org.apache.knox.gateway.shell,KnoxSession,executeNow,Magic Number,The method contains a magic number: 400,480
apache_knox,org.apache.knox.gateway.shell,KnoxSession,write,Long Statement,The length of the statement "try (FileChannel channel=FileChannel.open(file.toPath()`StandardOpenOption.WRITE`StandardOpenOption.CREATE`StandardOpenOption.TRUNCATE_EXISTING)){" is 146.,640
apache_knox,org.apache.knox.gateway.shell,KnoxSh,run,Long Statement,The length of the statement "out.println("ERROR: Invalid Command" + "\n" + "Unrecognized option:" + args[0] + "\n"+ "A fatal exception has occurred. Program will exit.");" is 141.,80
apache_knox,org.apache.knox.gateway.shell,KnoxSh,run,Magic Number,The method contains a magic number: 2,80
apache_knox,org.apache.knox.gateway.shell,KnoxSh,run,Magic Number,The method contains a magic number: 3,80
apache_knox,org.apache.knox.gateway.shell,KnoxSh,init,Complex Method,Cyclomatic complexity of the method is 11,103
apache_knox,org.apache.knox.gateway.shell,KnoxSh,printKnoxShellUsage,Magic Number,The method contains a magic number: 79,148
apache_knox,org.apache.knox.gateway.shell,KnoxSh,readFile,Long Statement,The length of the statement "try (InputStream inputStream=Files.newInputStream(Paths.get(file));InputStreamReader inputStreamReader=new InputStreamReader(inputStream`StandardCharsets.UTF_8);BufferedReader reader=new BufferedReader(inputStreamReader)){" is 222.,389
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testJAASConfigOption,Empty catch clause,The method has an empty catch block.,94
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testJAASConfigOption,Long Statement,The length of the statement "ClientContext context=ClientContext.with("https://localhost:8443/gateway/dt").kerberos().enable(true).jaasConf(testJaasConf).end();" is 131.,94
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testJAASConfigOption,Long Statement,The length of the statement "assertEquals("Using JAAS configuration file implementation: com.sun.security.auth.login.ConfigFile"`logCapture.logMessages.get(4));" is 131.,94
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testJAASConfigOption,Magic Number,The method contains a magic number: 2,94
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testJAASConfigOption,Magic Number,The method contains a magic number: 2,94
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testJAASConfigOption,Magic Number,The method contains a magic number: 3,94
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testJAASConfigOption,Magic Number,The method contains a magic number: 4,94
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testUseCurrentSubject,Empty catch clause,The method has an empty catch block.,136
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testRetry,Long Statement,The length of the statement "HttpServer server=ServerBootstrap.bootstrap().setListenerPort(findFreePort()).registerHandler("/retry"`(req`resp`ctx) -> resp.setStatusCode(counter[0]++ < 2 ? 503 : 200)).create();" is 180.,182
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testRetry,Magic Number,The method contains a magic number: 2,182
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testRetry,Magic Number,The method contains a magic number: 503,182
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testRetry,Magic Number,The method contains a magic number: 200,182
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testRetry,Magic Number,The method contains a magic number: 2,182
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testRetry,Magic Number,The method contains a magic number: 200,182
apache_knox,org.apache.knox.gateway.shell,KnoxSessionTest,testRetry,Magic Number,The method contains a magic number: 3,182
apache_knox,org.apache.knox.gateway.shell,KnoxShTest,shouldBuildTrustStoreWithDefaultPortIfGatewayUrlHasNoPort,Magic Number,The method contains a magic number: 443,33
apache_knox,org.apache.knox.gateway.shell,KnoxShTest,shouldBuildTrustStoreWithGatewayUrlPort,Magic Number,The method contains a magic number: 8443,38
apache_knox,org.apache.knox.gateway.shell,KnoxShTest,testBuildTruststore,Long Statement,The length of the statement "assertTrue(new String(baos.toByteArray()`StandardCharsets.UTF_8).contains("Opening connection to localhost:" + expectedPort));" is 126.,43
apache_knox,org.apache.knox.gateway.shell,KnoxTokenCredentialCollectorTest,testEmptyTokenCache,Empty catch clause,The method has an empty catch block.,84
apache_knox,org.apache.knox.gateway.shell,KnoxTokenCredentialCollectorTest,testEmptyTokenCache,Long Identifier,The length of the identifier caughtCredentialCollectionException is 35.,84
apache_knox,org.apache.knox.gateway.shell.alias,AbstractAliasRequest,createRequest,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@43d0f7f4,106
apache_knox,org.apache.knox.gateway.shell.alias,PostRequest,PostRequest,Long Parameter List,The method has 5 parameters. ,46
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testAddGatewayAlias,Empty catch clause,The method has an empty catch block.,45
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testAddGatewayAlias,Long Statement,The length of the statement "final String expectedEndpointPath=session.base() + AbstractAliasRequest.SERVICE_PATH + "/"+ AbstractAliasRequest.GATEWAY_CLUSTER_NAME+ "/"+ alias;" is 146.,45
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testAddClusterAlias,Empty catch clause,The method has an empty catch block.,90
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testRemoveGatewayAlias,Empty catch clause,The method has an empty catch block.,135
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testRemoveGatewayAlias,Long Statement,The length of the statement "final String expectedEndpointPath=session.base() + AbstractAliasRequest.SERVICE_PATH + "/"+ AbstractAliasRequest.GATEWAY_CLUSTER_NAME+ "/"+ alias;" is 146.,135
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testRemoveClusterAlias,Empty catch clause,The method has an empty catch block.,163
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testListGatewayAliases,Empty catch clause,The method has an empty catch block.,191
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testListGatewayAliases,Long Statement,The length of the statement "final String expectedEndpointPath=session.base() + AbstractAliasRequest.SERVICE_PATH + "/"+ AbstractAliasRequest.GATEWAY_CLUSTER_NAME;" is 134.,191
apache_knox,org.apache.knox.gateway.shell.alias,AliasTest,testListClusterAliases,Empty catch clause,The method has an empty catch block.,218
apache_knox,org.apache.knox.gateway.shell.alias,AddAliasResponseTest,testAddAliasResponse,Long Statement,The length of the statement "HttpResponse httpResponse=createTestResponse(createTestStatusLine(HttpStatus.SC_CREATED)`CLUSTER`Collections.singletonList(TEST_ALIAS));" is 136.,32
apache_knox,org.apache.knox.gateway.shell.alias,ListAliasResponseTest,createTestEntity,Magic Number,The method contains a magic number: 48,55
apache_knox,org.apache.knox.gateway.shell.alias,RemoveAliasResponseTest,testRemoveAliasResponse,Long Statement,The length of the statement "HttpResponse httpResponse=createTestResponse(createTestStatusLine(HttpStatus.SC_OK)`CLUSTER`Collections.singletonList(TEST_ALIAS));" is 131.,32
apache_knox,org.apache.knox.gateway.shell.manager,DeployResourceRequest,execute,Long Statement,The length of the statement "throw new IllegalStateException("A " + resourceType.getName() + " resource with the same name ("+ resourceName+ ") is already deployed.");" is 138.,48
apache_knox,org.apache.knox.gateway.shell.table,CSVKnoxShellTableBuilder,url,Long Statement,The length of the statement "try (Reader urlConnectionStreamReader=new InputStreamReader(connection.getInputStream()`StandardCharsets.UTF_8);BufferedReader csvReader=new BufferedReader(urlConnectionStreamReader)){" is 184.,43
apache_knox,org.apache.knox.gateway.shell.table,CSVKnoxShellTableBuilder,string,Long Statement,The length of the statement "try (InputStream is=new ByteArrayInputStream(csvString.getBytes(StandardCharsets.UTF_8));Reader stringStreamReader=new InputStreamReader(is`StandardCharsets.UTF_8);BufferedReader csvReader=new BufferedReader(stringStreamReader)){" is 229.,53
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRowDeserializer,cast,Complex Method,Cyclomatic complexity of the method is 10,116
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,toString,Complex Conditional,The conditional expression !tableToRender.headers.isEmpty() && !tableToRender.rows.isEmpty() && tableToRender.headers.size() != tableToRender.rows.get(0).size() is complex.,80
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,toString,Complex Method,Cyclomatic complexity of the method is 8,80
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,toString,Long Statement,The length of the statement "if (!tableToRender.headers.isEmpty() && !tableToRender.rows.isEmpty() && tableToRender.headers.size() != tableToRender.rows.get(0).size()) {" is 140.,80
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,toString,Magic Number,The method contains a magic number: 4,80
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,toString,Magic Number,The method contains a magic number: 4,80
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,centerString,Long Statement,The length of the statement "return String.format(Locale.ROOT`"%-" + width + "s"`String.format(Locale.ROOT`"%" + (s.length() + (width - s.length()) / 2) + "s"`s));" is 134.,130
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,centerString,Magic Number,The method contains a magic number: 2,130
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,ensureEvenLength,Magic Number,The method contains a magic number: 2,135
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableRenderer,createBorder,Magic Number,The method contains a magic number: 2,142
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistory,rollback,Magic Number,The method contains a magic number: 2,73
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistory,validateReplayStep,Long Statement,The length of the statement "throw new IllegalArgumentException(String.format(Locale.getDefault()`"It is not allowed to replay up to step %d as this step does not produce an intance of KnoxShellTable"`step));" is 179.,123
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableHistoryAspect,saveKnoxShellTableCall,Long Statement,The length of the statement "KnoxShellTableCallHistory.getInstance().saveCall(builderId`new KnoxShellTableCall(signature.getDeclaringTypeName()`signature.getName()`builderMethod`params));" is 158.,79
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,getConversion,Complex Method,Cyclomatic complexity of the method is 9,101
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,toDoubleArray,Complex Method,Cyclomatic complexity of the method is 11,135
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,median,Magic Number,The method contains a magic number: 50,192
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,getUniqueTableId,Magic Number,The method contains a magic number: 1000,312
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,getCallHistoryList,Long Statement,The length of the statement "final Map<Object`Class<?>> params=call.hasSensitiveData() ? Collections.singletonMap("***"`String.class) : call.getParams();" is 124.,316
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,getCallHistoryList,Long Statement,The length of the statement "sanitizedCallHistoryList.add(new KnoxShellTableCall(call.getInvokerClass()`call.getMethod()`call.isBuilderMethod()`params));" is 124.,316
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,getCallHistory,Long Statement,The length of the statement "final StringBuilder callHistoryStringBuilder=new StringBuilder("Call history (id=").append(id).append(')').append(LINE_SEPARATOR).append(LINE_SEPARATOR);" is 153.,325
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTable,getCallHistory,Long Statement,The length of the statement "getCallHistoryList().forEach(callHistory -> callHistoryStringBuilder.append("Step ").append(index.getAndIncrement()).append(':').append(LINE_SEPARATOR).append(callHistory).append(LINE_SEPARATOR));" is 196.,325
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableJSONSerializer,serializeKnoxShellTable,Long Statement,The length of the statement "filterProvider.addFilter("knoxShellTableFilter"`SimpleBeanPropertyFilter.filterOutAllExcept("headers"`"rows"`"title"`"id"));" is 124.,48
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableJSONSerializer,saveTableInFile,Long Statement,The length of the statement "filterProvider.addFilter("knoxShellTableFilter"`SimpleBeanPropertyFilter.filterOutAllExcept("headers"`"rows"`"title"`"id"));" is 124.,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableJSONSerializer,saveTableInFile,Long Statement,The length of the statement "jsonResult=JsonUtils.renderAsJsonString(KnoxShellTableCallHistory.getInstance().getCallHistory(table.id)`null`JSON_DATE_FORMAT.get());" is 134.,76
apache_knox,org.apache.knox.gateway.shell.table,JDBCKnoxShellTableBuilder,processResultSet,Empty catch clause,The method has an empty catch block.,117
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,init,Magic Number,The method contains a magic number: 10,36
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,init,Magic Number,The method contains a magic number: 20d,36
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,init,Magic Number,The method contains a magic number: 30,36
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,init,Magic Number,The method contains a magic number: 40d,36
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,init,Magic Number,The method contains a magic number: 50,36
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,init,Magic Number,The method contains a magic number: 60d,36
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testNameMethod,Magic Number,The method contains a magic number: 10,52
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testNameMethod,Magic Number,The method contains a magic number: 2,52
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testNameMethod,Magic Number,The method contains a magic number: 25d,52
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testNameMethod,Magic Number,The method contains a magic number: 2,52
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testNameMethod,Magic Number,The method contains a magic number: 3,52
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 5,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 3,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 25,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 2,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 10d,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 3,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 30d,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 2,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 3,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 2,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 3,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanFilter,Magic Number,The method contains a magic number: 2,59
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 20,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 100,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 3,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 30d,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 100d,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 3,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 3,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanFilter,Magic Number,The method contains a magic number: 3,76
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Long Statement,The length of the statement "assertEquals(TABLE.filter().name("Column Date").greaterThanOrEqualTo(TEST_DATE_FORMAT.parse("2009-12-31")).getRows().size()`3);" is 127.,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Long Statement,The length of the statement "assertEquals(TABLE.filter().name("Column Date").greaterThanOrEqualTo(TEST_DATE_FORMAT.parse("2012-01-01")).getRows().size()`2);" is 127.,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 30,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 2,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 50,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 40d,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 2,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 20d,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 3,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 2,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 3,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 3,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testGreaterThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 2,93
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Long Statement,The length of the statement "assertEquals(TABLE.filter().name("Column Date").lessThanOrEqualTo(TEST_DATE_FORMAT.parse("2012-02-01")).getRows().size()`3);" is 124.,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Long Statement,The length of the statement "assertEquals(TABLE.filter().name("Column Date").lessThanOrEqualTo(TEST_DATE_FORMAT.parse("2010-01-01")).getRows().size()`1);" is 124.,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 30,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 2,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 50,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 3,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 40d,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 2,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 20d,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 2,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testLessThanOrEqualToThanFilter,Magic Number,The method contains a magic number: 3,110
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testEqualToFilter,Magic Number,The method contains a magic number: 60,127
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testEqualToFilter,Magic Number,The method contains a magic number: 50,127
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testEqualToFilter,Magic Number,The method contains a magic number: 40d,127
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableFilterTest,testEqualToFilter,Magic Number,The method contains a magic number: 90d,127
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSimpleTableRendering,Long Statement,The length of the statement "String expectedResult="+------------+------------+------------+\n" + "| Column A | Column B | Column C |\n" + "+------------+------------+------------+\n"+ "| 123 | 456 | 3 |\n"+ "+------------+------------+------------+\n";" is 224.,70
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testValueLongerThanHeader,Long Statement,The length of the statement "String expectedResult="+------------+------------+--------------+\n" + "| Column A | Column B | Column C |\n" + "+------------+------------+--------------+\n"+ "| 123 | 456 | 344444444 |\n"+ "+------------+------------+--------------+\n";" is 238.,85
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMultipleRowsTableRendering,Long Statement,The length of the statement "String expectedResult="+------------+------------+--------------+\n" + "| Column A | Column B | Column C |\n" + "+------------+------------+--------------+\n"+ "| 123 | 456 | 344444444 |\n"+ "| 789 | 012 | 844444444 |\n"+ "+------------+------------+--------------+\n";" is 269.,100
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testTableSelect,Long Statement,The length of the statement "String expectedResult="+------------+------------+--------------+\n" + "| Column A | Column B | Column C |\n" + "+------------+------------+--------------+\n"+ "| 123 | 456 | 344444444 |\n"+ "| 789 | 012 | 844444444 |\n"+ "+------------+------------+--------------+\n";" is 269.,129
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMultipleRowsTableNoHeadersRendering,Long Statement,The length of the statement "String expectedResult="+--------+--------+--------------+\n" + "| 123 | 456 | 344444444 |\n" + "| 789 | 012 | 844444444 |\n"+ "+--------+--------+--------------+\n";" is 165.,149
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testCSVStringToTable,Magic Number,The method contains a magic number: 2,232
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testFromJSONUsingCallHistory,Long Statement,The length of the statement "final String jsonPath=KnoxShellTableCallHistoryTest.class.getClassLoader().getResource("knoxShellTableCallHistoryWithFiltering.json").getPath();" is 144.,264
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testFromJSONUsingCallHistory,Long Statement,The length of the statement "final String csvPath="file://" + KnoxShellTableCallHistoryTest.class.getClassLoader().getResource("knoxShellTableLocationsWithZipLessThan14.csv").getPath();" is 156.,264
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testFromJSONUsingCallHistory,Magic Number,The method contains a magic number: 4,264
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJoinTables,Long Statement,The length of the statement "KnoxShellTable joined2=KnoxShellTable.builder().join().title("Joined Table").left(table).right(table2).on("Column A"`"Column D");" is 129.,346
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJoinTables,Magic Number,The method contains a magic number: 3,346
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUnManagedConnection,Magic Number,The method contains a magic number: 2,386
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUnManagedConnection,Magic Number,The method contains a magic number: 2,386
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUnManagedConnection,Magic Number,The method contains a magic number: 2,386
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUnManagedConnection,Magic Number,The method contains a magic number: 2,386
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUnManagedConnection,Magic Number,The method contains a magic number: 2,386
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUnManagedConnection,Magic Number,The method contains a magic number: 2,386
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,answer,Magic Number,The method contains a magic number: 2,401
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUsingConnectionString,Long Identifier,The length of the field SYSTEM_PROPERTY_DERBY_STREAM_ERROR_FILE is 39.,474
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUsingConnectionString,Long Statement,The length of the statement "final KnoxShellTable table=KnoxShellTable.builder().jdbc().driver(DerbyDatabase.EMBEDDED_DRIVER).connectTo(DerbyDatabase.PROTOCOL + derbyDatabaseFolder.toString()).sql("select * from books");" is 191.,474
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUsingConnectionString,Long Statement,The length of the statement "assertTrue(table.values("TITLE").containsAll(Arrays.asList("Apache Knox: The Definitive Guide"`"Apache Knox: The Definitive Guide 2nd Edition")));" is 146.,474
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testJDBCBuilderUsingConnectionString,Magic Number,The method contains a magic number: 2,474
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,prepareDerbyDatabase,Long Statement,The length of the statement "final String createTableSql=readFileToString(new File(getClass().getClassLoader().getResource("createBooksTable.sql").getFile())`UTF_8);" is 136.,494
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,prepareDerbyDatabase,Long Statement,The length of the statement "final String insertDataSql=readFileToString(new File(getClass().getClassLoader().getResource("insertBooks.sql").getFile())`UTF_8);" is 130.,494
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,prepareDerbyDatabase,Long Statement,The length of the statement "try (Connection connection=derbyDatabase.getConnection();Statement createTableStatment=connection.createStatement();Statement insertDataStatement=connection.createStatement()){" is 176.,494
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,shouldMaskUserNameAndPasswordParametersWhenConnectingToDBUsingJDBCBuilder,Long Statement,The length of the statement "saveCall(table.id`"org.apache.knox.gateway.shell.table.JDBCKnoxShellTableBuilder"`"driver"`false`singletonMap("org.apache.derby.jdbc.EmbeddedDriver"`String.class));" is 164.,508
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,shouldMaskUserNameAndPasswordParametersWhenConnectingToDBUsingJDBCBuilder,Long Statement,The length of the statement "saveCall(table.id`"org.apache.knox.gateway.shell.table.JDBCKnoxShellTableBuilder"`"username"`false`singletonMap("myUserName"`String.class));" is 140.,508
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,shouldMaskUserNameAndPasswordParametersWhenConnectingToDBUsingJDBCBuilder,Long Statement,The length of the statement "saveCall(table.id`"org.apache.knox.gateway.shell.table.JDBCKnoxShellTableBuilder"`"pwd"`false`singletonMap("myP4ssW0rd"`String.class));" is 135.,508
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,shouldMaskUserNameAndPasswordParametersWhenConnectingToDBUsingJDBCBuilder,Long Statement,The length of the statement "saveCall(table.id`"org.apache.knox.gateway.shell.table.JDBCKnoxShellTableBuilder"`"connectTo"`false`singletonMap("myDBConnectionUrl"`String.class));" is 148.,508
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,shouldMaskUserNameAndPasswordParametersWhenConnectingToDBUsingJDBCBuilder,Long Statement,The length of the statement "saveCall(table.id`"org.apache.knox.gateway.shell.table.JDBCKnoxShellTableBuilder"`"sql"`true`singletonMap("SELECT 1 FROM DUAL"`String.class));" is 142.,508
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,saveCall,Long Parameter List,The method has 5 parameters. ,530
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testConversion,Magic Number,The method contains a magic number: 10,534
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Long Statement,The length of the statement "TABLE.header("Column Integer").header("Column Double").header("Column Float").header("Column Byte").header("Column Short").header("Column Long").header("Column String");" is 169.,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 10,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 20,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 30,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 10,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 20,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 30,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 100000000,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 200000000,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 300000000,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 10,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 20d,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 20.9999,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 30,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 40d,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 40.9999,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 27,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 60d,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 60.9999,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 22.3,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 40,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 22.3,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 40,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 40.9999,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 40.9999,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 2,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 20,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 20,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 2.0E8,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 696921.52666666,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMean,Magic Number,The method contains a magic number: 0.1,545
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 10,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 20d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 10,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 10,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 20,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 20,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 2,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 10,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 20d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 20.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 50,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 41d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 60.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.9999,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 2,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 10,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 20d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30.0000,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 31,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 41d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 31.0000,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 50,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 60d,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 70.0000,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30.5,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30.5,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.01,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.5,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.01,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 40.5,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.01,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30.5000,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 30.5000,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 2,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMedian,Magic Number,The method contains a magic number: 0.1,582
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 10,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 20d,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 40.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 10,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 10,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 40.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 40.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 2,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 10,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 20d,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 20.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 30,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 40d,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 20.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 30,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 40d,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 30.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 30,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 30,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 40,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 40,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 20.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 20.9999,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 2,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMode,Magic Number,The method contains a magic number: 0.1,619
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 10,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 20d,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 20.5000,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 90,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 100d,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 20.0500,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 100,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 0.1,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 100,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 0.1,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 120,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 0.1,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 120,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 0.1,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 40.5500,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 0.1,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 40.5500,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 2,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testSum,Magic Number,The method contains a magic number: 0.1,644
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 10,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 20d,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 30.9998,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 20,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 50d,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 30.9999,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 20,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 0.1,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 20,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 0.1,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 50,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 0.1,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 50,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 0.1,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 30.9999,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 0.1,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 30.9999,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 2,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMax,Magic Number,The method contains a magic number: 0.1,659
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 10,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20d,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20.9998,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 50d,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20.9999,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 10,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 0.1,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 10,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 0.1,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 0.1,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 0.1,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20.9998,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 0.1,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 20.9998,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 2,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testMin,Magic Number,The method contains a magic number: 0.1,674
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 100,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 300,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 200,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 400,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 200,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 500,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 100.0,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 200.0,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 166.66666666666666,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 2,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 200.0,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 3,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 200.0,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 4,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 500.0,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,testAggregate,Magic Number,The method contains a magic number: 5,702
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,shouldReturnDifferentCallHistoryForDifferentTables,Long Statement,The length of the statement "KnoxShellTableCallHistory.getInstance().saveCall(table1.getId()`new KnoxShellTableCall("class1"`"method1"`true`Collections.singletonMap("param1"`String.class)));" is 161.,719
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableTest,shouldReturnDifferentCallHistoryForDifferentTables,Long Statement,The length of the statement "KnoxShellTableCallHistory.getInstance().saveCall(table2.getId()`new KnoxShellTableCall("class2"`"method2"`false`Collections.singletonMap("param2"`String.class)));" is 162.,719
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,init,Long Statement,The length of the statement "CALL_LIST.add(new KnoxShellTableCall("org.apache.knox.gateway.shell.table.KnoxShellTableBuilder"`"csv"`false`Collections.emptyMap()));" is 134.,41
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,init,Long Statement,The length of the statement "CALL_LIST.add(new KnoxShellTableCall("org.apache.knox.gateway.shell.table.CSVKnoxShellTableBuilder"`"withHeaders"`false`Collections.emptyMap()));" is 145.,41
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,init,Long Statement,The length of the statement "final String csvPath=KnoxShellTableCallHistoryTest.class.getClassLoader().getResource("knoxShellTableLocationsWithZipLessThan14.csv").getPath();" is 144.,41
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,init,Long Statement,The length of the statement "CALL_LIST.add(new KnoxShellTableCall("org.apache.knox.gateway.shell.table.CSVKnoxShellTableBuilder"`"url"`true`Collections.singletonMap("file://" + csvPath`String.class)));" is 172.,41
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,init,Long Statement,The length of the statement "CALL_LIST.add(new KnoxShellTableCall("org.apache.knox.gateway.shell.table.KnoxShellTable"`"filter"`false`Collections.emptyMap()));" is 130.,41
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,init,Long Statement,The length of the statement "CALL_LIST.add(new KnoxShellTableCall("org.apache.knox.gateway.shell.table.KnoxShellTableFilter"`"name"`false`Collections.singletonMap("ZIP"`String.class)));" is 156.,41
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,init,Long Statement,The length of the statement "CALL_LIST.add(new KnoxShellTableCall("org.apache.knox.gateway.shell.table.KnoxShellTableFilter"`"greaterThan"`true`Collections.singletonMap("5"`String.class)));" is 160.,41
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldReturnCallHistoryInProperOrder,Magic Number,The method contains a magic number: 2,58
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldThrowIllegalArgumentExceptionIfReplayingToInappropriateStep,Long Statement,The length of the statement "expectedException.expectMessage("It is not allowed to replay up to step 2 as this step does not produce an intance of KnoxShellTable");" is 135.,68
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldThrowIllegalArgumentExceptionIfReplayingToInappropriateStep,Magic Number,The method contains a magic number: 3,68
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldThrowIllegalArgumentExceptionIfReplayingToInappropriateStep,Magic Number,The method contains a magic number: 2,68
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldProduceKnoxShellTableIfReplayingToValidStep,Magic Number,The method contains a magic number: 3,79
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldProduceKnoxShellTableIfReplayingToValidStep,Magic Number,The method contains a magic number: 3,79
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldProduceKnoxShellTableIfReplayingToValidStep,Magic Number,The method contains a magic number: 14,79
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldProduceKnoxShellTableIfReplayingToValidStep,Magic Number,The method contains a magic number: 13,79
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldNotRollBackIfOnlyOneBuilderMethodRecorded,Magic Number,The method contains a magic number: 3,101
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldRollbackToValidPreviousStep,Magic Number,The method contains a magic number: 6,111
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldRollbackToValidPreviousStep,Magic Number,The method contains a magic number: 6,111
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldRollbackToValidPreviousStep,Magic Number,The method contains a magic number: 4,111
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldRollbackToValidPreviousStep,Magic Number,The method contains a magic number: 14,111
apache_knox,org.apache.knox.gateway.shell.table,KnoxShellTableCallHistoryTest,shouldRollbackToValidPreviousStep,Magic Number,The method contains a magic number: 13,111
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFile,Long Identifier,The length of the field ENV_GATEWAY_CLIENT_TRUSTSTORE_DIR is 33.,37
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFile,Long Identifier,The length of the field DEFAULT_GATEWAY_CLIENT_TRUSTSTORE_DIR is 37.,37
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFile,Long Identifier,The length of the field ENV_GATEWAY_CLIENT_TRUSTSTORE_FILENAME is 38.,37
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFile,Long Identifier,The length of the field DEFAULT_GATEWAY_CLIENT_TRUSTSTORE_FILENAME is 42.,37
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFile,Long Statement,The length of the statement "final String truststoreDir=fetchTrustStoreAttribute(ENV_GATEWAY_CLIENT_TRUSTSTORE_DIR`DEFAULT_GATEWAY_CLIENT_TRUSTSTORE_DIR);" is 125.,37
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFile,Long Statement,The length of the statement "final String truststoreFileName=fetchTrustStoreAttribute(ENV_GATEWAY_CLIENT_TRUSTSTORE_FILENAME`DEFAULT_GATEWAY_CLIENT_TRUSTSTORE_FILENAME);" is 140.,37
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFilePassword,Long Identifier,The length of the field ENV_GATEWAY_CLIENT_TRUSTSTORE_PASSWORD is 38.,43
apache_knox,org.apache.knox.gateway.shell.util,ClientTrustStoreHelper,getClientTrustStoreFilePassword,Long Identifier,The length of the field DEFAULT_GATEWAY_CLIENT_TRUSTSTORE_PASSWORD is 42.,43
apache_knox,org.apache.knox.gateway.shell.knox.token,AbstractTokenLifecycleRequest,AbstractTokenLifecycleRequest,Abstract Function Call From Constructor,The constructor AbstractTokenLifecycleRequest calls a virtual method getOperation.,39
apache_knox,org.apache.knox.gateway.shell.knox.token,TokenTest,testToken,Long Statement,The length of the statement "assertEquals(setDoAsUser && StringUtils.isNotEmpty(doAsUser)`request.getRequestURI().toString().contains("doAs=" + doAsUser));" is 126.,110
apache_knox,org.apache.knox.gateway.shell.knox.token,TokenTest,testRevokeToken,Long Statement,The length of the statement "Revoke.Request request=(setDoAsUser) ? Token.revoke(knoxSession`testToken`doAsUser) : Token.revoke(knoxSession`testToken);" is 122.,161
apache_knox,org.apache.knox.gateway.shell.knox.token,TokenTest,testTokenLifecyle,Empty catch clause,The method has an empty catch block.,191
apache_knox,org.apache.knox.gateway.shell.commands,SelectCommand,keyPressed,Complex Method,Cyclomatic complexity of the method is 8,53
apache_knox,org.apache.knox.gateway.shell.commands,SelectCommand,execute,Complex Method,Cyclomatic complexity of the method is 12,90
apache_knox,org.apache.knox.gateway.shell.commands,SelectCommand,execute,Magic Number,The method contains a magic number: 5,90
apache_knox,org.apache.knox.gateway.shell.commands,SelectCommand,execute,Magic Number,The method contains a magic number: 40,90
apache_knox,org.apache.knox.gateway.shell.commands,AbstractSQLCommandSupport,AbstractSQLCommandSupport,Long Parameter List,The method has 6 parameters. ,43
apache_knox,org.apache.knox.gateway.shell.commands,AbstractSQLCommandSupport,getConnectionFromSession,Long Statement,The length of the statement "HashMap<String`Connection> connections=(HashMap<String`Connection>)getVariables().getOrDefault(KNOXDATASOURCE_CONNECTIONS`new HashMap<String`Connection>());" is 156.,48
apache_knox,org.apache.knox.gateway.shell.commands,AbstractSQLCommandSupport,getConnection,Long Statement,The length of the statement "HashMap<String`Connection> connections=(HashMap<String`Connection>)getVariables().getOrDefault(KNOXDATASOURCE_CONNECTIONS`new HashMap<String`Connection>());" is 156.,59
apache_knox,org.apache.knox.gateway.shell.commands,AbstractSQLCommandSupport,addToSQLHistory,Magic Number,The method contains a magic number: 20,144
apache_knox,org.apache.knox.gateway.shell.commands,AbstractSQLCommandSupport,addToSQLHistory,Magic Number,The method contains a magic number: 20,159
apache_knox,org.apache.knox.gateway.shell.commands,AbstractSQLCommandSupport,closeConnections,Empty catch clause,The method has an empty catch block.,191
apache_knox,org.apache.knox.gateway.shell.commands,AbstractSQLCommandSupport,closeConnections,Long Statement,The length of the statement "HashMap<String`Connection> connections=(HashMap<String`Connection>)getVariables().getOrDefault(KNOXDATASOURCE_CONNECTIONS`new HashMap<String`Connection>());" is 156.,191
apache_knox,org.apache.knox.gateway.shell.commands,KnoxLoginDialog,collect,Magic Number,The method contains a magic number: 24,36
apache_knox,org.apache.knox.gateway.shell.commands,KnoxLoginDialog,collect,Magic Number,The method contains a magic number: 24,36
apache_knox,org.apache.knox.gateway.shell.commands,DataSourceCommand,execute,Complex Method,Cyclomatic complexity of the method is 14,40
apache_knox,org.apache.knox.gateway.shell.commands,DataSourceCommand,execute,Long Statement,The length of the statement "datasource.row().value(dsValue.getName()).value(dsValue.getConnectStr()).value(dsValue.getDriver()).value(dsValue.getAuthnType());" is 130.,40
apache_knox,org.apache.knox.gateway.shell.commands,DataSourceCommand,execute,Magic Number,The method contains a magic number: 2,40
apache_knox,org.apache.knox.gateway.shell.commands,DataSourceCommand,execute,Magic Number,The method contains a magic number: 3,40
apache_knox,org.apache.knox.gateway.shell.commands,DataSourceCommand,execute,Magic Number,The method contains a magic number: 4,40
apache_knox,org.apache.knox.gateway.shell.commands,DataSourceCommand,buildTable,Long Statement,The length of the statement "@SuppressWarnings("unchecked") Map<String`KnoxDataSource> dataSources=(Map<String`KnoxDataSource>)getVariables().get(KNOXDATASOURCES);" is 134.,127
apache_knox,org.apache.knox.gateway.shell.commands,DataSourceCommand,buildTable,Long Statement,The length of the statement "datasource.row().value(dsValue.getName()).value(dsValue.getConnectStr()).value(dsValue.getDriver()).value(dsValue.getAuthnType());" is 130.,127
apache_knox,org.apache.knox.gateway.shell.commands,AbstractKnoxShellCommand,AbstractKnoxShellCommand,Long Parameter List,The method has 6 parameters. ,38
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Complex Method,Cyclomatic complexity of the method is 15,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 2,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 2,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 755,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 4,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 3,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 3,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 2,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 2,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,execute,Magic Number,The method contains a magic number: 2,61
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,exists,Empty catch clause,The method has an empty catch block.,251
apache_knox,org.apache.knox.gateway.shell.commands,WebHDFSCommand,buildTableFromListStatus,Long Statement,The length of the statement "table.row().value(map.get("permission")).value(map.get("owner")).value(map.get("group")).value(map.get("length")).value(cal.getTime()).value(map.get("pathSuffix"));" is 164.,386
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Complex Method,Cyclomatic complexity of the method is 12,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 2,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 3,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 4,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 5,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 6,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 7,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 8,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 9,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Magic Number,The method contains a magic number: 10,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,getDefaultPattern,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@a913e30,88
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesInvoker,createDefaultPatternSuffix,Magic Number,The method contains a magic number: 7,109
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Long Statement,The length of the statement "assertThat(res.withoutAnnotationsWithElevenParams("v1"`"v2"`"v3"`"v4"`"v5"`"v6"`"v7"`"v8"`"v9"`"v10"`"v11")`equalTo("withoutAnnotationsWithElevenParams(\"v1\"`\"v2\"`\"v3\"`\"v4\"`\"v5\"`\"v6\"`\"v7\"`\"v8\"`\"v9\"`\"v10\"`\"v11\")"));" is 235.,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Magic Number,The method contains a magic number: 42,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Magic Number,The method contains a magic number: 72,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Magic Number,The method contains a magic number: 33,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Magic Number,The method contains a magic number: 17,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Magic Number,The method contains a magic number: 7,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Magic Number,The method contains a magic number: 7,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesTest,testResourceFormatting,Magic Number,The method contains a magic number: 11,46
apache_knox,org.apache.knox.gateway.i18n.resources,ResourcesFormattingSubject,withoutAnnotationsWithElevenParams,Long Parameter List,The method has 11 parameters. ,35
apache_knox,org.apache.knox.gateway.i18n.messages,MessageLogger,log,Long Parameter List,The method has 5 parameters. ,24
apache_knox,org.apache.knox.gateway.i18n.messages,MessagesInvoker,invoke,Magic Number,The method contains a magic number: 2,42
apache_knox,org.apache.knox.gateway.i18n.messages,MessagesTest,testFirst,Magic Number,The method contains a magic number: 7,34
apache_knox,org.apache.knox.gateway.i18n.messages,MessagesSubject,withFullAnnotationAndParameter,Magic Number,The method contains a magic number: 3,22
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.sout,SoutMessageLogger,log,Long Parameter List,The method has 5 parameters. ,40
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.jdk,JdkMessageLogger,log,Long Parameter List,The method has 5 parameters. ,41
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.jdk,JdkMessageLogger,toLevel,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@39ad376f,52
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.test,TestMessageLogger,log,Long Parameter List,The method has 5 parameters. ,46
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.test,TestMessageRecord,TestMessageRecord,Long Parameter List,The method has 6 parameters. ,31
apache_knox,org.apache.knox.gateway.dispatch,UrlConnectionDispatch,doGet,Long Statement,The length of the statement "auditor.audit(Action.DISPATCH`urlStr`ResourceType.URI`ActionOutcome.FAILURE`RES.responseStatus(HttpServletResponse.SC_UNAUTHORIZED));" is 133.,88
apache_knox,org.apache.knox.gateway.dispatch,UrlConnectionDispatch,doGet,Long Statement,The length of the statement "auditor.audit(Action.DISPATCH`urlStr`ResourceType.URI`ActionOutcome.FAILURE`RES.responseStatus(HttpServletResponse.SC_NOT_FOUND));" is 130.,88
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,convertCommaDelimitedHeadersToMap,Long Statement,The length of the statement "Arrays.stream(headers.split("\\s*;\\s*")).forEach(keyValuePair -> extraHeaders.putIfAbsent(keyValuePair.split("\\s*:\\s*")[0]`keyValuePair.split("\\s*:\\s*")[1]));" is 163.,57
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,convertCommaDelimitedHeadersToMap,Long Statement,The length of the statement "auditor.audit("deserialize headers"`headers`"header"`ActionOutcome.WARNING`"Extra Headers are skipped because of " + e.getMessage());" is 133.,57
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,populateSetCookieHeaderDirectiveExlusions,Long Identifier,The length of the field responseExcludeSetCookieHeaderDirectives is 40.,100
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,populateSetCookieHeaderDirectiveExlusions,Long Statement,The length of the statement "final Optional<String> setCookieHeader=headerSet.stream().filter(s -> StringUtils.startsWithIgnoreCase(s`SET_COOKIE)).findFirst();" is 130.,100
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,populateSetCookieHeaderDirectiveExlusions,Long Statement,The length of the statement "responseExcludeSetCookieHeaderDirectives=setCookieHeaderParts.length > 1 ? new HashSet<>(Arrays.asList(setCookieHeaderParts[1].split(";"))).stream().map(e -> e.trim()).collect(Collectors.toSet()) : EXCLUDE_SET_COOKIES_DEFAULT;" is 226.,100
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,populateHttpHeaderExlusionsOtherThanSetCookie,Long Identifier,The length of the identifier excludedHeadersOthenThanSetCookie is 33.,114
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,populateHttpHeaderExlusionsOtherThanSetCookie,Long Statement,The length of the statement "final Set<String> excludedHeadersOthenThanSetCookie=headerSet.stream().filter(s -> !StringUtils.startsWithIgnoreCase(s`SET_COOKIE)).collect(Collectors.toSet());" is 160.,114
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,getOutboundResponseExcludedSetCookieHeaderDirectives,Long Identifier,The length of the field responseExcludeSetCookieHeaderDirectives is 40.,143
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,getOutboundResponseExcludedSetCookieHeaderDirectives,Long Statement,The length of the statement "return responseExcludeSetCookieHeaderDirectives == null ? Collections.emptySet() : responseExcludeSetCookieHeaderDirectives;" is 124.,143
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatch,getDispatchUrl,Empty catch clause,The method has an empty catch block.,161
apache_knox,org.apache.knox.gateway.dispatch,HeaderPreAuthFederationDispatch,executeRequest,Long Statement,The length of the statement "final GatewayConfig config=(GatewayConfig)inboundRequest.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 130.,50
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,getReplayBufferSize,Magic Number,The method contains a magic number: 1024,92
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,setReplayBufferSizeInBytes,Magic Number,The method contains a magic number: 1024,116
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,executeOutboundRequest,Long Statement,The length of the statement "auditor.audit(Action.DISPATCH`outboundRequest.getURI().toString()`ResourceType.URI`ActionOutcome.UNAVAILABLE`RES.requestMethod(outboundRequest.getMethod()));" is 157.,156
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,executeOutboundRequest,Long Statement,The length of the statement "auditor.audit(Action.DISPATCH`outboundRequest.getURI().toString()`ResourceType.URI`ActionOutcome.SUCCESS`RES.responseStatus(statusCode));" is 137.,156
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,executeOutboundRequest,Magic Number,The method contains a magic number: 201,156
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,copyResponseHeaderFields,Long Statement,The length of the statement "getOutboundResponseExcludeHeaders().stream().forEach(excludeHeader -> excludedHeaderDirectives.put(excludeHeader`Collections.singleton(EXCLUDE_ALL)));" is 150.,356
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,copyResponseHeaderFields,Long Statement,The length of the statement "boolean isBlockedAuthHeader=Arrays.stream(header.getElements()).anyMatch(h -> EXCLUDE_SET_COOKIES_DEFAULT.contains(h.getName()) && getOutboundResponseExcludedSetCookieHeaderDirectives().contains(h.getName()));" is 209.,356
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,calculateResponseHeaderValue,Long Statement,The length of the statement "headerValuesToCheck=headerValuesToCheck.stream().map(h -> h.replaceAll(separator.trim()`"")).collect(toCollection(LinkedHashSet::new));" is 135.,378
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,getOutboundResponseExcludeHeaders,Long Identifier,The length of the field outboundResponseExcludeHeaders is 30.,414
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,getOutboundResponseExcludedSetCookieHeaderDirectives,Long Identifier,The length of the field outboundResponseExcludedSetCookieHeaderDirectives is 49.,418
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatch,getOutboundResponseExcludedSetCookieHeaderDirectives,Long Statement,The length of the statement "return outboundResponseExcludedSetCookieHeaderDirectives == null ? Collections.emptySet() : outboundResponseExcludedSetCookieHeaderDirectives;" is 142.,418
apache_knox,org.apache.knox.gateway.dispatch,AbstractGatewayDispatch,copyRequestHeaderFields,Complex Conditional,The conditional expression StringUtils.isBlank(inboundRequest.getHeader(REQUEST_ID_HEADER_NAME)) && !getOutboundRequestExcludeHeaders().contains(REQUEST_ID_HEADER_NAME) && ThreadContext.containsKey(TRACE_ID) is complex.,128
apache_knox,org.apache.knox.gateway.dispatch,AbstractGatewayDispatch,copyRequestHeaderFields,Long Statement,The length of the statement "if (StringUtils.isBlank(inboundRequest.getHeader(REQUEST_ID_HEADER_NAME)) && !getOutboundRequestExcludeHeaders().contains(REQUEST_ID_HEADER_NAME) && ThreadContext.containsKey(TRACE_ID)) {" is 187.,128
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStore,HadoopAuthCookieStore,Magic Number,The method contains a magic number: 2,46
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStore,isAuthCookie,Long Statement,The length of the statement "return HADOOP_AUTH_COOKIE_NAME.equals(cookie.getName()) || HIVE_SERVER2_AUTH_COOKIE_NAME.equals(cookie.getName()) || IMPALA_AUTH_COOKIE_NAME.equals(cookie.getName());" is 166.,78
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStore,isKnoxCookie,Complex Conditional,The conditional expression value != null && (value.contains('=' + knoxPrincipal) || value.contains('=' + shortKnoxPrincipal)) is complex.,84
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,createHttpClient,Long Identifier,The length of the field DEFAULT_PARAMETER_RETRY_NON_SAFE_REQUEST is 40.,80
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,createHttpClient,Long Identifier,The length of the field PARAMETER_RETRY_NON_SAFE_REQUEST is 32.,80
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,createHttpClient,Long Statement,The length of the statement "GatewayConfig gatewayConfig=(GatewayConfig)filterConfig.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 129.,80
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,createHttpClient,Long Statement,The length of the statement "GatewayServices services=(GatewayServices)filterConfig.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 132.,80
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,createHttpClient,Long Statement,The length of the statement "Registry<AuthSchemeProvider> authSchemeRegistry=RegistryBuilder.<AuthSchemeProvider>create().register(AuthSchemes.SPNEGO`new KnoxSpnegoAuthSchemeFactory(true)).build();" is 168.,80
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,createHttpClient,Long Statement,The length of the statement "builder.setDefaultAuthSchemeRegistry(authSchemeRegistry).setDefaultCookieStore(new HadoopAuthCookieStore(gatewayConfig)).setDefaultCredentialsProvider(credentialsProvider);" is 172.,80
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,doesRetryParamExist,Long Statement,The length of the statement "return filterConfig.getInitParameter(PARAMETER_RETRY_COUNT) != null && StringUtils.isNumeric(filterConfig.getInitParameter(PARAMETER_RETRY_COUNT));" is 147.,146
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,getMaxConnections,Empty catch clause,The method has an empty catch block.,310
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,getMaxConnections,Long Statement,The length of the statement "GatewayConfig config=(GatewayConfig)filterConfig.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 122.,310
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,getMaxConnections,Magic Number,The method contains a magic number: 32,310
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,getConnectionTimeout,Empty catch clause,The method has an empty catch block.,328
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,getConnectionTimeout,Long Statement,The length of the statement "GatewayConfig globalConfig=(GatewayConfig)filterConfig.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 128.,328
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,getSocketTimeout,Empty catch clause,The method has an empty catch block.,346
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,getSocketTimeout,Long Statement,The length of the statement "GatewayConfig globalConfig=(GatewayConfig)filterConfig.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 128.,346
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactory,parseTimeout,Long Statement,The length of the statement "PeriodFormatter f=new PeriodFormatterBuilder().appendMinutes().appendSuffix("m"`" min").appendSeconds().appendSuffix("s"`" sec").appendMillis().toFormatter();" is 158.,364
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilter,isDispatchAllowed,Empty catch clause,The method has an empty catch block.,137
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testGetDispatchUrl,Long Statement,The length of the statement "assertThat(uri.toASCIIString()`is("http://test-host:42/test%2Cpath?service_config_version_note.matches(Updated%20Kerberos-related%20configurations"));" is 150.,54
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testGetDispatchUrlNoUrlEncoding,Long Statement,The length of the statement "assertThat(uri.toASCIIString()`is("http://test-host:42/test%2Cpath?service_config_version_note.matches(Updated%20Kerberos-related%20configurations"));" is 150.,111
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testGetDispatchUrlNoUrlEncoding,Long Statement,The length of the statement "path="https://test-host:42/api/v1/views/TEZ/versions/0.7.0.2.6.2.0-205/instances/TEZ_CLUSTER_INSTANCE/resources/atsproxy/ws/v1/timeline/TEZ_DAG_ID";" is 148.,111
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testGetDispatchUrlNoUrlEncoding,Long Statement,The length of the statement "assertThat(uri.toASCIIString()`is("https://test-host:42/api/v1/views/TEZ/versions/0.7.0.2.6.2.0-205/instances/TEZ_CLUSTER_INSTANCE/resources/atsproxy/ws/v1/timeline/TEZ_DAG_ID?limit=9007199254740991&primaryFilter=applicationId:%22application_1518808140659_0007%22&_=1519053586839"));" is 283.,111
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testGetDispatchUrlNoUrlEncoding,Long Statement,The length of the statement "assertThat(uri.toASCIIString()`is("http://test-host:8080/api/v1/clusters/mmolnar-knox2/configurations/service_config_versions?group_id%3E0&fields=*&_=1541527314780"));" is 167.,111
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeHeadersDefault,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,194
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeHeadersDefault,Magic Number,The method contains a magic number: 2,194
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeHeadersConfig,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,219
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testResponseExcludeHeadersDefault,Long Statement,The length of the statement "Header[] headers=new Header[]{new BasicHeader(SET_COOKIE`"abc")`new BasicHeader(WWW_AUTHENTICATE`"negotiate")`new BasicHeader("TEST"`"testValue")`new BasicHeader("Accept"`"applcation/json")};" is 191.,244
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testResponseExcludeHeadersDefault,Magic Number,The method contains a magic number: 2,244
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testResponseExcludeHeadersConfig,Long Statement,The length of the statement "Header[] headers=new Header[]{new BasicHeader(SET_COOKIE`"abc")`new BasicHeader(WWW_AUTHENTICATE`"negotiate")`new BasicHeader("TEST"`"testValue")`new BasicHeader("caseInsensitiveHeader"`"caseInsensitiveHeaderValue")};" is 217.,267
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testResponseExcludeHeadersConfig,Magic Number,The method contains a magic number: 2,267
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestAppendHeadersConfig,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,291
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestAppendHeadersConfig,Magic Number,The method contains a magic number: 4,291
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestAppendHeadersConfig,Magic Number,The method contains a magic number: 2,291
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestAppendHeadersConfig,Magic Number,The method contains a magic number: 3,291
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndAppendHeadersConfig,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,319
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndAppendHeadersConfig,Magic Number,The method contains a magic number: 3,319
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndAppendHeadersConfig,Magic Number,The method contains a magic number: 2,319
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndAppendWithDifferentValueHeadersConfig,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,347
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndAppendWithDifferentValueHeadersConfig,Magic Number,The method contains a magic number: 3,347
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndAppendWithDifferentValueHeadersConfig,Magic Number,The method contains a magic number: 2,347
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndAppendWithDifferentValueHeadersConfig,Magic Number,The method contains a magic number: 2,347
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testInvalidRequestAppendHeadersConfig,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,376
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testInvalidRequestAppendHeadersConfig,Magic Number,The method contains a magic number: 2,376
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndInvalidAppendHeadersConfig,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,402
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestExcludeAndInvalidAppendWithDifferentValueHeadersConfig,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,428
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testSetCookieHeaderOrder,Long Statement,The length of the statement "final String SET_COOKIE_VALUE="JSESSIONID=ba760126-414f-406d-baa1-99e14eb47656; zx=yz; SameSite=none; Secure; Path=/; HttpOnly; a=b; c=d";" is 138.,472
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testSetCookieHeaderOrder,Long Statement,The length of the statement "final String EXPECTED_SET_COOKIE_VALUE="JSESSIONID=ba760126-414f-406d-baa1-99e14eb47656; zx=yz; SameSite=none; Path=/; HttpOnly; a=b; c=d";" is 139.,472
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testPreventSetCookieHeaderDirectivesDefault,Long Statement,The length of the statement "final Header[] headers=new Header[]{new BasicHeader(SET_COOKIE`"hadoop.auth=\"u=knox&p=knox/knox.local@knox.local&t=kerberos&e=1604347441986c=\"; Path=/; Domain=knox.local; Expires=Fri` 13-Nov-2020 17:26:18 GMT; Secure; HttpOnly[\\r][\\n]")};" is 242.,494
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testAllowSetCookieHeaderNoSpaces,Long Statement,The length of the statement "final Header[] headers=new Header[]{new BasicHeader(SET_COOKIE`"SESSION=e69d3d08-7452-45cb-90bb-9cdde3fa1342;Path=/;HttpOnly")};" is 128.,544
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testPassthroughSetCookieHeaderDirectivesDefault,Long Statement,The length of the statement "final Header[] headers=new Header[]{new BasicHeader(SET_COOKIE`"hadoop.auth=\"u=knox&p=knox/knox.local@nox.local&t=kerberos&e=1604347441986c=\"; Path=/; Domain=knox.local; Expires=Fri` 13-Nov-2020 17:26:18 GMT; Secure; HttpOnly[\\r][\\n]")};" is 241.,568
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testCorrelationIDXRequestIDHeader,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,601
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testCorrelationIDXRequestIDHeader,Magic Number,The method contains a magic number: 3,601
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestHeaderXRequestID,Long Statement,The length of the statement "EasyMock.expect(inboundRequest.getHeader(EasyMock.capture(capturedArgument))).andAnswer(() -> headers.get(capturedArgument.getValue())).anyTimes();" is 147.,633
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testRequestHeaderXRequestID,Magic Number,The method contains a magic number: 3,633
apache_knox,org.apache.knox.gateway.dispatch,ConfigurableDispatchTest,testXRequestIDHeaderExcludeList,Long Statement,The length of the statement "Header[] headers=new Header[]{new BasicHeader(REQUEST_ID_HEADER_NAME`UUID.randomUUID().toString())`new BasicHeader(WWW_AUTHENTICATE`"negotiate")`new BasicHeader("TEST"`"testValue")};" is 182.,668
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS__C1_FC_IB,Magic Number,The method contains a magic number: 20,66
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB__C1_FC_IB,Magic Number,The method contains a magic number: 20,80
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB__C1_FC_IB,Magic Number,The method contains a magic number: 3,80
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS__C1_FC_OB,Magic Number,The method contains a magic number: 5,94
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB__C1_FC_OB,Magic Number,The method contains a magic number: 5,107
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB__C1_FC_OB,Magic Number,The method contains a magic number: 3,107
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 20,120
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 20,139
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 3,139
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 3,139
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_FC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,158
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,171
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 3,171
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,185
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,207
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 3,207
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 3,207
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_FC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 5,230
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_OB__C1_XC__C2_AC_EE,Magic Number,The method contains a magic number: 5,246
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_FC_OB__C1_XC__C2_AC_EE,Magic Number,The method contains a magic number: 3,246
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB,Magic Number,The method contains a magic number: 20,262
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB,Magic Number,The method contains a magic number: 3,262
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB,Magic Number,The method contains a magic number: 20,279
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB,Magic Number,The method contains a magic number: 3,279
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB,Magic Number,The method contains a magic number: 3,279
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_OB,Magic Number,The method contains a magic number: 5,296
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB,Magic Number,The method contains a magic number: 5,311
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB,Magic Number,The method contains a magic number: 4,311
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 20,327
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 4,327
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 20,349
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 4,349
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 7,349
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,371
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 7,371
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,388
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 7,388
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 2,388
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,404
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 7,404
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,426
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 7,426
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 2,426
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 7,426
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 5,448
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 5,464
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 7,464
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 2,464
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 20,480
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,480
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 4,480
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,480
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 20,505
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,505
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 2,505
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 4,505
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,505
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,505
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 2,505
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 5,529
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 3,529
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testS_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 5,529
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 5,551
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 3,551
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 2,551
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 6,551
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 4,551
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testWriteTo,Magic Number,The method contains a magic number: 5,572
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testIsChunked,Magic Number,The method contains a magic number: 5,605
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testIsChunked,Magic Number,The method contains a magic number: 5,605
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testGetContentLength,Magic Number,The method contains a magic number: 5,623
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testGetContentLength,Magic Number,The method contains a magic number: 5,623
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testGetContentLength,Magic Number,The method contains a magic number: 10L,623
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testGetContentType,Magic Number,The method contains a magic number: 5,641
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testGetContentType,Magic Number,The method contains a magic number: 5,641
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testGetContentEncoding,Magic Number,The method contains a magic number: 5,659
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testGetContentEncoding,Magic Number,The method contains a magic number: 5,659
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testIsStreaming,Long Statement,The length of the statement "streaming=new InputStreamEntity(new ByteArrayInputStream(input.getBytes(StandardCharsets.UTF_8))`10`ContentType.TEXT_PLAIN);" is 124.,677
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 5,677
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 5,677
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 10,677
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 5,677
apache_knox,org.apache.knox.gateway.dispatch,CappedBufferHttpEntityTest,testConsumeContent,Magic Number,The method contains a magic number: 5,699
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistViolation,Magic Number,The method contains a magic number: 400,43
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistNoServiceRoles,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.emptyList()`"^https?://localhost.*$"`serviceRole`"http://www.notonmylist.org:9999"`true);" is 132.,73
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistNoWhiteListForRole_invalid,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`null`serviceRole`"http://www.notonmylist.org:9999"`false);" is 128.,87
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistNoWhiteListForRole_invalid_alt_localhost,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`"127.0.0.1"`null`serviceRole`"http://www.notonmylist.org:9999"`false);" is 140.,102
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistNoWhiteListForRole_invalid_domain,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`"knoxbox.test.org"`null`serviceRole`"http://www.notonmylist.org:9999"`false);" is 147.,117
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistNoWhiteListForRole_encodedurl_valid,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`null`serviceRole`URLEncoder.encode("http://localhost:9999"`StandardCharsets.UTF_8.name())`true);" is 166.,148
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistNoWhiteListForRole_encodedurl_invalid,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`"DEFAULT"`serviceRole`URLEncoder.encode("http://www.notonmylist.org:9999"`StandardCharsets.UTF_8.name())`false);" is 182.,164
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistEmptyWhitelist,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`""`serviceRole`"http://www.notonmylist.org:9999"`false);" is 126.,178
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistCustomWhitelist_invalid,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`"^.*mydomain\\.org.*$;^.*myotherdomain.com.*"`serviceRole`"http://www.notonmylist.org:9999"`false);" is 169.,193
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistCustomWhitelist_valid,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Collections.singletonList(serviceRole)`"^.*mydomain\\.org.*$;^.*myotherdomain.com.*;^.*onmylist\\.org.*$"`serviceRole`"http://www.onmylist.org:9999"`true);" is 186.,208
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,testServiceDispatchWhitelistCustomWhitelistNoServiceRoles,Long Statement,The length of the statement "doTestServiceDispatchWhitelist(Arrays.asList("MYROLE"`"SOMEOTHER_ROLE")`"^.*mydomain\\.org.*$;^.*myotherdomain.com.*"`serviceRole`"http://www.onmylist.org:9999"`true);" is 167.,222
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,doTestServiceDispatchWhitelist,Long Parameter List,The method has 5 parameters. ,233
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,doTestServiceDispatchWhitelist,Long Parameter List,The method has 6 parameters. ,241
apache_knox,org.apache.knox.gateway.dispatch,GatewayDispatchFilterTest,doTestServiceDispatchWhitelist,Long Statement,The length of the statement "Method isDispatchAllowedMethod=GatewayDispatchFilter.class.getDeclaredMethod("isDispatchAllowed"`HttpServletRequest.class);" is 123.,241
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testJiraKnox58,Magic Number,The method contains a magic number: 12,62
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testCallToSecureClusterWithDelegationToken,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(gatewayConfig).anyTimes();" is 121.,109
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testCallToNonSecureClusterWithoutDelegationToken,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(gatewayConfig).anyTimes();" is 121.,127
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testCallToSecureClusterWithoutDelegationToken,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(gatewayConfig).anyTimes();" is 121.,145
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testCallToSecureClusterWithoutDelegationToken,Magic Number,The method contains a magic number: 10,145
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testUsingDefaultBufferSize,Long Statement,The length of the statement "EasyMock.expect(servletContext.getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE)).andReturn(gatewayConfig).anyTimes();" is 121.,164
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testUsingDefaultBufferSize,Magic Number,The method contains a magic number: 16384,164
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testUsingDefaultBufferSize,Magic Number,The method contains a magic number: 16,164
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testUsingDefaultBufferSize,Magic Number,The method contains a magic number: 16384,164
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testUsingDefaultBufferSize,Magic Number,The method contains a magic number: 16,164
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testUsingDefaultBufferSize,Magic Number,The method contains a magic number: 16384,164
apache_knox,org.apache.knox.gateway.dispatch,DefaultDispatchTest,testUsingDefaultBufferSize,Magic Number,The method contains a magic number: 16,164
apache_knox,org.apache.knox.gateway.dispatch,PassAllHeadersNoEncodingDispatchTest,testGetDispatchUrl,Long Statement,The length of the statement "path="https://test-host:42/api/v1/views/TEZ/versions/0.7.0.2.6.2.0-205/instances/TEZ_CLUSTER_INSTANCE/resources/atsproxy/ws/v1/timeline/TEZ_DAG_ID";" is 148.,31
apache_knox,org.apache.knox.gateway.dispatch,PassAllHeadersNoEncodingDispatchTest,testGetDispatchUrl,Long Statement,The length of the statement "assertThat(uri.toASCIIString()`is("https://test-host:42/api/v1/views/TEZ/versions/0.7.0.2.6.2.0-205/instances/TEZ_CLUSTER_INSTANCE/resources/atsproxy/ws/v1/timeline/TEZ_DAG_ID?limit=9007199254740991&primaryFilter=applicationId:%22application_1518808140659_0007%22&_=1519053586839"));" is 283.,31
apache_knox,org.apache.knox.gateway.dispatch,PassAllHeadersNoEncodingDispatchTest,testGetDispatchUrl,Long Statement,The length of the statement "assertThat(uri.toASCIIString()`is("http://test-host:8080/api/v1/clusters/mmolnar-knox2/configurations/service_config_versions?group_id%3E0&fields=*&_=1541527314780"));" is 167.,31
apache_knox,org.apache.knox.gateway.dispatch,URLDecodingDispatchTest,testGetDispatchUrl,Long Statement,The length of the statement "assertThat(uri.toASCIIString()`is("https://localhost:8443/gateway/sandbox/datanode/datanode.html?host=http://localhost:9864"));" is 127.,45
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,testOozieCookieWorkaroundKnox1171,Long Statement,The length of the statement "String rawValue="u=knox&p=knox/host.example.com.com@EXAMPLE.COM&t=kerberos&e=1517900515610&s=HpSXUOhoXR/2wXrsgPz5lSbNuf8=";" is 123.,40
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,testOozieCookieWorkaroundKnox1171,Long Statement,The length of the statement "File krb5LoginConf=createTestKrb5LoginConfigFile("krb5JAASLogin"`getTestKrb5LoginConf("knox/host.example.com.com@EXAMPLE.COM"));" is 128.,40
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,testKnoxCookieInclusionDefaultUserAndPrincipal,Long Statement,The length of the statement "doTestKnoxCookieInclusion("u=knox&p=knox/myhost.example.com@EXAMPLE.COM&t=kerberos&e=1517900515610&s=HpSXUOhoXR/2wXrsgPz5lSbNuf8=");" is 132.,88
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,testKnoxCookieInclusionDefaultUser,Long Statement,The length of the statement "doTestKnoxCookieInclusion("u=knox&p=anotherUser/myhost.example.com@EXAMPLE.COM&t=kerberos&e=1517900515610&s=HpSXUOhoXR/2wXrsgPz5lSbNuf8=");" is 139.,93
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,testKnoxCookieInclusionDefaultPrincipal,Long Statement,The length of the statement "doTestKnoxCookieInclusion("u=anotherUser&p=knox/myhost.example.com@EXAMPLE.COM&t=kerberos&e=1517900515610&s=HpSXUOhoXR/2wXrsgPz5lSbNuf8=");" is 139.,98
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,testKnoxCookieInclusionDefaultUserAndCustomPrincipal,Long Statement,The length of the statement "doTestKnoxCookieInclusion(gatewayConfig`"u=knox&p=" + principal + "&t=kerberos&e=1517900515610&s=HpSXUOhoXR/2wXrsgPz5lSbNuf8=");" is 128.,113
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,createTestKrb5LoginConfigFile,Empty catch clause,The method has an empty catch block.,166
apache_knox,org.apache.knox.gateway.dispatch,HadoopAuthCookieStoreTest,getTestKrb5LoginConf,Long Statement,The length of the statement "return "com.sun.security.jgss.initiate {\n" + "com.sun.security.auth.module.Krb5LoginModule required\n" + "renewTGT=false\n"+ "doNotPrompt=true\n"+ "useKeyTab=true\n"+ "keyTab=\"/etc/security/keytabs/knox.service.keytab\"\n" + (principal != null ? "principal=\"" + principal + "\"\n" : "") + "storeKey=true\n"+ "useTicketCache=false;";" is 335.,187
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS__C1_FC_IB,Magic Number,The method contains a magic number: 20,65
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB__C1_FC_IB,Magic Number,The method contains a magic number: 20,81
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB__C1_FC_IB,Magic Number,The method contains a magic number: 3,81
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS__C1_FC_OB,Magic Number,The method contains a magic number: 5,97
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB__C1_FC_OB,Magic Number,The method contains a magic number: 5,113
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB__C1_FC_OB,Magic Number,The method contains a magic number: 3,113
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 20,129
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 20,148
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 3,148
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_IB__C2_FC_IB,Magic Number,The method contains a magic number: 3,148
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_FC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,167
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,185
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 3,185
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,204
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,226
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 3,226
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 3,226
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_FC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 5,249
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_OB__C1_XC__C2_AC_EE,Magic Number,The method contains a magic number: 5,270
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_FC_OB__C1_XC__C2_AC_EE,Magic Number,The method contains a magic number: 3,270
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB,Magic Number,The method contains a magic number: 20,291
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB,Magic Number,The method contains a magic number: 3,291
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB,Magic Number,The method contains a magic number: 20,309
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB,Magic Number,The method contains a magic number: 3,309
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB,Magic Number,The method contains a magic number: 3,309
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_OB,Magic Number,The method contains a magic number: 5,327
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB,Magic Number,The method contains a magic number: 5,346
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB,Magic Number,The method contains a magic number: 4,346
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 20,365
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 4,365
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 20,388
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 4,388
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_FC,Magic Number,The method contains a magic number: 7,388
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,411
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 7,411
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 5,432
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 7,432
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB__C2_AC__EE,Magic Number,The method contains a magic number: 2,432
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,453
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 7,453
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 20,476
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 7,476
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 2,476
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C1_XC__C2_FC,Magic Number,The method contains a magic number: 7,476
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 5,499
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 7,499
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 5,520
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 7,520
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_OB__C1_XC__C2_AC__EE,Magic Number,The method contains a magic number: 2,520
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 20,541
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,541
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 4,541
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,541
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 20,566
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,566
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 2,566
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 4,566
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,566
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 3,566
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_IB__C2_PC_IB,Magic Number,The method contains a magic number: 2,566
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 5,590
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 3,590
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testS_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 6,590
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 5,614
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 3,614
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 2,614
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 6,614
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 4,614
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 6,614
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testB_C1_PC_IB__C2_PC_OB__C1_AC__EE,Magic Number,The method contains a magic number: 4,614
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testWriteTo,Magic Number,The method contains a magic number: 5,637
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testIsChunked,Magic Number,The method contains a magic number: 5,671
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testIsChunked,Magic Number,The method contains a magic number: 5,671
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testGetContentLength,Magic Number,The method contains a magic number: 5,689
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testGetContentLength,Magic Number,The method contains a magic number: 5,689
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testGetContentLength,Magic Number,The method contains a magic number: 10L,689
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testGetContentType,Magic Number,The method contains a magic number: 5,707
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testGetContentType,Magic Number,The method contains a magic number: 5,707
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testGetContentEncoding,Magic Number,The method contains a magic number: 5,725
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testGetContentEncoding,Magic Number,The method contains a magic number: 5,725
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testIsStreaming,Long Statement,The length of the statement "streaming=new InputStreamEntity(new ByteArrayInputStream(input.getBytes(StandardCharsets.UTF_8))`10`ContentType.TEXT_PLAIN);" is 124.,743
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 5,743
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 5,743
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 10,743
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testIsStreaming,Magic Number,The method contains a magic number: 5,743
apache_knox,org.apache.knox.gateway.dispatch,PartiallyRepeatableHttpEntityTest,testConsumeContent,Magic Number,The method contains a magic number: 5,765
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testCreateHttpClientSSLContextDefaults,Long Statement,The length of the statement "expect(servletContext.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).atLeastOnce();" is 121.,54
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testCreateHttpClientSSLContextDefaults,Magic Number,The method contains a magic number: 32,54
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testCreateHttpClientSSLContextDefaults,Magic Number,The method contains a magic number: 20000,54
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testCreateHttpClientSSLContextDefaults,Magic Number,The method contains a magic number: 20000,54
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testHttpClientPathNormalization,Magic Number,The method contains a magic number: 20000,207
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testHttpClientPathNormalization,Magic Number,The method contains a magic number: 20000,207
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testHttpRetriesValues,Long Statement,The length of the statement "expect(servletContext.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).atLeastOnce();" is 121.,239
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testHttpRetriesValues,Magic Number,The method contains a magic number: 32,239
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testHttpRetriesValues,Magic Number,The method contains a magic number: 20000,239
apache_knox,org.apache.knox.gateway.dispatch,DefaultHttpClientFactoryTest,testHttpRetriesValues,Magic Number,The method contains a magic number: 20000,239
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Complex Conditional,The conditional expression xForwardedContextHeaderValue != null && !xForwardedContextHeaderValue.isEmpty() && !xForwardedContextHeaderValue.contains("nifi-app") is complex.,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Complex Method,Cyclomatic complexity of the method is 8,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Long Identifier,The length of the identifier originalXForwardedContextHeader is 31.,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Long Identifier,The length of the identifier outboundRequestUriPathNoTrailingSlash is 37.,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Long Statement,The length of the statement "outboundRequest=RequestBuilder.copy(outboundRequest).setUri(split[0] + "/" + (split.length == 2 ? "?" + split[1] : "")).build();" is 128.,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Long Statement,The length of the statement "if (xForwardedContextHeaderValue != null && !xForwardedContextHeaderValue.isEmpty() && !xForwardedContextHeaderValue.contains("nifi-app")) {" is 140.,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Long Statement,The length of the statement "LogManager.getLogger(NiFiRequestUtil.class.getName()).error(String.format(Locale.ROOT`"Unable to find index of %s in %s"`outboundRequestUriPathNoTrailingSlash`inboundRequestPathInfo));" is 184.,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Long Statement,The length of the statement "outboundRequest.setHeader(NiFiHeaders.X_PROXIED_ENTITIES_CHAIN`proxiedEntitesChainHeader + String.format(Locale.ROOT`"<%s>"`"anonymous".equalsIgnoreCase(effectivePrincipalName) ? "" : effectivePrincipalName));" is 209.,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiRequestUtil,modifyOutboundRequest,Magic Number,The method contains a magic number: 2,34
apache_knox,org.apache.knox.gateway.dispatch,NiFiResponseUtil,modifyOutboundResponse,Long Statement,The length of the statement "final URI newLocation=new URIBuilder().setScheme(scheme).setHost(host).setPort((StringUtils.isNumeric(port) ? Integer.parseInt(port) : -1)).setPath(baseContextPath + pathInfo + trailingSlash).setParameters(queryParams).build();" is 227.,36
apache_knox,org.apache.knox.gateway.descriptor,GatewayDescriptorTest,testGatewayDescriptorConstruction,Long Statement,The length of the statement "GatewayDescriptor descriptor=GatewayDescriptorFactory.create().addParam().name("cluster-param1-name").value("cluster-param1-value").up().addParam().name("cluster-param2-name").value("cluster-param2-value").up().addResource().pattern("resource1-source").addFilter().role("resource1-filter1-role").impl("resource1-filter1-impl").param().name("resource1-filter1-param1-name").value("resource1-filter1-param1-value").up().param().name("resource1-filter1-param2-name").value("resource1-filter1-param2-value").up().up().addFilter().role("resource1-filter2-role").impl("resource1-filter2-impl").up().up().addResource().pattern("resource2-source").addFilter().param().up().up().up();" is 675.,32
apache_knox,org.apache.knox.gateway.descriptor,GatewayDescriptorTest,testGatewayDescriptorConstruction,Magic Number,The method contains a magic number: 2,32
apache_knox,org.apache.knox.gateway.descriptor,GatewayDescriptorTest,testGatewayDescriptorConstruction,Magic Number,The method contains a magic number: 2,32
apache_knox,org.apache.knox.gateway.descriptor,GatewayDescriptorTest,testGatewayDescriptorConstruction,Magic Number,The method contains a magic number: 2,32
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorRules,configure,Long Statement,The length of the statement "forPattern(GATEWAY + "/" + RESOURCE+ "/"+ FILTER+ "/"+ FILTER_PARAM+ "/"+ FILTER_PARAM_NAME).callMethod("name").usingElementBodyAsArgument();" is 141.,30
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorRules,configure,Long Statement,The length of the statement "forPattern(GATEWAY + "/" + RESOURCE+ "/"+ FILTER+ "/"+ FILTER_PARAM+ "/"+ FILTER_PARAM_VALUE).callMethod("value").usingElementBodyAsArgument();" is 143.,30
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorImporterTest,testXmlGatewayDescriptorLoad,Long Statement,The length of the statement "String xml="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" + "<gateway>\n" + " <resource>\n"+ " <pattern>resource1-source</pattern>\n"+ " <filter>\n"+ " <role>resource1-filter1-role</role>\n"+ " <class>resource1-filter1-impl</class>\n"+ " <param>\n"+ " <name>resource1-filter1-param1-name</name>\n"+ " <value>resource1-filter1-param1-value</value>\n"+ " </param>\n"+ " <param>\n"+ " <name>resource1-filter1-param2-name</name>\n"+ " <value>resource1-filter1-param2-value</value>\n"+ " </param>\n"+ " </filter>\n"+ " <filter>\n"+ " <role>resource1-filter2-role</role>\n"+ " <class>resource1-filter2-impl</class>\n"+ " </filter>\n"+ " </resource>\n"+ " <resource>\n"+ " <pattern>resource2-source</pattern>\n"+ " </resource>\n"+ "</gateway>";" is 756.,49
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorImporterTest,testXmlGatewayDescriptorLoad,Magic Number,The method contains a magic number: 2,49
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorImporterTest,testXmlGatewayDescriptorLoad,Magic Number,The method contains a magic number: 2,49
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorImporterTest,testXmlGatewayDescriptorLoad,Magic Number,The method contains a magic number: 2,49
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorImporterTest,testXmlGatewayDescriptorLoadEmpty,Long Statement,The length of the statement "String xml="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" + "<gateway>\n" + " <resource>\n"+ " <filter>\n"+ " <param>\n"+ " </param>\n"+ " </filter>\n"+ " </resource>\n"+ "</gateway>";" is 203.,119
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorImporterTest,testXmlGatewayDescriptorLoadInvalid,Long Statement,The length of the statement "String xml="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" + "<gateway>\n" + " <resource>\n"+ " <filter>\n"+ " <param>";" is 138.,147
apache_knox,org.apache.knox.gateway.descriptor.xml,XmlGatewayDescriptorExporterTest,testXmlGatewayDescriptorStore,Long Statement,The length of the statement "GatewayDescriptor descriptor=GatewayDescriptorFactory.create().addResource().pattern("resource1-source").addFilter().role("resource1-filter1-role").impl("resource1-filter1-impl").param().name("resource1-filter1-param1-name").value("resource1-filter1-param1-value").up().param().name("resource1-filter1-param2-name").value("resource1-filter1-param2-value").up().up().addFilter().name("resource1-filter2-name").role("resource1-filter2-role").impl("resource1-filter2-impl").up().up();" is 481.,49
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorFactory,setClientService,Long Identifier,The length of the field remoteConfigRegistryClientService is 33.,34
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorFactory,getClientService,Long Identifier,The length of the field remoteConfigRegistryClientService is 33.,38
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorFactory,get,Long Statement,The length of the statement "ServiceLoader<RemoteConfigurationMonitorProvider> providers=ServiceLoader.load(RemoteConfigurationMonitorProvider.class);" is 121.,49
apache_knox,org.apache.knox.gateway.topology.monitor,DefaultRemoteConfigurationMonitorTest,testInitWithoutRequiredConfig,Long Identifier,The length of the identifier remoteConfigurationRegistryClientService is 40.,25
apache_knox,org.apache.knox.gateway.topology.monitor,DefaultRemoteConfigurationMonitorTest,testInitWithoutRequiredConfig,Long Statement,The length of the statement "RemoteConfigurationRegistryClientService remoteConfigurationRegistryClientService=EasyMock.createNiceMock(RemoteConfigurationRegistryClientService.class);" is 154.,25
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,configureAndStartZKCluster,Long Statement,The length of the statement "client=CuratorFrameworkFactory.builder().connectString(zkCluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(100`3)).build();" is 141.,87
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,configureAndStartZKCluster,Magic Number,The method contains a magic number: 100,87
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,configureAndStartZKCluster,Magic Number,The method contains a magic number: 3,87
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,configureAndStartZKCluster,Magic Number,The method contains a magic number: 10,87
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Identifier,The length of the identifier preExistingProviderConfigLocalFile is 34.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "EasyMock.expect(gc.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(configMonitorName)).anyTimes();" is 125.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "final String registryConfig=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString();" is 192.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(preExistingProviderConfig`TEST_PROVIDERS_CONFIG_1.getBytes(StandardCharsets.UTF_8));" is 140.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertFalse("This file should not exist locally prior to monitor starting."`preExistingProviderConfigLocalFile.exists());" is 121.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertTrue("This file should exist locally immediately after monitor starting."`preExistingProviderConfigLocalFile.exists());" is 125.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(pc_one_znode`TEST_PROVIDERS_CONFIG_1.getBytes(StandardCharsets.UTF_8));" is 127.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(getProviderPath("providers-config2.xml")`TEST_PROVIDERS_CONFIG_2.getBytes(StandardCharsets.UTF_8));" is 155.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertTrue(TestUtils.waitUntil(() -> TEST_PROVIDERS_CONFIG_2.equals(FileUtils.readFileToString(pc_two`StandardCharsets.UTF_8))`true`1000));" is 139.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertTrue(TestUtils.waitUntil(() -> TEST_PROVIDERS_CONFIG_1.equals(FileUtils.readFileToString(pc_two`StandardCharsets.UTF_8))`true`1000));" is 139.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(desc_one_znode`TEST_DESCRIPTOR_1.getBytes(StandardCharsets.UTF_8));" is 123.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertTrue(TestUtils.waitUntil(() -> TEST_DESCRIPTOR_1.equals(FileUtils.readFileToString(desc_one`StandardCharsets.UTF_8))`true`1000));" is 135.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(desc_two_znode`TEST_DESCRIPTOR_1.getBytes(StandardCharsets.UTF_8));" is 123.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertTrue(TestUtils.waitUntil(() -> TEST_DESCRIPTOR_1.equals(FileUtils.readFileToString(desc_two`StandardCharsets.UTF_8))`true`1000));" is 135.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertTrue(TestUtils.waitUntil(() -> TEST_DESCRIPTOR_2.equals(FileUtils.readFileToString(desc_two`StandardCharsets.UTF_8))`true`1000));" is 135.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(desc_three_znode`TEST_DESCRIPTOR_1.getBytes(StandardCharsets.UTF_8));" is 125.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Long Statement,The length of the statement "assertTrue(TestUtils.waitUntil(() -> TEST_DESCRIPTOR_1.equals(FileUtils.readFileToString(desc_three`StandardCharsets.UTF_8))`true`1000));" is 137.,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,ZooKeeperConfigurationMonitorTest,testZooKeeperConfigMonitor,Magic Number,The method contains a magic number: 1000,145
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,setupDigestSaslConfig,Long Statement,The length of the statement "try (OutputStream outputStream=Files.newOutputStream(saslConfigFile.toPath());Writer fw=new OutputStreamWriter(outputStream`StandardCharsets.UTF_8)){" is 149.,128
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,setupDigestSaslConfig,Long Statement,The length of the statement "fw.write("Server {\n" + " org.apache.zookeeper.server.auth.DigestLoginModule required\n" + " user_" + username + " =\""+ password+ "\";\n"+ "};\n"+ "Client {\n"+ " org.apache.zookeeper.server.auth.DigestLoginModule required\n"+ " username=\""+ username+ "\"\n"+ " password=\""+ password+ "\";\n"+ "};\n");" is 305.,128
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,configureAndStartZKCluster,Long Statement,The length of the statement "client=CuratorFrameworkFactory.builder().connectString(zkCluster.getConnectString()).retryPolicy(new ExponentialBackoffRetry(100`3)).build();" is 141.,154
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,configureAndStartZKCluster,Long Statement,The length of the statement "List<ACL> acls=Arrays.asList(new ACL(ZooDefs.Perms.ALL`new Id("sasl"`ALT_USERNAME))`new ACL(ZooDefs.Perms.READ`ZooDefs.Ids.ANYONE_ID_UNSAFE));" is 142.,154
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,configureAndStartZKCluster,Magic Number,The method contains a magic number: 100,154
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,configureAndStartZKCluster,Magic Number,The method contains a magic number: 3,154
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,configureAndStartZKCluster,Magic Number,The method contains a magic number: 10,154
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithUnacceptableACL,Long Statement,The length of the statement "EasyMock.expect(gc.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(configMonitorName)).anyTimes();" is 125.,217
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithUnacceptableACL,Long Statement,The length of the statement "final String registryConfig=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString()+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_PRINCIPAL+ "="+ ZK_USERNAME+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_AUTH_TYPE+ "=Digest;"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_CREDENTIAL_ALIAS+ "="+ alias;" is 395.,217
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithUnacceptableACL,Magic Number,The method contains a magic number: 2,217
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithUnacceptableACLAllowUnauthenticatedReads,Long Statement,The length of the statement "EasyMock.expect(gc.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(configMonitorName)).anyTimes();" is 125.,292
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithUnacceptableACLAllowUnauthenticatedReads,Long Statement,The length of the statement "final String registryConfig=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString()+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_PRINCIPAL+ "="+ ZK_USERNAME+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_AUTH_TYPE+ "=Digest;"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_CREDENTIAL_ALIAS+ "="+ alias;" is 395.,292
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithUnacceptableACLAllowUnauthenticatedReads,Magic Number,The method contains a magic number: 2,292
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithAcceptableACL,Long Statement,The length of the statement "EasyMock.expect(gc.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(configMonitorName)).anyTimes();" is 125.,367
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithAcceptableACL,Long Statement,The length of the statement "final String registryConfig=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString()+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_PRINCIPAL+ "="+ ZK_USERNAME+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_AUTH_TYPE+ "=Digest;"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_CREDENTIAL_ALIAS+ "="+ alias;" is 395.,367
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithAcceptableACL,Long Statement,The length of the statement "assertNull("Creation should have been prevented since write access is not granted to the test client."`client.checkExists().forPath("/auth_test/child_node/test1"));" is 164.,367
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLNodesExistWithAcceptableACL,Long Statement,The length of the statement "assertTrue("Creation should have been prevented since write access is not granted to the test client."`client.getChildren().forPath("/auth_test/child_node").isEmpty());" is 168.,367
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "EasyMock.expect(gc.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(configMonitorName)).anyTimes();" is 125.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "final String registryConfig=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkCluster.getConnectString()+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_PRINCIPAL+ "="+ ZK_USERNAME+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_AUTH_TYPE+ "=Digest;"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_CREDENTIAL_ALIAS+ "="+ alias;" is 395.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "assertNull("Creation should have been prevented since write access is not granted to the test client."`client.checkExists().forPath("/auth_test/child_node/test1"));" is 164.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "assertTrue("Creation should have been prevented since write access is not granted to the test client."`client.getChildren().forPath("/auth_test/child_node").isEmpty());" is 168.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(pc_one_znode`TEST_PROVIDERS_CONFIG_1.getBytes(StandardCharsets.UTF_8));" is 127.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(getProviderPath("providers-config2.xml")`TEST_PROVIDERS_CONFIG_2.getBytes(StandardCharsets.UTF_8));" is 155.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(desc_one_znode`TEST_DESCRIPTOR_1.getBytes(StandardCharsets.UTF_8));" is 123.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(desc_two_znode`TEST_DESCRIPTOR_1.getBytes(StandardCharsets.UTF_8));" is 123.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(desc_three_znode`TEST_DESCRIPTOR_1.getBytes(StandardCharsets.UTF_8));" is 125.,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.monitor,RemoteConfigurationMonitorTest,testZooKeeperConfigMonitorSASLCreateNodes,Magic Number,The method contains a magic number: 100,441
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + APPLICATION_TAG+ "/"+ VERSION_TAG).createObject().ofType(Version.class).then().setBeanProperty().then().setNext("setVersion");" is 154.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + APPLICATION_TAG+ "/"+ PARAM_TAG).createObject().ofType(Param.class).then().addRule(paramRule).then().setNext("addParam");" is 149.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ VERSION_TAG).createObject().ofType(Version.class).then().setBeanProperty().then().setNext("setVersion");" is 150.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ PARAM_TAG).createObject().ofType(Param.class).then().addRule(paramRule).then().setNext("addParam");" is 145.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG).createObject().ofType(CustomDispatch.class).then().setNext("addDispatch");" is 134.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG+ "/"+ CONTRIBUTOR_NAME).callMethod("setContributorName").usingElementBodyAsArgument();" is 145.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG+ "/"+ HA_CONTRIBUTOR_NAME).callMethod("setHaContributorName").usingElementBodyAsArgument();" is 150.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG+ "/"+ CLASSNAME).callMethod("setClassName").usingElementBodyAsArgument();" is 132.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG+ "/"+ HA_CLASSNAME).callMethod("setHaClassName").usingElementBodyAsArgument();" is 137.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG+ "/"+ HTTP_CLIENT_FACTORY).callMethod("setHttpClientFactory").usingElementBodyAsArgument();" is 150.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG+ "/"+ USE_TWO_WAY_SSL).callMethod("setUseTwoWaySsl").usingElementBodyAsArgument();" is 141.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + SERVICE_TAG+ "/"+ DISPATCH_TAG+ "/"+ PARAM_TAG).createObject().ofType(DispatchParam.class).then().addRule(dispatchParamRule).then().setNext("addParam");" is 180.,61
apache_knox,org.apache.knox.gateway.topology.xml,KnoxFormatXmlTopologyRules,configure,Long Statement,The length of the statement "forPattern(ROOT_TAG + "/" + PROVIDER_TAG+ "/"+ PARAM_TAG).createObject().ofType(Param.class).then().addRule(paramRule).then().setNext("addParam");" is 146.,61
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInKnoxFormat,Magic Number,The method contains a magic number: 3,57
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInKnoxFormat,Magic Number,The method contains a magic number: 2,57
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInKnoxFormat,Magic Number,The method contains a magic number: 5,57
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInKnoxFormat,Magic Number,The method contains a magic number: 2,57
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInKnoxFormat,Magic Number,The method contains a magic number: 4,57
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseServiceParamsInKnoxFormat,Magic Number,The method contains a magic number: 2,103
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInHadoopFormat,Magic Number,The method contains a magic number: 4,139
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInHadoopFormat,Magic Number,The method contains a magic number: 2,139
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInHadoopFormat,Magic Number,The method contains a magic number: 2,139
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInHadoopFormat,Magic Number,The method contains a magic number: 5,139
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseSimpleTopologyXmlInHadoopFormat,Magic Number,The method contains a magic number: 2,139
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseServiceParamsInAmbariFormat,Magic Number,The method contains a magic number: 2,202
apache_knox,org.apache.knox.gateway.topology.xml,TopologyRulesModuleTest,testParseTopologyWithDispatchParameters,Magic Number,The method contains a magic number: 2,283
apache_knox,org.apache.knox.gateway.topology.builder,PropertyTopologyBuilderTest,testBuildSuccessfulForProviderProperty,Long Statement,The length of the statement "propertyTopologyBuilder.addProperty(new Property("topology.gateway.provider.authentication.ShiroProvider.enabled"`"value"));" is 124.,79
apache_knox,org.apache.knox.gateway.topology.builder,PropertyTopologyBuilderTest,testBuildFailedForWrongProviderProperty,Long Statement,The length of the statement "propertyTopologyBuilder.addProperty(new Property("topology.gateway.provider.authentication.ShiroProvider.miss_prop"`"value"));" is 126.,90
apache_knox,org.apache.knox.gateway.topology.builder,PropertyTopologyBuilderTest,testBuildFailedForWrongProviderParamToken1,Long Statement,The length of the statement "propertyTopologyBuilder.addProperty(new Property("topology.gateway.provider.authentication.ShiroProvider.param"`"value"));" is 122.,97
apache_knox,org.apache.knox.gateway.topology.builder,PropertyTopologyBuilderTest,testBuildFailedForEmptyProviderParamName,Long Statement,The length of the statement "propertyTopologyBuilder.addProperty(new Property("topology.gateway.provider.authentication.ShiroProvider.param."`"value"));" is 123.,104
apache_knox,org.apache.knox.gateway.topology.builder,PropertyTopologyBuilderTest,testBuildFailedForEmptyProviderParamValue,Long Statement,The length of the statement "propertyTopologyBuilder.addProperty(new Property("topology.gateway.provider.authentication.ShiroProvider.param.name1"`""));" is 123.,111
apache_knox,org.apache.knox.gateway.topology.builder.property.interpreter,ServicePropertyInterpreter,interpret,Complex Method,Cyclomatic complexity of the method is 9,40
apache_knox,org.apache.knox.gateway.topology.builder.property.interpreter,ProviderPropertyInterpreter,interpret,Complex Method,Cyclomatic complexity of the method is 9,40
apache_knox,org.apache.knox.gateway.services.factory,HostMappingServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,TokenServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,ServerInfoServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,AbstractServiceFactory,create,Long Parameter List,The method has 5 parameters. ,47
apache_knox,org.apache.knox.gateway.services.factory,AbstractServiceFactory,create,Long Statement,The length of the statement "throw new ServiceLifecycleException("Error while instantiating " + serviceType.getShortName() + " service implementation "+ implementation`e);" is 142.,47
apache_knox,org.apache.knox.gateway.services.factory,AbstractServiceFactory,shouldCreateService,Long Statement,The length of the statement "return implementation == null || isEmptyDefaultImplementation(implementation) || getKnownImplementations().contains(implementation);" is 132.,86
apache_knox,org.apache.knox.gateway.services.factory,AbstractServiceFactory,logServiceUsage,Long Statement,The length of the statement "LOG.usingServiceImplementation(isEmptyDefaultImplementation(implementation) ? "default" : implementation`serviceType.getServiceTypeName());" is 139.,102
apache_knox,org.apache.knox.gateway.services.factory,AbstractServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,108
apache_knox,org.apache.knox.gateway.services.factory,SslServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,KeystoreServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,MetricsServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,AliasServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,40
apache_knox,org.apache.knox.gateway.services.factory,AliasServiceFactory,createService,Long Statement,The length of the statement "service=new ZookeeperRemoteAliasServiceProvider().newInstance(gatewayServices`defaultAliasService`getMasterService(gatewayServices));" is 133.,40
apache_knox,org.apache.knox.gateway.services.factory,AliasServiceFactory,getKnownImplementations,Long Statement,The length of the statement "return unmodifiableList(asList(DefaultAliasService.class.getName()`HashicorpVaultAliasService.class.getName()`RemoteAliasService.class.getName()`ZookeeperRemoteAliasService.class.getName()));" is 191.,70
apache_knox,org.apache.knox.gateway.services.factory,TopologyServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,43
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactory,createService,Long Statement,The length of the statement "logServiceUsage(isEmptyDefaultImplementation(implementation) ? AliasBasedTokenStateService.class.getName() : implementation`serviceType);" is 137.,43
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactory,getKnownImplementations,Long Statement,The length of the statement "return unmodifiableList(asList(DefaultTokenStateService.class.getName()`AliasBasedTokenStateService.class.getName()`JournalBasedTokenStateService.class.getName()`ZookeeperTokenStateService.class.getName()`JDBCTokenStateService.class.getName()));" is 245.,80
apache_knox,org.apache.knox.gateway.services.factory,ServiceRegistryServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,RemoteRegistryClientServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,43
apache_knox,org.apache.knox.gateway.services.factory,RemoteRegistryClientServiceFactory,createService,Long Statement,The length of the statement "final AliasService localAliasService=(AliasService)aliasServiceFactory.create(gatewayServices`ServiceType.ALIAS_SERVICE`gatewayConfig`options`"");" is 146.,43
apache_knox,org.apache.knox.gateway.services.factory,MasterServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,36
apache_knox,org.apache.knox.gateway.services.factory,ClusterConfigurationMonitorServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,CryptoServiceFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,ServiceDefinitionRegistryFactory,createService,Long Parameter List,The method has 5 parameters. ,33
apache_knox,org.apache.knox.gateway.services.factory,KeystoreServiceFactoryTest,shouldReturnDefaultKeystoreService,Long Statement,The length of the statement "final KeystoreService keystoreService=(KeystoreService)serviceFactory.create(gatewayServices`ServiceType.KEYSTORE_SERVICE`gatewayConfig`options);" is 145.,42
apache_knox,org.apache.knox.gateway.services.factory,AliasServiceFactoryTest,shouldReturnDefaultAliasService,Long Statement,The length of the statement "AliasService aliasService=(AliasService)serviceFactory.create(gatewayServices`ServiceType.ALIAS_SERVICE`gatewayConfig`options`DefaultAliasService.class.getName());" is 163.,46
apache_knox,org.apache.knox.gateway.services.factory,AliasServiceFactoryTest,shouldReturnHashicorpVaultAliasService,Long Statement,The length of the statement "assertTrue(serviceFactory.create(gatewayServices`ALIAS_SERVICE`gatewayConfig`options`HashicorpVaultAliasService.class.getName()) instanceof HashicorpVaultAliasService);" is 168.,59
apache_knox,org.apache.knox.gateway.services.factory,AliasServiceFactoryTest,shouldReturnRemoteAliasService,Long Statement,The length of the statement "assertTrue(serviceFactory.create(gatewayServices`ALIAS_SERVICE`gatewayConfig`options`RemoteAliasService.class.getName()) instanceof RemoteAliasService);" is 152.,64
apache_knox,org.apache.knox.gateway.services.factory,AliasServiceFactoryTest,shouldReturnZookeeperAliasService,Long Statement,The length of the statement "assertTrue(serviceFactory.create(gatewayServices`ALIAS_SERVICE`gatewayConfig`options`ZookeeperRemoteAliasService.class.getName()) instanceof ZookeeperRemoteAliasService);" is 170.,69
apache_knox,org.apache.knox.gateway.services.factory,MetricsServiceFactoryTest,shouldReturnDefaultMetricsService,Long Statement,The length of the statement "final MetricsService metricsService=(MetricsService)serviceFactory.create(gatewayServices`ServiceType.METRICS_SERVICE`gatewayConfig`options);" is 141.,42
apache_knox,org.apache.knox.gateway.services.factory,CryptoServiceFactoryTest,shouldReturnDefaultCryptoService,Long Statement,The length of the statement "final CryptoService cryptoService=(CryptoService)serviceFactory.create(gatewayServices`ServiceType.CRYPTO_SERVICE`gatewayConfig`options);" is 137.,41
apache_knox,org.apache.knox.gateway.services.factory,ClusterConfigurationMonitorServiceFactoryTest,shouldReturnDefaultClusterConfigurationMonitorService,Long Identifier,The length of the identifier clusterConfigurationMonitorService is 34.,42
apache_knox,org.apache.knox.gateway.services.factory,ClusterConfigurationMonitorServiceFactoryTest,shouldReturnDefaultClusterConfigurationMonitorService,Long Statement,The length of the statement "final ClusterConfigurationMonitorService clusterConfigurationMonitorService=(ClusterConfigurationMonitorService)serviceFactory.create(gatewayServices`ServiceType.CLUSTER_CONFIGURATION_MONITOR_SERVICE`gatewayConfig`options);" is 223.,42
apache_knox,org.apache.knox.gateway.services.factory,TokenServiceFactoryTest,shouldReturnDefaultTokenService,Long Statement,The length of the statement "final DefaultTokenAuthorityService keystoreService=(DefaultTokenAuthorityService)serviceFactory.create(gatewayServices`ServiceType.TOKEN_SERVICE`gatewayConfig`options);" is 168.,41
apache_knox,org.apache.knox.gateway.services.factory,ServerInfoServiceFactoryTest,shouldReturnDefaultServerInfoService,Long Statement,The length of the statement "final ServerInfoService serverInfoService=(ServerInfoService)serviceFactory.create(gatewayServices`ServiceType.SERVER_INFO_SERVICE`gatewayConfig`options);" is 154.,42
apache_knox,org.apache.knox.gateway.services.factory,ServiceFactoryTest,initConfig,Long Statement,The length of the statement "final RemoteConfigurationRegistryClientService registryClientService=EasyMock.createNiceMock(RemoteConfigurationRegistryClientService.class);" is 141.,58
apache_knox,org.apache.knox.gateway.services.factory,ServiceFactoryTest,initConfig,Long Statement,The length of the statement "expect(gatewayServices.getService(ServiceType.REMOTE_REGISTRY_CLIENT_SERVICE)).andReturn(registryClientService).anyTimes();" is 123.,58
apache_knox,org.apache.knox.gateway.services.factory,ServiceFactoryTest,shouldFailWithClassNotFoundExceptionForUnknownImplementationWithClassNotOnClasspath,Long Statement,The length of the statement "expectedException.expectMessage(String.format(Locale.ROOT`"Error while instantiating %s service implementation %s"`serviceType.getShortName()`implementation));" is 159.,87
apache_knox,org.apache.knox.gateway.services.factory,ServiceFactoryTest,shouldReturnCustomImplementation,Long Statement,The length of the statement "final Service service=serviceFactory.create(gatewayServices`matchingServiceType`null`null`"org.apache.knox.gateway.services.TestService");" is 138.,96
apache_knox,org.apache.knox.gateway.services.factory,ServiceDefinitionRegistryFactoryTest,shouldReturnDefaultServiceDefinitionRegistry,Long Statement,The length of the statement "final ServiceDefinitionRegistry serviceDefinitionRegistry=(ServiceDefinitionRegistry)serviceFactory.create(gatewayServices`SERVICE_DEFINITION_REGISTRY`gatewayConfig`options);" is 174.,43
apache_knox,org.apache.knox.gateway.services.factory,HostMappingServiceFactoryTest,shouldReturnDefaultHostMapperService,Long Statement,The length of the statement "final HostMapperService hostMapperService=(HostMapperService)serviceFactory.create(gatewayServices`ServiceType.HOST_MAPPING_SERVICE`gatewayConfig`options);" is 155.,42
apache_knox,org.apache.knox.gateway.services.factory,SslServiceFactoryTest,shouldReturnJettySslService,Long Statement,The length of the statement "final SSLService keystoreService=(SSLService)serviceFactory.create(gatewayServices`ServiceType.SSL_SERVICE`gatewayConfig`options);" is 130.,42
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactoryTest,shouldReturnDefaultTokenStateService,Long Statement,The length of the statement "TokenStateService tokenStateService=(TokenStateService)serviceFactory.create(gatewayServices`ServiceType.TOKEN_STATE_SERVICE`gatewayConfig`options`DefaultTokenStateService.class.getName());" is 189.,45
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactoryTest,shouldReturnAliasBasedTokenStateServiceByDefault,Long Statement,The length of the statement "TokenStateService tokenStateService=(TokenStateService)serviceFactory.create(gatewayServices`ServiceType.TOKEN_STATE_SERVICE`gatewayConfig`options`"");" is 151.,52
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactoryTest,shouldReturnAliasBasedTokenStateService,Long Statement,The length of the statement "final TokenStateService tokenStateService=(TokenStateService)serviceFactory.create(gatewayServices`ServiceType.TOKEN_STATE_SERVICE`gatewayConfig`options`AliasBasedTokenStateService.class.getName());" is 198.,59
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactoryTest,shouldReturnJournalTokenStateService,Long Statement,The length of the statement "assertTrue(serviceFactory.create(gatewayServices`ServiceType.TOKEN_STATE_SERVICE`gatewayConfig`options`JournalBasedTokenStateService.class.getName()) instanceof JournalBasedTokenStateService);" is 192.,67
apache_knox,org.apache.knox.gateway.services.factory,TokenStateServiceFactoryTest,shouldReturnZookeeperTokenStateService,Long Statement,The length of the statement "assertTrue(serviceFactory.create(gatewayServices`ServiceType.TOKEN_STATE_SERVICE`gatewayConfig`options`ZookeeperTokenStateService.class.getName()) instanceof ZookeeperTokenStateService);" is 186.,73
apache_knox,org.apache.knox.gateway.services.factory,TopologyServiceFactoryTest,shouldReturnDefaultTopologyService,Long Statement,The length of the statement "TopologyService topologyService=(TopologyService)serviceFactory.create(gatewayServices`ServiceType.TOPOLOGY_SERVICE`gatewayConfig`null);" is 136.,42
apache_knox,org.apache.knox.gateway.services.factory,MasterServiceFactoryTest,shouldReturnDefaultMasterService,Long Statement,The length of the statement "MasterService masterService=(MasterService)serviceFactory.create(gatewayServices`ServiceType.MASTER_SERVICE`null`null`DefaultMasterService.class.getName());" is 156.,43
apache_knox,org.apache.knox.gateway.services.factory,MasterServiceFactoryTest,shouldReturnCliMasterService,Long Statement,The length of the statement "MasterService masterService=(MasterService)serviceFactory.create(gatewayServices`ServiceType.MASTER_SERVICE`null`null`CLIMasterService.class.getName());" is 152.,52
apache_knox,org.apache.knox.gateway.services.topology.monitor,SharedProviderConfigMonitor,getReferencingDescriptors,Long Statement,The length of the statement "for ( String reference : descriptorsMonitor.getReferencingDescriptors(FilenameUtils.normalize(sharedProviderConfig.getAbsolutePath()))) {" is 137.,61
apache_knox,org.apache.knox.gateway.services.topology.monitor,DescriptorsMonitor,onFileChange,Long Statement,The length of the statement "Map<String`File> result=SimpleDescriptorHandler.handle(gatewayConfig`file`topologiesDir`aliasService`GatewayServer.getGatewayServices());" is 137.,93
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultClusterConfigurationMonitorService,init,Long Statement,The length of the statement "ServiceLoader<ClusterConfigurationMonitorProvider> providers=ServiceLoader.load(ClusterConfigurationMonitorProvider.class);" is 123.,37
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,loadTopology,Magic Number,The method contains a magic number: 250,130
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,loadTopology,Magic Number,The method contains a magic number: 50,130
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,redeployTopology,Long Statement,The length of the statement "updated=updated.replace(TOPOLOGY_CLOSING_XML_ELEMENT`String.format(Locale.getDefault()`REDEPLOY_TIME_TEMPLATE`System.currentTimeMillis()));" is 139.,170
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,initListener,Long Parameter List,The method has 5 parameters. ,258
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,initListener,Magic Number,The method contains a magic number: 5000L,265
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,deleteProviderConfiguration,Complex Conditional,The conditional expression force || (providerConfig == null || !hasReferences) is complex.,449
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,onServiceDefinitionChange,Long Statement,The length of the statement "getTopologies().stream().filter(topology -> topology.getServices().stream().anyMatch(service -> isRelevantService(service`role`name`version))).forEach(topology -> {" is 164.,530
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,isRelevantService,Long Statement,The length of the statement "return service.getRole().equalsIgnoreCase(role) && (service.getName() == null || service.getName().equalsIgnoreCase(name) && (service.getVersion() == null || service.getVersion().equals(new Version(version))));" is 210.,538
apache_knox,org.apache.knox.gateway.services.topology.impl,DefaultTopologyService,accept,Long Identifier,The length of the field SUPPORTED_TOPOLOGY_FILE_EXTENSIONS is 34.,584
apache_knox,org.apache.knox.gateway.services,CLIGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.MASTER_SERVICE`gatewayServiceFactory.create(this`ServiceType.MASTER_SERVICE`config`options`CLIMasterService.class.getName()));" is 149.,38
apache_knox,org.apache.knox.gateway.services,CLIGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.REMOTE_REGISTRY_CLIENT_SERVICE`gatewayServiceFactory.create(this`ServiceType.REMOTE_REGISTRY_CLIENT_SERVICE`config`options));" is 148.,38
apache_knox,org.apache.knox.gateway.services,CLIGatewayServices,contributeFilter,Long Parameter List,The method has 5 parameters. ,66
apache_knox,org.apache.knox.gateway.services,GatewayServiceFactory,create,Long Parameter List,The method has 5 parameters. ,36
apache_knox,org.apache.knox.gateway.services,GatewayServiceFactory,create,Long Statement,The length of the statement "service=implementation == null ? serviceFactory.create(gatewayServices`serviceType`gatewayConfig`options) : serviceFactory.create(gatewayServices`serviceType`gatewayConfig`options`implementation);" is 196.,36
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.REMOTE_REGISTRY_CLIENT_SERVICE`gatewayServiceFactory.create(this`ServiceType.REMOTE_REGISTRY_CLIENT_SERVICE`config`options));" is 148.,41
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.TOKEN_STATE_SERVICE`gatewayServiceFactory.create(this`ServiceType.TOKEN_STATE_SERVICE`config`options));" is 126.,41
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.SERVICE_REGISTRY_SERVICE`gatewayServiceFactory.create(this`ServiceType.SERVICE_REGISTRY_SERVICE`config`options));" is 136.,41
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.HOST_MAPPING_SERVICE`gatewayServiceFactory.create(this`ServiceType.HOST_MAPPING_SERVICE`config`options));" is 128.,41
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.SERVER_INFO_SERVICE`gatewayServiceFactory.create(this`ServiceType.SERVER_INFO_SERVICE`config`options));" is 126.,41
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.CLUSTER_CONFIGURATION_MONITOR_SERVICE`gatewayServiceFactory.create(this`ServiceType.CLUSTER_CONFIGURATION_MONITOR_SERVICE`config`options));" is 162.,41
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,init,Long Statement,The length of the statement "addService(ServiceType.SERVICE_DEFINITION_REGISTRY`gatewayServiceFactory.create(this`ServiceType.SERVICE_DEFINITION_REGISTRY`config`options));" is 142.,41
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,initializeContribution,Long Statement,The length of the statement "throw new RuntimeException("Credential store was found but was unable to be loaded - the provided (or persisted) master secret may not match the password for the credential store."`e);" is 184.,83
apache_knox,org.apache.knox.gateway.services,DefaultGatewayServices,contributeFilter,Long Parameter List,The method has 5 parameters. ,105
apache_knox,org.apache.knox.gateway.services,AbstractGatewayServicesTest,testAddStartAndStop,Long Statement,The length of the statement "AbstractGatewayServices gatewayServices=createMockBuilder(AbstractGatewayServices.class).withConstructor("role"`"name").createMock();" is 133.,41
apache_knox,org.apache.knox.gateway.services,AbstractGatewayServicesTest,testAddStartAndStop,Long Statement,The length of the statement "ServiceType[] orderedServiceTypes={ServiceType.MASTER_SERVICE`ServiceType.KEYSTORE_SERVICE`ServiceType.ALIAS_SERVICE`ServiceType.SSL_SERVICE`ServiceType.TOKEN_STATE_SERVICE`ServiceType.TOKEN_SERVICE`ServiceType.SERVER_INFO_SERVICE`ServiceType.REMOTE_REGISTRY_CLIENT_SERVICE`ServiceType.CLUSTER_CONFIGURATION_MONITOR_SERVICE`ServiceType.TOPOLOGY_SERVICE`ServiceType.METRICS_SERVICE`ServiceType.CRYPTO_SERVICE`ServiceType.HOST_MAPPING_SERVICE`ServiceType.SERVICE_DEFINITION_REGISTRY`ServiceType.SERVICE_REGISTRY_SERVICE};" is 519.,41
apache_knox,org.apache.knox.gateway.services,AbstractGatewayServicesTest,testGetRoleAndGetName,Long Statement,The length of the statement "AbstractGatewayServices gatewayServices=createMockBuilder(AbstractGatewayServices.class).withConstructor("role"`"name").createMock();" is 133.,92
apache_knox,org.apache.knox.gateway.services,AbstractGatewayServicesTest,testGetServiceAndGetServiceTypes,Long Statement,The length of the statement "AbstractGatewayServices gatewayServices=createMockBuilder(AbstractGatewayServices.class).withConstructor("role"`"name").createMock();" is 133.,102
apache_knox,org.apache.knox.gateway.services,ServiceFactory,create,Long Parameter List,The method has 5 parameters. ,28
apache_knox,org.apache.knox.gateway.services.metrics.impl.reporters,GraphiteMetricsReporter,start,Long Statement,The length of the statement "reporter=GraphiteReporter.forRegistry(registry).convertRatesTo(TimeUnit.SECONDS).convertDurationsTo(TimeUnit.MILLISECONDS).filter(MetricFilter.ALL).build(graphite);" is 164.,49
apache_knox,org.apache.knox.gateway.services.metrics.impl,DefaultMetricsService,loadInstrumentationProviders,Long Statement,The length of the statement "ServiceLoader<InstrumentationProviderDescriptor> descriptors=ServiceLoader.load(InstrumentationProviderDescriptor.class);" is 121.,80
apache_knox,org.apache.knox.gateway.services.metrics.impl,DefaultMetricsService,registerJvmMetricSets,Magic Number,The method contains a magic number: 5,99
apache_knox,org.apache.knox.gateway.services.metrics.impl,DefaultMetricsServiceTest,instrumentationProvidersLoading,Magic Number,The method contains a magic number: 2,60
apache_knox,org.apache.knox.gateway.services.metrics.impl,DefaultMetricsServiceTest,reportersLoadingDisabled,Magic Number,The method contains a magic number: 2,72
apache_knox,org.apache.knox.gateway.services.metrics.impl.instr,InstrHttpClientBuilderProvider,getInstrumented,Long Statement,The length of the statement "return HttpClientBuilder.create().setRequestExecutor(new InstrumentedHttpRequestExecutor(registry`TOPOLOGY_URL_AND_METHOD));" is 124.,38
apache_knox,org.apache.knox.gateway.services.metrics.impl.instr,InstrumentedGatewayFilter,addFilter,Long Parameter List,The method has 5 parameters. ,56
apache_knox,org.apache.knox.gateway.services.metrics.impl.instr,InstrumentedGatewayFilter,addFilter,Long Parameter List,The method has 5 parameters. ,61
apache_knox,org.apache.knox.gateway.services.metrics.impl.instr,InstrGatewayFilterProvider,getInstrumented,Long Statement,The length of the statement "return new InstrumentedGatewayFilter(gatewayFilter`(MetricRegistry)metricsContext.getProperty(DefaultMetricsService.METRICS_REGISTRY));" is 135.,34
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,ZookeeperRemoteAliasService,Long Identifier,The length of the parameter remoteConfigurationRegistryClientService is 40.,134
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,ZookeeperRemoteAliasService,Long Identifier,The length of the field remoteConfigurationRegistryClientService is 40.,134
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,registerRemoteTokenStateChangeListener,Long Identifier,The length of the field remoteTokenStateChangeListeners is 31.,140
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,buildAliasEntryName,Magic Number,The method contains a magic number: 2,144
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,buildAliasEntryName,Magic Number,The method contains a magic number: 2,144
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,ensureEntry,Long Statement,The length of the statement "if (ZooKeeperClientService.AUTH_TYPE_KERBEROS.equalsIgnoreCase(remoteClient.authenticationType()) && !remoteClient.isBackwardsCompatible()) {" is 141.,170
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,checkPathsExist,Long Identifier,The length of the field PATH_KNOX_ALIAS_STORE_TOPOLOGY is 30.,206
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,addAliasForCluster,Long Statement,The length of the statement "throw new IllegalStateException(String.format(Locale.ROOT`"Failed to store alias %s for cluster %s in remote registry"`alias`clusterName));" is 139.,242
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,removeAliasForCluster,Long Statement,The length of the statement "throw new IllegalStateException(String.format(Locale.ROOT`"Failed to delete alias %s for cluster %s in remote registry"`alias`clusterName));" is 140.,273
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,getPasswordFromAliasForCluster,Long Statement,The length of the statement "char[] password=shouldUseLocalAliasService ? localAliasService.getPasswordFromAliasForCluster(clusterName`alias`generate) : null;" is 129.,301
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,generateAliasForCluster,Magic Number,The method contains a magic number: 16,331
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,init,Long Identifier,The length of the field remoteConfigurationRegistryClientService is 40.,373
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,init,Long Identifier,The length of the field PATH_KNOX_ALIAS_STORE_TOPOLOGY is 30.,373
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,init,Long Identifier,The length of the field OPTION_NAME_SHOULD_USE_LOCAL_ALIAS is 34.,373
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,init,Long Identifier,The length of the field OPTION_NAME_SHOULD_CREATE_TOKENS_SUB_NODE is 41.,373
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,init,Long Statement,The length of the statement "this.shouldCreateTokensSubNode=Boolean.parseBoolean(options.getOrDefault(OPTION_NAME_SHOULD_CREATE_TOKENS_SUB_NODE`"false"));" is 125.,373
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,stop,Long Identifier,The length of the field PATH_KNOX_ALIAS_STORE_TOPOLOGY is 30.,415
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,encrypt,Long Statement,The length of the statement "return Base64.encodeBase64String((Base64.encodeBase64String(result.salt) + "::" + Base64.encodeBase64String(result.iv)+ "::"+ Base64.encodeBase64String(result.cipher)).getBytes(StandardCharsets.UTF_8));" is 202.,426
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,decrypt,Long Statement,The length of the statement "return new String(encryptor.decrypt(Base64.decodeBase64(parts[0])`Base64.decodeBase64(parts[1])`Base64.decodeBase64(parts[2]))`StandardCharsets.UTF_8);" is 151.,442
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,decrypt,Magic Number,The method contains a magic number: 3,442
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,decrypt,Magic Number,The method contains a magic number: 2,442
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasService,ensureEntries,Long Identifier,The length of the field PATH_KNOX_ALIAS_STORE_TOPOLOGY is 30.,460
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceProvider,newInstance,Long Statement,The length of the statement "final RemoteConfigurationRegistryClientService registryClientService=getRemoteConfigRegistryClientService(gatewayServices);" is 123.,44
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasService,generateAliasForCluster,Magic Number,The method contains a magic number: 16,183
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLService,init,Long Identifier,The length of the field EPHEMERAL_DH_KEY_SIZE_PROPERTY is 30.,57
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLService,init,Long Statement,The length of the statement "throw new ServiceLifecycleException("Keystore was not loaded properly - the provided password may not match the password for the keystore."`e);" is 143.,57
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLService,init,Long Statement,The length of the statement "throw new ServiceLifecycleException("The identity keystore was not loaded properly - the provided password may not match the password for the keystore."`e);" is 156.,57
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLService,logAndValidateCertificate,Long Statement,The length of the statement "throw new ServiceLifecycleException("Public certificate for the gateway is not of the expected type of . Something is wrong with the gateway keystore.");" is 153.,99
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLService,logAndValidateCertificate,Long Statement,The length of the statement "throw new ServiceLifecycleException("Public certificate for the gateway cannot be found with the alias " + identityKeyAlias + ". Please check the identity certificate alias.");" is 176.,99
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLService,buildSslContextFactory,Complex Method,Cyclomatic complexity of the method is 10,133
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultCryptoService,decryptForCluster,Long Parameter List,The method has 5 parameters. ,109
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultCryptoService,sign,Long Statement,The length of the statement "catch ( NoSuchAlgorithmException|AliasServiceException|KeystoreServiceException|SignatureException|InvalidKeyException e) {" is 123.,147
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,init,Long Statement,The length of the statement "this.cache=Caffeine.newBuilder().expireAfterAccess(config.getKeystoreCacheEntryTimeToLiveInMinutes()`TimeUnit.MINUTES).maximumSize(config.getKeystoreCacheSizeLimit()).build();" is 175.,98
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,createKeystoreForGateway,Long Statement,The length of the statement "createKeyStore(Paths.get(config.getIdentityKeystorePath())`config.getIdentityKeystoreType()`getKeyStorePassword(config.getIdentityKeystorePasswordAlias()));" is 156.,131
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,getKeystoreForGateway,Long Statement,The length of the statement "return getKeystore(Paths.get(config.getIdentityKeystorePath())`config.getIdentityKeystoreType()`config.getIdentityKeystorePasswordAlias()`true);" is 144.,137
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,getTruststoreForHttpClient,Long Statement,The length of the statement "return getKeystore(Paths.get(trustStorePath)`config.getHttpClientTruststoreType()`config.getHttpClientTruststorePasswordAlias()`true);" is 134.,142
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,addCertForGateway,Long Statement,The length of the statement "writeKeyStoreToFile(privateKS`Paths.get(config.getIdentityKeystorePath())`getKeyStorePassword(config.getIdentityKeystorePasswordAlias()));" is 138.,185
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,addCertForGateway,Magic Number,The method contains a magic number: 2048,185
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,addCertForGateway,Magic Number,The method contains a magic number: 365,185
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,addCertForGateway,Magic Number,The method contains a magic number: 365,185
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,createCredentialStoreForCluster,Long Statement,The length of the statement "createKeyStore(keyStoreDirPath.resolve(clusterName + this.credentialsSuffix)`this.credentialStoreType`masterService.getMasterSecret());" is 135.,225
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,checkExistingCredentialStore,Long Identifier,The length of the identifier existingClusterCredentialStoreFiles is 35.,231
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,checkExistingCredentialStore,Long Statement,The length of the statement "final File[] existingClusterCredentialStoreFiles=keyStoreDirPath.toFile().listFiles((FileFilter)new PrefixFileFilter(clusterName + CREDENTIALS_SUFFIX));" is 152.,231
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,isKeystoreForGatewayAvailable,Long Statement,The length of the statement "return isKeyStoreAvailable(keyStoreFilePath`config.getIdentityKeystoreType()`getKeyStorePassword(config.getIdentityKeystorePasswordAlias()));" is 141.,253
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,isKeyStoreAvailable,Complex Conditional,The conditional expression Files.exists(keyStoreFilePath) && Files.isRegularFile(keyStoreFilePath) && Files.isReadable(keyStoreFilePath) is complex.,493
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreService,writeKeyStoreToFile,Long Statement,The length of the statement "try (FileChannel fileChannel=FileChannel.open(path`StandardOpenOption.WRITE`StandardOpenOption.CREATE`StandardOpenOption.TRUNCATE_EXISTING)){" is 141.,566
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultAliasService,generateAliasForCluster,Magic Number,The method contains a magic number: 16,142
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,setupSuite,Long Statement,The length of the statement "EasyMock.expect(gc.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(configMonitorName)).anyTimes();" is 125.,63
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,setupSuite,Long Statement,The length of the statement "final String registryConfig=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkNodes.getConnectString();" is 190.,63
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,setupSuite,Long Statement,The length of the statement "EasyMock.expect(gc.getGatewayKeystoreDir()).andReturn(Paths.get(baseFolder.toString()`"data"`"keystores").toString()).anyTimes();" is 129.,63
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testAliasForCluster,Long Identifier,The length of the identifier testAutoGeneratedpasswordAlias is 30.,125
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testAliasForCluster,Long Statement,The length of the statement "Assert.assertTrue("Expected alias '" + expectedAlias + "' not found "`aliases.contains(expectedAlias.toLowerCase(Locale.ROOT)));" is 128.,125
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testAliasForCluster,Long Statement,The length of the statement "Assert.assertFalse("Expected alias '" + expectedAliasDev + "' to be removed but found."`aliasesDev.contains(expectedAliasDev));" is 127.,125
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testAliasForCluster,Long Statement,The length of the statement "Assert.assertTrue("Expected alias '" + expectedAlias + "' not found "`aliases.contains(expectedAlias.toLowerCase(Locale.ROOT)));" is 128.,125
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testAliasForCluster,Long Statement,The length of the statement "final char[] autoGeneratedPassword=zkAlias.getPasswordFromAliasForCluster(expectedClusterName`testAutoGeneratedpasswordAlias`true);" is 131.,125
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testAliasForCluster,Magic Number,The method contains a magic number: 2,125
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testRemoveAliasesForCluster,Magic Number,The method contains a magic number: 5,270
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testRemoveAliasesForCluster,Magic Number,The method contains a magic number: 3,270
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testRemoveAliasesForCluster,Magic Number,The method contains a magic number: 3,270
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testPerformance,Magic Number,The method contains a magic number: 11,346
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasServiceTest,testPerformance,Magic Number,The method contains a magic number: 200,346
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Long Identifier,The length of the field preferRemoteAliasEncryptedPassword is 34.,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Long Statement,The length of the statement "client=CuratorFrameworkFactory.builder().connectString(zkNodes.getConnectString()).retryPolicy(new ExponentialBackoffRetry(100`3)).build();" is 139.,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Long Statement,The length of the statement "client.create().creatingParentsIfNeeded().withMode(CreateMode.PERSISTENT).withACL(acls).forPath(ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR + expectedClusterName);" is 223.,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Long Statement,The length of the statement "assertNotNull("Failed to create node:" + ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR+ expectedClusterName`client.checkExists().forPath(ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR + expectedClusterName));" is 323.,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Long Statement,The length of the statement "client.create().creatingParentsIfNeeded().withMode(CreateMode.PERSISTENT).withACL(acls).forPath(ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR + expectedClusterNameDev);" is 226.,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Long Statement,The length of the statement "assertNotNull("Failed to create node:" + ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR+ expectedClusterNameDev`client.checkExists().forPath(ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR + expectedClusterNameDev));" is 329.,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR + expectedClusterName+ ZookeeperRemoteAliasService.PATH_SEPARATOR+ preferRemoteAlias`preferRemoteAliasEncryptedPassword.getBytes(StandardCharsets.UTF_8));" is 314.,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Magic Number,The method contains a magic number: 100,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Magic Number,The method contains a magic number: 3,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,setupSuite,Magic Number,The method contains a magic number: 10,70
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,testListener,Long Identifier,The length of the field preferRemoteAliasClearPassword is 30.,148
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,testListener,Long Statement,The length of the statement "EasyMock.expect(gc.getRemoteRegistryConfigurationNames()).andReturn(Collections.singletonList(configMonitorName)).anyTimes();" is 125.,148
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,testListener,Long Statement,The length of the statement "final String registryConfig=GatewayConfig.REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ GatewayConfig.REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkNodes.getConnectString();" is 190.,148
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,testListener,Long Statement,The length of the statement "EasyMock.expect(defaultAlias.getPasswordFromAliasForCluster(expectedClusterName`preferRemoteAlias)).andReturn(preferRemoteAliasClearPassword.toCharArray()).anyTimes();" is 167.,148
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,testListener,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR + expectedClusterName+ ZookeeperRemoteAliasService.PATH_SEPARATOR+ expectedAlias`zkAlias.encrypt(expectedPassword).getBytes(StandardCharsets.UTF_8));" is 309.,148
apache_knox,org.apache.knox.gateway.services.security.impl,ZookeeperRemoteAliasMonitorTest,testListener,Long Statement,The length of the statement "client.create().withMode(CreateMode.PERSISTENT).forPath(ZookeeperRemoteAliasService.PATH_KNOX_ALIAS_STORE_TOPOLOGY + ZookeeperRemoteAliasService.PATH_SEPARATOR + expectedClusterNameDev+ ZookeeperRemoteAliasService.PATH_SEPARATOR+ expectedAliasDev`zkAlias.encrypt(expectedPasswordDev).getBytes(StandardCharsets.UTF_8));" is 318.,148
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testGetTruststoreForHttpClientCustomTrustStore,Long Statement,The length of the statement "DefaultKeystoreService keystoreService=createMockBuilder(DefaultKeystoreService.class).addMockedMethod("loadKeyStore"`Path.class`String.class`char[].class).addMockedMethod("getCredentialForCluster"`String.class`String.class).createMock();" is 238.,101
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testGetTruststoreForHttpClientCustomTrustStore,Long Statement,The length of the statement "expect(keystoreService.loadKeyStore(eq(truststoreFile)`eq(truststoreType)`eq(truststorePassword))).andReturn(keystore).once();" is 126.,101
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testGetTruststoreForHttpClientCustomTrustStore,Long Statement,The length of the statement "expect(keystoreService.getCredentialForCluster(eq(AliasService.NO_CLUSTER_NAME)`eq(truststorePasswordAlias))).andReturn(truststorePassword).once();" is 147.,101
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testGetTruststoreForHttpClientMissingCustomTrustStore,Long Statement,The length of the statement "DefaultKeystoreService keystoreService=createMockBuilder(DefaultKeystoreService.class).addMockedMethod("getCredentialForCluster"`String.class`String.class).createMock();" is 169.,137
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testGetTruststoreForHttpClientMissingCustomTrustStore,Long Statement,The length of the statement "expect(keystoreService.getCredentialForCluster(eq(AliasService.NO_CLUSTER_NAME)`eq(truststorePasswordAlias))).andReturn(truststorePassword).once();" is 147.,137
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testGetTruststoreForHttpClientCustomTrustStoreMissingPasswordAlias,Long Statement,The length of the statement "DefaultKeystoreService keystoreService=createMockBuilder(DefaultKeystoreService.class).addMockedMethod("loadKeyStore"`Path.class`String.class`char[].class).addMockedMethod("getCredentialForCluster"`String.class`String.class).withConstructor().createMock();" is 256.,166
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testGetTruststoreForHttpClientCustomTrustStoreMissingPasswordAlias,Long Statement,The length of the statement "expect(keystoreService.getCredentialForCluster(eq(AliasService.NO_CLUSTER_NAME)`eq(GatewayConfig.DEFAULT_HTTP_CLIENT_TRUSTSTORE_PASSWORD_ALIAS))).andReturn(null).once();" is 169.,166
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testKeystoreForGateway,Long Statement,The length of the statement "DefaultKeystoreService keystoreServiceAlt=createMockBuilder(DefaultKeystoreService.class).addMockedMethod("getCredentialForCluster"`String.class`String.class).createMock();" is 172.,205
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testKeystoreForGateway,Long Statement,The length of the statement "expect(keystoreServiceAlt.getCredentialForCluster(eq(AliasService.NO_CLUSTER_NAME)`eq("custom_key_passphrase_alias"))).andReturn(customKeyPassword).anyTimes();" is 159.,205
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testKeystoreForGateway,Long Statement,The length of the statement "expect(keystoreServiceAlt.getCredentialForCluster(eq(AliasService.NO_CLUSTER_NAME)`eq("custom_keystore_password_alias"))).andReturn(customKeystorePassword).anyTimes();" is 167.,205
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testKeystoreForGateway,Long Statement,The length of the statement "testCreateGetAndCheckKeystoreForGateway(keystoreService`defaultKeystoreFile`GatewayConfigImpl.DEFAULT_IDENTITY_KEY_ALIAS`keyPassword`config);" is 141.,205
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testKeystoreForGateway,Long Statement,The length of the statement "assertNotNull(keystoreService.loadKeyStore(defaultKeystoreFile`GatewayConfigImpl.DEFAULT_IDENTITY_KEYSTORE_TYPE`masterPassword));" is 129.,205
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testSigningKeystore,Long Statement,The length of the statement "DefaultKeystoreService keystoreServiceAlt=createMockBuilder(DefaultKeystoreService.class).addMockedMethod("getCredentialForCluster"`String.class`String.class).createMock();" is 172.,276
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testSigningKeystore,Long Statement,The length of the statement "expect(keystoreServiceAlt.getCredentialForCluster(eq(AliasService.NO_CLUSTER_NAME)`eq(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS))).andReturn(null).atLeastOnce();" is 173.,276
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testSigningKeystore,Long Statement,The length of the statement "DefaultKeystoreService keystoreServiceSymlink=createMockBuilder(DefaultKeystoreService.class).addMockedMethod("getCredentialForCluster"`String.class`String.class).createMock();" is 176.,276
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testSigningKeystore,Long Statement,The length of the statement "expect(keystoreServiceSymlink.getCredentialForCluster(eq(AliasService.NO_CLUSTER_NAME)`eq(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS))).andReturn(null).atLeastOnce();" is 177.,276
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testSigningKeystore,Long Statement,The length of the statement "fail("Not expecting ServiceLifecycleException due to missing signing keystore file since a custom one is not specified");" is 121.,276
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testAddRemoveCredentialForClusterSynchronization,Magic Number,The method contains a magic number: 10,585
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testAddRemoveCredentialForClusterSynchronization,Magic Number,The method contains a magic number: 5,585
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testAddRemoveCredentialForClusterSynchronization,Magic Number,The method contains a magic number: 5,585
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,testCreateGetAndCheckKeystoreForGateway,Long Parameter List,The method has 5 parameters. ,770
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,createKeystore,Long Statement,The length of the statement "X509Certificate cert=X509CertificateUtil.generateCertificate(String.format(Locale.ROOT`"CN=%s`OU=Test`O=Hadoop`L=Test`ST=Test`C=US"`this.getClass().getName())`keyPair`365`"SHA1withRSA");" is 186.,817
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,createKeystore,Magic Number,The method contains a magic number: 2048,817
apache_knox,org.apache.knox.gateway.services.security.impl,DefaultKeystoreServiceTest,createKeystore,Magic Number,The method contains a magic number: 365,817
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testNoRemoteAlias,Long Statement,The length of the statement "Assert.assertFalse("Expected alias 'knox.test.alias.dev' to be removed but found."`aliasesDev.contains(expectedAliasDev));" is 122.,46
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testDoesNotGeneratePasswordIfAlreadyExists,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreType()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_TYPE).anyTimes();" is 122.,128
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testDoesNotGeneratePasswordIfAlreadyExists,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreAlgorithm()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_ALG).anyTimes();" is 126.,128
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testGeneratesPasswordIfDoesNotExist,Long Statement,The length of the statement "EasyMock.expect(defaultAlias.getPasswordFromAliasForCluster("cluster"`"alias")).andReturn(null).andReturn(GENERATED_PASSWORD);" is 126.,164
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testNoRemoteAliasNoConfigs,Long Identifier,The length of the identifier testAutoGeneratedpasswordAlias is 30.,187
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testNoRemoteAliasNoConfigs,Long Statement,The length of the statement "Assert.assertFalse("Expected alias 'knox.test.alias.dev' to be removed but found."`aliasesDev.contains(expectedAliasDev));" is 122.,187
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testNoRemoteAliasNoConfigs,Long Statement,The length of the statement "final char[] autoGeneratedPassword=remoteAliasService.getPasswordFromAliasForCluster(expectedClusterName`testAutoGeneratedpasswordAlias`true);" is 142.,187
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testNoRemoteAliasNoConfigs,Magic Number,The method contains a magic number: 2,187
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testRemoteAliasServiceLoading,Long Statement,The length of the statement "Assert.assertFalse("Expected alias 'knox.test.alias.dev' to be removed but found."`aliasesDev.contains(expectedAliasDev));" is 122.,283
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testRemoveAliasesForCluster,Magic Number,The method contains a magic number: 5,381
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testRemoveAliasesForCluster,Magic Number,The method contains a magic number: 3,381
apache_knox,org.apache.knox.gateway.services.security.impl,RemoteAliasServiceTest,testRemoveAliasesForCluster,Magic Number,The method contains a magic number: 3,381
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryOnlyIdentityKeystore,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(false`false`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 167.,46
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryOnlyIdentityKeystoreErrorGettingPassword,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(false`false`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 167.,97
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryOnlyIdentityKeystoreNullKeystorePassword,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(false`false`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 167.,131
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryOnlyIdentityKeystoreNullKeyPassword,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(false`false`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 167.,183
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryImplicitTrustStore,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(true`false`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 166.,221
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryExplicitTrustStore,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(true`true`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 165.,272
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryExplicitTrustStore,Long Statement,The length of the statement "expect(aliasService.getPasswordFromAliasForGateway(eq(truststorePasswordAlias))).andReturn(truststorePassword).atLeastOnce();" is 125.,272
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryExplicitTrustStoreErrorGettingPassword,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(true`true`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 165.,326
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryExplicitTrustStoreErrorGettingPassword,Long Statement,The length of the statement "expect(aliasService.getPasswordFromAliasForGateway(eq(truststorePasswordAlias))).andThrow(new AliasServiceException(null)).atLeastOnce();" is 137.,326
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryExplicitTrustStoreNullPassword,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(true`true`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 165.,362
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,TestBuildSslContextFactoryExplicitTrustStoreNullPasswords,Long Statement,The length of the statement "GatewayConfig config=createGatewayConfig(true`true`identityKeystorePath`identityKeystoreType`identityKeyAlias`truststorePath`truststoreType`truststorePasswordAlias);" is 165.,417
apache_knox,org.apache.knox.gateway.services.security.impl,JettySSLServiceTest,createGatewayConfig,Long Parameter List,The method has 8 parameters. ,456
apache_knox,org.apache.knox.gateway.services.security.impl,ConfigurableEncryptor,init,Complex Method,Cyclomatic complexity of the method is 8,56
apache_knox,org.apache.knox.gateway.services.security.impl,ConfigurableEncryptor,encrypt,Long Statement,The length of the statement "return new EncryptionResult(salt`ecipher.getParameters().getParameterSpec(IvParameterSpec.class).getIV()`ecipher.doFinal(plain));" is 129.,104
apache_knox,org.apache.knox.gateway.services.security.impl,CMFMasterService,persistMaster,Long Statement,The length of the statement "String line=Base64.encodeBase64String((Base64.encodeBase64String(atom.salt) + "::" + Base64.encodeBase64String(atom.iv)+ "::"+ Base64.encodeBase64String(atom.cipher)).getBytes(StandardCharsets.UTF_8));" is 201.,135
apache_knox,org.apache.knox.gateway.services.security.impl,CMFMasterService,initializeFromMaster,Long Statement,The length of the statement "this.master=new String(encryptor.decrypt(Base64.decodeBase64(parts[0])`Base64.decodeBase64(parts[1])`Base64.decodeBase64(parts[2]))`StandardCharsets.UTF_8).toCharArray();" is 170.,164
apache_knox,org.apache.knox.gateway.services.security.impl,CMFMasterService,initializeFromMaster,Magic Number,The method contains a magic number: 2,164
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceRegistryService,getRegistrationCode,Magic Number,The method contains a magic number: 16,63
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,addServiceDefEntry,Long Statement,The length of the statement "entries.add(template`new DefaultServiceDefEntry(serviceDefinition.getRole()`serviceDefinition.getName()`template.getPattern()));" is 128.,112
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,saveServiceDefinition,Long Statement,The length of the statement "LOG.savedServiceDefinitionChange(serviceDefinition.getService().getName()`serviceDefinition.getService().getRole()`serviceDefinition.getService().getVersion());" is 160.,158
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,saveOrUpdateServiceDefinition,Long Statement,The length of the statement "LOG.updatedServiceDefinitionChange(serviceDefinition.getService().getName()`serviceDefinition.getService().getRole()`serviceDefinition.getService().getVersion());" is 162.,164
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,saveOrUpdateServiceDefinition,Long Statement,The length of the statement "final Optional<ServiceDefinition> persistedServiceDefinition=findServiceDefinition(service.getName()`service.getRole()`service.getVersion());" is 141.,170
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,saveOrUpdateServiceDefinition,Long Statement,The length of the statement "throw new ServiceDefinitionRegistryException("The requested service definition (" + serviceDefinition.toString() + ") already exists!");" is 136.,170
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,saveOrUpdateServiceDefinition,Long Statement,The length of the statement "throw new ServiceDefinitionRegistryException("Error while persisting service definition " + serviceDefinition.toString()`e);" is 124.,170
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,writeOutServiceDefinitionFile,Long Statement,The length of the statement "try (BufferedWriter serviceDefinitionXmlFileWriter=newBufferedWriter(Paths.get(serviceDefinitionFolderPath.toAbsolutePath().toString()`SERVICE_DEFINITION_FILE_NAME)`UTF_8)){" is 173.,198
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,writeOutRewriteRules,Long Statement,The length of the statement "try (BufferedWriter rewriteRuleXmlFileWriter=newBufferedWriter(Paths.get(serviceDefinitionFolderPath.toAbsolutePath().toString()`REWRITE_RULES_FILE_NAME)`UTF_8)){" is 162.,207
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,deleteServiceDefinition,Long Statement,The length of the statement "throw new ServiceDefinitionRegistryException("Error while deleting service definition " + serviceDefinition.toString()`e);" is 122.,220
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,deleteServiceDefinition,Long Statement,The length of the statement "throw new ServiceDefinitionRegistryException("There is no service definition with the given attributes: " + name + "`"+ role+ "`"+ version);" is 140.,220
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,getServices,Long Statement,The length of the statement "return serviceDefinitions.stream().map(serviceDefinitionPair -> serviceDefinitionPair.getService()).collect(Collectors.toSet());" is 128.,240
apache_knox,org.apache.knox.gateway.services.registry.impl,DefaultServiceDefinitionRegistry,findServiceDefinition,Long Statement,The length of the statement "return getServices().stream().filter(sd -> sd.getName().equalsIgnoreCase(name) && sd.getRole().equalsIgnoreCase(role) && sd.getVersion().equalsIgnoreCase(version)).findFirst();" is 176.,244
apache_knox,org.apache.knox.gateway.services.registry.impl,RegEntry,getUrls,Complex Conditional,The conditional expression urls == null && url != null && !"null".equals(url) is complex.,48
apache_knox,org.apache.knox.gateway.services.token.state,TokenStateJournal,add,Long Parameter List,The method has 5 parameters. ,32
apache_knox,org.apache.knox.gateway.services.token,TokenStateServiceStatistics,getKeystoreInteractions,Long Statement,The length of the statement "return this.keystoreInteractions.entrySet().stream().collect(Collectors.toMap(entry -> entry.getKey()`entry -> entry.getValue().get()));" is 136.,82
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournal,add,Long Parameter List,The method has 5 parameters. ,74
apache_knox,org.apache.knox.gateway.services.token.impl.state,MultiFileTokenStateJournal,add,Long Parameter List,The method has 5 parameters. ,57
apache_knox,org.apache.knox.gateway.services.token.impl.state,MultiFileTokenStateJournal,add,Long Statement,The length of the statement "try (FileChannel fileChannel=FileChannel.open(entryFile`StandardOpenOption.WRITE`StandardOpenOption.CREATE`StandardOpenOption.TRUNCATE_EXISTING)){" is 146.,62
apache_knox,org.apache.knox.gateway.services.token.impl.state,MultiFileTokenStateJournal,getDisplayableJournalFilepath,Magic Number,The method contains a magic number: 36,150
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testSingleTokenRoundTrip,Magic Number,The method contains a magic number: 5,68
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testSingleTokenRoundTrip,Magic Number,The method contains a magic number: 5,68
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testSingleTokenRoundTrip,Magic Number,The method contains a magic number: 5,68
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testUpdateTokenState,Magic Number,The method contains a magic number: 5,98
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testUpdateTokenState,Magic Number,The method contains a magic number: 5,98
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testUpdateTokenState,Magic Number,The method contains a magic number: 5,98
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testUpdateTokenState,Magic Number,The method contains a magic number: 5,98
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testSingleJournalEntryRoundTrip,Magic Number,The method contains a magic number: 5,138
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testSingleJournalEntryRoundTrip,Magic Number,The method contains a magic number: 5,138
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testSingleJournalEntryRoundTrip,Magic Number,The method contains a magic number: 5,138
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testMultipleTokensRoundTrip,Magic Number,The method contains a magic number: 10,169
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testMultipleTokensRoundTrip,Magic Number,The method contains a magic number: 5,169
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testMultipleTokensRoundTrip,Magic Number,The method contains a magic number: 5,169
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testMultipleTokensRoundTrip,Magic Number,The method contains a magic number: 5,169
apache_knox,org.apache.knox.gateway.services.token.impl.state,AbstractFileTokenStateJournalTest,testMultipleTokensRoundTrip,Magic Number,The method contains a magic number: 10,169
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,testParseJournalEntry,Magic Number,The method contains a magic number: 7,34
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,testParseJournalEntry_MissingIssueTime,Magic Number,The method contains a magic number: 7,54
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,testParseJournalEntry_MissingIssueAndExpirationTimes,Magic Number,The method contains a magic number: 7,64
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,testParseJournalEntry_OnlyMaxLifetime,Magic Number,The method contains a magic number: 7,72
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,doTestParseJournalEntry,Long Parameter List,The method has 7 parameters. ,95
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,doTestParseJournalEntry,Long Statement,The length of the statement "doTestParseJournalEntry(tokenId`(issueTime != null ? issueTime.toString() : null)`(expiration != null ? expiration.toString() : null)`(maxLifetime != null ? maxLifetime.toString() : null)`(enabled != null ? enabled.toString() : null)`userName`comment);" is 252.,95
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,doTestParseJournalEntry,Long Parameter List,The method has 7 parameters. ,110
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,doTestParseJournalEntry,Long Statement,The length of the statement "StringBuilder entryStringBuilder=new StringBuilder(tokenId != null ? tokenId : "").append('`').append(issueTime != null ? issueTime : "").append('`').append(expiration != null ? expiration : "").append('`').append(maxLifetime != null ? maxLifetime : "").append("`").append(enabled != null ? enabled : "").append("`").append(userName == null ? "" : userName).append("`").append(comment == null ? "" : comment);" is 409.,110
apache_knox,org.apache.knox.gateway.services.token.impl.state,FileTokenStateJournalTest,doTestParseJournalEntry,Long Statement,The length of the statement "assertJournalEntryField(StringUtils.isBlank(enabled) ? "false" : enabled`String.valueOf(entry.getTokenMetadata().isEnabled()));" is 127.,110
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,TokenStateDatabase,Long Identifier,The length of the field TOKENS_TABLE_CREATE_SQL_FILE_NAME is 33.,68
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,TokenStateDatabase,Long Identifier,The length of the field TOKEN_METADATA_TABLE_CREATE_SQL_FILE_NAME is 41.,68
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addToken,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement addTokenStatement=connection.prepareStatement(ADD_TOKEN_SQL)){" is 134.,100
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addToken,Magic Number,The method contains a magic number: 2,100
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addToken,Magic Number,The method contains a magic number: 3,100
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addToken,Magic Number,The method contains a magic number: 4,100
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,removeToken,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement addTokenStatement=connection.prepareStatement(REMOVE_TOKEN_SQL)){" is 137.,110
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,getTokenIssueTime,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement getTokenExpirationStatement=connection.prepareStatement(GET_TOKEN_ISSUE_TIME_SQL)){" is 155.,117
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,getTokenExpiration,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement getTokenExpirationStatement=connection.prepareStatement(GET_TOKEN_EXPIRATION_SQL)){" is 155.,126
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,updateExpiration,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement updateTokenExpirationStatement=connection.prepareStatement(UPDATE_TOKEN_EXPIRATION_SQL)){" is 161.,135
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,updateExpiration,Magic Number,The method contains a magic number: 2,135
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,getMaxLifetime,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement getMaxLifetimeStatement=connection.prepareStatement(GET_MAX_LIFETIME_SQL)){" is 147.,143
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,getExpiredTokenIds,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement getExpiredTokenIdsStatement=connection.prepareStatement(GET_EXPIRED_TOKENS_SQL)){" is 153.,152
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,deleteExpiredTokens,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement deleteExpiredTokensStatement=connection.prepareStatement(REMOVE_EXPIRED_TOKENS_SQL)){" is 157.,165
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,updateMetadata,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement updateMetadataStatement=connection.prepareStatement(UPDATE_METADATA_SQL)){" is 146.,172
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,updateMetadata,Long Statement,The length of the statement "updateMetadataStatement.setString(1`metadataName.equals(TokenMetadata.PASSCODE) ? Base64.encodeBase64String(metadataValue.getBytes(UTF_8)) : metadataValue);" is 156.,172
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,updateMetadata,Magic Number,The method contains a magic number: 2,172
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,updateMetadata,Magic Number,The method contains a magic number: 3,172
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addMetadata,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement addMetadataStatement=connection.prepareStatement(ADD_METADATA_SQL)){" is 140.,181
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addMetadata,Long Statement,The length of the statement "addMetadataStatement.setString(3`metadataName.equals(TokenMetadata.PASSCODE) ? Base64.encodeBase64String(metadataValue.getBytes(UTF_8)) : metadataValue);" is 153.,181
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addMetadata,Magic Number,The method contains a magic number: 2,181
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,addMetadata,Magic Number,The method contains a magic number: 3,181
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,getTokenMetadata,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement getMaxLifetimeStatement=connection.prepareStatement(GET_METADATA_SQL)){" is 143.,190
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,getTokenMetadata,Magic Number,The method contains a magic number: 2,190
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,decodeMetadata,Long Statement,The length of the statement "return metadataName.equals(TokenMetadata.PASSCODE) ? new String(Base64.decodeBase64(metadataValue.getBytes(UTF_8))`UTF_8) : metadataValue;" is 138.,204
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,getDoAsTokens,Long Identifier,The length of the field GET_TOKENS_CREATED_BY_USER_NAME_SQL is 35.,212
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,fetchTokens,Long Statement,The length of the statement "try (Connection connection=dataSource.getConnection();PreparedStatement getTokenIdsStatement=connection.prepareStatement(sql)){" is 127.,216
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,fetchTokens,Magic Number,The method contains a magic number: 2,216
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,fetchTokens,Magic Number,The method contains a magic number: 3,216
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,fetchTokens,Magic Number,The method contains a magic number: 4,216
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,fetchTokens,Magic Number,The method contains a magic number: 5,216
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStateDatabase,fetchTokens,Magic Number,The method contains a magic number: 6,216
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,addToken,Long Statement,The length of the statement "throw new TokenStateServiceException("Failed to save token " + Tokens.getTokenIDDisplayText(tokenId) + " in the database");" is 123.,74
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,addToken,Long Statement,The length of the statement "throw new TokenStateServiceException("An error occurred while saving token " + Tokens.getTokenIDDisplayText(tokenId) + " in the database"`e);" is 141.,74
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,getTokenIssueTime,Empty catch clause,The method has an empty catch block.,93
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,updateExpiration,Long Statement,The length of the statement "throw new TokenStateServiceException("Failed to updated expiration for " + Tokens.getTokenIDDisplayText(tokenId) + " in the database");" is 135.,145
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,updateExpiration,Long Statement,The length of the statement "throw new TokenStateServiceException("An error occurred while updating expiration for " + Tokens.getTokenIDDisplayText(tokenId) + " in the database"`e);" is 152.,145
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,evictExpiredTokens,Long Statement,The length of the statement "log.removingExpiredTokensFromDatabase(expiredTokenIds.size()`String.join("` "`expiredTokenIds.stream().map(tokenId -> Tokens.getTokenIDDisplayText(tokenId)).collect(Collectors.toSet())));" is 187.,210
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,addMetadata,Long Statement,The length of the statement "throw new TokenStateServiceException("Failed to update metadata for " + Tokens.getTokenIDDisplayText(tokenId) + " in the database");" is 132.,229
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateService,addMetadata,Long Statement,The length of the statement "throw new TokenStateServiceException("An error occurred while updating metadata for " + Tokens.getTokenIDDisplayText(tokenId) + " in the database"`e);" is 150.,229
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,init,Long Statement,The length of the statement "this.gatewayCredentialsFilePath=Paths.get(config.getGatewayKeystoreDir()).resolve(AliasService.NO_CLUSTER_NAME + DefaultKeystoreService.CREDENTIALS_SUFFIX + config.getCredentialStoreType().toLowerCase(Locale.ROOT));" is 215.,81
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,start,Long Statement,The length of the statement "final ExecutorService gatewayCredentialsLoader=Executors.newSingleThreadExecutor(new BasicThreadFactory.Builder().namingPattern("PersistenceStoreLoader").build());" is 163.,125
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,loadTokenAliasesFromPersistenceStore,Magic Number,The method contains a magic number: 2,140
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,loadTokenAliasesFromPersistenceStore,Magic Number,The method contains a magic number: 100,140
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,loadTokenAliasesFromPersistenceStore,Magic Number,The method contains a magic number: 2,140
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,scheduleTokenStatePersistence,Long Statement,The length of the statement "statePersistenceScheduler=Executors.newSingleThreadScheduledExecutor(new BasicThreadFactory.Builder().namingPattern("TokenStatePerister-%d").build());" is 150.,203
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,scheduleTokenStatePersistence,Long Statement,The length of the statement "final ScheduledFuture<?> persistTokenStateTask=statePersistenceScheduler.scheduleAtFixedRate(this::persistTokenState`statePersistenceInterval`statePersistenceInterval`TimeUnit.SECONDS);" is 185.,203
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,scheduleTokenStatePersistence,Magic Number,The method contains a magic number: 10,203
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,getTokenIssueTime,Empty catch clause,The method has an empty catch block.,336
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,getTokenExpiration,Empty catch clause,The method has an empty catch block.,365
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,addMetadata,Long Statement,The length of the statement "journal.add(entry.getTokenId()`Long.parseLong(entry.getIssueTime())`Long.parseLong(entry.getExpiration())`Long.parseLong(entry.getMaxLifetime())`metadata);" is 155.,472
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateService,getTokenMetadata,Empty catch clause,The method has an empty catch block.,493
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityService,issueToken,Long Statement,The length of the statement "final JWT token=SUPPORTED_PKI_SIG_ALGS.contains(algorithm) || SUPPORTED_HMAC_SIG_ALGS.contains(algorithm) ? new JWTToken(jwtAttributes) : null;" is 143.,104
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityService,issueToken,Long Statement,The length of the statement "signTokenWithRSA(token`jwtAttributes.getSigningKeystoreName()`jwtAttributes.getSigningKeystoreAlias()`jwtAttributes.getSigningKeystorePassphrase());" is 148.,104
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityService,getSigningKey,Long Statement,The length of the statement "return (RSAPrivateKey)keystoreService.getSigningKey(signingKeystoreName`getSigningKeyAlias(signingKeystoreAlias)`getSigningKeyPassphrase(signingKeystorePassphrase));" is 165.,139
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityService,verifyToken,Long Statement,The length of the statement "return SUPPORTED_HMAC_SIG_ALGS.contains(signatureAlgorithm) ? verifyTokenUsingHMAC(token) : verifyTokenUsingRSA(token`publicKey);" is 129.,193
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityService,start,Complex Method,Cyclomatic complexity of the method is 8,260
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityService,start,Long Statement,The length of the statement "throw new ServiceLifecycleException(RESOURCES.signingKeyPassphraseNotAvailable(config.getSigningKeyPassphraseAlias())`e);" is 121.,260
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStatePersisterMonitor,TokenStatePersisterMonitor,Long Statement,The length of the statement "this.monitor=Executors.newSingleThreadExecutor(new BasicThreadFactory.Builder().namingPattern("TokenStatePeristerMonitor-%d").build());" is 135.,41
apache_knox,org.apache.knox.gateway.services.token.impl,TokenStatePersisterMonitor,monitorPersisterTask,Magic Number,The method contains a magic number: 10,51
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateService,init,Long Statement,The length of the statement "final ZookeeperRemoteAliasService zookeeperAliasService=(ZookeeperRemoteAliasService)aliasServiceFactory.create(gatewayServices`ALIAS_SERVICE`config`options`ZookeeperRemoteAliasService.class.getName());" is 202.,56
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateService,getTokenIssueTime,Empty catch clause,The method has an empty catch block.,79
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateService,getTokenExpiration,Empty catch clause,The method has an empty catch block.,106
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateService,updateExpiration,Long Statement,The length of the statement "journal.add(entry.getTokenId()`Long.parseLong(entry.getIssueTime())`expiration`Long.parseLong(entry.getMaxLifetime())`entry.getTokenMetadata());" is 144.,171
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateService,addMetadata,Long Statement,The length of the statement "journal.add(entry.getTokenId()`Long.parseLong(entry.getIssueTime())`Long.parseLong(entry.getExpiration())`Long.parseLong(entry.getMaxLifetime())`metadata);" is 155.,203
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateService,init,Long Statement,The length of the statement "catch ( MalformedObjectNameException|InstanceAlreadyExistsException|MBeanRegistrationException|NotCompliantMBeanException e) {" is 126.,90
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateService,start,Long Statement,The length of the statement "evictionScheduler.scheduleAtFixedRate(this::evictExpiredTokens`tokenEvictionInterval`tokenEvictionInterval`TimeUnit.SECONDS);" is 125.,106
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateService,hasRemainingRenewals,Magic Number,The method contains a magic number: 30,315
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateService,fetchTokens,Empty catch clause,The method has an empty catch block.,432
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateService,fetchTokens,Long Statement,The length of the statement "tokens.add(new KnoxToken(tokenId`getTokenIssueTime(tokenId)`getTokenExpiration(tokenId)`getMaxLifetime(tokenId)`metadata.getValue()));" is 134.,432
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreation,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").anyTimes();" is 134.,49
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreation,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,49
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreation,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeyPassphraseAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 128.,49
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreation,Long Statement,The length of the statement "JWT token=ta.issueToken(new JWTokenAttributesBuilder().setUserName(userName).setAlgorithm("RS256").setManaged(true).build());" is 125.,49
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationAudience,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").anyTimes();" is 134.,98
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationAudience,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,98
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationAudience,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeyPassphraseAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 128.,98
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationAudience,Long Statement,The length of the statement "JWT token=ta.issueToken(new JWTokenAttributesBuilder().setUserName(userName).setAudiences("https://login.example.com").setAlgorithm("RS256").build());" is 150.,98
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationNullAudience,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").anyTimes();" is 134.,148
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationNullAudience,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,148
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationNullAudience,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeyPassphraseAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 128.,148
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationSignatureAlgorithm,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").anyTimes();" is 134.,196
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationSignatureAlgorithm,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,196
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationSignatureAlgorithm,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeyPassphraseAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 128.,196
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationBadSignatureAlgorithm,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").anyTimes();" is 134.,245
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationBadSignatureAlgorithm,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,245
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationBadSignatureAlgorithm,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeyPassphraseAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 128.,245
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationCustomSigningKey,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").anyTimes();" is 134.,287
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationCustomSigningKey,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,287
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationCustomSigningKey,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeyPassphraseAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 128.,287
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationCustomSigningKey,Long Statement,The length of the statement "final JWTokenAttributes jwtAttributes=new JWTokenAttributesBuilder().setUserName(userName).setAudiences(Collections.emptyList()).setAlgorithm("RS256").setExpires(-1).setSigningKeystoreName(customSigningKeyName).setSigningKeystoreAlias(customSigningKeyAlias).setSigningKeystorePassphrase(customSigningKeyPassphrase.toCharArray()).build();" is 337.,287
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testTokenCreationCustomSigningKey,Long Statement,The length of the statement "RSAPublicKey customPublicKey=(RSAPublicKey)ks.getSigningKeystore(customSigningKeyName).getCertificate(customSigningKeyAlias).getPublicKey();" is 140.,287
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStart,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").atLeastOnce();" is 137.,349
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStart,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,349
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStartMissingKeystore,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/missing-server-keystore.jks").atLeastOnce();" is 145.,401
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStartMissingKeystore,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,401
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStartInvalidKeystorePassword,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").atLeastOnce();" is 137.,440
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStartInvalidKeystorePassword,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,440
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStartMissingKey,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").atLeastOnce();" is 137.,488
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceStartMissingKey,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,488
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceInvalidKeyPassword,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").atLeastOnce();" is 137.,536
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testServiceInvalidKeyPassword,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,536
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testGetSigningCertKid,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePath()).andReturn(basedir + "/target/test-classes/keystores/server-keystore.jks").anyTimes();" is 134.,584
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testGetSigningCertKid,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeystorePasswordAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 134.,584
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenAuthorityServiceTest,testGetSigningCertKid,Long Statement,The length of the statement "EasyMock.expect(config.getSigningKeyPassphraseAlias()).andReturn(GatewayConfig.DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 128.,584
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,setUp,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_USER_ALIAS_NAME)).andReturn(USERNAME.toCharArray()).anyTimes();" is 142.,71
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,setUp,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForGateway(JDBCUtils.DATABASE_PASSWORD_ALIAS_NAME)).andReturn(PASSWORD.toCharArray()).anyTimes();" is 146.,71
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,setUp,Long Statement,The length of the statement "tokenMAC=new TokenMAC(HmacAlgorithms.HMAC_SHA_256.getName()`"sPj8FCgQhCEi6G18kBfpswxYSki33plbelGLs0hMSbk".toCharArray());" is 121.,71
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddToken,Long Statement,The length of the statement "assertEquals(issueTime + maxLifetimeDuration`getLongTokenAttributeFromDatabase(tokenId`TokenStateDatabase.GET_MAX_LIFETIME_SQL));" is 129.,88
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddToken,Magic Number,The method contains a magic number: 1000,88
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddTokensForMultipleUsers,Magic Number,The method contains a magic number: 2,103
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddTokensForMultipleUsers,Magic Number,The method contains a magic number: 2,103
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddTokensForMultipleUsers,Magic Number,The method contains a magic number: 3,103
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddTokensForMultipleUsers,Magic Number,The method contains a magic number: 3,103
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddTokensForMultipleUsers,Magic Number,The method contains a magic number: 2,103
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,assertToken,Long Parameter List,The method has 5 parameters. ,139
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,saveToken,Long Parameter List,The method has 5 parameters. ,147
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testUpdateExpiration,Magic Number,The method contains a magic number: 2,163
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testUpdateExpiration,Magic Number,The method contains a magic number: 3L,163
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testUpdateExpiration,Magic Number,The method contains a magic number: 2,163
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testUpdateExpiration,Magic Number,The method contains a magic number: 2,163
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddMetadata,Long Statement,The length of the statement "assertEquals("my test comment"`getStringTokenAttributeFromDatabase(tokenId`getSelectMetadataSql(TokenMetadata.COMMENT)));" is 121.,179
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testAddMetadata,Long Statement,The length of the statement "final String storedPasscodeInDb=new String(Base64.decodeBase64(getStringTokenAttributeFromDatabase(tokenId`getSelectMetadataSql(TokenMetadata.PASSCODE)))`UTF_8);" is 161.,179
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,testEvictExpiredTokens,Magic Number,The method contains a magic number: 1000,219
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,truncateDatabase,Long Identifier,The length of the field TRUNCATE_KNOX_TOKEN_METADATA_SQL is 32.,252
apache_knox,org.apache.knox.gateway.services.token.impl,JDBCTokenStateServiceTest,getSelectMetadataSql,Long Statement,The length of the statement "return "SELECT md_value FROM " + TokenStateDatabase.TOKEN_METADATA_TABLE_NAME + " WHERE token_id = ? AND md_name = '"+ metadataName+ "'";" is 137.,266
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,getTokenStatePersistenceInterval,Long Statement,The length of the statement "return (tokenStatePersistenceInterval != null) ? tokenStatePersistenceInterval : super.getTokenStatePersistenceInterval();" is 122.,61
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Long Statement,The length of the statement "EasyMock.expect(aliasService.getPasswordFromAliasForCluster(anyString()`anyString())).andReturn(String.valueOf(System.currentTimeMillis()).toCharArray()).anyTimes();" is 165.,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Long Statement,The length of the statement "EasyMock.expect(aliasService.getAliasesForCluster(AliasService.NO_CLUSTER_NAME)).andReturn(testTokenStateAliases).anyTimes();" is 125.,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 3,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 3,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 10,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 60,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 2,69
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "EasyMock.expect(aliasService.getAliasesForCluster(AliasService.NO_CLUSTER_NAME)).andReturn(new ArrayList<>(testTokenStateAliases)).anyTimes();" is 142.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been added in the base class cache."`TOKEN_COUNT`maxTokenLifetimes.size());" is 127.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the token issue times to have been added in the base class cache."`TOKEN_COUNT`tokenIssueTimes.size());" is 126.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens to have been removed from the base class cache as a result of eviction."`0`tokenExpirations.size());" is 134.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been removed from the base class cache as a result of eviction."`0`maxTokenLifetimes.size());" is 145.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the token metadata to have been removed from the base class cache as a result of eviction."`0`metadata.size());" is 134.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the token issue times to have been removed from the base class cache as a result of eviction."`0`tokenIssueTimes.size());" is 144.,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 10,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 60,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 2,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 2,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 2,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 2,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 3,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 3,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 4,129
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Long Statement,The length of the statement "testTokenStateAliases.add(token.getClaim(JWTToken.KNOX_ID_CLAIM) + AliasBasedTokenStateService.TOKEN_MAX_LIFETIME_POSTFIX);" is 123.,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Long Statement,The length of the statement "EasyMock.expect(aliasService.getAliasesForCluster(AliasService.NO_CLUSTER_NAME)).andReturn(testTokenStateAliases).anyTimes();" is 125.,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Long Statement,The length of the statement "assertEquals("Expected the tokens to have been removed from the base class cache as a result of eviction."`0`tokenExpirations.size());" is 134.,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been removed from the base class cache as a result of eviction."`0`maxTokenLifetimes.size());" is 145.,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 3,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 3,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 10,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 60,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 60,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 10,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 10,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenEvictionIncludesUncachedAliases,Magic Number,The method contains a magic number: 4,220
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Long Statement,The length of the statement "assertEquals("Expected the cached max lifetime` rather than the alias value"`updatedMaxLifetime`tss.getMaxLifetime(tokenId));" is 125.,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 3,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 3,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 10,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 60,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 10,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 5,305
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Long Statement,The length of the statement "assertEquals("Expected the cached expiration to have been updated."`updatedExpiration`tss.getTokenExpiration(tokenId`count++ % 2 == 0));" is 136.,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 3,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 3,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 10,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 60,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 10,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 2,366
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 3,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 3,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 10,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 60,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 10,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 10,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 3,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testTokenStateJournaling,Magic Number,The method contains a magic number: 2,427
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Long Statement,The length of the statement "journal.add(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`System.currentTimeMillis() + TimeUnit.HOURS.toMillis(24)`null);" is 174.,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Long Statement,The length of the statement "assertEquals("Expected the tokens expirations to have been added in the base class cache."`TOKEN_COUNT`tokenExpirations.size());" is 128.,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been added in the base class cache."`TOKEN_COUNT`maxTokenLifetimes.size());" is 127.,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Long Statement,The length of the statement "assertEquals("Expected the tokens issue times to have been added in the base class cache."`TOKEN_COUNT`tokenIssueTimes.size());" is 127.,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Magic Number,The method contains a magic number: 10,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Magic Number,The method contains a magic number: 60,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Magic Number,The method contains a magic number: 24,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Magic Number,The method contains a magic number: 3,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInit,Magic Number,The method contains a magic number: 3,506
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Long Statement,The length of the statement "journal.add(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`System.currentTimeMillis() + TimeUnit.HOURS.toMillis(24)`null);" is 174.,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Long Statement,The length of the statement "journal.add(new TestJournalEntry(UUID.randomUUID().toString()`"invalidLongValue"`String.valueOf(System.currentTimeMillis())`String.valueOf(System.currentTimeMillis())`new TokenMetadata("testUser")));" is 199.,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Long Statement,The length of the statement "journal.add(new TestJournalEntry(UUID.randomUUID().toString()`String.valueOf(System.currentTimeMillis())`"invalidLongValue"`String.valueOf(System.currentTimeMillis())`new TokenMetadata("testUser")));" is 199.,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Long Statement,The length of the statement "journal.add(new TestJournalEntry(UUID.randomUUID().toString()`String.valueOf(System.currentTimeMillis())`String.valueOf(System.currentTimeMillis())`"invalidLongValue"`new TokenMetadata("testUser")));" is 199.,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Long Statement,The length of the statement "assertEquals("Expected the tokens expirations to have been added in the base class cache."`TOKEN_COUNT`tokenExpirations.size());" is 128.,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been added in the base class cache."`TOKEN_COUNT`maxTokenLifetimes.size());" is 127.,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Long Statement,The length of the statement "assertEquals("Expected the tokens issue times to have been added in the base class cache."`TOKEN_COUNT`tokenIssueTimes.size());" is 127.,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Magic Number,The method contains a magic number: 5,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Magic Number,The method contains a magic number: 60,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Magic Number,The method contains a magic number: 24,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Magic Number,The method contains a magic number: 3,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,testLoadTokenStateJournalDuringInitWithInvalidEntries,Magic Number,The method contains a magic number: 3,564
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,ensureAliases,Long Statement,The length of the statement "final List<AliasBasedTokenStateService.TokenState> unpersistedTokenStates=new ArrayList<>(getUnpersistedStateField(tss`0));" is 123.,650
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,ensureAliases,Magic Number,The method contains a magic number: 1000,650
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,ensureAliases,Magic Number,The method contains a magic number: 60,650
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,ensureAliases,Magic Number,The method contains a magic number: 3,650
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,addToken,Long Parameter List,The method has 5 parameters. ,812
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,getTokenExpirationsField,Magic Number,The method contains a magic number: 3,840
apache_knox,org.apache.knox.gateway.services.token.impl,AliasBasedTokenStateServiceTest,getMaxTokenLifetimesField,Magic Number,The method contains a magic number: 3,862
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2048,66
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testGetExpiration,Magic Number,The method contains a magic number: 60,75
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testGetExpiration_InvalidToken,Magic Number,The method contains a magic number: 60,97
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testGetExpiration_InvalidToken_WithoutValidation,Magic Number,The method contains a magic number: 60,105
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testGetMetadata_InvalidToken,Magic Number,The method contains a magic number: 60,113
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testGetExpiration_AfterRenewal,Magic Number,The method contains a magic number: 60,121
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testIsExpired_Negative,Magic Number,The method contains a magic number: 60,135
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testIsExpired_Positive,Magic Number,The method contains a magic number: 60,144
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testIsExpired_Revoked,Magic Number,The method contains a magic number: 60,153
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testRenewal,Magic Number,The method contains a magic number: 60,165
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testRenewalBeyondMaxLifetime,Magic Number,The method contains a magic number: 5,178
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testNegativeTokenEviction,Long Statement,The length of the statement "addToken(tss`token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,199
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testNegativeTokenEviction,Magic Number,The method contains a magic number: 60,199
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testNegativeTokenEviction,Magic Number,The method contains a magic number: 3,199
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testNegativeTokenEviction,Magic Number,The method contains a magic number: 2,199
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testNegativeTokenEviction,Magic Number,The method contains a magic number: 2,199
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testNegativeTokenEviction,Magic Number,The method contains a magic number: 10,199
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testTokenEviction,Long Statement,The length of the statement "addToken(tss`token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,223
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testTokenEviction,Magic Number,The method contains a magic number: 60,223
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testTokenEviction,Magic Number,The method contains a magic number: 3,223
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testTokenEviction,Magic Number,The method contains a magic number: 3,223
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testTokenEviction,Magic Number,The method contains a magic number: 2,223
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testTokenPermissiveness,Magic Number,The method contains a magic number: 300,252
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,testAddTokenMetadata,Empty catch clause,The method has an empty catch block.,279
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,createMockGatewayConfig,Magic Number,The method contains a magic number: 2L,331
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,getTokenStatePersistenceInterval,Magic Number,The method contains a magic number: 15,353
apache_knox,org.apache.knox.gateway.services.token.impl,DefaultTokenStateServiceTest,addToken,Long Parameter List,The method has 5 parameters. ,384
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,configureAndStartZKCluster,Magic Number,The method contains a magic number: 2,71
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testStoringTokenAliasesInZookeeper,Long Identifier,The length of the field SHORT_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL is 44.,97
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testStoringTokenAliasesInZookeeper,Long Statement,The length of the statement "final ZookeeperTokenStateService zktokenStateService=setupZkTokenStateService(SHORT_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL);" is 124.,97
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testStoringTokenAliasesInZookeeper,Long Statement,The length of the statement "assertFalse(zkNodeExists("/knox/security/topology/__gateway/tokens/a0/a0-token1" + AliasBasedTokenStateService.TOKEN_MAX_LIFETIME_POSTFIX));" is 140.,97
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testStoringTokenAliasesInZookeeper,Long Statement,The length of the statement "assertTrue(zkNodeExists("/knox/security/topology/__gateway/tokens/a0/a0-token1" + AliasBasedTokenStateService.TOKEN_MAX_LIFETIME_POSTFIX));" is 139.,97
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testStoringTokenAliasesInZookeeper,Magic Number,The method contains a magic number: 2L,97
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testStoringTokenAliasesInZookeeper,Magic Number,The method contains a magic number: 2,97
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testStoringTokenAliasesInZookeeper,Magic Number,The method contains a magic number: 1000,97
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Long Identifier,The length of the field LONG_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL is 43.,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Long Statement,The length of the statement "final ZookeeperTokenStateService zktokenStateServiceNode1=setupZkTokenStateService(LONG_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL);" is 128.,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Long Statement,The length of the statement "final ZookeeperTokenStateService zktokenStateServiceNode2=setupZkTokenStateService(LONG_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL);" is 128.,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Magic Number,The method contains a magic number: 10L,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Magic Number,The method contains a magic number: 2000L,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Magic Number,The method contains a magic number: 1000,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Magic Number,The method contains a magic number: 2000L,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRetry,Magic Number,The method contains a magic number: 1000,113
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRenewal,Long Identifier,The length of the field SHORT_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL is 44.,132
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRenewal,Long Statement,The length of the statement "final ZookeeperTokenStateService zktokenStateServiceNode1=setupZkTokenStateService(SHORT_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL);" is 129.,132
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRenewal,Long Statement,The length of the statement "final ZookeeperTokenStateService zktokenStateServiceNode2=setupZkTokenStateService(SHORT_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL);" is 129.,132
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRenewal,Magic Number,The method contains a magic number: 1000L,132
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRenewal,Magic Number,The method contains a magic number: 2000L,132
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRenewal,Magic Number,The method contains a magic number: 1500,132
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testRenewal,Magic Number,The method contains a magic number: 1500,132
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testTokenIDDisplayText,Long Identifier,The length of the field SHORT_TOKEN_STATE_ALIAS_PERSISTENCE_INTERVAL is 44.,151
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testTokenIDDisplayText,Magic Number,The method contains a magic number: 8,151
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testTokenIDDisplayText,Magic Number,The method contains a magic number: 8,151
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,testTokenIDDisplayText,Magic Number,The method contains a magic number: 8,151
apache_knox,org.apache.knox.gateway.services.token.impl,ZookeeperTokenStateServiceTest,setupZkTokenStateService,Long Statement,The length of the statement "final String registryConfig=REMOTE_CONFIG_REGISTRY_TYPE + "=" + ZooKeeperClientService.TYPE+ ";"+ REMOTE_CONFIG_REGISTRY_ADDRESS+ "="+ zkNodes.getConnectString();" is 162.,181
apache_knox,org.apache.knox.gateway.services.token.impl,TokenMACTest,testHash,Long Statement,The length of the statement "final TokenMAC tokenMAC=new TokenMAC(HmacAlgorithms.HMAC_SHA_256.getName()`"sPj8FCgQhCEi6G18kBfpswxYSki33plbelGLs0hMSbk".toCharArray());" is 136.,31
apache_knox,org.apache.knox.gateway.services.token.impl,TokenMACTest,testHash,Magic Number,The method contains a magic number: 123L,31
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testBulkTokenStateEviction,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,46
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 5,46
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 3,46
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 3,46
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 60,46
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testBulkTokenStateEviction,Magic Number,The method contains a magic number: 2,46
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been added in the base class cache."`TOKEN_COUNT`maxTokenLifetimes.size());" is 127.,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens to have been removed from the base class cache as a result of eviction."`0`tokenExpirations.size());" is 134.,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been removed from the base class cache as a result of eviction."`0`maxTokenLifetimes.size());" is 145.,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 5,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 60,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 3,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 3,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testAddAndRemoveTokenIncludesCache,Magic Number,The method contains a magic number: 4,84
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "TokenStateJournal testJournal=TokenStateJournalFactory.create(createMockGatewayConfig(false`getGatewaySecurityDir()`getTokenStatePersistenceInterval()));" is 153.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "testJournal.add(uncachedTokenId`System.currentTimeMillis()`uncachedToken.getExpiresDate().getTime()`maxTokenLifetime`null);" is 123.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "assertEquals("Expected the previously-persisted journal entry to have been loaded into the cache."`1`tokenExpirations.size());" is 126.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "assertEquals("Expected the previously-persisted journal entry to have been loaded into the cache."`1`maxTokenLifetimes.size());" is 127.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been added in the base class cache."`TOKEN_COUNT + 1`maxTokenLifetimes.size());" is 131.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "assertEquals("Expected the uncached journal entry in addition to the cached tokens"`TOKEN_COUNT + 1`journal.get().size());" is 122.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "assertEquals("Expected the tokens to have been removed from the base class cache as a result of eviction."`0`tokenExpirations.size());" is 134.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been removed from the base class cache as a result of eviction."`0`maxTokenLifetimes.size());" is 145.,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Magic Number,The method contains a magic number: 5,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Magic Number,The method contains a magic number: 3,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Magic Number,The method contains a magic number: 3,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Magic Number,The method contains a magic number: 60,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Magic Number,The method contains a magic number: 60,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testTokenEvictionIncludesPreviouslyPersistedJournalEntries,Magic Number,The method contains a magic number: 4,138
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens lifetimes to have been added in the base class cache."`TOKEN_COUNT`maxTokenLifetimes.size());" is 127.,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Long Statement,The length of the statement "assertEquals("Expected the cached max lifetime` rather than the journal entry value"`updatedMaxLifetime`((JournalBasedTokenStateService)tss).getMaxLifetime(tokenId));" is 166.,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 10,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 3,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 3,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 60,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testGetMaxLifetimeUsesCache,Magic Number,The method contains a magic number: 5,217
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Long Statement,The length of the statement "tss.addToken(token.getClaim(JWTToken.KNOX_ID_CLAIM)`System.currentTimeMillis()`token.getExpiresDate().getTime()`maxTokenLifetime);" is 130.,265
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Long Statement,The length of the statement "assertEquals("Expected the tokens expirations to have been added in the base class cache."`TOKEN_COUNT`tokenExpirations.size());" is 128.,265
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Long Statement,The length of the statement "assertEquals("Expected the cached expiration to have been updated."`updatedExpiration`tss.getTokenExpiration(tokenId`count++ % 2 == 0));" is 136.,265
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 10,265
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 3,265
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 3,265
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 60,265
apache_knox,org.apache.knox.gateway.services.token.impl,JournalBasedTokenStateServiceTest,testUpdateExpirationUsesCache,Magic Number,The method contains a magic number: 2,265
apache_knox,org.apache.knox.gateway.trace,AccessHandler,log,Long Statement,The length of the statement "sb.append('|').append(request.getRemoteAddr()).append('|').append(request.getMethod()).append('|').append(request.getHttpURI()).append('|').append(request.getContentLength()).append('|').append(response.getStatus()).append('|').append(response.getContentCount()).append('|').append(System.currentTimeMillis() - request.getTimeStamp());" is 335.,30
apache_knox,org.apache.knox.gateway.trace,TraceUtil,addParsedIntegerToSet,Empty catch clause,The method has an empty catch block.,62
apache_knox,org.apache.knox.gateway.trace,TraceResponse,getOutputStream,Complex Conditional,The conditional expression output == null && (filter == null || filter.isEmpty() || filter.contains(getStatus())) is complex.,43
apache_knox,org.apache.knox.gateway.websockets,GatewayWebsocketHandler,getClientEndpointConfig,Long Statement,The length of the statement "LOG.onError(String.format(Locale.ROOT`"Error getting backend url` this could cause 'Host does not match SNI' exception. Cause: "`e.toString()));" is 144.,146
apache_knox,org.apache.knox.gateway.websockets,GatewayWebsocketHandler,beforeRequest,Long Statement,The length of the statement "LOG.onError(String.format(Locale.ROOT`"Error getting backend url` this could cause 'Host does not match SNI' exception. Cause: "`e.toString()));" is 144.,156
apache_knox,org.apache.knox.gateway.websockets,GatewayWebsocketHandler,getMatchedBackendURL,Long Identifier,The length of the field SECURE_WEBSOCKET_PROTOCOL_STRING is 32.,173
apache_knox,org.apache.knox.gateway.websockets,GatewayWebsocketHandler,getMatchedBackendURL,Long Statement,The length of the statement "final String protocol=(serviceUrl.getProtocol().equals("ws") || serviceUrl.getProtocol().equals("wss")) ? serviceUrl.getProtocol() : "ws";" is 138.,173
apache_knox,org.apache.knox.gateway.websockets,GatewayWebsocketHandler,urlFromServiceDefinition,Magic Number,The method contains a magic number: 2,256
apache_knox,org.apache.knox.gateway.websockets,GatewayWebsocketHandler,generateUrlSuffix,Complex Conditional,The conditional expression !StringUtils.endsWith(backendPart`"/ws") && pathService.length > 0 && pathService[1] != null is complex.,270
apache_knox,org.apache.knox.gateway.websockets,ProxyWebSocketAdapter,onWebSocketConnect,Complex Conditional,The conditional expression container instanceof org.eclipse.jetty.websocket.jsr356.ClientContainer && ((org.eclipse.jetty.websocket.jsr356.ClientContainer)container).getClient() != null && ((org.eclipse.jetty.websocket.jsr356.ClientContainer)container).getClient().getSslContextFactory() != null is complex.,91
apache_knox,org.apache.knox.gateway.websockets,ProxyWebSocketAdapter,onWebSocketConnect,Long Statement,The length of the statement "if (container instanceof org.eclipse.jetty.websocket.jsr356.ClientContainer && ((org.eclipse.jetty.websocket.jsr356.ClientContainer)container).getClient() != null && ((org.eclipse.jetty.websocket.jsr356.ClientContainer)container).getClient().getSslContextFactory() != null) {" is 275.,91
apache_knox,org.apache.knox.gateway.websockets,ProxyWebSocketAdapter,onWebSocketConnect,Long Statement,The length of the statement "((org.eclipse.jetty.websocket.jsr356.ClientContainer)container).getClient().getHttpClient().getSslContextFactory().setTrustStore(ks);" is 133.,91
apache_knox,org.apache.knox.gateway.websockets,BigEchoSocketHandler,configure,Magic Number,The method contains a magic number: 66000,37
apache_knox,org.apache.knox.gateway.websockets,BigEchoSocketHandler,configure,Magic Number,The method contains a magic number: 66000,37
apache_knox,org.apache.knox.gateway.websockets,WebsocketBackendUrlTest,testWebsocketBackendUrlWithQueryParams,Long Statement,The length of the statement "URI requestURI=new URI(String.format(Locale.ROOT`"%sgateway/websocket/123foo456bar/%s"`serverUri.toString()`pathContext));" is 122.,82
apache_knox,org.apache.knox.gateway.websockets,WebsocketServerInitiatedMessageTest,testGatewayServerInitiatedEcho,Magic Number,The method contains a magic number: 5000,84
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getGatewayProvidersConfigDir()).andReturn(topoDir.getAbsolutePath() + "/shared-providers").anyTimes();" is 132.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getGatewayDescriptorsDir()).andReturn(topoDir.getAbsolutePath() + "/descriptors").anyTimes();" is 123.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxTextMessageSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_SIZE).anyTimes();" is 144.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxBinaryMessageSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_SIZE).anyTimes();" is 148.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxTextMessageBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_BUFFER_SIZE).anyTimes();" is 157.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxBinaryMessageBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_BUFFER_SIZE).anyTimes();" is 161.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketInputBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_INPUT_BUFFER_SIZE).anyTimes();" is 137.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketAsyncWriteTimeout()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_ASYNC_WRITE_TIMEOUT).anyTimes();" is 141.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketIdleTimeout()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_IDLE_TIMEOUT).anyTimes();" is 128.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxWaitBufferCount()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_WAIT_BUFFER_COUNT).anyTimes();" is 144.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getIdentityKeystorePasswordAlias()).andReturn(DEFAULT_IDENTITY_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 129.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getIdentityKeyPassphraseAlias()).andReturn(DEFAULT_IDENTITY_KEY_PASSPHRASE_ALIAS).anyTimes();" is 123.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getSigningKeystorePasswordAlias()).andReturn(DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 127.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getSigningKeyPassphraseAlias()).andReturn(DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 121.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreType()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_TYPE).anyTimes();" is 122.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreAlgorithm()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_ALG).anyTimes();" is 126.,214
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTestBase,createKnoxTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("service").addTag("role").addText("WEBSOCKET").addTag("url").addText(backend).gotoParent().gotoRoot();" is 161.,368
apache_knox,org.apache.knox.gateway.websockets,BadBackendTest,testBadBackEnd,Long Statement,The length of the statement "Assert.assertThat(client.close.getCloseCode().getCode()`CoreMatchers.is(CloseReason.CloseCodes.UNEXPECTED_CONDITION.getCode()));" is 128.,64
apache_knox,org.apache.knox.gateway.websockets,BadBackendTest,testBadBackEnd,Magic Number,The method contains a magic number: 8000,64
apache_knox,org.apache.knox.gateway.websockets,BadBackendTest,testBadBackEnd,Magic Number,The method contains a magic number: 5000,64
apache_knox,org.apache.knox.gateway.websockets,BadBackendTest,startProxy,Long Statement,The length of the statement "final BigEchoSocketHandler wsHandler=new BigEchoSocketHandler(new ProxyWebSocketAdapter(new URI(BAD_BACKEND)`Executors.newFixedThreadPool(10)`gatewayConfig));" is 158.,81
apache_knox,org.apache.knox.gateway.websockets,BadBackendTest,startProxy,Magic Number,The method contains a magic number: 10,81
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageTooBig,Magic Number,The method contains a magic number: 8000,73
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageTooBig,Magic Number,The method contains a magic number: 66001,73
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageTooBig,Magic Number,The method contains a magic number: 1000,73
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageBiggerThanDefault,Magic Number,The method contains a magic number: 8000,90
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageBiggerThanDefault,Magic Number,The method contains a magic number: 66000,90
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageBiggerThanDefault,Magic Number,The method contains a magic number: 1000,90
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageOk,Magic Number,The method contains a magic number: 8000,115
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,testMessageOk,Magic Number,The method contains a magic number: 1000,115
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,startProxy,Long Statement,The length of the statement "final BigEchoSocketHandler wsHandler=new BigEchoSocketHandler(new ProxyWebSocketAdapter(serverUri`Executors.newFixedThreadPool(10)`gatewayConfig));" is 147.,156
apache_knox,org.apache.knox.gateway.websockets,MessageFailureTest,startProxy,Magic Number,The method contains a magic number: 10,156
apache_knox,org.apache.knox.gateway.websockets,ProxyInboundClientTest,testBinarymessage,Long Statement,The length of the statement "Assert.assertEquals("Binary message does not match"`textMessage`new String(receivedBinaryMessage`StandardCharsets.UTF_8));" is 122.,146
apache_knox,org.apache.knox.gateway.websockets,ProxyInboundClientTest,testBinarymessage,Magic Number,The method contains a magic number: 3000,146
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoHandler,configure,Magic Number,The method contains a magic number: 2,33
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoHandler,configure,Magic Number,The method contains a magic number: 1024,33
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoHandler,configure,Magic Number,The method contains a magic number: 1024,33
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,testMultipleConnections,Magic Number,The method contains a magic number: 50,151
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,startWebsocketServer,Magic Number,The method contains a magic number: 254,184
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,startGatewayServer,Magic Number,The method contains a magic number: 254,212
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getGatewayProvidersConfigDir()).andReturn(topoDir.getAbsolutePath() + "/shared-providers").anyTimes();" is 132.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getGatewayDescriptorsDir()).andReturn(topoDir.getAbsolutePath() + "/descriptors").anyTimes();" is 123.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxTextMessageSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_SIZE).anyTimes();" is 144.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxBinaryMessageSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_SIZE).anyTimes();" is 148.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxTextMessageBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_BUFFER_SIZE).anyTimes();" is 157.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxBinaryMessageBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_BUFFER_SIZE).anyTimes();" is 161.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketInputBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_INPUT_BUFFER_SIZE).anyTimes();" is 137.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketAsyncWriteTimeout()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_ASYNC_WRITE_TIMEOUT).anyTimes();" is 141.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketIdleTimeout()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_IDLE_TIMEOUT).anyTimes();" is 128.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxWaitBufferCount()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_WAIT_BUFFER_COUNT).anyTimes();" is 144.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getIdentityKeystorePasswordAlias()).andReturn(DEFAULT_IDENTITY_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 129.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getIdentityKeyPassphraseAlias()).andReturn(DEFAULT_IDENTITY_KEY_PASSPHRASE_ALIAS).anyTimes();" is 123.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getSigningKeystorePasswordAlias()).andReturn(DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 127.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getSigningKeyPassphraseAlias()).andReturn(DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 121.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreType()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_TYPE).anyTimes();" is 122.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreAlgorithm()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_ALG).anyTimes();" is 126.,247
apache_knox,org.apache.knox.gateway.websockets,WebsocketMultipleConnectionTest,createKnoxTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("service").addTag("role").addText("WEBSOCKET").addTag("url").addText(backend).gotoParent().gotoRoot();" is 161.,401
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoHTTPServiceRoleTest,testGatewayRewriteHttpEcho,Long Statement,The length of the statement "Session session=container.connectToServer(client`new URI(serverUri.toString() + "gateway/websocket/123foo456bar/channels"));" is 124.,75
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoHTTPServiceRoleTest,testGatewayRewriteHttpEcho,Magic Number,The method contains a magic number: 1000,75
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTest,testDirectEcho,Magic Number,The method contains a magic number: 1000,74
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTest,testGatewayEcho,Magic Number,The method contains a magic number: 1000,89
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTest,testGatewayRewriteEcho,Long Statement,The length of the statement "Session session=container.connectToServer(client`new URI(serverUri.toString() + "gateway/websocket/123foo456bar/channels"));" is 124.,106
apache_knox,org.apache.knox.gateway.websockets,WebsocketEchoTest,testGatewayRewriteEcho,Magic Number,The method contains a magic number: 1000,106
apache_knox,org.apache.knox.gateway.websockets,WebsocketServerInitiatedPingTest,testGatewayServerInitiatedPing,Magic Number,The method contains a magic number: 10000,86
apache_knox,org.apache.knox.gateway.websockets,WebsocketClient,awaitClose,Empty catch clause,The method has an empty catch block.,92
apache_knox,org.apache.knox.gateway.websockets,WebsocketClient,awaitClose,Magic Number,The method contains a magic number: 10,92
apache_knox,org.apache.knox.gateway.websockets,ConnectionDroppedTest,testDroppedConnection,Magic Number,The method contains a magic number: 1000,75
apache_knox,org.apache.knox.gateway.websockets,ConnectionDroppedTest,startProxy,Long Statement,The length of the statement "final BigEchoSocketHandler wsHandler=new BigEchoSocketHandler(new ProxyWebSocketAdapter(serverUri`Executors.newFixedThreadPool(10)`gatewayConfig));" is 147.,116
apache_knox,org.apache.knox.gateway.websockets,ConnectionDroppedTest,startProxy,Magic Number,The method contains a magic number: 10,116
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,testBadUrl,Long Statement,The length of the statement "Assert.assertThat(client.close.getCloseCode().getCode()`CoreMatchers.is(CloseReason.CloseCodes.UNEXPECTED_CONDITION.getCode()));" is 128.,137
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,testBadUrl,Magic Number,The method contains a magic number: 5000,137
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getGatewayProvidersConfigDir()).andReturn(topoDir.getAbsolutePath() + "/shared-providers").anyTimes();" is 132.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getGatewayDescriptorsDir()).andReturn(topoDir.getAbsolutePath() + "/descriptors").anyTimes();" is 123.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxTextMessageSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_SIZE).anyTimes();" is 144.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxBinaryMessageSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_SIZE).anyTimes();" is 148.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxTextMessageBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_TEXT_MESSAGE_BUFFER_SIZE).anyTimes();" is 157.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketMaxBinaryMessageBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_MAX_BINARY_MESSAGE_BUFFER_SIZE).anyTimes();" is 161.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketInputBufferSize()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_INPUT_BUFFER_SIZE).anyTimes();" is 137.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketAsyncWriteTimeout()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_ASYNC_WRITE_TIMEOUT).anyTimes();" is 141.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getWebsocketIdleTimeout()).andReturn(GatewayConfigImpl.DEFAULT_WEBSOCKET_IDLE_TIMEOUT).anyTimes();" is 128.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getIdentityKeystorePasswordAlias()).andReturn(DEFAULT_IDENTITY_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 129.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getIdentityKeyPassphraseAlias()).andReturn(DEFAULT_IDENTITY_KEY_PASSPHRASE_ALIAS).anyTimes();" is 123.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getSigningKeystorePasswordAlias()).andReturn(DEFAULT_SIGNING_KEYSTORE_PASSWORD_ALIAS).anyTimes();" is 127.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getSigningKeyPassphraseAlias()).andReturn(DEFAULT_SIGNING_KEY_PASSPHRASE_ALIAS).anyTimes();" is 121.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreType()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_TYPE).anyTimes();" is 122.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,setupGatewayConfig,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getCredentialStoreAlgorithm()).andReturn(GatewayConfig.DEFAULT_CREDENTIAL_STORE_ALG).anyTimes();" is 126.,191
apache_knox,org.apache.knox.gateway.websockets,BadUrlTest,createKnoxTopology,Long Statement,The length of the statement "return XMLDoc.newDocument(true).addRoot("topology").addTag("service").addTag("role").addText("WEBSOCKET").addTag("url").addText(backend).gotoParent().gotoRoot();" is 161.,339
apache_knox,org.apache.knox.gateway.topology.discovery.test.extension,PropertiesFileServiceDiscovery,discover,Complex Method,Cyclomatic complexity of the method is 11,49
apache_knox,org.apache.knox.gateway.topology.discovery.test.extension,PropertiesFileServiceDiscovery,discover,Long Statement,The length of the statement "result.put(clusterName`new PropertiesFileServiceDiscovery.Cluster(clusterName`clusterURLs.get(clusterName)`clusterProperties.get(clusterName)));" is 144.,49
apache_knox,org.apache.knox.gateway.topology.discovery.test.extension,PropertiesFileServiceDiscovery,discover,Magic Number,The method contains a magic number: 3,49
apache_knox,org.apache.knox.gateway.topology.discovery.test.extension,PropertiesFileServiceDiscovery,discover,Magic Number,The method contains a magic number: 2,49
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testGetTopologies,Magic Number,The method contains a magic number: 2,108
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testGetTopologies,Magic Number,The method contains a magic number: 2L,108
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testGetTopologies,Magic Number,The method contains a magic number: 2,108
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testSimpleDescriptorsTopologyGeneration,Long Statement,The length of the statement "File provCfgFile=createFile(sharedProvidersDir`"ambari-cluster-policy.xml"`"org/apache/knox/gateway/topology/file/ambari-cluster-policy.xml"`System.currentTimeMillis());" is 169.,222
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testSimpleDescriptorsTopologyGeneration,Long Statement,The length of the statement "File simpleDesc=createFile(descriptorsDir`"four.json"`"org/apache/knox/gateway/topology/file/simple-topology-four.json"`System.currentTimeMillis());" is 148.,222
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testSimpleDescriptorsTopologyGeneration,Long Statement,The length of the statement "simpleDesc=createFile(descriptorsDir`"four.json"`"org/apache/knox/gateway/topology/file/simple-descriptor-five.json"`System.currentTimeMillis());" is 145.,222
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testSimpleDescriptorsTopologyGeneration,Long Statement,The length of the statement "simpleDesc=createFile(descriptorsDir`"deleteme.json"`"org/apache/knox/gateway/topology/file/simple-descriptor-five.json"`System.currentTimeMillis());" is 149.,222
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testSimpleDescriptorsTopologyGeneration,Magic Number,The method contains a magic number: 10,222
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testSimpleDescriptorsTopologyGeneration,Magic Number,The method contains a magic number: 6,222
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologiesUpdateFromProviderConfigChange,Long Statement,The length of the statement "createFile(sharedProvidersDir`"provider-config-one.xml"`"org/apache/knox/gateway/topology/file/provider-config-one.xml"`System.currentTimeMillis());" is 148.,347
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologiesUpdateFromProviderConfigChange,Long Statement,The length of the statement "File simpleDesc=createFile(descriptorsDir`"six.json"`"org/apache/knox/gateway/topology/file/simple-descriptor-six.json"`System.currentTimeMillis());" is 148.,347
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologiesUpdateFromProviderConfigChange,Long Statement,The length of the statement "assertFalse("The Shiro provider is disabled in provider-config-one.xml"`topology.getProvider("authentication"`"ShiroProvider").isEnabled());" is 140.,347
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologiesUpdateFromProviderConfigChange,Long Statement,The length of the statement "File providerConfig=createFile(sharedProvidersDir`"provider-config-one.xml"`"org/apache/knox/gateway/topology/file/ambari-cluster-policy.xml"`System.currentTimeMillis());" is 170.,347
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologiesUpdateFromProviderConfigChange,Long Statement,The length of the statement "assertTrue("The Shiro provider is enabled in ambari-cluster-policy.xml"`topology.getProvider("authentication"`"ShiroProvider").isEnabled());" is 140.,347
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologiesUpdateFromProviderConfigChange,Long Statement,The length of the statement "assertTrue("The Shiro provider is enabled in ambari-cluster-policy.xml"`topology.getProvider("authentication"`"ShiroProvider").isEnabled());" is 140.,347
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "boolean isDeployed=ts.deployProviderConfiguration(provConfOne`FileUtils.readFileToString(new File(ClassLoader.getSystemResource("org/apache/knox/gateway/topology/file/provider-config-one.xml").toURI())`StandardCharsets.UTF_8));" is 227.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "isDeployed=ts.deployProviderConfiguration(provConfTwo`FileUtils.readFileToString(new File(ClassLoader.getSystemResource("org/apache/knox/gateway/topology/file/ambari-cluster-policy.xml").toURI())`StandardCharsets.UTF_8));" is 221.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "isDeployed=ts.deployDescriptor(simpleDescName`FileUtils.readFileToString(new File(ClassLoader.getSystemResource("org/apache/knox/gateway/topology/file/simple-descriptor-six.json").toURI())`StandardCharsets.UTF_8));" is 214.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "assertFalse("Should not be able to delete a provider configuration that is referenced by one or more descriptors"`ts.deleteProviderConfiguration(FilenameUtils.getBaseName(provConfOne)));" is 186.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "isDeployed=ts.deployDescriptor(simpleDescName`FileUtils.readFileToString(new File(ClassLoader.getSystemResource("org/apache/knox/gateway/topology/file/simple-descriptor-five.json").toURI())`StandardCharsets.UTF_8));" is 215.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "assertTrue("Should be able to delete the provider configuration` now that it's not referenced by any descriptors"`ts.deleteProviderConfiguration(FilenameUtils.getBaseName(provConfOne)));" is 186.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "assertFalse("Should not be able to delete a provider configuration that is referenced by one or more descriptors"`ts.deleteProviderConfiguration(FilenameUtils.getBaseName(provConfTwo)));" is 186.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Long Statement,The length of the statement "assertTrue("Should be able to delete the provider configuration` now that it's not referenced by any descriptors"`ts.deleteProviderConfiguration(FilenameUtils.getBaseName(provConfTwo)));" is 186.,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testConfigurationCRUDAPI,Magic Number,The method contains a magic number: 2,446
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testProviderParamsOrderIsPreserved,Long Statement,The length of the statement "String[] names={"ldapRealm="`"ldapContextFactory"`"ldapRealm.contextFactory"`"ldapGroupRealm"`"ldapGroupRealm.contextFactory"`"ldapGroupRealm.contextFactory.systemAuthenticationMechanism"};" is 189.,595
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologyDiscoveryTriggerHandlesInvalidDescriptorContent,Long Statement,The length of the statement "createFile(sharedProvidersDir`"provider-config-one.xml"`"org/apache/knox/gateway/topology/file/provider-config-one.xml"`System.currentTimeMillis());" is 148.,627
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologyDiscoveryTriggerHandlesInvalidDescriptorContent,Long Statement,The length of the statement "File validDescriptorFile=createFile(descriptorsDir`"valid-descriptor.json"`"org/apache/knox/gateway/topology/file/simple-descriptor-six.json"`System.currentTimeMillis() - TimeUnit.HOURS.toMillis(1));" is 199.,627
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologyDiscoveryTriggerHandlesInvalidDescriptorContent,Long Statement,The length of the statement "File invalidDescriptorFile=createFile(descriptorsDir`"invalid-descriptor.json"`new ByteArrayInputStream(invalidDescriptorContent.getBytes(StandardCharsets.UTF_8))`System.currentTimeMillis() - TimeUnit.MINUTES.toMillis(45));" is 223.,627
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologyDiscoveryTriggerHandlesInvalidDescriptorContent,Long Statement,The length of the statement "assertEquals("Expected the invalid descriptor file's timestamp to have remained unchanged."`initialInvalidTimestamp`invalidDescriptorFile.lastModified());" is 154.,627
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologyDiscoveryTriggerHandlesInvalidDescriptorContent,Long Statement,The length of the statement "assertTrue("Expected the timestamp of the valid descriptor to have been updated."`(initialValidTimestamp < validDescriptorFile.lastModified()));" is 144.,627
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologyDiscoveryTriggerHandlesInvalidDescriptorContent,Magic Number,The method contains a magic number: 45,627
apache_knox,org.apache.knox.gateway.services.topology,DefaultTopologyServiceTest,testTopologyRedeployment,Long Statement,The length of the statement "createFile(topologyDir`topologyFileName`"org/apache/knox/gateway/topology/file/topology-one.xml"`topologyDir.lastModified());" is 125.,734
apache_knox,org.apache.knox.gateway.services.security,CryptoServiceTest,setupSuite,Long Statement,The length of the statement "@Override public void addAliasesForCluster( String clusterName` Map<String`String> credentials) throws AliasServiceException {" is 126.,45
apache_knox,org.apache.knox.gateway.services.security,CryptoServiceTest,testCryptoServiceAES,Long Statement,The length of the statement "assertEquals(queryString.getBytes(StandardCharsets.UTF_8).length`new String(decrypted0`StandardCharsets.UTF_8).toCharArray().length);" is 133.,145
apache_knox,org.apache.knox.gateway.services.security,CryptoServiceTest,testCryptoServiceDES,Long Statement,The length of the statement "assertEquals(queryString.getBytes(StandardCharsets.UTF_8).length`new String(decrypted0`StandardCharsets.UTF_8).toCharArray().length);" is 133.,168
apache_knox,org.apache.knox.gateway.services.security,CryptoServiceTest,testConfigurableEncryptor,Long Statement,The length of the statement "ConfigurableEncryptor aes3=new ConfigurableEncryptor(new String(as.getPasswordFromAliasForCluster("test"`"encrypt_url")));" is 122.,191
apache_knox,org.apache.knox.gateway.services.security,CryptoServiceTest,testConfigurableEncryptor,Long Statement,The length of the statement "ConfigurableEncryptor aes4=new ConfigurableEncryptor(new String(as.getPasswordFromAliasForCluster("test"`"encrypt_url")));" is 122.,191
apache_knox,org.apache.knox.gateway.services.security,CryptoServiceTest,testEncryptionOfQueryStrings,Magic Number,The method contains a magic number: 16,229
apache_knox,org.apache.knox.gateway.services.security,EncryptionResult,toByteAray,Magic Number,The method contains a magic number: 12,36
apache_knox,org.apache.knox.gateway.services.security,CryptoService,decryptForCluster,Long Parameter List,The method has 5 parameters. ,29
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,HashicorpVaultAliasService,generateAliasForCluster,Magic Number,The method contains a magic number: 16,162
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,HashicorpVaultAliasService,init,Long Identifier,The length of the identifier remoteAliasServiceConfiguration is 31.,202
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,HashicorpVaultAliasService,getClientAuthentication,Long Statement,The length of the statement "ServiceLoader<HashicorpVaultClientAuthenticationProvider> providers=ServiceLoader.load(HashicorpVaultClientAuthenticationProvider.class);" is 137.,243
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,setUpClass,Long Statement,The length of the statement "vaultAddress=String.format(Locale.ROOT`"http://%s:%s"`vaultContainer.getContainerIpAddress()`vaultContainer.getMappedPort(vaultPort));" is 134.,68
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,setUp,Magic Number,The method contains a magic number: 100,89
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,setupVaultSecretsEngine,Long Statement,The length of the statement "Container.ExecResult execResult=vaultContainer.execInContainer("vault"`"secrets"`"enable"`"-path=" + vaultSecretsEngine`"-version=2"`"kv");" is 139.,96
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,getKnoxToken,Long Statement,The length of the statement "Container.ExecResult tokenCreationExecResult=vaultContainer.execInContainer("vault"`"token"`"create"`"-policy=" + getVaultPolicy()`"-field=token");" is 147.,123
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegration,Long Identifier,The length of the identifier remoteAliasServiceConfiguration is 31.,141
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegration,Long Statement,The length of the statement "remoteAliasServiceConfiguration.put(HashicorpVaultClientAuthenticationProvider.AUTHENTICATION_TYPE_KEY`TokenHashicorpVaultClientAuthenticationProvider.TYPE);" is 157.,141
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegration,Long Statement,The length of the statement "remoteAliasServiceConfiguration.put(TokenHashicorpVaultClientAuthenticationProvider.TOKEN_KEY`getKnoxToken(ThreadLocalRandom.current().nextBoolean()));" is 151.,141
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegration,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getRemoteAliasServiceConfiguration()).andReturn(remoteAliasServiceConfiguration).anyTimes();" is 122.,141
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegration,Magic Number,The method contains a magic number: 100,141
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegration,Magic Number,The method contains a magic number: 100,141
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegration,Magic Number,The method contains a magic number: 100,141
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegrationPermissions,Long Identifier,The length of the identifier remoteAliasServiceConfiguration is 31.,190
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegrationPermissions,Long Statement,The length of the statement "remoteAliasServiceConfiguration.put(HashicorpVaultClientAuthenticationProvider.AUTHENTICATION_TYPE_KEY`TokenHashicorpVaultClientAuthenticationProvider.TYPE);" is 157.,190
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegrationPermissions,Long Statement,The length of the statement "EasyMock.expect(gatewayConfig.getRemoteAliasServiceConfiguration()).andReturn(remoteAliasServiceConfiguration).anyTimes();" is 122.,190
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegrationPermissions,Magic Number,The method contains a magic number: 100,190
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegrationPermissions,Magic Number,The method contains a magic number: 100,190
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,testVaultIntegrationPermissions,Magic Number,The method contains a magic number: 100,190
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,generatePathPrefix,Magic Number,The method contains a magic number: 10,253
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,generatePathPrefix,Magic Number,The method contains a magic number: 10,253
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,setupVaultPolicy,Long Statement,The length of the statement "String policy="path \"" + vaultSecretsEngine + pathPrefix+ "*\" {\n"+ " capabilities = [\"create\"` \"read\"` \"update\"` \"delete\"` \"list\"]\n"+ "}";" is 152.,265
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault,TestHashicorpVaultAliasService,cleanupVaultPolicy,Empty catch clause,The method has an empty catch block.,278
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault.authentication,TokenHashicorpVaultClientAuthenticationProvider,getVaultToken,Magic Number,The method contains a magic number: 8,43
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault.authentication,KubernetesHashicorpVaultClientAuthenticationProvider,newInstance,Long Identifier,The length of the identifier kubernetesAuthenticationOptions is 31.,48
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault.authentication,KubernetesHashicorpVaultClientAuthenticationProvider,newInstance,Long Statement,The length of the statement "KubernetesAuthenticationOptions kubernetesAuthenticationOptions=KubernetesAuthenticationOptions.builder().role(role).build();" is 125.,48
apache_knox,org.apache.knox.gateway.backend.hashicorp.vault.authentication,KubernetesHashicorpVaultClientAuthenticationProvider,getRestOperations,Long Statement,The length of the statement "ClientHttpRequestFactory clientHttpRequestFactory=ClientHttpRequestFactoryFactory.create(clientOptions`sslConfiguration);" is 121.,58
apache_knox,org.apache.knox.gateway.topology,Service,equals,Long Statement,The length of the statement "return (new EqualsBuilder()).append(name`that.name).append(role`that.role).append(version`that.version).append(getUrls().stream().sorted().collect(Collectors.toList())`that.getUrls().stream().sorted().collect(Collectors.toList())).append(params`that.params).build();" is 266.,122
apache_knox,org.apache.knox.gateway.topology,Service,hashCode,Magic Number,The method contains a magic number: 17,137
apache_knox,org.apache.knox.gateway.topology,Service,hashCode,Magic Number,The method contains a magic number: 31,137
apache_knox,org.apache.knox.gateway.topology,Version,parseVersion,Magic Number,The method contains a magic number: 2,71
apache_knox,org.apache.knox.gateway.topology,Version,parseVersion,Magic Number,The method contains a magic number: 3,71
apache_knox,org.apache.knox.gateway.topology,Version,parseVersion,Magic Number,The method contains a magic number: 2,71
apache_knox,org.apache.knox.gateway.topology,Version,equals,Complex Conditional,The conditional expression major == that.getMajor() && minor == that.getMinor() && patch == that.getPatch() is complex.,117
apache_knox,org.apache.knox.gateway.topology,Topology,hashCode,Long Statement,The length of the statement "return (new HashCodeBuilder(17`31)).append(name).append(providerList.stream().sorted(providerComparator).collect(Collectors.toList())).append(services.stream().sorted(serviceComparator).collect(Collectors.toList())).append(applications.stream().sorted(appComparator).collect(Collectors.toList())).append(getRedeployTime()).build();" is 331.,173
apache_knox,org.apache.knox.gateway.topology,Topology,hashCode,Magic Number,The method contains a magic number: 17,173
apache_knox,org.apache.knox.gateway.topology,Topology,hashCode,Magic Number,The method contains a magic number: 31,173
apache_knox,org.apache.knox.gateway.topology,Topology,equals,Complex Method,Cyclomatic complexity of the method is 8,183
apache_knox,org.apache.knox.gateway.topology,Provider,equals,Long Statement,The length of the statement "return (new EqualsBuilder()).append(name`other.name).append(role`other.role).append(params`other.params).append(enabled`other.enabled).build();" is 143.,97
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 2,35
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 3,35
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 4,35
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 5,35
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 6,35
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 4,35
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 5,35
apache_knox,org.apache.knox.gateway.topology,VersionTest,testVersion,Magic Number,The method contains a magic number: 6,35
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testTopologiesAreEqual,Magic Number,The method contains a magic number: 2,243
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testTopologiesAreEqual,Magic Number,The method contains a magic number: 2,243
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testTopologiesAreEqual,Magic Number,The method contains a magic number: 2,243
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testSameTopologiesNoApps,Magic Number,The method contains a magic number: 2,248
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testSameTopologiesNoApps,Magic Number,The method contains a magic number: 2,248
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testSameTopologiesNoProviders,Magic Number,The method contains a magic number: 2,253
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testSameTopologiesNoProviders,Magic Number,The method contains a magic number: 2,253
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testSameTopologiesNoServices,Magic Number,The method contains a magic number: 2,258
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testSameTopologiesNoServices,Magic Number,The method contains a magic number: 2,258
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentAppCount,Long Statement,The length of the statement "assertFalse("Expected inequality because there are a different number of applications."`doTestApplicationEquality(apps.get(0)`modifiedApps));" is 141.,263
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentAppCount,Magic Number,The method contains a magic number: 2,263
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentAppURLCount,Long Statement,The length of the statement "assertFalse("Expected inequality because there are different number of application URLs."`doTestApplicationEquality(a1`a2));" is 124.,294
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentAppParamCount,Long Statement,The length of the statement "assertFalse("Expected inequality because there are different number of application params."`doTestApplicationEquality(a1`a2));" is 126.,325
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentAppParamValues,Long Statement,The length of the statement "assertFalse("Expected inequality because there are different application param values."`doTestApplicationEquality(a1`a2));" is 122.,346
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentServiceURLCount,Long Statement,The length of the statement "Service s2=createService(serviceName`serviceRole`Arrays.asList(serviceURL`serviceURL + "/other")`Collections.emptyMap());" is 121.,393
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentServiceURLValues,Long Statement,The length of the statement "Service s2=createService(serviceName`serviceRole`Collections.singletonList(serviceURL + "/other")`Collections.emptyMap());" is 122.,407
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentProviderCount,Long Statement,The length of the statement "assertFalse("Expected inequality because there are a different number of providers."`doTestProviderEquality(Collections.singletonList(p1)`Arrays.asList(p2`p1)));" is 161.,461
apache_knox,org.apache.knox.gateway.topology,TopologyTest,testDifferentProviderParamCount,Long Statement,The length of the statement "assertFalse("Expected inequality because there are a different number of provider params."`doTestProviderEquality(p1`p2));" is 122.,484
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestSameTopologies,Long Statement,The length of the statement "List<List<Provider>> providers=createProviderLists(providerName`providerRole`providerParamName`providerParamValue`providerCount);" is 129.,520
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestSameTopologies,Long Statement,The length of the statement "final List<List<Service>> services=createServiceLists(serviceName`serviceRole`serviceParamName`serviceParamValue`serviceURL`serviceCount);" is 138.,520
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestSameTopologies,Long Statement,The length of the statement "boolean isEqual=doTestEquals(!providers.isEmpty() ? providers.get(0) : Collections.emptyList()`providers.size() > 1 ? providers.get(1) : Collections.emptyList()`!services.isEmpty() ? services.get(0) : Collections.emptyList()`services.size() > 1 ? services.get(1) : Collections.emptyList()`!apps.isEmpty() ? apps.get(0) : Collections.emptyList()`apps.size() > 1 ? apps.get(1) : Collections.emptyList());" is 402.,520
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestApplicationEquality,Long Statement,The length of the statement "return doTestEquals(Collections.emptyList()`Collections.emptyList()`Collections.emptyList()`Collections.emptyList()`apps1`apps2);" is 129.,556
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestServiceEquality,Long Statement,The length of the statement "return doTestEquals(Collections.emptyList()`Collections.emptyList()`svcs1`svcs2`Collections.emptyList()`Collections.emptyList());" is 129.,571
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestProviderEquality,Long Statement,The length of the statement "return doTestEquals(p1`p2`Collections.emptyList()`Collections.emptyList()`Collections.emptyList()`Collections.emptyList());" is 123.,585
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestEquals,Long Parameter List,The method has 6 parameters. ,595
apache_knox,org.apache.knox.gateway.topology,TopologyTest,doTestEquals,Long Parameter List,The method has 8 parameters. ,616
apache_knox,org.apache.knox.gateway.topology,TopologyTest,createTopology,Long Parameter List,The method has 5 parameters. ,656
apache_knox,org.apache.knox.gateway.topology,TopologyTest,createProviderLists,Long Parameter List,The method has 5 parameters. ,671
apache_knox,org.apache.knox.gateway.topology,TopologyTest,createServiceLists,Long Parameter List,The method has 6 parameters. ,689
apache_knox,org.apache.knox.gateway.topology,TopologyTest,createAppLists,Long Parameter List,The method has 6 parameters. ,708
apache_knox,org.apache.knox.gateway.dto,HomePageProfileTest,testEmptyConfiguration,Magic Number,The method contains a magic number: 7,32
apache_knox,org.apache.knox.gateway.dto,HomePageProfileTest,testTokenProfileElements,Long Statement,The length of the statement "assertTrue(tokenProfileElements.containsAll(Arrays.asList(HomePageProfile.GPI_VERSION`HomePageProfile.GPI_CERT`HomePageProfile.GPI_TOKENS)));" is 141.,75
apache_knox,org.apache.knox.gateway.dto,HomePageProfileTest,testTokenProfileElements,Magic Number,The method contains a magic number: 3,75
apache_knox,org.apache.knox.gateway.filter.security,AbstractIdentityAssertionFilter,loadPrincipalMappings,Complex Conditional,The conditional expression principalMapping != null && !principalMapping.isEmpty() || groupMapping != null && !groupMapping.isEmpty() is complex.,47
apache_knox,org.apache.knox.gateway.filter.security,AbstractIdentityAssertionFilter,setSignatureAlgorithm,Long Statement,The length of the statement "final GatewayServices services=(GatewayServices)filterConfig.getServletContext().getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE);" is 138.,67
apache_knox,org.apache.knox.gateway.filter.security,AbstractIdentityAssertionFilter,setSignatureAlgorithm,Long Statement,The length of the statement "final GatewayConfig gatewayConfig=(GatewayConfig)filterConfig.getServletContext().getAttribute(GatewayConfig.GATEWAY_CONFIG_ATTRIBUTE);" is 135.,67
apache_knox,org.apache.knox.gateway.filter.security,AbstractIdentityAssertionFilter,setSignatureAlgorithm,Long Statement,The length of the statement "this.signatureAlgorithm=TokenUtils.getSignatureAlgorithm(configuredSignatureAlgorithm`aliasService`gatewayConfig.getSigningKeystoreName());" is 139.,67
apache_knox,org.apache.knox.gateway.security.principal,SimplePrincipalMapper,parseMapping,Long Statement,The length of the statement "throw new PrincipalMappingException("Unable to load mappings from provided string: " + mappings + " - no principal mapping will be provided."`e);" is 145.,40
apache_knox,org.apache.knox.gateway.security.principal,PrincipalMapperTest,testSimplePrincipalMappingWithUserAndWildcardAndExplicitGroups,Magic Number,The method contains a magic number: 2,79
apache_knox,org.apache.knox.gateway.security.principal,PrincipalMapperTest,testInvalidSimplePrincipalMapping,Empty catch clause,The method has an empty catch block.,192
apache_knox,org.apache.knox.gateway.security.principal,PrincipalMapperTest,testPartiallyInvalidSimplePrincipalMapping,Empty catch clause,The method has an empty catch block.,213
apache_knox,org.apache.knox.gateway.services.security.token,KnoxToken,KnoxToken,Long Parameter List,The method has 5 parameters. ,42
apache_knox,org.apache.knox.gateway.services.security.token,JWTokenAttributesBuilder,build,Long Statement,The length of the statement "return new JWTokenAttributes(userName`(audiences == null ? new ArrayList<>() : audiences)`algorithm`expires`signingKeystoreName`signingKeystoreAlias`signingKeystorePassphrase`managed`jku`type`groups`kid`issuer);" is 211.,110
apache_knox,org.apache.knox.gateway.services.security.token,JWTokenAttributes,JWTokenAttributes,Long Parameter List,The method has 13 parameters. ,42
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTToken,JWTToken,Long Statement,The length of the statement "header=new JWSHeader(new JWSAlgorithm(jwtAttributes.getAlgorithm())`jwtAttributes.getType() == null ? null : new JOSEObjectType(jwtAttributes.getType())`null`null`jwtAttributes.getJkuUri()`null`null`null`null`null`jwtAttributes.getKid()`null`null);" is 248.,61
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTToken,JWTToken,Long Statement,The length of the statement "JWTClaimsSet.Builder builder=new JWTClaimsSet.Builder().issuer(jwtAttributes.getIssuer()).subject(jwtAttributes.getUserName()).audience(jwtAttributes.getAudiences());" is 166.,61
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTToken,parseToken,Magic Number,The method contains a magic number: 2,163
apache_knox,org.apache.knox.gateway.services.security.token.impl,TokenMAC,TokenMAC,Long Identifier,The length of the field KNOX_TOKEN_HASH_KEY_ALIAS_NAME is 30.,38
apache_knox,org.apache.knox.gateway.services.security.token.impl,TokenMAC,TokenMAC,Long Statement,The length of the statement "throw new ServiceLifecycleException("Missing " + KNOX_TOKEN_HASH_KEY_ALIAS_NAME + " alias from Gateway's credential store");" is 124.,38
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,setUpBeforeClass,Magic Number,The method contains a magic number: 2048,57
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreation,Long Statement,The length of the statement "JWT token=new JWTToken(new JWTokenAttributesBuilder().setAudiences(singletonList("https://login.example.com")).setKid(KID).setUserName("john.doe@example.com").setJku(JKU).setAlgorithm(ALGO).build());" is 199.,74
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testPrivateUUIDClaim,Long Statement,The length of the statement "JWT token=new JWTToken(new JWTokenAttributesBuilder().setAudiences(singletonList("https://login.example.com")).setUserName("john.doe@example.com").setAlgorithm("RS256").build());" is 178.,90
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreationWithAudienceListSingle,Long Statement,The length of the statement "JWT token=new JWTToken(new JWTokenAttributesBuilder().setUserName("john.doe@example.com").setAudiences(audiences).setAlgorithm("RS256").setManaged(false).build());" is 163.,104
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreationWithAudienceListMultiple,Long Statement,The length of the statement "JWT token=new JWTToken(new JWTokenAttributesBuilder().setUserName("john.doe@example.com").setAudiences(audiences).setManaged(false).setAlgorithm("RS256").build());" is 163.,117
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreationWithAudienceListMultiple,Magic Number,The method contains a magic number: 2,117
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreationWithAudienceListCombined,Long Statement,The length of the statement "JWTToken token=new JWTToken(new JWTokenAttributesBuilder().setAudiences(asList("https://login.example.com"`"KNOXSSO"`"LJM")).setUserName("john.doe@example.com").setManaged(false).setAlgorithm("RS256").build());" is 210.,131
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreationWithAudienceListCombined,Magic Number,The method contains a magic number: 3,131
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreationWithNullAudienceList,Long Statement,The length of the statement "JWT token=new JWTToken(new JWTokenAttributesBuilder().setUserName("john.doe@example.com").setAudiences((List<String>)null).setAlgorithm("RS256").setManaged(false).build());" is 172.,140
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenCreationRS512,Long Statement,The length of the statement "JWTToken token=new JWTToken(new JWTokenAttributesBuilder().setAudiences(singletonList("https://login.example.com")).setUserName("john.doe@example.com").setAlgorithm(JWSAlgorithm.RS512.getName()).build());" is 204.,149
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenSignature,Long Statement,The length of the statement "JWT token=new JWTToken(new JWTokenAttributesBuilder().setAudiences(singletonList("https://login.example.com")).setUserName("john.doe@example.com").setAlgorithm("RS256").build());" is 178.,159
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testTokenSignatureRS512,Long Statement,The length of the statement "JWT token=new JWTToken(new JWTokenAttributesBuilder().setAudiences(singletonList("https://login.example.com")).setUserName("john.doe@example.com").setAlgorithm(JWSAlgorithm.RS512.getName()).build());" is 199.,177
apache_knox,org.apache.knox.gateway.services.security.token.impl,JWTTokenTest,testUnsignedToken,Long Statement,The length of the statement "String unsignedToken="eyJhbGciOiJub25lIn0.eyJzdWIiOiJhbGljZSIsImp0aSI6ImY2YmNj" + "MDVjLWI4MTktNGM0Mi1iMGMyLWJlYmY1MDE4YWFiZiJ9.";" is 130.,205
apache_knox,org.apache.knox.gateway.services.hostmap,FileBasedHostMapper,FileBasedHostMapper,Long Statement,The length of the statement "try (InputStream stream=url.openStream();InputStreamReader inputStreamReader=new InputStreamReader(stream`StandardCharsets.UTF_8);BufferedReader reader=new BufferedReader(inputStreamReader)){" is 191.,34
apache_knox,org.apache.knox.gateway.services.hostmap,FileBasedHostMapper,FileBasedHostMapper,Magic Number,The method contains a magic number: 2,34
apache_knox,org.apache.knox.gateway.shirorealm,KnoxPamRealm,doGetAuthenticationInfo,Long Statement,The length of the statement "HashRequest hashRequest=new HashRequest.Builder().setSource(token.getCredentials()).setAlgorithmName(HASHING_ALGORITHM).build();" is 128.,133
apache_knox,org.apache.knox.gateway.shirorealm,KnoxPamRealm,doGetAuthenticationInfo,Long Statement,The length of the statement "return new SimpleAuthenticationInfo(new UnixUserPrincipal(user)`credentialsHash.toHex()`credentialsHash.getSalt()`getName());" is 125.,133
apache_knox,org.apache.knox.gateway.shirorealm,KnoxPamRealm,handleAuthFailure,Long Statement,The length of the statement "auditor.audit(Action.AUTHENTICATION`token.getPrincipal().toString()`ResourceType.PRINCIPAL`ActionOutcome.FAILURE`errorMessage);" is 127.,164
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,doGetAuthenticationInfo,Long Statement,The length of the statement "auditor.audit(Action.AUTHENTICATION`token.getPrincipal().toString()`ResourceType.PRINCIPAL`ActionOutcome.FAILURE`e.getMessage());" is 129.,196
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,rolesFor,Complex Method,Cyclomatic complexity of the method is 9,253
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,rolesFor,Magic Number,The method contains a magic number: 100,253
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,addRoleIfMember,Complex Method,Cyclomatic complexity of the method is 12,330
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,addRoleIfMember,Long Parameter List,The method has 5 parameters. ,330
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,setMemberAttributeValueTemplate,Long Statement,The length of the statement "String msg="Member attribute value template must contain the '" + MEMBER_SUBSTITUTION_TOKEN + "' replacement token to understand how to "+ "parse the group members.";" is 166.,462
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,parsePermissionByRoleString,Magic Number,The method contains a magic number: 2,515
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,isUserMemberOfDynamicGroup,Complex Method,Cyclomatic complexity of the method is 8,538
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,isUserMemberOfDynamicGroup,Long Statement,The length of the statement "searchResultEnum=systemLdapCtx.search(userLdapDn`searchFilter`"sub".equalsIgnoreCase(searchScope) ? SUBTREE_SCOPE : ONELEVEL_SCOPE);" is 132.,538
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,isUserMemberOfDynamicGroup,Magic Number,The method contains a magic number: 4,538
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,isUserMemberOfDynamicGroup,Magic Number,The method contains a magic number: 2,538
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,isUserMemberOfDynamicGroup,Magic Number,The method contains a magic number: 3,538
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,getUserDn,Complex Conditional,The conditional expression (userSearchBase == null || userSearchBase.isEmpty()) || (userSearchAttributeName == null && userSearchFilter == null && !"object".equalsIgnoreCase(userSearchScope)) is complex.,660
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,getUserDn,Empty catch clause,The method has an empty catch block.,660
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,getUserDn,Long Statement,The length of the statement "if ((userSearchBase == null || userSearchBase.isEmpty()) || (userSearchAttributeName == null && userSearchFilter == null && !"object".equalsIgnoreCase(userSearchScope))) {" is 171.,660
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,getUserDn,Long Statement,The length of the statement "searchFilter=String.format(Locale.ROOT`"(&(objectclass=%1$s)(%2$s=%3$s))"`getUserObjectClass()`userSearchAttributeName`expandTemplate(getUserSearchAttributeTemplate()`matchedPrincipal));" is 186.,660
apache_knox,org.apache.knox.gateway.shirorealm,KnoxLdapRealm,createAuthenticationInfo,Long Statement,The length of the statement "Hash credentialsHash=hashService.computeHash(builder.setSource(token.getCredentials()).setAlgorithmName(HASHING_ALGORITHM).build());" is 132.,745
apache_knox,org.apache.knox.test,TestUtils,LOG_ENTER,Magic Number,The method contains a magic number: 2,116
apache_knox,org.apache.knox.test,TestUtils,LOG_EXIT,Magic Number,The method contains a magic number: 2,123
apache_knox,org.apache.knox.test,TestUtils,awaitPortOpen,Empty catch clause,The method has an empty catch block.,130
apache_knox,org.apache.knox.test,TestUtils,awaitNon404HttpStatus,Empty catch clause,The method has an empty catch block.,143
apache_knox,org.apache.knox.test,TestUtils,awaitNon404HttpStatus,Magic Number,The method contains a magic number: 404,143
apache_knox,org.apache.knox.test,TestUtils,merge,Long Statement,The length of the statement "final Map<String`Object> propertiesMap=properties.entrySet().stream().collect(Collectors.toMap(e -> String.valueOf(e.getKey())`e -> String.valueOf(e.getValue())`(prev`next) -> next`HashMap::new));" is 196.,166
apache_knox,org.apache.knox.test,TestUtils,waitUntil,Magic Number,The method contains a magic number: 100,202
apache_knox,org.apache.knox.test,TestUtils,waitUntilNextSecond,Magic Number,The method contains a magic number: 1000,221
apache_knox,org.apache.knox.test,TestUtils,execute,Long Statement,The length of the statement "LOG.trace("execute: requestBuffer=[" + new String(requestBuffer.array()`0`requestBuffer.limit()`StandardCharsets.UTF_8) + "]");" is 127.,233
apache_knox,org.apache.knox.test,TestUtils,execute,Long Statement,The length of the statement "LOG.trace("execute: responseBuffer=[" + new String(responseBuffer.array()`0`responseBuffer.limit()`StandardCharsets.UTF_8) + "]");" is 130.,233
apache_knox,org.apache.knox.test,TestUtils,execute,Magic Number,The method contains a magic number: 30,233
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Complex Method,Cyclomatic complexity of the method is 23,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " is not using one of the expected HTTP methods"`methods`hasItem(request.getMethod()));" is 163.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected pathInfo"`request.getPathInfo()`is(pathInfo));" is 151.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected requestURI"`request.getRequestURI()`is(requestURI));" is 157.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected requestURL"`request.getRequestURL().toString()`is(requestURL));" is 168.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected value for header "+ entry.getKey()`request.getHeader(entry.getKey())`entry.getValue());" is 192.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected cookie "+ cookie`requestCookies`hasItem(cookie));" is 154.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected content type"`requestContentType[0]`is(contentType));" is 158.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected character encoding"`request.getCharacterEncoding()`equalToIgnoringCase(characterEncoding));" is 196.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " does not have the expected content length"`request.getContentLength()`is(contentLength));" is 167.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " is missing attribute '"+ name+ "'"`request.getAttribute(name)`notNullValue());" is 156.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " has wrong value for attribute '"+ name+ "'"`request.getAttribute(name)`is(request.getAttribute(name)));" is 181.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " query string "+ queryString+ " is missing parameter '"+ entry.getKey()+ "'"`requestParams`hasItem(new BasicNameValuePair(entry.getKey()`entry.getValue())));" is 234.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " form params "+ paramString+ " is missing a value "+ expectedValue+ " for parameter '"+ entry.getKey()+ "'"`requestParams`hasItem(new BasicNameValuePair(entry.getKey()`expectedValue)));" is 262.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "String actual=IOUtils.toString(request.getInputStream()`actualEncoding == null ? StandardCharsets.UTF_8.name() : actualEncoding);" is 129.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "String actual=IOUtils.toString(request.getInputStream()`actualEncoding == null ? StandardCharsets.UTF_8.name() : actualEncoding);" is 129.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " content does not match the expected content"`bytes`is(entity));" is 141.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Long Statement,The length of the statement "assertThat("Request " + request.getMethod() + " "+ request.getRequestURL()+ " content does not match the expected content"`actual`is(expect));" is 142.,204
apache_knox,org.apache.knox.test.mock,MockRequestMatcher,match,Magic Number,The method contains a magic number: 2,204
apache_knox,org.apache.knox.test.mock,MockResponseProvider,apply,Complex Method,Cyclomatic complexity of the method is 13,115
apache_knox,org.apache.knox.gateway.security.ldap,SimpleLdapDirectoryServer,SimpleLdapDirectoryServer,Long Statement,The length of the statement "Partition partition=factory.getPartitionFactory().createPartition(service.getSchemaManager()`service.getDnFactory()`"users"`rootDn`500`service.getInstanceLayout().getInstanceDirectory());" is 187.,54
apache_knox,org.apache.knox.gateway.security.ldap,SimpleLdapDirectoryServer,SimpleLdapDirectoryServer,Magic Number,The method contains a magic number: 500,54
apache_knox,org.apache.knox.gateway.security.ldap,SimpleLdapDirectoryServer,enabledPosixSchema,Long Statement,The length of the statement "service.getAdminSession().modify(new Dn("cn=nis`ou=schema")`new DefaultModification(ModificationOperation.REPLACE_ATTRIBUTE`"m-disabled"`"FALSE"));" is 147.,109
apache_knox,org.apache.knox.gateway.security.ldap,SimpleLdapServerTest,testBind,Long Statement,The length of the statement "assertEquals("INVALID_CREDENTIALS: Bind failed: ERR_229 " + "Cannot authenticate user uid=nobody`ou=people`dc=hadoop`dc=apache`dc=org"`e.getMessage());" is 151.,58
apache_knox,org.apache.knox.gateway.security.ldap,SimpleLdapServerTest,testBind,Long Statement,The length of the statement "assertEquals("INVALID_CREDENTIALS: Bind failed: ERR_229 " + "Cannot authenticate user uid=guest`ou=people`dc=hadoop`dc=apache`dc=org"`e.getMessage());" is 150.,58
apache_knox,org.apache.knox.gateway.securequery,SecureQueryDecryptProcessor,getUrlRewriteStepStatus,Long Parameter List,The method has 5 parameters. ,69
apache_knox,org.apache.knox.gateway.securequery,SecureQueryDecryptProcessor,getUrlRewriteStepStatus,Long Parameter List,The method has 5 parameters. ,78
apache_knox,org.apache.knox.gateway.securequery,SecureQueryDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,104
apache_knox,org.apache.knox.gateway.securequery,SecureQueryDeploymentContributorTest,testDeployment,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,42
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(as.getPasswordFromAliasForCluster("test-cluster-name"`"encryptQueryString")).andReturn(secret.toCharArray()).anyTimes();" is 136.,46
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,46
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn("test-cluster-name").anyTimes();" is 130.,46
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(as.getPasswordFromAliasForCluster("test-cluster-name"`"encryptQueryString")).andReturn(secret.toCharArray()).anyTimes();" is 136.,46
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(decEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,46
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(decEnvironment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn("test-cluster-name").anyTimes();" is 130.,46
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptDecrypt,Long Statement,The length of the statement "EasyMock.expect(decParams.resolve(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn(Collections.singletonList("test-cluster-name")).anyTimes();" is 147.,46
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "EasyMock.expect(as.getPasswordFromAliasForCluster("test-cluster-name"`"encryptQueryString")).andReturn(secret.toCharArray()).anyTimes();" is 136.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "EasyMock.expect(encEnvironment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn("test-cluster-name").anyTimes();" is 130.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "EasyMock.expect(as.getPasswordFromAliasForCluster("test-cluster-name"`"encryptQueryString")).andReturn(secret.toCharArray()).anyTimes();" is 136.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "EasyMock.expect(decEnvironment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 127.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "EasyMock.expect(decEnvironment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn("test-cluster-name").anyTimes();" is 130.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "EasyMock.expect(decParams.resolve(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn(Collections.singletonList("test-cluster-name")).anyTimes();" is 147.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncryptDecryptProcessorTest,testEncryptBadDecrypt,Long Statement,The length of the statement "SecureQueryDecryptProcessor decProcessor=EasyMock.createMockBuilder(SecureQueryDecryptProcessor.class).addMockedMethod(SecureQueryDecryptProcessor.class.getDeclaredMethod("decode"`String.class)).createMock();" is 208.,113
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncodeProcessorTest,testSimpleQueryEncoding,Long Statement,The length of the statement "EasyMock.expect(as.getPasswordFromAliasForCluster("test-cluster-name"`"encryptQueryString")).andReturn(secret.toCharArray()).anyTimes();" is 136.,41
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncodeProcessorTest,testSimpleQueryEncoding,Long Statement,The length of the statement "EasyMock.expect(environment.getAttribute(GatewayServices.GATEWAY_SERVICES_ATTRIBUTE)).andReturn(gatewayServices).anyTimes();" is 124.,41
apache_knox,org.apache.knox.gateway.securequery,SecureQueryEncodeProcessorTest,testSimpleQueryEncoding,Long Statement,The length of the statement "EasyMock.expect(environment.getAttribute(GatewayServices.GATEWAY_CLUSTER_ATTRIBUTE)).andReturn(Collections.singletonList("test-cluster-name")).anyTimes();" is 154.,41
apache_knox,org.apache.knox.gateway.hadoopauth,HadoopAuthDeploymentContributorTest,testDeployment,Magic Number,The method contains a magic number: 3,64
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthPostFilter,doFilter,Empty catch clause,The method has an empty catch block.,79
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthPostFilter,getPrincipalsAsString,Long Statement,The length of the statement "return String.join("`"`subject.getPrincipals().stream().map(principal -> principal.getName()).collect(Collectors.toSet()));" is 123.,116
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilter,init,Long Identifier,The length of the field HADOOP_AUTH_UNAUTHENTICATED_PATHS_PARAM is 39.,115
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testHadoopAuthFilterAliases,Long Statement,The length of the statement "expect(filterConfig.getInitParameter(anyString())).andAnswer(() -> props.get(getCurrentArguments()[0].toString())).atLeastOnce();" is 129.,74
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testHadoopAuthFilterIgnoreDoAs,Long Statement,The length of the statement "expect(filterConfig.getInitParameterNames()).andReturn(Collections.enumeration(Collections.singleton(GatewayConfig.PROXYUSER_SERVICES_IGNORE_DOAS))).atLeastOnce();" is 163.,120
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testHadoopAuthFilterIgnoreDoAs,Long Statement,The length of the statement "expect(filterConfig.getInitParameter(GatewayConfig.PROXYUSER_SERVICES_IGNORE_DOAS)).andReturn("Knox` hdfs`TesT").atLeastOnce();" is 127.,120
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testHadoopAuthFilterIgnoreDoAs,Long Statement,The length of the statement "HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 175.,120
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testHadoopAuthFilterIgnoreDoAs,Long Statement,The length of the statement "expect(hadoopAuthFilter.getConfiguration(eq("some.prefix.")`eq(filterConfig))).andReturn(configProperties).atLeastOnce();" is 121.,120
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testUnauthenticatedList,Long Statement,The length of the statement "final HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 181.,193
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSemicolon,Long Statement,The length of the statement "expect(filterConfig.getInitParameter("hadoop.auth.unauthenticated.path.list")).andReturn(request_semicolon_path).anyTimes();" is 124.,232
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSemicolon,Long Statement,The length of the statement "EasyMock.expect(request_semicolon.getRequestURL()).andReturn(new StringBuffer(SERVICE_URL + request_semicolon_path)).anyTimes();" is 128.,232
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSemicolon,Long Statement,The length of the statement "final HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 181.,232
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSemicolon,Magic Number,The method contains a magic number: 403,232
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListQuery,Long Statement,The length of the statement "expect(filterConfig.getInitParameter("hadoop.auth.unauthenticated.path.list")).andReturn(request_semicolon_path).anyTimes();" is 124.,290
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListQuery,Long Statement,The length of the statement "EasyMock.expect(request_query.getRequestURL()).andReturn(new StringBuffer(SERVICE_URL + request_semicolon_path)).anyTimes();" is 124.,290
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListQuery,Long Statement,The length of the statement "final HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 181.,290
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListQuery,Magic Number,The method contains a magic number: 403,290
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListAmpersand,Long Statement,The length of the statement "expect(filterConfig.getInitParameter("hadoop.auth.unauthenticated.path.list")).andReturn(request_semicolon_path).anyTimes();" is 124.,348
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListAmpersand,Long Statement,The length of the statement "EasyMock.expect(request_ampersand.getRequestURL()).andReturn(new StringBuffer(SERVICE_URL + request_semicolon_path)).anyTimes();" is 128.,348
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListAmpersand,Long Statement,The length of the statement "final HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 181.,348
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListAmpersand,Magic Number,The method contains a magic number: 403,348
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListDash,Long Statement,The length of the statement "expect(filterConfig.getInitParameter("hadoop.auth.unauthenticated.path.list")).andReturn(request_semicolon_path).anyTimes();" is 124.,406
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListDash,Long Statement,The length of the statement "EasyMock.expect(request_dash.getRequestURL()).andReturn(new StringBuffer(SERVICE_URL + request_semicolon_path)).anyTimes();" is 123.,406
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListDash,Long Statement,The length of the statement "final HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 181.,406
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListDash,Magic Number,The method contains a magic number: 403,406
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSpace,Long Statement,The length of the statement "expect(filterConfig.getInitParameter("hadoop.auth.unauthenticated.path.list")).andReturn(request_semicolon_path).anyTimes();" is 124.,464
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSpace,Long Statement,The length of the statement "EasyMock.expect(request_space.getRequestURL()).andReturn(new StringBuffer(SERVICE_URL + request_semicolon_path)).anyTimes();" is 124.,464
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSpace,Long Statement,The length of the statement "final HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 181.,464
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testNegativeUnauthenticatedListSpace,Magic Number,The method contains a magic number: 403,464
apache_knox,org.apache.knox.gateway.hadoopauth.filter,HadoopAuthFilterTest,testIfJwtSupported,Long Statement,The length of the statement "final HadoopAuthFilter hadoopAuthFilter=createMockBuilder(HadoopAuthFilter.class).addMockedMethod("getConfiguration"`String.class`FilterConfig.class).withConstructor().createMock();" is 181.,550
apache_knox,org.apache.knox.gateway.hadoopauth.deploy,HadoopAuthDeploymentContributor,contributeFilter,Long Identifier,The length of the field HADOOPAUTH_POSTFILTER_CLASSNAME is 31.,52
apache_knox,org.apache.knox.gateway.hadoopauth.deploy,HadoopAuthDeploymentContributor,contributeFilter,Long Parameter List,The method has 5 parameters. ,52
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlImportFunctionProcessor,initialize,Long Statement,The length of the statement "UrlRewriteFunctionDescriptor frontendDescriptor=UrlRewriteFunctionDescriptorFactory.create(FrontendFunctionDescriptor.FUNCTION_NAME);" is 133.,61
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlUrlRewriteFilterReader,HtmlUrlRewriteFilterReader,Long Parameter List,The method has 5 parameters. ,41
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlFilterReaderBase,processText,Complex Conditional,The conditional expression SCRIPTTAG.equals(tagName) && config != null && !config.getSelectors().isEmpty() is complex.,209
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlPostfixProcessor,initialize,Long Statement,The length of the statement "final UrlRewriteFunctionDescriptor frontendDescriptor=UrlRewriteFunctionDescriptorFactory.create(FrontendFunctionDescriptor.FUNCTION_NAME);" is 139.,57
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlInfixProcessor,initialize,Long Statement,The length of the statement "final UrlRewriteFunctionDescriptor frontendDescriptor=UrlRewriteFunctionDescriptorFactory.create(FrontendFunctionDescriptor.FUNCTION_NAME);" is 139.,56
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlUrlRewriteStreamFilter,filter,Long Parameter List,The method has 6 parameters. ,46
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlUrlRewriteStreamFilter,filter,Long Statement,The length of the statement "return new ReaderInputStream(new HtmlUrlRewriteFilterReader(new InputStreamReader(stream`encoding)`rewriter`resolver`direction`config)`encoding);" is 145.,46
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlPrefixProcessor,initialize,Long Statement,The length of the statement "final UrlRewriteFunctionDescriptor frontendDescriptor=UrlRewriteFunctionDescriptorFactory.create(FrontendFunctionDescriptor.FUNCTION_NAME);" is 139.,66
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlFilterReaderBaseTest,testCombined,Long Statement,The length of the statement "String inputXml="<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\n" + "<!-- Comment -->\n" + "<ns1:root xmlns:ns1='http://hortonworks.com/xml/ns1' attr1='attr1-input' ns1:attr2='attr2-input'>\n"+ " root-input1\n"+ " <child1 attr3='attr3-input' ns1:attr4='attr4-input'>\n"+ " child1-input\n"+ " </child1>\n"+ " root-input2\n"+ " <ns2:child2 xmlns:ns2='http://hortonworks.com/xml/ns2' attr5='attr5-input' ns1:attr6='attr6-input' ns2:attr7='attr7-input'>\n"+ " child2-input\n"+ " </ns2:child2>\n"+ " root-input3\n"+ "</ns1:root>";" is 541.,237
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlFilterReaderBaseTest,testMatchedJavaScriptText,Long Statement,The length of the statement "String inputXml="<root>\n" + " <script type=\"text/javascript\">\n" + " var appsTableData=[\n"+ " [\"<a href='/cluster/app/application_1436831599487_0008'>application_1436831599487_0008</a>\"`\"hdfs\"`\"Spark Pi\"`\"SPARK\"`\"<a href='http://testhost:8088/cluster/app/application_1436831599487_0008'>History</a>\"]`\n"+ " [\"<a href='/cluster/app/application_1436831599487_0006'>application_1436831599487_0006</a>\"`\"hdfs\"`\"Spark Pi\"`\"SPARK\"`\"<a href='http://testhost:8088/cluster/app/application_1436831599487_0006'>History</a>\"]`\n"+ " [\"<a href='/cluster/app/application_1436831599487_0007'>application_1436831599487_0007</a>\"`\"hdfs\"`\"Spark Pi\"`\"SPARK\"`\"<a href='http://testhost:8088/cluster/app/application_1436831599487_0007'>History</a>\"]\n"+ " ]\n"+ " </script>\n"+ "</root>\n";" is 803.,302
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlFilterReaderBaseTest,testMatchedJavaScriptText,Long Statement,The length of the statement "String expectedOutput="<root>\n" + " <script type=\"text/javascript\">\n" + " var appsTableData=[\n"+ " [\"<a href='https://knoxhost:8443/cluster/app/application_1436831599487_0008'>application_1436831599487_0008</a>\"`\"hdfs\"`\"Spark Pi\"`\"SPARK\"`\"<a href='https://knoxhost:8443/cluster/app/application_1436831599487_0008'>History</a>\"]`\n"+ " [\"<a href='https://knoxhost:8443/cluster/app/application_1436831599487_0006'>application_1436831599487_0006</a>\"`\"hdfs\"`\"Spark Pi\"`\"SPARK\"`\"<a href='https://knoxhost:8443/cluster/app/application_1436831599487_0006'>History</a>\"]`\n"+ " [\"<a href='https://knoxhost:8443/cluster/app/application_1436831599487_0007'>application_1436831599487_0007</a>\"`\"hdfs\"`\"Spark Pi\"`\"SPARK\"`\"<a href='https://knoxhost:8443/cluster/app/application_1436831599487_0007'>History</a>\"]\n"+ " ]\n"+ " </script>\n"+ "</root>\n";" is 875.,302
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlFilterReaderBaseTest,testMRJobHistoryUIJavaScriptText,Long Statement,The length of the statement "String inputXml="<root>\n" + " <script type=\"text/javascript\">\n" + " var appsTableData=[\n"+ " [\"<a href='http://testhost:8042'>/default-rack/node</a>\"`\"<a href='http://testhost:8042'>testhost:8042</a>\"]`\n"+ " ]\n"+ " </script>\n"+ "</root>\n";" is 252.,336
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.html,HtmlFilterReaderBaseTest,testMRJobHistoryUIJavaScriptText,Long Statement,The length of the statement "String expectedOutput="<root>\n" + " <script type=\"text/javascript\">\n" + " var appsTableData=[\n"+ " [\"<a href='https://knoxhost:8443/gateway/nodemanagerui/node?host=knoxhost'>/default-rack/node</a>\"`\"<a href='https://knoxhost:8443/gateway/nodemanagerui/node?host=knoxhost'>testhost:8042</a>\"]`\n"+ " ]\n"+ " </script>\n"+ "</root>\n";" is 342.,336
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.javascript,JavaScriptUrlRewriteFilterReader,JavaScriptUrlRewriteFilterReader,Long Parameter List,The method has 5 parameters. ,40
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.javascript,JavaScriptUrlRewriteStreamFilter,filter,Long Parameter List,The method has 6 parameters. ,47
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.javascript,JavaScriptUrlRewriteStreamFilter,filter,Long Statement,The length of the statement "return new ReaderInputStream(new JavaScriptUrlRewriteFilterReader(new InputStreamReader(stream`encoding)`rewriter`resolver`direction`config)`encoding);" is 151.,47
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.javascript,JavaScriptFilterReaderTest,testSimpleMultipleLines,Long Statement,The length of the statement "String inputJs="var url = '/webhdfs/v1' + abs_path + '?op=GET_BLOCK_LOCATIONS';\n" + "$.ajax({\"url\": url` \"crossDomain\": true}).done(function(data) {}).error(network_error_handler(url));\n";" is 194.,80
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.javascript,JavaScriptFilterReaderTest,testMatchedJsContent,Long Statement,The length of the statement "String inputJs="var url = '/webhdfs/v1' + abs_path + '?op=GET_BLOCK_LOCATIONS';\n" + "$.ajax({\"url\": url` \"crossDomain\": true}).done(function(data) {\n" + " var url = http://testhost:8088/cluster/app/application_1436831599487_0001;\n"+ "}).error(network_error_handler(url));\n";" is 282.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.javascript,JavaScriptFilterReaderTest,testMatchedJsContent,Long Statement,The length of the statement "String expectedOutputJs="var url = 'https://knoxhost:8443/webhdfs/v1' + abs_path + '?op=GET_BLOCK_LOCATIONS';\n" + "$.ajax({\"url\": url` \"crossDomain\": true}).done(function(data) {\n" + " var url = https://knoxhost:8443/cluster/app/application_1436831599487_0001;\n"+ "}).error(network_error_handler(url));\n";" is 313.,93
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,processCurrentToken,Complex Method,Cyclomatic complexity of the method is 13,110
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,processStartObject,Magic Number,The method contains a magic number: 2,161
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,processStartObject,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@4d49f25f,161
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,processEndObject,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@962c355,197
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,processStartArray,Magic Number,The method contains a magic number: 2,224
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,processStartArray,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@a811cf7,224
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,processEndArray,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@5ac75487,259
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReader,filterBufferedNode,Complex Method,Cyclomatic complexity of the method is 9,545
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonUrlRewriteStreamFilter,filter,Long Parameter List,The method has 6 parameters. ,50
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonUrlRewriteStreamFilter,filter,Long Statement,The length of the statement "return new ReaderInputStream(new JsonUrlRewriteFilterReader(new InputStreamReader(stream`encoding)`rewriter`resolver`direction`config)`encoding);" is 145.,50
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonUrlRewriteFilterReader,JsonUrlRewriteFilterReader,Long Parameter List,The method has 5 parameters. ,39
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testRootArray,Magic Number,The method contains a magic number: 777,114
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testRootArray,Magic Number,The method contains a magic number: 42,114
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedDetectApply,Long Statement,The length of the statement "JsonAssert.with(output).assertThat("name<properties>[1].name<property>.name<property-value>"`is("value:test-rule-2<test-value-2>"));" is 132.,241
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedApply,Long Statement,The length of the statement "JsonAssert.with(output).assertThat("name<properties>[0].name<property>.name<property-value>"`is("value:test-rule<test-value-1>"));" is 130.,265
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedApply,Long Statement,The length of the statement "JsonAssert.with(output).assertThat("name<properties>[1].name<property>.name<property-value>"`is("value:test-rule<test-value-2>"));" is 130.,265
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedApply,Long Statement,The length of the statement "JsonAssert.with(output).assertThat("name<properties>[2].name<property>.name<property-value>"`is("value:test-rule<test-value-3>"));" is 130.,265
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedMultiApply,Long Statement,The length of the statement "UrlRewriteFilterApplyDescriptor applyConfig=bufferConfig.addApply("$.*.name<property>.name<property-value>"`"test-rule");" is 121.,288
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedMultiApply,Long Statement,The length of the statement "JsonAssert.with(output).assertThat("name<properties>[0].name<property>.name<property-value>"`is("value:test-rule<test-value-1>"));" is 130.,288
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedMultiApply,Long Statement,The length of the statement "JsonAssert.with(output).assertThat("name<properties>[1].name<property>.name<property-value>"`is("value:test-rule<test-value-2>"));" is 130.,288
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.json,JsonFilterReaderTest,testBufferedMultiApply,Long Statement,The length of the statement "JsonAssert.with(output).assertThat("name<properties>[2].name<property>.name<property-value>"`is("value:test-rule<test-value-3>"));" is 130.,288
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.form,FormReader,getNextPair,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@581e9e8a,42
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.form,FormUrlRewriteStreamFilter,filter,Long Parameter List,The method has 6 parameters. ,45
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.form,FormUrlRewriteStreamFilter,filter,Long Statement,The length of the statement "return new ReaderInputStream(new FormUrlRewriteFilterReader(new InputStreamReader(stream`encoding)`rewriter`resolver`direction`config)`encoding);" is 145.,45
apache_knox,org.apache.knox.gateway.filter.rewrite.impl.form,FormUrlRewriteFilterReader,FormUrlRewriteFilterReader,Long Parameter List,The method has 5 parameters. ,40
apache_knox,org.apache.knox.gateway.filter.rewrite.ext,ScopedMatcher,getMatch,Complex Conditional,The conditional expression matchedScope != null && scope != null && !matchedScope.equals(scope) && !matchedScope.equals(GLOBAL_SCOPE) is complex.,99
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.sl4j,Sl4jMessageLogger,isLoggable,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@477996b7,32
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.sl4j,Sl4jMessageLogger,log,Complex Method,Cyclomatic complexity of the method is 12,45
apache_knox,org.apache.knox.gateway.i18n.messages.loggers.sl4j,Sl4jMessageLogger,log,Long Parameter List,The method has 5 parameters. ,45
