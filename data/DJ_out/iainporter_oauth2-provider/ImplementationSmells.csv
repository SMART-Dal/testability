Project Name,Package Name,Type Name,Method Name,Implementation Smell,Cause of the Smell,Method start line no
iainporter_oauth2-provider,com.porterhead.resource,BaseResource,ensureUserIsAuthorized,Complex Conditional,The conditional expression user != null && (user.getId().equals(userId) || user.getEmailAddress().equals(userId.toLowerCase())) is complex.,22
iainporter_oauth2-provider,com.porterhead.filter.jersey,JerseyCrossOriginResourceSharingFilter,filter,Long Statement,The length of the statement "responseContext.getHeaders().add("Access-Control-Allow-Headers"`"X-HTTP-Method-Override` Content-Type` x-requested-with` Authorization");" is 137.,23
iainporter_oauth2-provider,com.porterhead.exception,ValidationException,ValidationException,Long Statement,The length of the statement "error.setPropertyValue(constraintViolation.getInvalidValue() != null ? constraintViolation.getInvalidValue().toString() : null);" is 128.,39
iainporter_oauth2-provider,com.porterhead.exception,ApplicationRuntimeException,ApplicationRuntimeException,Magic Number,The method contains a magic number: 500,10
iainporter_oauth2-provider,com.porterhead.exception,BadClientCredentialsException,BadClientCredentialsException,Long Statement,The length of the statement "super("401"`"Client Credentials were incorrect"`"Client Credentials were incorrect. Useage: Base64Encode(username:password) ");" is 127.,10
iainporter_oauth2-provider,com.porterhead.exception,AccessDeniedExceptionMapper,toResponse,Long Statement,The length of the statement "return Response.status(Response.Status.UNAUTHORIZED).entity(new ErrorResponse("401"`"You do not have the appropriate privileges to access this resource"`exception.getMessage())).type(MediaType.APPLICATION_JSON).build();" is 219.,15
iainporter_oauth2-provider,com.porterhead.configuration,MailServiceConfiguration,velocityEngine,Long Statement,The length of the statement "velocityEngine.setProperty("class.resource.loader.class"`"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader");" is 128.,36
iainporter_oauth2-provider,com.porterhead.configuration,InMemoryMailServiceConfiguration,velocityEngine,Long Statement,The length of the statement "velocityEngine.setProperty("class.resource.loader.class"`"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader");" is 128.,21
iainporter_oauth2-provider,com.porterhead.configuration,MongoDbConfiguration,mongoTemplate,Long Statement,The length of the statement "MongoDbFactory mongoDbFactory=new SimpleMongoDbFactory(mongo()`mongoDBName`new UserCredentials(mongoDbLogin`mongoDbPassword));" is 126.,69
iainporter_oauth2-provider,com.porterhead.configuration,PropertiesConfiguration,getProperties,Long Identifier,The length of the field IGNORE_UNRESOLVABLE_PLACEHOLDERS is 32.,21
iainporter_oauth2-provider,com.porterhead.configuration,PropertiesConfiguration,getProperties,Long Statement,The length of the statement "Resource[] resources=new Resource[]{new ClassPathResource("properties/application.properties")`new ClassPathResource("properties/app-" + profile + ".properties")`new FileSystemResource(System.getProperty("PROPERTY_FILE_LOCATION"`""))};" is 235.,21
iainporter_oauth2-provider,com.porterhead.configuration,UserConfiguration,verificationTokenService,Long Statement,The length of the statement "return new VerificationTokenServiceImpl(userRepository`verificationTokenRepository`mailSenderService`validator`passwordEncoder);" is 128.,42
iainporter_oauth2-provider,com.porterhead.user,UserAuthenticationProvider,authenticate,Long Statement,The length of the statement "final UsernamePasswordAuthenticationToken token=new UsernamePasswordAuthenticationToken(username`password`Arrays.<GrantedAuthority>asList(new SimpleGrantedAuthority("ROLE_USER")));" is 180.,28
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,VerificationTokenServiceImpl,Long Parameter List,The method has 5 parameters. ,56
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,sendEmailVerificationToken,Long Identifier,The length of the field emailVerificationTokenExpiryTimeInMinutes is 41.,73
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,sendEmailVerificationToken,Long Statement,The length of the statement "VerificationToken token=new VerificationToken(user`VerificationTokenType.emailVerification`emailVerificationTokenExpiryTimeInMinutes);" is 134.,73
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,sendEmailRegistrationToken,Long Identifier,The length of the field emailRegistrationTokenExpiryTimeInMinutes is 41.,82
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,sendEmailRegistrationToken,Long Statement,The length of the statement "VerificationToken token=new VerificationToken(user`VerificationTokenType.emailRegistration`emailRegistrationTokenExpiryTimeInMinutes);" is 134.,82
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,sendLostPasswordToken,Long Identifier,The length of the field lostPasswordTokenExpiryTimeInMinutes is 36.,94
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,sendLostPasswordToken,Long Statement,The length of the statement "List<VerificationToken> tokens=tokenRepository.findByUserIdAndTokenType(user.getId()`VerificationTokenType.lostPassword);" is 121.,94
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,generateEmailVerificationToken,Long Statement,The length of the statement "VerificationToken token=getActiveToken(tokenRepository.findByUserIdAndTokenType(user.getId()`VerificationTokenType.emailVerification));" is 135.,135
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,setEmailVerificationTokenExpiryTimeInMinutes,Long Identifier,The length of the parameter emailVerificationTokenExpiryTimeInMinutes is 41.,225
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,setEmailVerificationTokenExpiryTimeInMinutes,Long Identifier,The length of the field emailVerificationTokenExpiryTimeInMinutes is 41.,225
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,setEmailRegistrationTokenExpiryTimeInMinutes,Long Identifier,The length of the parameter emailRegistrationTokenExpiryTimeInMinutes is 41.,229
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,setEmailRegistrationTokenExpiryTimeInMinutes,Long Identifier,The length of the field emailRegistrationTokenExpiryTimeInMinutes is 41.,229
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,setLostPasswordTokenExpiryTimeInMinutes,Long Identifier,The length of the parameter lostPasswordTokenExpiryTimeInMinutes is 36.,233
iainporter_oauth2-provider,com.porterhead.user,VerificationTokenServiceImpl,setLostPasswordTokenExpiryTimeInMinutes,Long Identifier,The length of the field lostPasswordTokenExpiryTimeInMinutes is 36.,233
iainporter_oauth2-provider,com.porterhead.user,MailSenderServiceTest,getVelocityEngine,Long Statement,The length of the statement "velocityEngine.setProperty("class.resource.loader.class"`"org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader");" is 128.,85
iainporter_oauth2-provider,com.porterhead.user,MailSenderServiceTest,sendVerificationEmail,Magic Number,The method contains a magic number: 120,93
iainporter_oauth2-provider,com.porterhead.user,MailSenderServiceTest,sendRegistrationEmail,Magic Number,The method contains a magic number: 120,103
iainporter_oauth2-provider,com.porterhead.user,MailSenderServiceTest,sendLostPasswordEmail,Magic Number,The method contains a magic number: 120,113
iainporter_oauth2-provider,com.porterhead.user,UserServiceTest,badNameRequest,Magic Number,The method contains a magic number: 101,87
iainporter_oauth2-provider,com.porterhead.user,UserServiceTest,createRandomEmailAddress,Magic Number,The method contains a magic number: 8,154
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,setUp,Long Statement,The length of the statement "verificationTokenService=new VerificationTokenServiceImpl(userRepository`tokenRepository`mailSenderService`validator`passwordEncoder);" is 134.,46
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,setUp,Magic Number,The method contains a magic number: 120,46
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,setUp,Magic Number,The method contains a magic number: 120,46
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,setUp,Magic Number,The method contains a magic number: 120,46
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,sendLostPasswordTokenAgain,Long Statement,The length of the statement "VerificationToken token1=verificationTokenService.sendLostPasswordToken(new LostPasswordRequest(user.getEmailAddress()));" is 121.,102
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,sendLostPasswordTokenAgain,Long Statement,The length of the statement "when(tokenRepository.findByUserIdAndTokenType(user.getId()`VerificationTokenType.lostPassword)).thenReturn(Arrays.asList(token1));" is 130.,102
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,sendLostPasswordTokenAgain,Long Statement,The length of the statement "VerificationToken token2=verificationTokenService.sendLostPasswordToken(new LostPasswordRequest(user.getEmailAddress()));" is 121.,102
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,sendLostPasswordTokenAgain,Magic Number,The method contains a magic number: 2,102
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,resetPassword,Magic Number,The method contains a magic number: 2,115
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,resetPasswordGetNewToken,Long Statement,The length of the statement "VerificationToken token2=verificationTokenService.sendLostPasswordToken(new LostPasswordRequest(user.getEmailAddress()));" is 121.,132
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,resetPasswordGetNewToken,Magic Number,The method contains a magic number: 3,132
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,verifyValidToken,Magic Number,The method contains a magic number: 2,174
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,tokenNotFound,Magic Number,The method contains a magic number: 120,231
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,generateEmailTokenAlreadyActive,Long Statement,The length of the statement "when(tokenRepository.findByUserIdAndTokenType(user.getId()`VerificationTokenType.emailVerification)).thenReturn(Arrays.asList(token));" is 134.,260
iainporter_oauth2-provider,com.porterhead.user,VerificationServiceTest,generateEmailTokenAlreadyActive,Magic Number,The method contains a magic number: 2,260
iainporter_oauth2-provider,com.porterhead.user.resource,UserResource,UserResource,Long Parameter List,The method has 5 parameters. ,49
iainporter_oauth2-provider,com.porterhead.user.resource,UserResource,signupUser,Long Statement,The length of the statement "CreateUserResponse createUserResponse=new CreateUserResponse(user`createTokenForNewUser(user.getId()`request.getPassword().getPassword()`sc.getUserPrincipal().getName()));" is 171.,60
iainporter_oauth2-provider,com.porterhead.user.resource,UserResource,createTokenForNewUser,Long Statement,The length of the statement "UsernamePasswordAuthenticationToken userAuthentication=new UsernamePasswordAuthenticationToken(userId`hashedPassword`Collections.singleton(new SimpleGrantedAuthority(Role.ROLE_USER.toString())));" is 195.,80
iainporter_oauth2-provider,com.porterhead.user.resource,UserResource,createTokenForNewUser,Long Statement,The length of the statement "OAuth2Request oAuth2Request=createOAuth2Request(null`clientId`Collections.singleton(new SimpleGrantedAuthority(Role.ROLE_USER.toString()))`true`authenticatedClient.getScope()`null`null`null`null);" is 196.,80
iainporter_oauth2-provider,com.porterhead.user.resource,UserResource,updateUser,Long Statement,The length of the statement "boolean sendVerificationToken=StringUtils.hasLength(request.getEmailAddress()) && !request.getEmailAddress().equals(requestingUser.getEmailAddress());" is 150.,93
iainporter_oauth2-provider,com.porterhead.user.resource,UserResource,createOAuth2Request,Long Parameter List,The method has 9 parameters. ,108
iainporter_oauth2-provider,com.porterhead.user.resource,UserResource,createOAuth2Request,Long Statement,The length of the statement "return new OAuth2Request(requestParameters`clientId`authorities`approved`scope == null ? null : new LinkedHashSet<String>(scope)`resourceIds`redirectUri`responseTypes`extensionProperties);" is 188.,108
iainporter_oauth2-provider,com.porterhead.user.exception,AuthenticationException,AuthenticationException,Magic Number,The method contains a magic number: 401,8
iainporter_oauth2-provider,com.porterhead.user.exception,AlreadyVerifiedException,AlreadyVerifiedException,Magic Number,The method contains a magic number: 409,12
iainporter_oauth2-provider,com.porterhead.user.exception,TokenNotFoundException,TokenNotFoundException,Magic Number,The method contains a magic number: 404,12
iainporter_oauth2-provider,com.porterhead.user.exception,UserNotFoundException,UserNotFoundException,Magic Number,The method contains a magic number: 404,12
iainporter_oauth2-provider,com.porterhead.user.exception,DuplicateUserException,DuplicateUserException,Magic Number,The method contains a magic number: 409,7
iainporter_oauth2-provider,com.porterhead.user.exception,TokenHasExpiredException,TokenHasExpiredException,Magic Number,The method contains a magic number: 403,12
iainporter_oauth2-provider,com.porterhead.user.api,CreateUserRequestTest,validRequest,Magic Number,The method contains a magic number: 10,19
iainporter_oauth2-provider,com.porterhead.user.api,CreateUserRequestTest,nullUser,Magic Number,The method contains a magic number: 10,28
iainporter_oauth2-provider,com.porterhead.user.api,CreateUserRequestTest,invalidPassword,Magic Number,The method contains a magic number: 6,36
iainporter_oauth2-provider,com.porterhead.user.api,CreateUserRequestTest,getValidUser,Magic Number,The method contains a magic number: 8,45
iainporter_oauth2-provider,com.porterhead.user.api,LoginRequestTest,validRequest,Magic Number,The method contains a magic number: 8,19
iainporter_oauth2-provider,com.porterhead.user.api,LoginRequestTest,validRequest,Magic Number,The method contains a magic number: 8,19
iainporter_oauth2-provider,com.porterhead.user.api,LoginRequestTest,invalidEmailAddress,Magic Number,The method contains a magic number: 8,28
iainporter_oauth2-provider,com.porterhead.user.api,LoginRequestTest,invalidPassword,Magic Number,The method contains a magic number: 8,36
iainporter_oauth2-provider,com.porterhead.user.api,LoginRequestTest,invalidPassword,Magic Number,The method contains a magic number: 7,36
iainporter_oauth2-provider,com.porterhead.user.api,PasswordRequestTest,passwordTooShort,Magic Number,The method contains a magic number: 7,36
iainporter_oauth2-provider,com.porterhead.user.api,PasswordRequestTest,passwordTooLong,Magic Number,The method contains a magic number: 36,46
iainporter_oauth2-provider,com.porterhead.oauth2,AuthorizationException,AuthorizationException,Magic Number,The method contains a magic number: 403,13
iainporter_oauth2-provider,com.porterhead.oauth2.mongodb,OAuth2RepositoryTokenStore,storeAccessToken,Long Identifier,The length of the identifier oAuth2AuthenticationAccessToken is 31.,49
iainporter_oauth2-provider,com.porterhead.oauth2.mongodb,OAuth2RepositoryTokenStore,storeAccessToken,Long Statement,The length of the statement "OAuth2AuthenticationAccessToken oAuth2AuthenticationAccessToken=new OAuth2AuthenticationAccessToken(token`authentication`authenticationKeyGenerator.extractKey(authentication));" is 176.,49
iainporter_oauth2-provider,com.porterhead.oauth2.mongodb,OAuth2RepositoryTokenStore,getAccessToken,Long Statement,The length of the statement "OAuth2AuthenticationAccessToken token=oAuth2AccessTokenRepository.findByAuthenticationId(authenticationKeyGenerator.extractKey(authentication));" is 144.,99
iainporter_oauth2-provider,com.porterhead.oauth2.mongodb,OAuth2AuthenticationReadConverter,convert,Long Statement,The length of the statement "OAuth2Request oAuth2Request=new OAuth2Request((Map<String`String>)storedRequest.get("requestParameters")`(String)storedRequest.get("clientId")`null`true`new HashSet((List)storedRequest.get("scope"))`null`null`null`null);" is 220.,25
iainporter_oauth2-provider,com.porterhead.oauth2.mongodb,OAuth2AuthenticationReadConverter,convert,Long Statement,The length of the statement "Authentication userAuthentication=new UsernamePasswordAuthenticationToken(principal`(String)userAuthorization.get("credentials")`getAuthorities((List)userAuthorization.get("authorities")));" is 189.,25
iainporter_oauth2-provider,com.porterhead.mail,MailSenderServiceImpl,sendVerificationEmail,Long Statement,The length of the statement "return sendVerificationEmail(emailVerificationModel`emailVerificationSubjectText`"META-INF/velocity/VerifyEmail.vm"`resources);" is 127.,56
iainporter_oauth2-provider,com.porterhead.mail,MailSenderServiceImpl,sendRegistrationEmail,Long Statement,The length of the statement "return sendVerificationEmail(emailVerificationModel`emailRegistrationSubjectText`"META-INF/velocity/RegistrationEmail.vm"`resources);" is 133.,62
iainporter_oauth2-provider,com.porterhead.mail,MailSenderServiceImpl,sendLostPasswordEmail,Long Statement,The length of the statement "return sendVerificationEmail(emailServiceTokenModel`lostPasswordSubjectText`"META-INF/velocity/LostPasswordEmail.vm"`resources);" is 128.,68
iainporter_oauth2-provider,com.porterhead.mail,MailSenderServiceImpl,sendVerificationEmail,Long Statement,The length of the statement "LOG.debug("Sending {} token to : {}"`emailVerificationModel.getTokenType().toString()`emailVerificationModel.getEmailAddress());" is 128.,80
