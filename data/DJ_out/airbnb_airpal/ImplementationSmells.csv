Project Name,Package Name,Type Name,Method Name,Implementation Smell,Cause of the Smell,Method start line no
airbnb_airpal,com.airbnb.shiro,AllowAllToken,AllowAllToken,Long Parameter List,The method has 7 parameters. ,31
airbnb_airpal,com.airbnb.shiro.filter,AllowAllFilter,createToken,Long Statement,The length of the statement "return new AllowAllToken(request.getRemoteHost()`true`"anonymous"`ImmutableSet.of("all")`"default"`Duration.standardHours(1)`"default");" is 136.,36
airbnb_airpal,com.airbnb.airpal,AirpalApplicationBase,run,Long Statement,The length of the statement "ServletRegistration.Dynamic sseServlet=environment.servlets().addServlet("updates"`injector.getInstance(SSEEventSourceServlet.class));" is 134.,86
airbnb_airpal,com.airbnb.airpal.resources,ExecuteResource,getPermissions,Long Statement,The length of the statement "return Response.ok(new ExecutionPermissions(AuthorizationUtil.isAuthorizedWrite(user`"hive"`"airpal"`"any")`true`user.getUserName()`user.getAccessLevel())).build();" is 164.,54
airbnb_airpal,com.airbnb.airpal.resources,QueryResource,saveQuery,Long Statement,The length of the statement "CreateSavedQueryBuilder createFeaturedQueryRequest=CreateSavedQueryBuilder.featured().description(description).name(name).query(query);" is 135.,67
airbnb_airpal,com.airbnb.airpal.resources,QueryResource,getHistory,Long Statement,The length of the statement "filtered.add(new Job(job.getUser()`job.getQuery()`job.getUuid()`job.getOutput()`job.getQueryStats()`job.getState()`Collections.<Column>emptyList()`Collections.<Table>emptySet()`job.getQueryStartedDateTime()`job.getError()`job.getQueryFinishedDateTime()));" is 255.,126
airbnb_airpal,com.airbnb.airpal.resources,QueryResource,getHistory,Long Statement,The length of the statement "List<Job> sortedResult=Ordering.natural().nullsLast().onResultOf(JOB_ORDERING).reverse().immutableSortedCopy(filtered.build());" is 127.,126
airbnb_airpal,com.airbnb.airpal.resources,QueryResource,getHistory,Magic Number,The method contains a magic number: 200,126
airbnb_airpal,com.airbnb.airpal.resources,QueryResource,getHistory,Magic Number,The method contains a magic number: 200,126
airbnb_airpal,com.airbnb.airpal.resources,UsersResource,getUserPermissions,Long Statement,The length of the statement "return Response.ok(new ExecutionPermissions(AuthorizationUtil.isAuthorizedWrite(user`"hive"`"airpal"`"any")`true`user.getAccessLevel())).build();" is 145.,48
airbnb_airpal,com.airbnb.airpal.resources,UsersResource,getUserQueries,Long Statement,The length of the statement "recentlyRun=jobHistoryStore.getRecentlyRunForUser(userId`results`Iterables.transform(tables`new PartitionedTableToTable()));" is 124.,66
airbnb_airpal,com.airbnb.airpal.resources,UsersResource,getUserQueries,Long Statement,The length of the statement "filtered.add(new Job(job.getUser()`job.getQuery()`job.getUuid()`job.getOutput()`job.getQueryStats()`job.getState()`Collections.<Column>emptyList()`Collections.<Table>emptySet()`job.getQueryStartedDateTime()`job.getError()`job.getQueryFinishedDateTime()));" is 255.,66
airbnb_airpal,com.airbnb.airpal.resources,UsersResource,getUserQueries,Long Statement,The length of the statement "List<Job> sortedResult=Ordering.natural().nullsLast().onResultOf(JOB_ORDERING).reverse().immutableSortedCopy(filtered.build());" is 127.,66
airbnb_airpal,com.airbnb.airpal.resources,UsersResource,getUserQueries,Magic Number,The method contains a magic number: 100,66
airbnb_airpal,com.airbnb.airpal.resources,UsersResource,getUserActiveQueries,Long Statement,The length of the statement "List<Job> sortedResult=Ordering.natural().nullsLast().onResultOf(JOB_ORDERING).reverse().immutableSortedCopy(activeJobsStore.getJobsForUser(user));" is 147.,122
airbnb_airpal,com.airbnb.airpal.resources,QueriesResource,getQueries,Long Statement,The length of the statement "recentlyRun=jobHistoryStore.getRecentlyRun(results`Iterables.transform(tables`new PartitionedTable.PartitionedTableToTable()));" is 127.,50
airbnb_airpal,com.airbnb.airpal.resources,QueriesResource,getQueries,Long Statement,The length of the statement "filtered.add(new Job(job.getUser()`job.getQuery()`job.getUuid()`job.getOutput()`job.getQueryStats()`job.getState()`Collections.<Column>emptyList()`Collections.<Table>emptySet()`job.getQueryStartedDateTime()`job.getError()`job.getQueryFinishedDateTime()));" is 255.,50
airbnb_airpal,com.airbnb.airpal.resources,QueriesResource,getQueries,Long Statement,The length of the statement "List<Job> sortedResult=Ordering.natural().nullsLast().onResultOf(JOB_ORDERING).reverse().immutableSortedCopy(filtered.build());" is 127.,50
airbnb_airpal,com.airbnb.airpal.resources,QueriesResource,getQueries,Magic Number,The method contains a magic number: 200,50
airbnb_airpal,com.airbnb.airpal.resources,UserResource,getUserInfo,Long Statement,The length of the statement "return Response.ok(new UserInfo(user.getUserName()`new ExecutionPermissions(AuthorizationUtil.isAuthorizedWrite(user`"hive"`"airpal"`"any")`true`user.getAccessLevel()))).build();" is 178.,18
airbnb_airpal,com.airbnb.airpal.resources,ResultsPreviewResource,getS3Preview,Magic Number,The method contains a magic number: 100,79
airbnb_airpal,com.airbnb.airpal.resources,ResultsPreviewResource,getS3Preview,Magic Number,The method contains a magic number: 1024,79
airbnb_airpal,com.airbnb.airpal.resources,TablesResource,TablesResource,Long Parameter List,The method has 5 parameters. ,52
airbnb_airpal,com.airbnb.airpal.resources,TablesResource,getTablePreview,Long Parameter List,The method has 6 parameters. ,128
airbnb_airpal,com.airbnb.airpal.resources,TablesResource,getTablePreview,Long Statement,The length of the statement "return Response.ok(previewTableCache.getPreview(Optional.fromNullable(connectorId).or(defaultCatalog)`schema`tableName`partition`partitionValue)).build();" is 154.,128
airbnb_airpal,com.airbnb.airpal.resources,TablesResource,createTablesWithMetaData,Long Statement,The length of the statement "builder.add(PartitionedTableWithMetaData.fromTable(table`lastUsage`usageWindow.getUnit()`(int)usageWindow.getQuantity()`updatedAt));" is 132.,215
airbnb_airpal,com.airbnb.airpal.resources.sse,SSEEventSourceServlet,SSEEventSourceServlet,Long Parameter List,The method has 5 parameters. ,42
airbnb_airpal,com.airbnb.airpal.core.health,PrestoHealthCheck,PrestoHealthCheck,Magic Number,The method contains a magic number: 120,27
airbnb_airpal,com.airbnb.airpal.core.health,PrestoHealthCheck,check,Magic Number,The method contains a magic number: 5,72
airbnb_airpal,com.airbnb.airpal.core.store.usage,CachingUsageStore,CachingUsageStore,Long Statement,The length of the statement "this.cache=CacheBuilder.newBuilder().expireAfterWrite(expireAfter.getQuantity()`expireAfter.getUnit()).build(new CacheLoader<Table`Long>(){" is 139.,19
airbnb_airpal,com.airbnb.airpal.core.store.usage,SQLUsageStore,getUsages,Long Statement,The length of the statement "Query<Map<String`Object>> query=handle.createQuery("SELECT connector_id AS connectorId` schema_ AS \"schema\"` table_ AS \"table\"` COUNT(*) AS count " + "FROM jobs j " + "LEFT OUTER JOIN job_tables jt ON j.id = jt.job_id "+ "LEFT OUTER JOIN tables t ON jt.table_id = t.id "+ "WHERE " + Util.getQueryFinishedCondition(dbType) + " "+ "AND ("+ Util.getTableCondition(Lists.newArrayList(tables))+ ") "+ "GROUP BY connector_id` schema_` table_ "+ "ORDER BY count DESC").bind("day_interval"`1);" is 489.,45
airbnb_airpal,com.airbnb.airpal.core.store.usage,SQLUsageStore,getUsages,Long Statement,The length of the statement "return query.map(RosettaResultSetMapperFactory.mapperFor(JobUsageCountRow.class)).fold(new HashMap<Table`Long>()`new JobUsageCountRow.CountFolder());" is 149.,45
airbnb_airpal,com.airbnb.airpal.core.store.usage,LocalUsageStore,markUsage,Long Statement,The length of the statement "final SlidingTimeWindowReservoir reservoir=new SlidingTimeWindowReservoir(usageTrackTime.getQuantity()`usageTrackTime.getUnit());" is 129.,34
airbnb_airpal,com.airbnb.airpal.core.store.history,JobHistoryStoreDAO,getJobs,Long Statement,The length of the statement "Query<Map<String`Object>> query=handle.createQuery("SELECT " + "j.id AS id` " + "j.query AS query` "+ "j.user AS user` "+ "j.uuid AS uuid` "+ "j.queryStats as queryStats` "+ "j.state AS state` "+ "j.columns AS columns` "+ "j.query_finished AS queryFinished` "+ "j.query_started AS queryStarted` "+ "j.error AS error` "+ "t.connector_id AS connectorId` "+ "t.schema_ AS \"schema\"` "+ "t.table_ AS \"table\"` "+ "t.columns` "+ "jo.type` "+ "jo.description` "+ "jo.location "+ "FROM (SELECT * FROM jobs "+ "WHERE " + Util.getQueryFinishedCondition(dbType) + " "+ "AND "+ innerWhereClause+ " "+ "ORDER BY query_finished DESC LIMIT :limit) j "+ "LEFT OUTER JOIN job_tables jt ON j.id = jt.job_id "+ "LEFT OUTER JOIN tables t ON jt.table_id = t.id "+ "LEFT OUTER JOIN job_outputs jo ON j.id = jo.job_id "+ "WHERE "+ outerWhereClause+ " "+ "ORDER BY query_finished DESC").bind("limit"`limit).bind("day_interval"`dayInterval);" is 919.,49
airbnb_airpal,com.airbnb.airpal.core.store.history,JobHistoryStoreDAO,getJobs,Long Statement,The length of the statement "Map<Long`Job> idToJobMap=query.map(RosettaResultSetMapperFactory.mapperFor(JobTableOutputJoinRow.class)).fold(new HashMap<Long`Job>()`new JobTableOutputJoinRow.JobFolder());" is 173.,49
airbnb_airpal,com.airbnb.airpal.core.store.history,JobHistoryStoreDAO,addRun,Long Statement,The length of the statement "Sets.SetView<Table> tablesToAdd=Sets.difference(job.getTablesUsed()`Sets.newHashSet(Iterables.transform(tablesInDb`TableRow.MAP_TO_TABLE)));" is 140.,151
airbnb_airpal,com.airbnb.airpal.core.store.files,ExpiringFileStore,ExpiringFileStore,Long Statement,The length of the statement "this.fileWithMetadataCache=CacheBuilder.newBuilder().maximumWeight(maxWeightInBytes).weigher(new Weigher<String`FileWithMetadata>(){" is 132.,25
airbnb_airpal,com.airbnb.airpal.core.execution,QueryClient,QueryClient,Magic Number,The method contains a magic number: 60,23
airbnb_airpal,com.airbnb.airpal.core.execution,QueryClient,QueryClient,Magic Number,The method contains a magic number: 30,23
airbnb_airpal,com.airbnb.airpal.core.execution,InputReferenceExtractor,qualifiedNameToTable,Magic Number,The method contains a magic number: 3,37
airbnb_airpal,com.airbnb.airpal.core.execution,InputReferenceExtractor,qualifiedNameToTable,Magic Number,The method contains a magic number: 2,37
airbnb_airpal,com.airbnb.airpal.core.execution,InputReferenceExtractor,qualifiedNameToTable,Magic Number,The method contains a magic number: 2,37
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,doExecute,Complex Method,Cyclomatic complexity of the method is 16,88
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,doExecute,Long Method,The method has 101 lines of code.,88
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,doExecute,Long Statement,The length of the statement "job.setError(new QueryError(e.getMessage()`null`-1`null`null`new ErrorLocation(e.getLineNumber()`e.getColumnNumber())`null));" is 125.,88
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,doExecute,Long Statement,The length of the statement "throw new ExecutionFailureException(job`format("Query exceeded maximum execution time of %s minutes"`Duration.millis(e.getElapsedMs()).getStandardMinutes())`e);" is 160.,88
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,doExecute,Long Statement,The length of the statement "updateJobInfo(null`null`queryInfo.getQueryStats()`JobState.fromStatementState(finalResults.getStats().getState())`finalResults.getError()`outputPreview`true);" is 158.,88
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,apply,Complex Method,Cyclomatic complexity of the method is 10,133
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,rlUpdateJobInfo,Long Parameter List,The method has 6 parameters. ,230
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,updateJobInfo,Complex Conditional,The conditional expression (state != null) && (job.getState() != JobState.FINISHED) && (job.getState() != JobState.FAILED) is complex.,248
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,updateJobInfo,Long Parameter List,The method has 7 parameters. ,248
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,updateJobInfo,Long Statement,The length of the statement "FailureInfo failureInfo=new FailureInfo(error.getFailureInfo().getType()`error.getFailureInfo().getMessage()`null`Collections.<FailureInfo>emptyList()`Collections.<String>emptyList()`error.getFailureInfo().getErrorLocation());" is 226.,248
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,updateJobInfo,Long Statement,The length of the statement "QueryError queryError=new QueryError(error.getMessage()`error.getSqlState()`error.getErrorCode()`error.getErrorName()`error.getErrorType()`error.getErrorLocation()`failureInfo);" is 177.,248
airbnb_airpal,com.airbnb.airpal.core.execution,Execution,createNoOpQueryStats,Long Statement,The length of the statement "return new QueryStats(now`null`now`now`zeroDuration`zeroDuration`zeroDuration`zeroDuration`zeroDuration`zeroDuration`0`0`0`0`0`0`0`0.0`zeroData`zeroData`zeroDuration`zeroDuration`zeroDuration`zeroDuration`false`ImmutableSet.of()`zeroData`0`zeroData`0`zeroData`0);" is 263.,299
airbnb_airpal,com.airbnb.airpal.core.execution,ExecutionClient,ExecutionClient,Long Parameter List,The method has 11 parameters. ,65
airbnb_airpal,com.airbnb.airpal.core.execution,ExecutionClient,runQuery,Long Parameter List,The method has 5 parameters. ,99
airbnb_airpal,com.airbnb.airpal.core.execution,ExecutionClient,runQuery,Long Statement,The length of the statement "final Job job=new Job(user.getUserName()`query`uuid`persistentJobOutputFactory.create(tmpTable`uuid)`null`JobState.QUEUED`Collections.<Column>emptyList()`null`null);" is 165.,99
airbnb_airpal,com.airbnb.airpal.core.execution,ExecutionClient,runQuery,Long Statement,The length of the statement "final Execution execution=new Execution(job`eventBus`queryRunnerFactory.create(user.getUserName()`schema)`queryInfoClient`new QueryExecutionAuthorizer(user`"hive"`user.getDefaultSchema())`timeout`columnCache`outputBuilderFactory`persistorFactory);" is 247.,99
airbnb_airpal,com.airbnb.airpal.core.execution,ExecutionClient,jobFinished,Magic Number,The method contains a magic number: 2,161
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesCreateTable,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`defaultSchema`"users")`new Table(defaultConnector`"the_gibson"`"users_pii"));" is 146.,18
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesCreateView,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`defaultSchema`"users")`new Table(defaultConnector`"the_gibson"`"users_pii"));" is 146.,32
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesReplaceView,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`defaultSchema`"users")`new Table(defaultConnector`"the_gibson"`"users"));" is 142.,46
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesRenameTable,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`"default"`"users")`new Table(defaultConnector`"the_gibson"`"users_pii"));" is 142.,60
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesRenameTable2,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`"default"`"users")`new Table(defaultConnector`"the_gibson"`"users_pii"));" is 142.,74
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesRenameTable3,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`"default"`"users")`new Table("cassandra"`"the_gibson"`"users_pii"));" is 137.,88
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesSelectUnion,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`defaultSchema`"users")`new Table(defaultConnector`"the_gibson"`"users"));" is 142.,102
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesSelectWith,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`defaultSchema`"users")`new Table(defaultConnector`"the_gibson"`"users"));" is 142.,116
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesSelectStarSubquery,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`defaultSchema`"users")`new Table(defaultConnector`"the_gibson"`"users"));" is 142.,156
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesJoinAlias,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(defaultConnector`defaultSchema`"users")`new Table(defaultConnector`defaultSchema`"users_pii"));" is 147.,196
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testTableReferencesSelectConnector,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table("cassandra"`"pii"`"users")`new Table(defaultConnector`defaultSchema`"users_pii"));" is 134.,210
airbnb_airpal,com.airbnb.airpal.core.execution,QueryExecutionAuthorizerTest,testAlternateDefaultConnectorSchemaReferences,Long Statement,The length of the statement "Set<Table> tablesExpected=ImmutableSet.of(new Table(alternateDefaultConnector`alternateDefaultSchema`"users")`new Table(alternateDefaultConnector`alternateDefaultSchema`"users_pii"));" is 183.,240
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,configure,Long Statement,The length of the statement "httpClientBinder(binder()).bindHttpClient("query-info"`ForQueryInfoClient.class).withConfigDefaults(HTTP_CLIENT_CONFIG_DEFAULTS);" is 129.,102
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,configure,Long Statement,The length of the statement "httpClientBinder(binder()).bindHttpClient("query-runner"`ForQueryRunner.class).withConfigDefaults(HTTP_CLIENT_CONFIG_DEFAULTS);" is 127.,102
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,configure,Long Statement,The length of the statement "bind(String.class).annotatedWith(Names.named("createTableDestinationSchema")).toInstance(config.getCreateTableDestinationSchema());" is 131.,102
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,provideClientSessionFactory,Long Statement,The length of the statement "return new ClientSessionFactory(uriProvider`config.getPrestoUser()`config.getPrestoSource()`config.getPrestoCatalog()`config.getPrestoSchema()`config.isPrestoDebug()`null);" is 172.,186
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,provideColumnCache,Long Statement,The length of the statement "return new ColumnCache(queryRunnerFactory`new Duration(5`TimeUnit.MINUTES)`new Duration(60`TimeUnit.MINUTES)`executorService);" is 126.,223
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,provideColumnCache,Magic Number,The method contains a magic number: 5,223
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,provideColumnCache,Magic Number,The method contains a magic number: 60,223
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,providePreviewTableCache,Magic Number,The method contains a magic number: 20,234
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,providePreviewTableCache,Magic Number,The method contains a magic number: 100,234
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,provideUsageCache,Magic Number,The method contains a magic number: 6,344
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,provideAirpalUserFactory,Magic Number,The method contains a magic number: 15,359
airbnb_airpal,com.airbnb.airpal.modules,AirpalModule,provideExpiringFileStore,Magic Number,The method contains a magic number: 100,373
airbnb_airpal,com.airbnb.airpal.modules,DropwizardModule,provideObjectMapper,Long Statement,The length of the statement "mapper.registerSubtypes(new NamedType(CSVPersistentOutput.class`"csv")`new NamedType(HiveTablePersistentOutput.class`"hive"));" is 126.,37
airbnb_airpal,com.airbnb.airpal.presto,ClientSessionFactory,ClientSessionFactory,Long Parameter List,The method has 7 parameters. ,30
airbnb_airpal,com.airbnb.airpal.presto,ClientSessionFactory,create,Long Statement,The length of the statement "return new ClientSession(server.get()`user`source`catalog`schema`timeZoneId`locale`ImmutableMap.<String`String>of()`null`debug`clientSessionTimeout);" is 149.,43
airbnb_airpal,com.airbnb.airpal.presto,ClientSessionFactory,create,Long Statement,The length of the statement "return new ClientSession(server.get()`user`source`catalog`schema`timeZoneId`locale`ImmutableMap.<String`String>of()`null`debug`clientSessionTimeout);" is 149.,59
airbnb_airpal,com.airbnb.airpal.presto,ClientSessionFactory,create,Long Statement,The length of the statement "return new ClientSession(server.get()`user`source`catalog`defaultSchema`timeZoneId`locale`ImmutableMap.<String`String>of()`null`debug`clientSessionTimeout);" is 156.,75
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,PartitionedTable,Long Parameter List,The method has 5 parameters. ,21
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,hashCode,Long Statement,The length of the statement "return getConnectorId().hashCode() + getSchema().hashCode() + getTable().hashCode()+ ((getTable() == null) ? 0 : getTable().hashCode());" is 136.,73
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,equals,Long Statement,The length of the statement "return getConnectorId().equals(otherTable.getConnectorId()) && getSchema().equals(otherTable.getSchema()) && getTable().equals(otherTable.getTable())&& partitionsSame(partitionName`otherTable.getPartitionName());" is 212.,82
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,partitionsSame,Complex Conditional,The conditional expression ((partition1 == null) && (partition2 != null)) || ((partition1 != null) && (partition2 == null)) is complex.,97
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,valueOf,Magic Number,The method contains a magic number: 4,109
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,valueOf,Magic Number,The method contains a magic number: 2,109
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,valueOf,Magic Number,The method contains a magic number: 3,109
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,valueOf,Magic Number,The method contains a magic number: 3,109
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,valueOf,Magic Number,The method contains a magic number: 2,109
airbnb_airpal,com.airbnb.airpal.presto,PartitionedTable,valueOf,Magic Number,The method contains a magic number: 2,109
airbnb_airpal,com.airbnb.airpal.presto,Table,valueOf,Magic Number,The method contains a magic number: 3,57
airbnb_airpal,com.airbnb.airpal.presto,Table,valueOf,Magic Number,The method contains a magic number: 2,57
airbnb_airpal,com.airbnb.airpal.presto,Table,valueOf,Magic Number,The method contains a magic number: 2,57
airbnb_airpal,com.airbnb.airpal.presto,Table,hashCode,Magic Number,The method contains a magic number: 31,89
airbnb_airpal,com.airbnb.airpal.presto,Table,hashCode,Magic Number,The method contains a magic number: 31,89
airbnb_airpal,com.airbnb.airpal.presto,Table,equals,Long Statement,The length of the statement "return getConnectorId().equals(other.getConnectorId()) && getSchema().equals(other.getSchema()) && getTable().equals(other.getTable());" is 135.,98
airbnb_airpal,com.airbnb.airpal.presto,Table,equals,Long Statement,The length of the statement "return getConnectorId().equals(other.getConnectorId()) && getSchema().equals(other.getSchema()) && getTable().equals(other.getTable());" is 135.,98
airbnb_airpal,com.airbnb.airpal.presto,QueryInfoClient,from,Long Statement,The length of the statement "Request request=prepareGet().setHeader(USER_AGENT`USER_AGENT_VALUE).setHeader(ACCEPT`MediaType.JSON_UTF_8.toString()).setUri(infoUri).build();" is 142.,43
airbnb_airpal,com.airbnb.airpal.presto.metadata,PreviewTableCache,PreviewTableCache,Long Statement,The length of the statement "BackgroundCacheLoader<PartitionedTableWithValue`List<List<Object>>> tableLoader=new BackgroundCacheLoader<PartitionedTableWithValue`List<List<Object>>>(listeningExecutor){" is 171.,37
airbnb_airpal,com.airbnb.airpal.presto.metadata,PreviewTableCache,PreviewTableCache,Long Statement,The length of the statement "this.previewTableCache=CacheBuilder.newBuilder().expireAfterWrite(Math.round(previewCacheLifetime.getValue())`previewCacheLifetime.getUnit()).maximumSize(previewLimit).build(tableLoader);" is 187.,37
airbnb_airpal,com.airbnb.airpal.presto.metadata,PreviewTableCache,buildQueryWithLimit,Long Statement,The length of the statement "return format("SELECT * FROM %s %s LIMIT %d"`Util.fqn(table.getConnectorId()`table.getSchema()`table.getTable())`partitionClause`limit);" is 136.,64
airbnb_airpal,com.airbnb.airpal.presto.metadata,PreviewTableCache,queryRows,Magic Number,The method contains a magic number: 60,85
airbnb_airpal,com.airbnb.airpal.presto.metadata,PreviewTableCache,getPreview,Long Parameter List,The method has 5 parameters. ,113
airbnb_airpal,com.airbnb.airpal.presto.metadata,PreviewTableCache,getPreview,Long Statement,The length of the statement "return previewTableCache.get(new PartitionedTableWithValue(new Table(connectorId`schema`table)`partition`partitionValue));" is 122.,113
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,ColumnCache,Long Statement,The length of the statement "BackgroundCacheLoader<String`List<HiveColumn>> columnLoader=new BackgroundCacheLoader<String`List<HiveColumn>>(listeningExecutor){" is 130.,43
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,ColumnCache,Long Statement,The length of the statement "BackgroundCacheLoader<String`List<HivePartition>> partitionLoader=new BackgroundCacheLoader<String`List<HivePartition>>(listeningExecutor){" is 139.,43
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,ColumnCache,Long Statement,The length of the statement "this.schemaTableCache=CacheBuilder.newBuilder().expireAfterWrite(Math.round(columnCacheLifetime.getValue())`columnCacheLifetime.getUnit()).build(columnLoader);" is 159.,43
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,ColumnCache,Long Statement,The length of the statement "this.partitionCache=CacheBuilder.newBuilder().expireAfterWrite(Math.round(partitionCacheLifetime.getValue())`partitionCacheLifetime.getUnit()).build(partitionLoader);" is 166.,43
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,queryPartitions,Magic Number,The method contains a magic number: 60,83
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,queryColumns,Long Statement,The length of the statement "Column column=new Column((String)row.get(0)`(String)row.get(1)`new ClientTypeSignature(TypeSignature.parseTypeSignature((String)row.get(1))));" is 142.,127
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,queryColumns,Magic Number,The method contains a magic number: 60,127
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,queryColumns,Magic Number,The method contains a magic number: 2,127
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,queryColumns,Magic Number,The method contains a magic number: 3,127
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,apply,Long Statement,The length of the statement "Column column=new Column((String)row.get(0)`(String)row.get(1)`new ClientTypeSignature(TypeSignature.parseTypeSignature((String)row.get(1))));" is 142.,135
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,apply,Magic Number,The method contains a magic number: 2,135
airbnb_airpal,com.airbnb.airpal.presto.metadata,ColumnCache,apply,Magic Number,The method contains a magic number: 3,135
airbnb_airpal,com.airbnb.airpal.presto.metadata,SchemaCache,SchemaCache,Long Statement,The length of the statement "BackgroundCacheLoader<String`Map<String`List<String>>> loader=new BackgroundCacheLoader<String`Map<String`List<String>>>(listeningExecutor){" is 140.,45
airbnb_airpal,com.airbnb.airpal.presto.metadata,SchemaCache,SchemaCache,Long Statement,The length of the statement "return queryMetadata(format("SELECT table_catalog` table_schema` table_name " + "FROM information_schema.tables " + "WHERE table_catalog = '%s'"`catalogName));" is 159.,45
airbnb_airpal,com.airbnb.airpal.presto.metadata,SchemaCache,load,Long Statement,The length of the statement "return queryMetadata(format("SELECT table_catalog` table_schema` table_name " + "FROM information_schema.tables " + "WHERE table_catalog = '%s'"`catalogName));" is 159.,55
airbnb_airpal,com.airbnb.airpal.presto.metadata,SchemaCache,queryMetadata,Magic Number,The method contains a magic number: 60,71
airbnb_airpal,com.airbnb.airpal.presto.metadata,SchemaCache,queryMetadata,Magic Number,The method contains a magic number: 2,71
airbnb_airpal,com.airbnb.airpal.presto.metadata,SchemaCache,apply,Magic Number,The method contains a magic number: 2,79
airbnb_airpal,com.airbnb.airpal.api,Job,Job,Long Parameter List,The method has 11 parameters. ,70
airbnb_airpal,com.airbnb.airpal.api,Job,Job,Long Parameter List,The method has 9 parameters. ,96
airbnb_airpal,com.airbnb.airpal.api.output.builders,OutputBuilderFactory,forJob,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@23dea00f,20
airbnb_airpal,com.airbnb.airpal.api.output.persistors,HiveTablePersistor,canPersist,Magic Number,The method contains a magic number: 2,26
airbnb_airpal,com.airbnb.airpal.api.output.persistors,PersistorFactory,getPersistor,Missing default,The following switch statement is missing a default case: !org.eclipse.jdt.core.dom.SwitchStatement@d4e3ce5,12
airbnb_airpal,com.airbnb.airpal.api.queries,CreateSavedQueryBuilder,CreateSavedQueryBuilder,Long Parameter List,The method has 5 parameters. ,30
airbnb_airpal,com.airbnb.airpal.api.queries,CreateSavedQueryBuilder,build,Long Statement,The length of the statement "final FeaturedQuery.QueryWithPlaceholders queryWithPlaceholders=checkNotNull(FeaturedQuery.QueryWithPlaceholders.fromQuery(getQuery())`"Generated query can not be null");" is 170.,77
airbnb_airpal,com.airbnb.airpal.api.queries,CreateSavedQueryBuilder,build,Long Statement,The length of the statement "return new FeaturedQuery(queryWithPlaceholders`getUser()`getName()`getDescription()`getCreatedAt()`UUID.randomUUID()`true);" is 123.,77
airbnb_airpal,com.airbnb.airpal.api.queries,CreateSavedQueryBuilder,build,Long Statement,The length of the statement "return new UserSavedQuery(queryWithPlaceholders`getUser()`getName()`getDescription()`getCreatedAt()`UUID.randomUUID()`false);" is 125.,77
airbnb_airpal,com.airbnb.airpal.api.queries,FeaturedQuery,FeaturedQuery,Long Parameter List,The method has 7 parameters. ,23
airbnb_airpal,com.airbnb.airpal.sql,Util,getTableCondition,Long Statement,The length of the statement "tablesUsedByQuery.add(format("(connector_id = '%s' AND schema_ = '%s' AND table_ = '%s')"`DOT_JOINER.join(alias`table.getConnectorId())`DOT_JOINER.join(alias`table.getSchema())`DOT_JOINER.join(alias`table.getTable())));" is 219.,23
airbnb_airpal,com.airbnb.airpal.sql.dao,TableDAO,getTables,Long Statement,The length of the statement "return handle.createQuery(format("SELECT * FROM tables WHERE %s"`Util.getTableCondition(tables))).mapTo(TableRow.class).list();" is 127.,28
airbnb_airpal,com.airbnb.airpal.sql.jdbi,QueryStoreMapper,map,Long Statement,The length of the statement "return new UserSavedQuery(objectMapper.readValue(r.getString("query")`FeaturedQuery.QueryWithPlaceholders.class)`r.getString("user")`r.getString("name")`r.getString("description")`null`UUID.fromString(r.getString("uuid"))`false);" is 229.,26
